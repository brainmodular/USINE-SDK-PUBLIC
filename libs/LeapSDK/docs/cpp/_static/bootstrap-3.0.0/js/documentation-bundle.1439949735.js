/*! jQuery v1.8.3 jquery.com | jquery.org/license */
(function(e,t){function _(e){var t=M[e]={};return v.each(e.split(y),function(e,n){t[n]=!0}),t}function H(e,n,r){if(r===t&&e.nodeType===1){var i="data-"+n.replace(P,"-$1").toLowerCase();r=e.getAttribute(i);if(typeof r=="string"){try{r=r==="true"?!0:r==="false"?!1:r==="null"?null:+r+""===r?+r:D.test(r)?v.parseJSON(r):r}catch(s){}v.data(e,n,r)}else{r=t}}return r}function B(e){var t;for(t in e){if(t==="data"&&v.isEmptyObject(e[t])){continue}if(t!=="toJSON"){return !1}}return !0}function et(){return !1}function tt(){return !0}function ut(e){return !e||!e.parentNode||e.parentNode.nodeType===11}function at(e,t){do{e=e[t]}while(e&&e.nodeType!==1);return e}function ft(e,t,n){t=t||0;if(v.isFunction(t)){return v.grep(e,function(e,r){var i=!!t.call(e,r,e);return i===n})}if(t.nodeType){return v.grep(e,function(e,r){return e===t===n})}if(typeof t=="string"){var r=v.grep(e,function(e){return e.nodeType===1});if(it.test(t)){return v.filter(t,r,!n)}t=v.filter(t,r)}return v.grep(e,function(e,r){return v.inArray(e,t)>=0===n})}function lt(e){var t=ct.split("|"),n=e.createDocumentFragment();if(n.createElement){while(t.length){n.createElement(t.pop())}}return n}function Lt(e,t){return e.getElementsByTagName(t)[0]||e.appendChild(e.ownerDocument.createElement(t))}function At(e,t){if(t.nodeType!==1||!v.hasData(e)){return}var n,r,i,s=v._data(e),o=v._data(t,s),u=s.events;if(u){delete o.handle,o.events={};for(n in u){for(r=0,i=u[n].length;r<i;r++){v.event.add(t,n,u[n][r])}}}o.data&&(o.data=v.extend({},o.data))}function Ot(e,t){var n;if(t.nodeType!==1){return}t.clearAttributes&&t.clearAttributes(),t.mergeAttributes&&t.mergeAttributes(e),n=t.nodeName.toLowerCase(),n==="object"?(t.parentNode&&(t.outerHTML=e.outerHTML),v.support.html5Clone&&e.innerHTML&&!v.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):n==="input"&&Et.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):n==="option"?t.selected=e.defaultSelected:n==="input"||n==="textarea"?t.defaultValue=e.defaultValue:n==="script"&&t.text!==e.text&&(t.text=e.text),t.removeAttribute(v.expando)}function Mt(e){return typeof e.getElementsByTagName!="undefined"?e.getElementsByTagName("*"):typeof e.querySelectorAll!="undefined"?e.querySelectorAll("*"):[]}function _t(e){Et.test(e.type)&&(e.defaultChecked=e.checked)}function Qt(e,t){if(t in e){return t}var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=Jt.length;while(i--){t=Jt[i]+n;if(t in e){return t}}return r}function Gt(e,t){return e=t||e,v.css(e,"display")==="none"||!v.contains(e.ownerDocument,e)}function Yt(e,t){var n,r,i=[],s=0,o=e.length;for(;s<o;s++){n=e[s];if(!n.style){continue}i[s]=v._data(n,"olddisplay"),t?(!i[s]&&n.style.display==="none"&&(n.style.display=""),n.style.display===""&&Gt(n)&&(i[s]=v._data(n,"olddisplay",nn(n.nodeName)))):(r=Dt(n,"display"),!i[s]&&r!=="none"&&v._data(n,"olddisplay",r))}for(s=0;s<o;s++){n=e[s];if(!n.style){continue}if(!t||n.style.display==="none"||n.style.display===""){n.style.display=t?i[s]||"":"none"}}return e}function Zt(e,t,n){var r=Rt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function en(e,t,n,r){var i=n===(r?"border":"content")?4:t==="width"?1:0,s=0;for(;i<4;i+=2){n==="margin"&&(s+=v.css(e,n+$t[i],!0)),r?(n==="content"&&(s-=parseFloat(Dt(e,"padding"+$t[i]))||0),n!=="margin"&&(s-=parseFloat(Dt(e,"border"+$t[i]+"Width"))||0)):(s+=parseFloat(Dt(e,"padding"+$t[i]))||0,n!=="padding"&&(s+=parseFloat(Dt(e,"border"+$t[i]+"Width"))||0))}return s}function tn(e,t,n){var r=t==="width"?e.offsetWidth:e.offsetHeight,i=!0,s=v.support.boxSizing&&v.css(e,"boxSizing")==="border-box";if(r<=0||r==null){r=Dt(e,t);if(r<0||r==null){r=e.style[t]}if(Ut.test(r)){return r}i=s&&(v.support.boxSizingReliable||r===e.style[t]),r=parseFloat(r)||0}return r+en(e,t,n||(s?"border":"content"),i)+"px"}function nn(e){if(Wt[e]){return Wt[e]}var t=v("<"+e+">").appendTo(i.body),n=t.css("display");t.remove();if(n==="none"||n===""){Pt=i.body.appendChild(Pt||v.extend(i.createElement("iframe"),{frameBorder:0,width:0,height:0}));if(!Ht||!Pt.createElement){Ht=(Pt.contentWindow||Pt.contentDocument).document,Ht.write("<!doctype html><html><body>"),Ht.close()}t=Ht.body.appendChild(Ht.createElement(e)),n=Dt(t,"display"),i.body.removeChild(Pt)}return Wt[e]=n,n}function fn(e,t,n,r){var i;if(v.isArray(t)){v.each(t,function(t,i){n||sn.test(e)?r(e,i):fn(e+"["+(typeof i=="object"?t:"")+"]",i,n,r)})}else{if(!n&&v.type(t)==="object"){for(i in t){fn(e+"["+i+"]",t[i],n,r)}}else{r(e,t)}}}function Cn(e){return function(t,n){typeof t!="string"&&(n=t,t="*");var r,i,s,o=t.toLowerCase().split(y),u=0,a=o.length;if(v.isFunction(n)){for(;u<a;u++){r=o[u],s=/^\+/.test(r),s&&(r=r.substr(1)||"*"),i=e[r]=e[r]||[],i[s?"unshift":"push"](n)}}}}function kn(e,n,r,i,s,o){s=s||n.dataTypes[0],o=o||{},o[s]=!0;var u,a=e[s],f=0,l=a?a.length:0,c=e===Sn;for(;f<l&&(c||!u);f++){u=a[f](n,r,i),typeof u=="string"&&(!c||o[u]?u=t:(n.dataTypes.unshift(u),u=kn(e,n,r,i,u,o)))}return(c||!u)&&!o["*"]&&(u=kn(e,n,r,i,"*",o)),u}function Ln(e,n){var r,i,s=v.ajaxSettings.flatOptions||{};for(r in n){n[r]!==t&&((s[r]?e:i||(i={}))[r]=n[r])}i&&v.extend(!0,e,i)}function An(e,n,r){var i,s,o,u,a=e.contents,f=e.dataTypes,l=e.responseFields;for(s in l){s in r&&(n[l[s]]=r[s])}while(f[0]==="*"){f.shift(),i===t&&(i=e.mimeType||n.getResponseHeader("content-type"))}if(i){for(s in a){if(a[s]&&a[s].test(i)){f.unshift(s);break}}}if(f[0] in r){o=f[0]}else{for(s in r){if(!f[0]||e.converters[s+" "+f[0]]){o=s;break}u||(u=s)}o=o||u}if(o){return o!==f[0]&&f.unshift(o),r[o]}}function On(e,t){var n,r,i,s,o=e.dataTypes.slice(),u=o[0],a={},f=0;e.dataFilter&&(t=e.dataFilter(t,e.dataType));if(o[1]){for(n in e.converters){a[n.toLowerCase()]=e.converters[n]}}for(;i=o[++f];){if(i!=="*"){if(u!=="*"&&u!==i){n=a[u+" "+i]||a["* "+i];if(!n){for(r in a){s=r.split(" ");if(s[1]===i){n=a[u+" "+s[0]]||a["* "+s[0]];if(n){n===!0?n=a[r]:a[r]!==!0&&(i=s[0],o.splice(f--,0,i));break}}}}if(n!==!0){if(n&&e["throws"]){t=n(t)}else{try{t=n(t)}catch(l){return{state:"parsererror",error:n?l:"No conversion from "+u+" to "+i}}}}}u=i}}return{state:"success",data:t}}function Fn(){try{return new e.XMLHttpRequest}catch(t){}}function In(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function $n(){return setTimeout(function(){qn=t},0),qn=v.now()}function Jn(e,t){v.each(t,function(t,n){var r=(Vn[t]||[]).concat(Vn["*"]),i=0,s=r.length;for(;i<s;i++){if(r[i].call(e,t,n)){return}}})}function Kn(e,t,n){var r,i=0,s=0,o=Xn.length,u=v.Deferred().always(function(){delete a.elem}),a=function(){var t=qn||$n(),n=Math.max(0,f.startTime+f.duration-t),r=n/f.duration||0,i=1-r,s=0,o=f.tweens.length;for(;s<o;s++){f.tweens[s].run(i)}return u.notifyWith(e,[f,i,n]),i<1&&o?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:v.extend({},t),opts:v.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:qn||$n(),duration:n.duration,tweens:[],createTween:function(t,n,r){var i=v.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(i),i},stop:function(t){var n=0,r=t?f.tweens.length:0;for(;n<r;n++){f.tweens[n].run(1)}return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;Qn(l,f.opts.specialEasing);for(;i<o;i++){r=Xn[i].call(f,e,l,f.opts);if(r){return r}}return Jn(f,l),v.isFunction(f.opts.start)&&f.opts.start.call(e,f),v.fx.timer(v.extend(a,{anim:f,queue:f.opts.queue,elem:e})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function Qn(e,t){var n,r,i,s,o;for(n in e){r=v.camelCase(n),i=t[r],s=e[n],v.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),o=v.cssHooks[r];if(o&&"expand" in o){s=o.expand(s),delete e[r];for(n in s){n in e||(e[n]=s[n],t[n]=i)}}else{t[r]=i}}}function Gn(e,t,n){var r,i,s,o,u,a,f,l,c,h=this,p=e.style,d={},m=[],g=e.nodeType&&Gt(e);n.queue||(l=v._queueHooks(e,"fx"),l.unqueued==null&&(l.unqueued=0,c=l.empty.fire,l.empty.fire=function(){l.unqueued||c()}),l.unqueued++,h.always(function(){h.always(function(){l.unqueued--,v.queue(e,"fx").length||l.empty.fire()})})),e.nodeType===1&&("height" in t||"width" in t)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],v.css(e,"display")==="inline"&&v.css(e,"float")==="none"&&(!v.support.inlineBlockNeedsLayout||nn(e.nodeName)==="inline"?p.display="inline-block":p.zoom=1)),n.overflow&&(p.overflow="hidden",v.support.shrinkWrapBlocks||h.done(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}));for(r in t){s=t[r];if(Un.exec(s)){delete t[r],a=a||s==="toggle";if(s===(g?"hide":"show")){continue}m.push(r)}}o=m.length;if(o){u=v._data(e,"fxshow")||v._data(e,"fxshow",{}),"hidden" in u&&(g=u.hidden),a&&(u.hidden=!g),g?v(e).show():h.done(function(){v(e).hide()}),h.done(function(){var t;v.removeData(e,"fxshow",!0);for(t in d){v.style(e,t,d[t])}});for(r=0;r<o;r++){i=m[r],f=h.createTween(i,g?u[i]:0),d[i]=u[i]||v.style(e,i),i in u||(u[i]=f.start,g&&(f.end=f.start,f.start=i==="width"||i==="height"?1:0))}}}function Yn(e,t,n,r,i){return new Yn.prototype.init(e,t,n,r,i)}function Zn(e,t){var n,r={height:e},i=0;t=t?1:0;for(;i<4;i+=2-t){n=$t[i],r["margin"+n]=r["padding"+n]=e}return t&&(r.opacity=r.width=e),r}function tr(e){return v.isWindow(e)?e:e.nodeType===9?e.defaultView||e.parentWindow:!1}var n,r,i=e.document,s=e.location,o=e.navigator,u=e.jQuery,a=e.$,f=Array.prototype.push,l=Array.prototype.slice,c=Array.prototype.indexOf,h=Object.prototype.toString,p=Object.prototype.hasOwnProperty,d=String.prototype.trim,v=function(e,t){return new v.fn.init(e,t,n)},m=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,g=/\S/,y=/\s+/,b=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,w=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,E=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,S=/^[\],:{}\s]*$/,x=/(?:^|:|,)(?:\s*\[)+/g,T=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,N=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,C=/^-ms-/,k=/-([\da-z])/gi,L=function(e,t){return(t+"").toUpperCase()},A=function(){i.addEventListener?(i.removeEventListener("DOMContentLoaded",A,!1),v.ready()):i.readyState==="complete"&&(i.detachEvent("onreadystatechange",A),v.ready())},O={};v.fn=v.prototype={constructor:v,init:function(e,n,r){var s,o,u,a;if(!e){return this}if(e.nodeType){return this.context=this[0]=e,this.length=1,this}if(typeof e=="string"){e.charAt(0)==="<"&&e.charAt(e.length-1)===">"&&e.length>=3?s=[null,e,null]:s=w.exec(e);if(s&&(s[1]||!n)){if(s[1]){return n=n instanceof v?n[0]:n,a=n&&n.nodeType?n.ownerDocument||n:i,e=v.parseHTML(s[1],a,!0),E.test(s[1])&&v.isPlainObject(n)&&this.attr.call(e,n,!0),v.merge(this,e)}o=i.getElementById(s[2]);if(o&&o.parentNode){if(o.id!==s[2]){return r.find(e)}this.length=1,this[0]=o}return this.context=i,this.selector=e,this}return !n||n.jquery?(n||r).find(e):this.constructor(n).find(e)}return v.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),v.makeArray(e,this))},selector:"",jquery:"1.8.3",length:0,size:function(){return this.length},toArray:function(){return l.call(this)},get:function(e){return e==null?this.toArray():e<0?this[this.length+e]:this[e]},pushStack:function(e,t,n){var r=v.merge(this.constructor(),e);return r.prevObject=this,r.context=this.context,t==="find"?r.selector=this.selector+(this.selector?" ":"")+n:t&&(r.selector=this.selector+"."+t+"("+n+")"),r},each:function(e,t){return v.each(this,e,t)},ready:function(e){return v.ready.promise().done(e),this},eq:function(e){return e=+e,e===-1?this.slice(e):this.slice(e,e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(l.apply(this,arguments),"slice",l.call(arguments).join(","))},map:function(e){return this.pushStack(v.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:f,sort:[].sort,splice:[].splice},v.fn.init.prototype=v.fn,v.extend=v.fn.extend=function(){var e,n,r,i,s,o,u=arguments[0]||{},a=1,f=arguments.length,l=!1;typeof u=="boolean"&&(l=u,u=arguments[1]||{},a=2),typeof u!="object"&&!v.isFunction(u)&&(u={}),f===a&&(u=this,--a);for(;a<f;a++){if((e=arguments[a])!=null){for(n in e){r=u[n],i=e[n];if(u===i){continue}l&&i&&(v.isPlainObject(i)||(s=v.isArray(i)))?(s?(s=!1,o=r&&v.isArray(r)?r:[]):o=r&&v.isPlainObject(r)?r:{},u[n]=v.extend(l,o,i)):i!==t&&(u[n]=i)}}}return u},v.extend({noConflict:function(t){return e.$===v&&(e.$=a),t&&e.jQuery===v&&(e.jQuery=u),v},isReady:!1,readyWait:1,holdReady:function(e){e?v.readyWait++:v.ready(!0)},ready:function(e){if(e===!0?--v.readyWait:v.isReady){return}if(!i.body){return setTimeout(v.ready,1)}v.isReady=!0;if(e!==!0&&--v.readyWait>0){return}r.resolveWith(i,[v]),v.fn.trigger&&v(i).trigger("ready").off("ready")},isFunction:function(e){return v.type(e)==="function"},isArray:Array.isArray||function(e){return v.type(e)==="array"},isWindow:function(e){return e!=null&&e==e.window},isNumeric:function(e){return !isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return e==null?String(e):O[h.call(e)]||"object"},isPlainObject:function(e){if(!e||v.type(e)!=="object"||e.nodeType||v.isWindow(e)){return !1}try{if(e.constructor&&!p.call(e,"constructor")&&!p.call(e.constructor.prototype,"isPrototypeOf")){return !1}}catch(n){return !1}var r;for(r in e){}return r===t||p.call(e,r)},isEmptyObject:function(e){var t;for(t in e){return !1}return !0},error:function(e){throw new Error(e)},parseHTML:function(e,t,n){var r;return !e||typeof e!="string"?null:(typeof t=="boolean"&&(n=t,t=0),t=t||i,(r=E.exec(e))?[t.createElement(r[1])]:(r=v.buildFragment([e],t,n?null:[]),v.merge([],(r.cacheable?v.clone(r.fragment):r.fragment).childNodes)))},parseJSON:function(t){if(!t||typeof t!="string"){return null}t=v.trim(t);if(e.JSON&&e.JSON.parse){return e.JSON.parse(t)}if(S.test(t.replace(T,"@").replace(N,"]").replace(x,""))){return(new Function("return "+t))()}v.error("Invalid JSON: "+t)},parseXML:function(n){var r,i;if(!n||typeof n!="string"){return null}try{e.DOMParser?(i=new DOMParser,r=i.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))}catch(s){r=t}return(!r||!r.documentElement||r.getElementsByTagName("parsererror").length)&&v.error("Invalid XML: "+n),r},noop:function(){},globalEval:function(t){t&&g.test(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(C,"ms-").replace(k,L)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,n,r){var i,s=0,o=e.length,u=o===t||v.isFunction(e);if(r){if(u){for(i in e){if(n.apply(e[i],r)===!1){break}}}else{for(;s<o;){if(n.apply(e[s++],r)===!1){break}}}}else{if(u){for(i in e){if(n.call(e[i],i,e[i])===!1){break}}}else{for(;s<o;){if(n.call(e[s],s,e[s++])===!1){break}}}}return e},trim:d&&!d.call("\ufeff\u00a0")?function(e){return e==null?"":d.call(e)}:function(e){return e==null?"":(e+"").replace(b,"")},makeArray:function(e,t){var n,r=t||[];return e!=null&&(n=v.type(e),e.length==null||n==="string"||n==="function"||n==="regexp"||v.isWindow(e)?f.call(r,e):v.merge(r,e)),r},inArray:function(e,t,n){var r;if(t){if(c){return c.call(t,e,n)}r=t.length,n=n?n<0?Math.max(0,r+n):n:0;for(;n<r;n++){if(n in t&&t[n]===e){return n}}}return -1},merge:function(e,n){var r=n.length,i=e.length,s=0;if(typeof r=="number"){for(;s<r;s++){e[i++]=n[s]}}else{while(n[s]!==t){e[i++]=n[s++]}}return e.length=i,e},grep:function(e,t,n){var r,i=[],s=0,o=e.length;n=!!n;for(;s<o;s++){r=!!t(e[s],s),n!==r&&i.push(e[s])}return i},map:function(e,n,r){var i,s,o=[],u=0,a=e.length,f=e instanceof v||a!==t&&typeof a=="number"&&(a>0&&e[0]&&e[a-1]||a===0||v.isArray(e));if(f){for(;u<a;u++){i=n(e[u],u,r),i!=null&&(o[o.length]=i)}}else{for(s in e){i=n(e[s],s,r),i!=null&&(o[o.length]=i)}}return o.concat.apply([],o)},guid:1,proxy:function(e,n){var r,i,s;return typeof n=="string"&&(r=e[n],n=e,e=r),v.isFunction(e)?(i=l.call(arguments,2),s=function(){return e.apply(n,i.concat(l.call(arguments)))},s.guid=e.guid=e.guid||v.guid++,s):t},access:function(e,n,r,i,s,o,u){var a,f=r==null,l=0,c=e.length;if(r&&typeof r=="object"){for(l in r){v.access(e,n,l,r[l],1,o,i)}s=1}else{if(i!==t){a=u===t&&v.isFunction(i),f&&(a?(a=n,n=function(e,t,n){return a.call(v(e),n)}):(n.call(e,i),n=null));if(n){for(;l<c;l++){n(e[l],r,a?i.call(e[l],l,n(e[l],r)):i,u)}}s=1}}return s?e:f?n.call(e):c?n(e[0],r):o},now:function(){return(new Date).getTime()}}),v.ready.promise=function(t){if(!r){r=v.Deferred();if(i.readyState==="complete"){setTimeout(v.ready,1)}else{if(i.addEventListener){i.addEventListener("DOMContentLoaded",A,!1),e.addEventListener("load",v.ready,!1)}else{i.attachEvent("onreadystatechange",A),e.attachEvent("onload",v.ready);var n=!1;try{n=e.frameElement==null&&i.documentElement}catch(s){}n&&n.doScroll&&function o(){if(!v.isReady){try{n.doScroll("left")}catch(e){return setTimeout(o,50)}v.ready()}}()}}}return r.promise(t)},v.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(e,t){O["[object "+t+"]"]=t.toLowerCase()}),n=v(i);var M={};v.Callbacks=function(e){e=typeof e=="string"?M[e]||_(e):v.extend({},e);var n,r,i,s,o,u,a=[],f=!e.once&&[],l=function(t){n=e.memory&&t,r=!0,u=s||0,s=0,o=a.length,i=!0;for(;a&&u<o;u++){if(a[u].apply(t[0],t[1])===!1&&e.stopOnFalse){n=!1;break}}i=!1,a&&(f?f.length&&l(f.shift()):n?a=[]:c.disable())},c={add:function(){if(a){var t=a.length;(function r(t){v.each(t,function(t,n){var i=v.type(n);i==="function"?(!e.unique||!c.has(n))&&a.push(n):n&&n.length&&i!=="string"&&r(n)})})(arguments),i?o=a.length:n&&(s=t,l(n))}return this},remove:function(){return a&&v.each(arguments,function(e,t){var n;while((n=v.inArray(t,a,n))>-1){a.splice(n,1),i&&(n<=o&&o--,n<=u&&u--)}}),this},has:function(e){return v.inArray(e,a)>-1},empty:function(){return a=[],this},disable:function(){return a=f=n=t,this},disabled:function(){return !a},lock:function(){return f=t,n||c.disable(),this},locked:function(){return !f},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],a&&(!r||f)&&(i?f.push(t):l(t)),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return !!r}};return c},v.extend({Deferred:function(e){var t=[["resolve","done",v.Callbacks("once memory"),"resolved"],["reject","fail",v.Callbacks("once memory"),"rejected"],["notify","progress",v.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return v.Deferred(function(n){v.each(t,function(t,r){var s=r[0],o=e[t];i[r[1]](v.isFunction(o)?function(){var e=o.apply(this,arguments);e&&v.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[s+"With"](this===i?n:this,[e])}:n[s])}),e=null}).promise()},promise:function(e){return e!=null?v.extend(e,r):r}},i={};return r.pipe=r.then,v.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[e^1][2].disable,t[2][2].lock),i[s[0]]=o.fire,i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=l.call(arguments),r=n.length,i=r!==1||e&&v.isFunction(e.promise)?r:0,s=i===1?e:v.Deferred(),o=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?l.call(arguments):r,n===u?s.notifyWith(t,n):--i||s.resolveWith(t,n)}},u,a,f;if(r>1){u=new Array(r),a=new Array(r),f=new Array(r);for(;t<r;t++){n[t]&&v.isFunction(n[t].promise)?n[t].promise().done(o(t,f,n)).fail(s.reject).progress(o(t,a,u)):--i}}return i||s.resolveWith(f,n),s.promise()}}),v.support=function(){var t,n,r,s,o,u,a,f,l,c,h,p=i.createElement("div");p.setAttribute("className","t"),p.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=p.getElementsByTagName("*"),r=p.getElementsByTagName("a")[0];if(!n||!r||!n.length){return{}}s=i.createElement("select"),o=s.appendChild(i.createElement("option")),u=p.getElementsByTagName("input")[0],r.style.cssText="top:1px;float:left;opacity:.5",t={leadingWhitespace:p.firstChild.nodeType===3,tbody:!p.getElementsByTagName("tbody").length,htmlSerialize:!!p.getElementsByTagName("link").length,style:/top/.test(r.getAttribute("style")),hrefNormalized:r.getAttribute("href")==="/a",opacity:/^0.5/.test(r.style.opacity),cssFloat:!!r.style.cssFloat,checkOn:u.value==="on",optSelected:o.selected,getSetAttribute:p.className!=="t",enctype:!!i.createElement("form").enctype,html5Clone:i.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",boxModel:i.compatMode==="CSS1Compat",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},u.checked=!0,t.noCloneChecked=u.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!o.disabled;try{delete p.test}catch(d){t.deleteExpando=!1}!p.addEventListener&&p.attachEvent&&p.fireEvent&&(p.attachEvent("onclick",h=function(){t.noCloneEvent=!1}),p.cloneNode(!0).fireEvent("onclick"),p.detachEvent("onclick",h)),u=i.createElement("input"),u.value="t",u.setAttribute("type","radio"),t.radioValue=u.value==="t",u.setAttribute("checked","checked"),u.setAttribute("name","t"),p.appendChild(u),a=i.createDocumentFragment(),a.appendChild(p.lastChild),t.checkClone=a.cloneNode(!0).cloneNode(!0).lastChild.checked,t.appendChecked=u.checked,a.removeChild(u),a.appendChild(p);if(p.attachEvent){for(l in {submit:!0,change:!0,focusin:!0}){f="on"+l,c=f in p,c||(p.setAttribute(f,"return;"),c=typeof p[f]=="function"),t[l+"Bubbles"]=c}}return v(function(){var n,r,s,o,u="padding:0;margin:0;border:0;display:block;overflow:hidden;",a=i.getElementsByTagName("body")[0];if(!a){return}n=i.createElement("div"),n.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px",a.insertBefore(n,a.firstChild),r=i.createElement("div"),n.appendChild(r),r.innerHTML="<table><tr><td></td><td>t</td></tr></table>",s=r.getElementsByTagName("td"),s[0].style.cssText="padding:0;margin:0;border:0;display:none",c=s[0].offsetHeight===0,s[0].style.display="",s[1].style.display="none",t.reliableHiddenOffsets=c&&s[0].offsetHeight===0,r.innerHTML="",r.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",t.boxSizing=r.offsetWidth===4,t.doesNotIncludeMarginInBodyOffset=a.offsetTop!==1,e.getComputedStyle&&(t.pixelPosition=(e.getComputedStyle(r,null)||{}).top!=="1%",t.boxSizingReliable=(e.getComputedStyle(r,null)||{width:"4px"}).width==="4px",o=i.createElement("div"),o.style.cssText=r.style.cssText=u,o.style.marginRight=o.style.width="0",r.style.width="1px",r.appendChild(o),t.reliableMarginRight=!parseFloat((e.getComputedStyle(o,null)||{}).marginRight)),typeof r.style.zoom!="undefined"&&(r.innerHTML="",r.style.cssText=u+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=r.offsetWidth===3,r.style.display="block",r.style.overflow="visible",r.innerHTML="<div></div>",r.firstChild.style.width="5px",t.shrinkWrapBlocks=r.offsetWidth!==3,n.style.zoom=1),a.removeChild(n),n=r=s=o=null}),a.removeChild(p),n=r=s=o=u=a=p=null,t}();var D=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,P=/([A-Z])/g;v.extend({cache:{},deletedIds:[],uuid:0,expando:"jQuery"+(v.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return e=e.nodeType?v.cache[e[v.expando]]:e[v.expando],!!e&&!B(e)},data:function(e,n,r,i){if(!v.acceptData(e)){return}var s,o,u=v.expando,a=typeof n=="string",f=e.nodeType,l=f?v.cache:e,c=f?e[u]:e[u]&&u;if((!c||!l[c]||!i&&!l[c].data)&&a&&r===t){return}c||(f?e[u]=c=v.deletedIds.pop()||v.guid++:c=u),l[c]||(l[c]={},f||(l[c].toJSON=v.noop));if(typeof n=="object"||typeof n=="function"){i?l[c]=v.extend(l[c],n):l[c].data=v.extend(l[c].data,n)}return s=l[c],i||(s.data||(s.data={}),s=s.data),r!==t&&(s[v.camelCase(n)]=r),a?(o=s[n],o==null&&(o=s[v.camelCase(n)])):o=s,o},removeData:function(e,t,n){if(!v.acceptData(e)){return}var r,i,s,o=e.nodeType,u=o?v.cache:e,a=o?e[v.expando]:v.expando;if(!u[a]){return}if(t){r=n?u[a]:u[a].data;if(r){v.isArray(t)||(t in r?t=[t]:(t=v.camelCase(t),t in r?t=[t]:t=t.split(" ")));for(i=0,s=t.length;i<s;i++){delete r[t[i]]}if(!(n?B:v.isEmptyObject)(r)){return}}}if(!n){delete u[a].data;if(!B(u[a])){return}}o?v.cleanData([e],!0):v.support.deleteExpando||u!=u.window?delete u[a]:u[a]=null},_data:function(e,t,n){return v.data(e,t,n,!0)},acceptData:function(e){var t=e.nodeName&&v.noData[e.nodeName.toLowerCase()];return !t||t!==!0&&e.getAttribute("classid")===t}}),v.fn.extend({data:function(e,n){var r,i,s,o,u,a=this[0],f=0,l=null;if(e===t){if(this.length){l=v.data(a);if(a.nodeType===1&&!v._data(a,"parsedAttrs")){s=a.attributes;for(u=s.length;f<u;f++){o=s[f].name,o.indexOf("data-")||(o=v.camelCase(o.substring(5)),H(a,o,l[o]))}v._data(a,"parsedAttrs",!0)}}return l}return typeof e=="object"?this.each(function(){v.data(this,e)}):(r=e.split(".",2),r[1]=r[1]?"."+r[1]:"",i=r[1]+"!",v.access(this,function(n){if(n===t){return l=this.triggerHandler("getData"+i,[r[0]]),l===t&&a&&(l=v.data(a,e),l=H(a,e,l)),l===t&&r[1]?this.data(r[0]):l}r[1]=n,this.each(function(){var t=v(this);t.triggerHandler("setData"+i,r),v.data(this,e,n),t.triggerHandler("changeData"+i,r)})},null,n,arguments.length>1,null,!1))},removeData:function(e){return this.each(function(){v.removeData(this,e)})}}),v.extend({queue:function(e,t,n){var r;if(e){return t=(t||"fx")+"queue",r=v._data(e,t),n&&(!r||v.isArray(n)?r=v._data(e,t,v.makeArray(n)):r.push(n)),r||[]}},dequeue:function(e,t){t=t||"fx";var n=v.queue(e,t),r=n.length,i=n.shift(),s=v._queueHooks(e,t),o=function(){v.dequeue(e,t)};i==="inprogress"&&(i=n.shift(),r--),i&&(t==="fx"&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return v._data(e,n)||v._data(e,n,{empty:v.Callbacks("once memory").add(function(){v.removeData(e,t+"queue",!0),v.removeData(e,n,!0)})})}}),v.fn.extend({queue:function(e,n){var r=2;return typeof e!="string"&&(n=e,e="fx",r--),arguments.length<r?v.queue(this[0],e):n===t?this:this.each(function(){var t=v.queue(this,e,n);v._queueHooks(this,e),e==="fx"&&t[0]!=="inprogress"&&v.dequeue(this,e)})},dequeue:function(e){return this.each(function(){v.dequeue(this,e)})},delay:function(e,t){return e=v.fx?v.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var r,i=1,s=v.Deferred(),o=this,u=this.length,a=function(){--i||s.resolveWith(o,[o])};typeof e!="string"&&(n=e,e=t),e=e||"fx";while(u--){r=v._data(o[u],e+"queueHooks"),r&&r.empty&&(i++,r.empty.add(a))}return a(),s.promise(n)}});var j,F,I,q=/[\t\r\n]/g,R=/\r/g,U=/^(?:button|input)$/i,z=/^(?:button|input|object|select|textarea)$/i,W=/^a(?:rea|)$/i,X=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,V=v.support.getSetAttribute;v.fn.extend({attr:function(e,t){return v.access(this,v.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){v.removeAttr(this,e)})},prop:function(e,t){return v.access(this,v.prop,e,t,arguments.length>1)},removeProp:function(e){return e=v.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,r,i,s,o,u;if(v.isFunction(e)){return this.each(function(t){v(this).addClass(e.call(this,t,this.className))})}if(e&&typeof e=="string"){t=e.split(y);for(n=0,r=this.length;n<r;n++){i=this[n];if(i.nodeType===1){if(!i.className&&t.length===1){i.className=e}else{s=" "+i.className+" ";for(o=0,u=t.length;o<u;o++){s.indexOf(" "+t[o]+" ")<0&&(s+=t[o]+" ")}i.className=v.trim(s)}}}}return this},removeClass:function(e){var n,r,i,s,o,u,a;if(v.isFunction(e)){return this.each(function(t){v(this).removeClass(e.call(this,t,this.className))})}if(e&&typeof e=="string"||e===t){n=(e||"").split(y);for(u=0,a=this.length;u<a;u++){i=this[u];if(i.nodeType===1&&i.className){r=(" "+i.className+" ").replace(q," ");for(s=0,o=n.length;s<o;s++){while(r.indexOf(" "+n[s]+" ")>=0){r=r.replace(" "+n[s]+" "," ")}}i.className=e?v.trim(r):""}}}return this},toggleClass:function(e,t){var n=typeof e,r=typeof t=="boolean";return v.isFunction(e)?this.each(function(n){v(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if(n==="string"){var i,s=0,o=v(this),u=t,a=e.split(y);while(i=a[s++]){u=r?u:!o.hasClass(i),o[u?"addClass":"removeClass"](i)}}else{if(n==="undefined"||n==="boolean"){this.className&&v._data(this,"__className__",this.className),this.className=this.className||e===!1?"":v._data(this,"__className__")||""}}})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;n<r;n++){if(this[n].nodeType===1&&(" "+this[n].className+" ").replace(q," ").indexOf(t)>=0){return !0}}return !1},val:function(e){var n,r,i,s=this[0];if(!arguments.length){if(s){return n=v.valHooks[s.type]||v.valHooks[s.nodeName.toLowerCase()],n&&"get" in n&&(r=n.get(s,"value"))!==t?r:(r=s.value,typeof r=="string"?r.replace(R,""):r==null?"":r)}return}return i=v.isFunction(e),this.each(function(r){var s,o=v(this);if(this.nodeType!==1){return}i?s=e.call(this,r,o.val()):s=e,s==null?s="":typeof s=="number"?s+="":v.isArray(s)&&(s=v.map(s,function(e){return e==null?"":e+""})),n=v.valHooks[this.type]||v.valHooks[this.nodeName.toLowerCase()];if(!n||!("set" in n)||n.set(this,s,"value")===t){this.value=s}})}}),v.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return !t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,s=e.type==="select-one"||i<0,o=s?null:[],u=s?i+1:r.length,a=i<0?u:s?i:0;for(;a<u;a++){n=r[a];if((n.selected||a===i)&&(v.support.optDisabled?!n.disabled:n.getAttribute("disabled")===null)&&(!n.parentNode.disabled||!v.nodeName(n.parentNode,"optgroup"))){t=v(n).val();if(s){return t}o.push(t)}}return o},set:function(e,t){var n=v.makeArray(t);return v(e).find("option").each(function(){this.selected=v.inArray(v(this).val(),n)>=0}),n.length||(e.selectedIndex=-1),n}}},attrFn:{},attr:function(e,n,r,i){var s,o,u,a=e.nodeType;if(!e||a===3||a===8||a===2){return}if(i&&v.isFunction(v.fn[n])){return v(e)[n](r)}if(typeof e.getAttribute=="undefined"){return v.prop(e,n,r)}u=a!==1||!v.isXMLDoc(e),u&&(n=n.toLowerCase(),o=v.attrHooks[n]||(X.test(n)?F:j));if(r!==t){if(r===null){v.removeAttr(e,n);return}return o&&"set" in o&&u&&(s=o.set(e,r,n))!==t?s:(e.setAttribute(n,r+""),r)}return o&&"get" in o&&u&&(s=o.get(e,n))!==null?s:(s=e.getAttribute(n),s===null?t:s)},removeAttr:function(e,t){var n,r,i,s,o=0;if(t&&e.nodeType===1){r=t.split(y);for(;o<r.length;o++){i=r[o],i&&(n=v.propFix[i]||i,s=X.test(i),s||v.attr(e,i,""),e.removeAttribute(V?i:n),s&&n in e&&(e[n]=!1))}}},attrHooks:{type:{set:function(e,t){if(U.test(e.nodeName)&&e.parentNode){v.error("type property can't be changed")}else{if(!v.support.radioValue&&t==="radio"&&v.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},value:{get:function(e,t){return j&&v.nodeName(e,"button")?j.get(e,t):t in e?e.value:null},set:function(e,t,n){if(j&&v.nodeName(e,"button")){return j.set(e,t,n)}e.value=t}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,n,r){var i,s,o,u=e.nodeType;if(!e||u===3||u===8||u===2){return}return o=u!==1||!v.isXMLDoc(e),o&&(n=v.propFix[n]||n,s=v.propHooks[n]),r!==t?s&&"set" in s&&(i=s.set(e,r,n))!==t?i:e[n]=r:s&&"get" in s&&(i=s.get(e,n))!==null?i:e[n]},propHooks:{tabIndex:{get:function(e){var n=e.getAttributeNode("tabindex");return n&&n.specified?parseInt(n.value,10):z.test(e.nodeName)||W.test(e.nodeName)&&e.href?0:t}}}}),F={get:function(e,n){var r,i=v.prop(e,n);return i===!0||typeof i!="boolean"&&(r=e.getAttributeNode(n))&&r.nodeValue!==!1?n.toLowerCase():t},set:function(e,t,n){var r;return t===!1?v.removeAttr(e,n):(r=v.propFix[n]||n,r in e&&(e[r]=!0),e.setAttribute(n,n.toLowerCase())),n}},V||(I={name:!0,id:!0,coords:!0},j=v.valHooks.button={get:function(e,n){var r;return r=e.getAttributeNode(n),r&&(I[n]?r.value!=="":r.specified)?r.value:t},set:function(e,t,n){var r=e.getAttributeNode(n);return r||(r=i.createAttribute(n),e.setAttributeNode(r)),r.value=t+""}},v.each(["width","height"],function(e,t){v.attrHooks[t]=v.extend(v.attrHooks[t],{set:function(e,n){if(n===""){return e.setAttribute(t,"auto"),n}}})}),v.attrHooks.contenteditable={get:j.get,set:function(e,t,n){t===""&&(t="false"),j.set(e,t,n)}}),v.support.hrefNormalized||v.each(["href","src","width","height"],function(e,n){v.attrHooks[n]=v.extend(v.attrHooks[n],{get:function(e){var r=e.getAttribute(n,2);return r===null?t:r}})}),v.support.style||(v.attrHooks.style={get:function(e){return e.style.cssText.toLowerCase()||t},set:function(e,t){return e.style.cssText=t+""}}),v.support.optSelected||(v.propHooks.selected=v.extend(v.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),v.support.enctype||(v.propFix.enctype="encoding"),v.support.checkOn||v.each(["radio","checkbox"],function(){v.valHooks[this]={get:function(e){return e.getAttribute("value")===null?"on":e.value}}}),v.each(["radio","checkbox"],function(){v.valHooks[this]=v.extend(v.valHooks[this],{set:function(e,t){if(v.isArray(t)){return e.checked=v.inArray(v(e).val(),t)>=0}}})});var $=/^(?:textarea|input|select)$/i,J=/^([^\.]*|)(?:\.(.+)|)$/,K=/(?:^|\s)hover(\.\S+|)\b/,Q=/^key/,G=/^(?:mouse|contextmenu)|click/,Y=/^(?:focusinfocus|focusoutblur)$/,Z=function(e){return v.event.special.hover?e:e.replace(K,"mouseenter$1 mouseleave$1")};v.event={add:function(e,n,r,i,s){var o,u,a,f,l,c,h,p,d,m,g;if(e.nodeType===3||e.nodeType===8||!n||!r||!(o=v._data(e))){return}r.handler&&(d=r,r=d.handler,s=d.selector),r.guid||(r.guid=v.guid++),a=o.events,a||(o.events=a={}),u=o.handle,u||(o.handle=u=function(e){return typeof v=="undefined"||!!e&&v.event.triggered===e.type?t:v.event.dispatch.apply(u.elem,arguments)},u.elem=e),n=v.trim(Z(n)).split(" ");for(f=0;f<n.length;f++){l=J.exec(n[f])||[],c=l[1],h=(l[2]||"").split(".").sort(),g=v.event.special[c]||{},c=(s?g.delegateType:g.bindType)||c,g=v.event.special[c]||{},p=v.extend({type:c,origType:l[1],data:i,handler:r,guid:r.guid,selector:s,needsContext:s&&v.expr.match.needsContext.test(s),namespace:h.join(".")},d),m=a[c];if(!m){m=a[c]=[],m.delegateCount=0;if(!g.setup||g.setup.call(e,i,h,u)===!1){e.addEventListener?e.addEventListener(c,u,!1):e.attachEvent&&e.attachEvent("on"+c,u)}}g.add&&(g.add.call(e,p),p.handler.guid||(p.handler.guid=r.guid)),s?m.splice(m.delegateCount++,0,p):m.push(p),v.event.global[c]=!0}e=null},global:{},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,m,g=v.hasData(e)&&v._data(e);if(!g||!(h=g.events)){return}t=v.trim(Z(t||"")).split(" ");for(s=0;s<t.length;s++){o=J.exec(t[s])||[],u=a=o[1],f=o[2];if(!u){for(u in h){v.event.remove(e,u+t[s],n,r,!0)}continue}p=v.event.special[u]||{},u=(r?p.delegateType:p.bindType)||u,d=h[u]||[],l=d.length,f=f?new RegExp("(^|\\.)"+f.split(".").sort().join("\\.(?:.*\\.|)")+"(\\.|$)"):null;for(c=0;c<d.length;c++){m=d[c],(i||a===m.origType)&&(!n||n.guid===m.guid)&&(!f||f.test(m.namespace))&&(!r||r===m.selector||r==="**"&&m.selector)&&(d.splice(c--,1),m.selector&&d.delegateCount--,p.remove&&p.remove.call(e,m))}d.length===0&&l!==d.length&&((!p.teardown||p.teardown.call(e,f,g.handle)===!1)&&v.removeEvent(e,u,g.handle),delete h[u])}v.isEmptyObject(h)&&(delete g.handle,v.removeData(e,"events",!0))},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(n,r,s,o){if(!s||s.nodeType!==3&&s.nodeType!==8){var u,a,f,l,c,h,p,d,m,g,y=n.type||n,b=[];if(Y.test(y+v.event.triggered)){return}y.indexOf("!")>=0&&(y=y.slice(0,-1),a=!0),y.indexOf(".")>=0&&(b=y.split("."),y=b.shift(),b.sort());if((!s||v.event.customEvent[y])&&!v.event.global[y]){return}n=typeof n=="object"?n[v.expando]?n:new v.Event(y,n):new v.Event(y),n.type=y,n.isTrigger=!0,n.exclusive=a,n.namespace=b.join("."),n.namespace_re=n.namespace?new RegExp("(^|\\.)"+b.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,h=y.indexOf(":")<0?"on"+y:"";if(!s){u=v.cache;for(f in u){u[f].events&&u[f].events[y]&&v.event.trigger(n,r,u[f].handle.elem,!0)}return}n.result=t,n.target||(n.target=s),r=r!=null?v.makeArray(r):[],r.unshift(n),p=v.event.special[y]||{};if(p.trigger&&p.trigger.apply(s,r)===!1){return}m=[[s,p.bindType||y]];if(!o&&!p.noBubble&&!v.isWindow(s)){g=p.delegateType||y,l=Y.test(g+y)?s:s.parentNode;for(c=s;l;l=l.parentNode){m.push([l,g]),c=l}c===(s.ownerDocument||i)&&m.push([c.defaultView||c.parentWindow||e,g])}for(f=0;f<m.length&&!n.isPropagationStopped();f++){l=m[f][0],n.type=m[f][1],d=(v._data(l,"events")||{})[n.type]&&v._data(l,"handle"),d&&d.apply(l,r),d=h&&l[h],d&&v.acceptData(l)&&d.apply&&d.apply(l,r)===!1&&n.preventDefault()}return n.type=y,!o&&!n.isDefaultPrevented()&&(!p._default||p._default.apply(s.ownerDocument,r)===!1)&&(y!=="click"||!v.nodeName(s,"a"))&&v.acceptData(s)&&h&&s[y]&&(y!=="focus"&&y!=="blur"||n.target.offsetWidth!==0)&&!v.isWindow(s)&&(c=s[h],c&&(s[h]=null),v.event.triggered=y,s[y](),v.event.triggered=t,c&&(s[h]=c)),n.result}return},dispatch:function(n){n=v.event.fix(n||e.event);var r,i,s,o,u,a,f,c,h,p,d=(v._data(this,"events")||{})[n.type]||[],m=d.delegateCount,g=l.call(arguments),y=!n.exclusive&&!n.namespace,b=v.event.special[n.type]||{},w=[];g[0]=n,n.delegateTarget=this;if(b.preDispatch&&b.preDispatch.call(this,n)===!1){return}if(m&&(!n.button||n.type!=="click")){for(s=n.target;s!=this;s=s.parentNode||this){if(s.disabled!==!0||n.type!=="click"){u={},f=[];for(r=0;r<m;r++){c=d[r],h=c.selector,u[h]===t&&(u[h]=c.needsContext?v(h,this).index(s)>=0:v.find(h,this,null,[s]).length),u[h]&&f.push(c)}f.length&&w.push({elem:s,matches:f})}}}d.length>m&&w.push({elem:this,matches:d.slice(m)});for(r=0;r<w.length&&!n.isPropagationStopped();r++){a=w[r],n.currentTarget=a.elem;for(i=0;i<a.matches.length&&!n.isImmediatePropagationStopped();i++){c=a.matches[i];if(y||!n.namespace&&!c.namespace||n.namespace_re&&n.namespace_re.test(c.namespace)){n.data=c.data,n.handleObj=c,o=((v.event.special[c.origType]||{}).handle||c.handler).apply(a.elem,g),o!==t&&(n.result=o,o===!1&&(n.preventDefault(),n.stopPropagation()))}}}return b.postDispatch&&b.postDispatch.call(this,n),n.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return e.which==null&&(e.which=t.charCode!=null?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var r,s,o,u=n.button,a=n.fromElement;return e.pageX==null&&n.clientX!=null&&(r=e.target.ownerDocument||i,s=r.documentElement,o=r.body,e.pageX=n.clientX+(s&&s.scrollLeft||o&&o.scrollLeft||0)-(s&&s.clientLeft||o&&o.clientLeft||0),e.pageY=n.clientY+(s&&s.scrollTop||o&&o.scrollTop||0)-(s&&s.clientTop||o&&o.clientTop||0)),!e.relatedTarget&&a&&(e.relatedTarget=a===e.target?n.toElement:a),!e.which&&u!==t&&(e.which=u&1?1:u&2?3:u&4?2:0),e}},fix:function(e){if(e[v.expando]){return e}var t,n,r=e,s=v.event.fixHooks[e.type]||{},o=s.props?this.props.concat(s.props):this.props;e=v.Event(r);for(t=o.length;t;){n=o[--t],e[n]=r[n]}return e.target||(e.target=r.srcElement||i),e.target.nodeType===3&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,s.filter?s.filter(e,r):e},special:{load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(e,t,n){v.isWindow(this)&&(this.onbeforeunload=n)},teardown:function(e,t){this.onbeforeunload===t&&(this.onbeforeunload=null)}}},simulate:function(e,t,n,r){var i=v.extend(new v.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?v.event.trigger(i,null,t):v.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},v.event.handle=v.event.dispatch,v.removeEvent=i.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&(typeof e[r]=="undefined"&&(e[r]=null),e.detachEvent(r,n))},v.Event=function(e,t){if(!(this instanceof v.Event)){return new v.Event(e,t)}e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?tt:et):this.type=e,t&&v.extend(this,t),this.timeStamp=e&&e.timeStamp||v.now(),this[v.expando]=!0},v.Event.prototype={preventDefault:function(){this.isDefaultPrevented=tt;var e=this.originalEvent;if(!e){return}e.preventDefault?e.preventDefault():e.returnValue=!1},stopPropagation:function(){this.isPropagationStopped=tt;var e=this.originalEvent;if(!e){return}e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=tt,this.stopPropagation()},isDefaultPrevented:et,isPropagationStopped:et,isImmediatePropagationStopped:et},v.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){v.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj,o=s.selector;if(!i||i!==r&&!v.contains(r,i)){e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t}return n}}}),v.support.submitBubbles||(v.event.special.submit={setup:function(){if(v.nodeName(this,"form")){return !1}v.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,r=v.nodeName(n,"input")||v.nodeName(n,"button")?n.form:t;r&&!v._data(r,"_submit_attached")&&(v.event.add(r,"submit._submit",function(e){e._submit_bubble=!0}),v._data(r,"_submit_attached",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&v.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){if(v.nodeName(this,"form")){return !1}v.event.remove(this,"._submit")}}),v.support.changeBubbles||(v.event.special.change={setup:function(){if($.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio"){v.event.add(this,"propertychange._change",function(e){e.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),v.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),v.event.simulate("change",this,e,!0)})}return !1}v.event.add(this,"beforeactivate._change",function(e){var t=e.target;$.test(t.nodeName)&&!v._data(t,"_change_attached")&&(v.event.add(t,"change._change",function(e){this.parentNode&&!e.isSimulated&&!e.isTrigger&&v.event.simulate("change",this.parentNode,e,!0)}),v._data(t,"_change_attached",!0))})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||t.type!=="radio"&&t.type!=="checkbox"){return e.handleObj.handler.apply(this,arguments)}},teardown:function(){return v.event.remove(this,"._change"),!$.test(this.nodeName)}}),v.support.focusinBubbles||v.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){v.event.simulate(t,e.target,v.event.fix(e),!0)};v.event.special[t]={setup:function(){n++===0&&i.addEventListener(e,r,!0)},teardown:function(){--n===0&&i.removeEventListener(e,r,!0)}}}),v.fn.extend({on:function(e,n,r,i,s){var o,u;if(typeof e=="object"){typeof n!="string"&&(r=r||n,n=t);for(u in e){this.on(u,n,r,e[u],s)}return this}r==null&&i==null?(i=n,r=n=t):i==null&&(typeof n=="string"?(i=r,r=t):(i=r,r=n,n=t));if(i===!1){i=et}else{if(!i){return this}}return s===1&&(o=i,i=function(e){return v().off(e),o.apply(this,arguments)},i.guid=o.guid||(o.guid=v.guid++)),this.each(function(){v.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,n,r){var i,s;if(e&&e.preventDefault&&e.handleObj){return i=e.handleObj,v(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this}if(typeof e=="object"){for(s in e){this.off(s,n,e[s])}return this}if(n===!1||typeof n=="function"){r=n,n=t}return r===!1&&(r=et),this.each(function(){v.event.remove(this,e,r,n)})},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},live:function(e,t,n){return v(this.context).on(e,this.selector,t,n),this},die:function(e,t){return v(this.context).off(e,this.selector||"**",t),this},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return arguments.length===1?this.off(e,"**"):this.off(t,e||"**",n)},trigger:function(e,t){return this.each(function(){v.event.trigger(e,t,this)})},triggerHandler:function(e,t){if(this[0]){return v.event.trigger(e,t,this[0],!0)}},toggle:function(e){var t=arguments,n=e.guid||v.guid++,r=0,i=function(n){var i=(v._data(this,"lastToggle"+e.guid)||0)%r;return v._data(this,"lastToggle"+e.guid,i+1),n.preventDefault(),t[i].apply(this,arguments)||!1};i.guid=n;while(r<t.length){t[r++].guid=n}return this.click(i)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),v.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){v.fn[t]=function(e,n){return n==null&&(n=e,e=null),arguments.length>0?this.on(t,null,e,n):this.trigger(t)},Q.test(t)&&(v.event.fixHooks[t]=v.event.keyHooks),G.test(t)&&(v.event.fixHooks[t]=v.event.mouseHooks)}),function(e,t){function nt(e,t,n,r){n=n||[],t=t||g;var i,s,a,f,l=t.nodeType;if(!e||typeof e!="string"){return n}if(l!==1&&l!==9){return[]}a=o(t);if(!a&&!r){if(i=R.exec(e)){if(f=i[1]){if(l===9){s=t.getElementById(f);if(!s||!s.parentNode){return n}if(s.id===f){return n.push(s),n}}else{if(t.ownerDocument&&(s=t.ownerDocument.getElementById(f))&&u(t,s)&&s.id===f){return n.push(s),n}}}else{if(i[2]){return S.apply(n,x.call(t.getElementsByTagName(e),0)),n}if((f=i[3])&&Z&&t.getElementsByClassName){return S.apply(n,x.call(t.getElementsByClassName(f),0)),n}}}}return vt(e.replace(j,"$1"),t,n,r,a)}function rt(e){return function(t){var n=t.nodeName.toLowerCase();return n==="input"&&t.type===e}}function it(e){return function(t){var n=t.nodeName.toLowerCase();return(n==="input"||n==="button")&&t.type===e}}function st(e){return N(function(t){return t=+t,N(function(n,r){var i,s=e([],n.length,t),o=s.length;while(o--){n[i=s[o]]&&(n[i]=!(r[i]=n[i]))}})})}function ot(e,t,n){if(e===t){return n}var r=e.nextSibling;while(r){if(r===t){return -1}r=r.nextSibling}return 1}function ut(e,t){var n,r,s,o,u,a,f,l=L[d][e+" "];if(l){return t?0:l.slice(0)}u=e,a=[],f=i.preFilter;while(u){if(!n||(r=F.exec(u))){r&&(u=u.slice(r[0].length)||u),a.push(s=[])}n=!1;if(r=I.exec(u)){s.push(n=new m(r.shift())),u=u.slice(n.length),n.type=r[0].replace(j," ")}for(o in i.filter){(r=J[o].exec(u))&&(!f[o]||(r=f[o](r)))&&(s.push(n=new m(r.shift())),u=u.slice(n.length),n.type=o,n.matches=r)}if(!n){break}}return t?u.length:u?nt.error(e):L(e,a).slice(0)}function at(e,t,r){var i=t.dir,s=r&&t.dir==="parentNode",o=w++;return t.first?function(t,n,r){while(t=t[i]){if(s||t.nodeType===1){return e(t,n,r)}}}:function(t,r,u){if(!u){var a,f=b+" "+o+" ",l=f+n;while(t=t[i]){if(s||t.nodeType===1){if((a=t[d])===l){return t.sizset}if(typeof a=="string"&&a.indexOf(f)===0){if(t.sizset){return t}}else{t[d]=l;if(e(t,r,u)){return t.sizset=!0,t}t.sizset=!1}}}}else{while(t=t[i]){if(s||t.nodeType===1){if(e(t,r,u)){return t}}}}}}function ft(e){return e.length>1?function(t,n,r){var i=e.length;while(i--){if(!e[i](t,n,r)){return !1}}return !0}:e[0]}function lt(e,t,n,r,i){var s,o=[],u=0,a=e.length,f=t!=null;for(;u<a;u++){if(s=e[u]){if(!n||n(s,r,i)){o.push(s),f&&t.push(u)}}}return o}function ct(e,t,n,r,i,s){return r&&!r[d]&&(r=ct(r)),i&&!i[d]&&(i=ct(i,s)),N(function(s,o,u,a){var f,l,c,h=[],p=[],d=o.length,v=s||dt(t||"*",u.nodeType?[u]:u,[]),m=e&&(s||!t)?lt(v,h,e,u,a):v,g=n?i||(s?e:d||r)?[]:o:m;n&&n(m,g,u,a);if(r){f=lt(g,p),r(f,[],u,a),l=f.length;while(l--){if(c=f[l]){g[p[l]]=!(m[p[l]]=c)}}}if(s){if(i||e){if(i){f=[],l=g.length;while(l--){(c=g[l])&&f.push(m[l]=c)}i(null,g=[],f,a)}l=g.length;while(l--){(c=g[l])&&(f=i?T.call(s,c):h[l])>-1&&(s[f]=!(o[f]=c))}}}else{g=lt(g===o?g.splice(d,g.length):g),i?i(null,o,g,a):S.apply(o,g)}})}function ht(e){var t,n,r,s=e.length,o=i.relative[e[0].type],u=o||i.relative[" "],a=o?1:0,f=at(function(e){return e===t},u,!0),l=at(function(e){return T.call(t,e)>-1},u,!0),h=[function(e,n,r){return !o&&(r||n!==c)||((t=n).nodeType?f(e,n,r):l(e,n,r))}];for(;a<s;a++){if(n=i.relative[e[a].type]){h=[at(ft(h),n)]}else{n=i.filter[e[a].type].apply(null,e[a].matches);if(n[d]){r=++a;for(;r<s;r++){if(i.relative[e[r].type]){break}}return ct(a>1&&ft(h),a>1&&e.slice(0,a-1).join("").replace(j,"$1"),n,a<r&&ht(e.slice(a,r)),r<s&&ht(e=e.slice(r)),r<s&&e.join(""))}h.push(n)}}return ft(h)}function pt(e,t){var r=t.length>0,s=e.length>0,o=function(u,a,f,l,h){var p,d,v,m=[],y=0,w="0",x=u&&[],T=h!=null,N=c,C=u||s&&i.find.TAG("*",h&&a.parentNode||a),k=b+=N==null?1:Math.E;T&&(c=a!==g&&a,n=o.el);for(;(p=C[w])!=null;w++){if(s&&p){for(d=0;v=e[d];d++){if(v(p,a,f)){l.push(p);break}}T&&(b=k,n=++o.el)}r&&((p=!v&&p)&&y--,u&&x.push(p))}y+=w;if(r&&w!==y){for(d=0;v=t[d];d++){v(x,m,a,f)}if(u){if(y>0){while(w--){!x[w]&&!m[w]&&(m[w]=E.call(l))}}m=lt(m)}S.apply(l,m),T&&!u&&m.length>0&&y+t.length>1&&nt.uniqueSort(l)}return T&&(b=k,c=N),x};return o.el=0,r?N(o):o}function dt(e,t,n){var r=0,i=t.length;for(;r<i;r++){nt(e,t[r],n)}return n}function vt(e,t,n,r,s){var o,u,f,l,c,h=ut(e),p=h.length;if(!r&&h.length===1){u=h[0]=h[0].slice(0);if(u.length>2&&(f=u[0]).type==="ID"&&t.nodeType===9&&!s&&i.relative[u[1].type]){t=i.find.ID(f.matches[0].replace($,""),t,s)[0];if(!t){return n}e=e.slice(u.shift().length)}for(o=J.POS.test(e)?-1:u.length-1;o>=0;o--){f=u[o];if(i.relative[l=f.type]){break}if(c=i.find[l]){if(r=c(f.matches[0].replace($,""),z.test(u[0].type)&&t.parentNode||t,s)){u.splice(o,1),e=r.length&&u.join("");if(!e){return S.apply(n,x.call(r,0)),n}break}}}}return a(e,h)(r,t,s,n,z.test(e)),n}function mt(){}var n,r,i,s,o,u,a,f,l,c,h=!0,p="undefined",d=("sizcache"+Math.random()).replace(".",""),m=String,g=e.document,y=g.documentElement,b=0,w=0,E=[].pop,S=[].push,x=[].slice,T=[].indexOf||function(e){var t=0,n=this.length;for(;t<n;t++){if(this[t]===e){return t}}return -1},N=function(e,t){return e[d]=t==null||t,e},C=function(){var e={},t=[];return N(function(n,r){return t.push(n)>i.cacheLength&&delete e[t.shift()],e[n+" "]=r},e)},k=C(),L=C(),A=C(),O="[\\x20\\t\\r\\n\\f]",M="(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+",_=M.replace("w","w#"),D="([*^$|!~]?=)",P="\\["+O+"*("+M+")"+O+"*(?:"+D+O+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+_+")|)|)"+O+"*\\]",H=":("+M+")(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:"+P+")|[^:]|\\\\.)*|.*))\\)|)",B=":(even|odd|eq|gt|lt|nth|first|last)(?:\\("+O+"*((?:-\\d)?\\d*)"+O+"*\\)|)(?=[^-]|$)",j=new RegExp("^"+O+"+|((?:^|[^\\\\])(?:\\\\.)*)"+O+"+$","g"),F=new RegExp("^"+O+"*,"+O+"*"),I=new RegExp("^"+O+"*([\\x20\\t\\r\\n\\f>+~])"+O+"*"),q=new RegExp(H),R=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,U=/^:not/,z=/[\x20\t\r\n\f]*[+~]/,W=/:not\($/,X=/h\d/i,V=/input|select|textarea|button/i,$=/\\(?!\\)/g,J={ID:new RegExp("^#("+M+")"),CLASS:new RegExp("^\\.("+M+")"),NAME:new RegExp("^\\[name=['\"]?("+M+")['\"]?\\]"),TAG:new RegExp("^("+M.replace("w","w*")+")"),ATTR:new RegExp("^"+P),PSEUDO:new RegExp("^"+H),POS:new RegExp(B,"i"),CHILD:new RegExp("^:(only|nth|first|last)-child(?:\\("+O+"*(even|odd|(([+-]|)(\\d*)n|)"+O+"*(?:([+-]|)"+O+"*(\\d+)|))"+O+"*\\)|)","i"),needsContext:new RegExp("^"+O+"*[>+~]|"+B,"i")},K=function(e){var t=g.createElement("div");try{return e(t)}catch(n){return !1}finally{t=null}},Q=K(function(e){return e.appendChild(g.createComment("")),!e.getElementsByTagName("*").length}),G=K(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!==p&&e.firstChild.getAttribute("href")==="#"}),Y=K(function(e){e.innerHTML="<select></select>";var t=typeof e.lastChild.getAttribute("multiple");return t!=="boolean"&&t!=="string"}),Z=K(function(e){return e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",!e.getElementsByClassName||!e.getElementsByClassName("e").length?!1:(e.lastChild.className="e",e.getElementsByClassName("e").length===2)}),et=K(function(e){e.id=d+0,e.innerHTML="<a name='"+d+"'></a><div name='"+d+"'></div>",y.insertBefore(e,y.firstChild);var t=g.getElementsByName&&g.getElementsByName(d).length===2+g.getElementsByName(d+0).length;return r=!g.getElementById(d),y.removeChild(e),t});try{x.call(y.childNodes,0)[0].nodeType}catch(tt){x=function(e){var t,n=[];for(;t=this[e];e++){n.push(t)}return n}}nt.matches=function(e,t){return nt(e,null,null,t)},nt.matchesSelector=function(e,t){return nt(t,null,null,[e]).length>0},s=nt.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(i===1||i===9||i===11){if(typeof e.textContent=="string"){return e.textContent}for(e=e.firstChild;e;e=e.nextSibling){n+=s(e)}}else{if(i===3||i===4){return e.nodeValue}}}else{for(;t=e[r];r++){n+=s(t)}}return n},o=nt.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?t.nodeName!=="HTML":!1},u=nt.contains=y.contains?function(e,t){var n=e.nodeType===9?e.documentElement:e,r=t&&t.parentNode;return e===r||!!(r&&r.nodeType===1&&n.contains&&n.contains(r))}:y.compareDocumentPosition?function(e,t){return t&&!!(e.compareDocumentPosition(t)&16)}:function(e,t){while(t=t.parentNode){if(t===e){return !0}}return !1},nt.attr=function(e,t){var n,r=o(e);return r||(t=t.toLowerCase()),(n=i.attrHandle[t])?n(e):r||Y?e.getAttribute(t):(n=e.getAttributeNode(t),n?typeof e[t]=="boolean"?e[t]?t:null:n.specified?n.value:null:null)},i=nt.selectors={cacheLength:50,createPseudo:N,match:J,attrHandle:G?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},find:{ID:r?function(e,t,n){if(typeof t.getElementById!==p&&!n){var r=t.getElementById(e);return r&&r.parentNode?[r]:[]}}:function(e,n,r){if(typeof n.getElementById!==p&&!r){var i=n.getElementById(e);return i?i.id===e||typeof i.getAttributeNode!==p&&i.getAttributeNode("id").value===e?[i]:t:[]}},TAG:Q?function(e,t){if(typeof t.getElementsByTagName!==p){return t.getElementsByTagName(e)}}:function(e,t){var n=t.getElementsByTagName(e);if(e==="*"){var r,i=[],s=0;for(;r=n[s];s++){r.nodeType===1&&i.push(r)}return i}return n},NAME:et&&function(e,t){if(typeof t.getElementsByName!==p){return t.getElementsByName(name)}},CLASS:Z&&function(e,t,n){if(typeof t.getElementsByClassName!==p&&!n){return t.getElementsByClassName(e)}}},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace($,""),e[3]=(e[4]||e[5]||"").replace($,""),e[2]==="~="&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),e[1]==="nth"?(e[2]||nt.error(e[0]),e[3]=+(e[3]?e[4]+(e[5]||1):2*(e[2]==="even"||e[2]==="odd")),e[4]=+(e[6]+e[7]||e[2]==="odd")):e[2]&&nt.error(e[0]),e},PSEUDO:function(e){var t,n;if(J.CHILD.test(e[0])){return null}if(e[3]){e[2]=e[3]}else{if(t=e[4]){q.test(t)&&(n=ut(t,!0))&&(n=t.indexOf(")",t.length-n)-t.length)&&(t=t.slice(0,n),e[0]=e[0].slice(0,n)),e[2]=t}}return e.slice(0,3)}},filter:{ID:r?function(e){return e=e.replace($,""),function(t){return t.getAttribute("id")===e}}:function(e){return e=e.replace($,""),function(t){var n=typeof t.getAttributeNode!==p&&t.getAttributeNode("id");return n&&n.value===e}},TAG:function(e){return e==="*"?function(){return !0}:(e=e.replace($,"").toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===e})},CLASS:function(e){var t=k[d][e+" "];return t||(t=new RegExp("(^|"+O+")"+e+"("+O+"|$)"))&&k(e,function(e){return t.test(e.className||typeof e.getAttribute!==p&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r,i){var s=nt.attr(r,e);return s==null?t==="!=":t?(s+="",t==="="?s===n:t==="!="?s!==n:t==="^="?n&&s.indexOf(n)===0:t==="*="?n&&s.indexOf(n)>-1:t==="$="?n&&s.substr(s.length-n.length)===n:t==="~="?(" "+s+" ").indexOf(n)>-1:t==="|="?s===n||s.substr(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r){return e==="nth"?function(e){var t,i,s=e.parentNode;if(n===1&&r===0){return !0}if(s){i=0;for(t=s.firstChild;t;t=t.nextSibling){if(t.nodeType===1){i++;if(e===t){break}}}}return i-=r,i===n||i%n===0&&i/n>=0}:function(t){var n=t;switch(e){case"only":case"first":while(n=n.previousSibling){if(n.nodeType===1){return !1}}if(e==="first"){return !0}n=t;case"last":while(n=n.nextSibling){if(n.nodeType===1){return !1}}return !0}}},PSEUDO:function(e,t){var n,r=i.pseudos[e]||i.setFilters[e.toLowerCase()]||nt.error("unsupported pseudo: "+e);return r[d]?r(t):r.length>1?(n=[e,e,"",t],i.setFilters.hasOwnProperty(e.toLowerCase())?N(function(e,n){var i,s=r(e,t),o=s.length;while(o--){i=T.call(e,s[o]),e[i]=!(n[i]=s[o])}}):function(e){return r(e,0,n)}):r}},pseudos:{not:N(function(e){var t=[],n=[],r=a(e.replace(j,"$1"));return r[d]?N(function(e,t,n,i){var s,o=r(e,null,i,[]),u=e.length;while(u--){if(s=o[u]){e[u]=!(t[u]=s)}}}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:N(function(e){return function(t){return nt(e,t).length>0}}),contains:N(function(e){return function(t){return(t.textContent||t.innerText||s(t)).indexOf(e)>-1}}),enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&!!e.checked||t==="option"&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},parent:function(e){return !i.pseudos.empty(e)},empty:function(e){var t;e=e.firstChild;while(e){if(e.nodeName>"@"||(t=e.nodeType)===3||t===4){return !1}e=e.nextSibling}return !0},header:function(e){return X.test(e.nodeName)},text:function(e){var t,n;return e.nodeName.toLowerCase()==="input"&&(t=e.type)==="text"&&((n=e.getAttribute("type"))==null||n.toLowerCase()===t)},radio:rt("radio"),checkbox:rt("checkbox"),file:rt("file"),password:rt("password"),image:rt("image"),submit:it("submit"),reset:it("reset"),button:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&e.type==="button"||t==="button"},input:function(e){return V.test(e.nodeName)},focus:function(e){var t=e.ownerDocument;return e===t.activeElement&&(!t.hasFocus||t.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},active:function(e){return e===e.ownerDocument.activeElement},first:st(function(){return[0]}),last:st(function(e,t){return[t-1]}),eq:st(function(e,t,n){return[n<0?n+t:n]}),even:st(function(e,t){for(var n=0;n<t;n+=2){e.push(n)}return e}),odd:st(function(e,t){for(var n=1;n<t;n+=2){e.push(n)}return e}),lt:st(function(e,t,n){for(var r=n<0?n+t:n;--r>=0;){e.push(r)}return e}),gt:st(function(e,t,n){for(var r=n<0?n+t:n;++r<t;){e.push(r)}return e})}},f=y.compareDocumentPosition?function(e,t){return e===t?(l=!0,0):(!e.compareDocumentPosition||!t.compareDocumentPosition?e.compareDocumentPosition:e.compareDocumentPosition(t)&4)?-1:1}:function(e,t){if(e===t){return l=!0,0}if(e.sourceIndex&&t.sourceIndex){return e.sourceIndex-t.sourceIndex}var n,r,i=[],s=[],o=e.parentNode,u=t.parentNode,a=o;if(o===u){return ot(e,t)}if(!o){return -1}if(!u){return 1}while(a){i.unshift(a),a=a.parentNode}a=u;while(a){s.unshift(a),a=a.parentNode}n=i.length,r=s.length;for(var f=0;f<n&&f<r;f++){if(i[f]!==s[f]){return ot(i[f],s[f])}}return f===n?ot(e,s[f],-1):ot(i[f],t,1)},[0,0].sort(f),h=!l,nt.uniqueSort=function(e){var t,n=[],r=1,i=0;l=h,e.sort(f);if(l){for(;t=e[r];r++){t===e[r-1]&&(i=n.push(r))}while(i--){e.splice(n[i],1)}}return e},nt.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},a=nt.compile=function(e,t){var n,r=[],i=[],s=A[d][e+" "];if(!s){t||(t=ut(e)),n=t.length;while(n--){s=ht(t[n]),s[d]?r.push(s):i.push(s)}s=A(e,pt(i,r))}return s},g.querySelectorAll&&function(){var e,t=vt,n=/'|\\/g,r=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,i=[":focus"],s=[":active"],u=y.matchesSelector||y.mozMatchesSelector||y.webkitMatchesSelector||y.oMatchesSelector||y.msMatchesSelector;K(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||i.push("\\["+O+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),e.querySelectorAll(":checked").length||i.push(":checked")}),K(function(e){e.innerHTML="<p test=''></p>",e.querySelectorAll("[test^='']").length&&i.push("[*^$]="+O+"*(?:\"\"|'')"),e.innerHTML="<input type='hidden'/>",e.querySelectorAll(":enabled").length||i.push(":enabled",":disabled")}),i=new RegExp(i.join("|")),vt=function(e,r,s,o,u){if(!o&&!u&&!i.test(e)){var a,f,l=!0,c=d,h=r,p=r.nodeType===9&&e;if(r.nodeType===1&&r.nodeName.toLowerCase()!=="object"){a=ut(e),(l=r.getAttribute("id"))?c=l.replace(n,"\\$&"):r.setAttribute("id",c),c="[id='"+c+"'] ",f=a.length;while(f--){a[f]=c+a[f].join("")}h=z.test(e)&&r.parentNode||r,p=a.join(",")}if(p){try{return S.apply(s,x.call(h.querySelectorAll(p),0)),s}catch(v){}finally{l||r.removeAttribute("id")}}}return t(e,r,s,o,u)},u&&(K(function(t){e=u.call(t,"div");try{u.call(t,"[test!='']:sizzle"),s.push("!=",H)}catch(n){}}),s=new RegExp(s.join("|")),nt.matchesSelector=function(t,n){n=n.replace(r,"='$1']");if(!o(t)&&!s.test(n)&&!i.test(n)){try{var a=u.call(t,n);if(a||e||t.document&&t.document.nodeType!==11){return a}}catch(f){}}return nt(n,null,null,[t]).length>0})}(),i.pseudos.nth=i.pseudos.eq,i.filters=mt.prototype=i.pseudos,i.setFilters=new mt,nt.attr=v.attr,v.find=nt,v.expr=nt.selectors,v.expr[":"]=v.expr.pseudos,v.unique=nt.uniqueSort,v.text=nt.getText,v.isXMLDoc=nt.isXML,v.contains=nt.contains}(e);var nt=/Until$/,rt=/^(?:parents|prev(?:Until|All))/,it=/^.[^:#\[\.,]*$/,st=v.expr.match.needsContext,ot={children:!0,contents:!0,next:!0,prev:!0};v.fn.extend({find:function(e){var t,n,r,i,s,o,u=this;if(typeof e!="string"){return v(e).filter(function(){for(t=0,n=u.length;t<n;t++){if(v.contains(u[t],this)){return !0}}})}o=this.pushStack("","find",e);for(t=0,n=this.length;t<n;t++){r=o.length,v.find(e,this[t],o);if(t>0){for(i=r;i<o.length;i++){for(s=0;s<r;s++){if(o[s]===o[i]){o.splice(i--,1);break}}}}}return o},has:function(e){var t,n=v(e,this),r=n.length;return this.filter(function(){for(t=0;t<r;t++){if(v.contains(this,n[t])){return !0}}})},not:function(e){return this.pushStack(ft(this,e,!1),"not",e)},filter:function(e){return this.pushStack(ft(this,e,!0),"filter",e)},is:function(e){return !!e&&(typeof e=="string"?st.test(e)?v(e,this.context).index(this[0])>=0:v.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){var n,r=0,i=this.length,s=[],o=st.test(e)||typeof e!="string"?v(e,t||this.context):0;for(;r<i;r++){n=this[r];while(n&&n.ownerDocument&&n!==t&&n.nodeType!==11){if(o?o.index(n)>-1:v.find.matchesSelector(n,e)){s.push(n);break}n=n.parentNode}}return s=s.length>1?v.unique(s):s,this.pushStack(s,"closest",e)},index:function(e){return e?typeof e=="string"?v.inArray(this[0],v(e)):v.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(e,t){var n=typeof e=="string"?v(e,t):v.makeArray(e&&e.nodeType?[e]:e),r=v.merge(this.get(),n);return this.pushStack(ut(n[0])||ut(r[0])?r:v.unique(r))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}}),v.fn.andSelf=v.fn.addBack,v.each({parent:function(e){var t=e.parentNode;return t&&t.nodeType!==11?t:null},parents:function(e){return v.dir(e,"parentNode")},parentsUntil:function(e,t,n){return v.dir(e,"parentNode",n)},next:function(e){return at(e,"nextSibling")},prev:function(e){return at(e,"previousSibling")},nextAll:function(e){return v.dir(e,"nextSibling")},prevAll:function(e){return v.dir(e,"previousSibling")},nextUntil:function(e,t,n){return v.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return v.dir(e,"previousSibling",n)},siblings:function(e){return v.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return v.sibling(e.firstChild)},contents:function(e){return v.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:v.merge([],e.childNodes)}},function(e,t){v.fn[e]=function(n,r){var i=v.map(this,t,n);return nt.test(e)||(r=n),r&&typeof r=="string"&&(i=v.filter(r,i)),i=this.length>1&&!ot[e]?v.unique(i):i,this.length>1&&rt.test(e)&&(i=i.reverse()),this.pushStack(i,e,l.call(arguments).join(","))}}),v.extend({filter:function(e,t,n){return n&&(e=":not("+e+")"),t.length===1?v.find.matchesSelector(t[0],e)?[t[0]]:[]:v.find.matches(e,t)},dir:function(e,n,r){var i=[],s=e[n];while(s&&s.nodeType!==9&&(r===t||s.nodeType!==1||!v(s).is(r))){s.nodeType===1&&i.push(s),s=s[n]}return i},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling){e.nodeType===1&&e!==t&&n.push(e)}return n}});var ct="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",ht=/ jQuery\d+="(?:null|\d+)"/g,pt=/^\s+/,dt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,vt=/<([\w:]+)/,mt=/<tbody/i,gt=/<|&#?\w+;/,yt=/<(?:script|style|link)/i,bt=/<(?:script|object|embed|option|style)/i,wt=new RegExp("<(?:"+ct+")[\\s/>]","i"),Et=/^(?:checkbox|radio)$/,St=/checked\s*(?:[^=]|=\s*.checked.)/i,xt=/\/(java|ecma)script/i,Tt=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,Nt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},Ct=lt(i),kt=Ct.appendChild(i.createElement("div"));Nt.optgroup=Nt.option,Nt.tbody=Nt.tfoot=Nt.colgroup=Nt.caption=Nt.thead,Nt.th=Nt.td,v.support.htmlSerialize||(Nt._default=[1,"X<div>","</div>"]),v.fn.extend({text:function(e){return v.access(this,function(e){return e===t?v.text(this):this.empty().append((this[0]&&this[0].ownerDocument||i).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(v.isFunction(e)){return this.each(function(t){v(this).wrapAll(e.call(this,t))})}if(this[0]){var t=v(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstChild&&e.firstChild.nodeType===1){e=e.firstChild}return e}).append(this)}return this},wrapInner:function(e){return v.isFunction(e)?this.each(function(t){v(this).wrapInner(e.call(this,t))}):this.each(function(){var t=v(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=v.isFunction(e);return this.each(function(n){v(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){v.nodeName(this,"body")||v(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){(this.nodeType===1||this.nodeType===11)&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){(this.nodeType===1||this.nodeType===11)&&this.insertBefore(e,this.firstChild)})},before:function(){if(!ut(this[0])){return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this)})}if(arguments.length){var e=v.clean(arguments);return this.pushStack(v.merge(e,this),"before",this.selector)}},after:function(){if(!ut(this[0])){return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this.nextSibling)})}if(arguments.length){var e=v.clean(arguments);return this.pushStack(v.merge(this,e),"after",this.selector)}},remove:function(e,t){var n,r=0;for(;(n=this[r])!=null;r++){if(!e||v.filter(e,[n]).length){!t&&n.nodeType===1&&(v.cleanData(n.getElementsByTagName("*")),v.cleanData([n])),n.parentNode&&n.parentNode.removeChild(n)}}return this},empty:function(){var e,t=0;for(;(e=this[t])!=null;t++){e.nodeType===1&&v.cleanData(e.getElementsByTagName("*"));while(e.firstChild){e.removeChild(e.firstChild)}}return this},clone:function(e,t){return e=e==null?!1:e,t=t==null?e:t,this.map(function(){return v.clone(this,e,t)})},html:function(e){return v.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t){return n.nodeType===1?n.innerHTML.replace(ht,""):t}if(typeof e=="string"&&!yt.test(e)&&(v.support.htmlSerialize||!wt.test(e))&&(v.support.leadingWhitespace||!pt.test(e))&&!Nt[(vt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(dt,"<$1></$2>");try{for(;r<i;r++){n=this[r]||{},n.nodeType===1&&(v.cleanData(n.getElementsByTagName("*")),n.innerHTML=e)}n=0}catch(s){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){return ut(this[0])?this.length?this.pushStack(v(v.isFunction(e)?e():e),"replaceWith",e):this:v.isFunction(e)?this.each(function(t){var n=v(this),r=n.html();n.replaceWith(e.call(this,t,r))}):(typeof e!="string"&&(e=v(e).detach()),this.each(function(){var t=this.nextSibling,n=this.parentNode;v(this).remove(),t?v(t).before(e):v(n).append(e)}))},detach:function(e){return this.remove(e,!0)},domManip:function(e,n,r){e=[].concat.apply([],e);var i,s,o,u,a=0,f=e[0],l=[],c=this.length;if(!v.support.checkClone&&c>1&&typeof f=="string"&&St.test(f)){return this.each(function(){v(this).domManip(e,n,r)})}if(v.isFunction(f)){return this.each(function(i){var s=v(this);e[0]=f.call(this,i,n?s.html():t),s.domManip(e,n,r)})}if(this[0]){i=v.buildFragment(e,this,l),o=i.fragment,s=o.firstChild,o.childNodes.length===1&&(o=s);if(s){n=n&&v.nodeName(s,"tr");for(u=i.cacheable||c-1;a<c;a++){r.call(n&&v.nodeName(this[a],"table")?Lt(this[a],"tbody"):this[a],a===u?o:v.clone(o,!0,!0))}}o=s=null,l.length&&v.each(l,function(e,t){t.src?v.ajax?v.ajax({url:t.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):v.error("no ajax"):v.globalEval((t.text||t.textContent||t.innerHTML||"").replace(Tt,"")),t.parentNode&&t.parentNode.removeChild(t)})}return this}}),v.buildFragment=function(e,n,r){var s,o,u,a=e[0];return n=n||i,n=!n.nodeType&&n[0]||n,n=n.ownerDocument||n,e.length===1&&typeof a=="string"&&a.length<512&&n===i&&a.charAt(0)==="<"&&!bt.test(a)&&(v.support.checkClone||!St.test(a))&&(v.support.html5Clone||!wt.test(a))&&(o=!0,s=v.fragments[a],u=s!==t),s||(s=n.createDocumentFragment(),v.clean(e,n,s,r),o&&(v.fragments[a]=u&&s)),{fragment:s,cacheable:o}},v.fragments={},v.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){v.fn[e]=function(n){var r,i=0,s=[],o=v(n),u=o.length,a=this.length===1&&this[0].parentNode;if((a==null||a&&a.nodeType===11&&a.childNodes.length===1)&&u===1){return o[t](this[0]),this}for(;i<u;i++){r=(i>0?this.clone(!0):this).get(),v(o[i])[t](r),s=s.concat(r)}return this.pushStack(s,e,o.selector)}}),v.extend({clone:function(e,t,n){var r,i,s,o;v.support.html5Clone||v.isXMLDoc(e)||!wt.test("<"+e.nodeName+">")?o=e.cloneNode(!0):(kt.innerHTML=e.outerHTML,kt.removeChild(o=kt.firstChild));if((!v.support.noCloneEvent||!v.support.noCloneChecked)&&(e.nodeType===1||e.nodeType===11)&&!v.isXMLDoc(e)){Ot(e,o),r=Mt(e),i=Mt(o);for(s=0;r[s];++s){i[s]&&Ot(r[s],i[s])}}if(t){At(e,o);if(n){r=Mt(e),i=Mt(o);for(s=0;r[s];++s){At(r[s],i[s])}}}return r=i=null,o},clean:function(e,t,n,r){var s,o,u,a,f,l,c,h,p,d,m,g,y=t===i&&Ct,b=[];if(!t||typeof t.createDocumentFragment=="undefined"){t=i}for(s=0;(u=e[s])!=null;s++){typeof u=="number"&&(u+="");if(!u){continue}if(typeof u=="string"){if(!gt.test(u)){u=t.createTextNode(u)}else{y=y||lt(t),c=t.createElement("div"),y.appendChild(c),u=u.replace(dt,"<$1></$2>"),a=(vt.exec(u)||["",""])[1].toLowerCase(),f=Nt[a]||Nt._default,l=f[0],c.innerHTML=f[1]+u+f[2];while(l--){c=c.lastChild}if(!v.support.tbody){h=mt.test(u),p=a==="table"&&!h?c.firstChild&&c.firstChild.childNodes:f[1]==="<table>"&&!h?c.childNodes:[];for(o=p.length-1;o>=0;--o){v.nodeName(p[o],"tbody")&&!p[o].childNodes.length&&p[o].parentNode.removeChild(p[o])}}!v.support.leadingWhitespace&&pt.test(u)&&c.insertBefore(t.createTextNode(pt.exec(u)[0]),c.firstChild),u=c.childNodes,c.parentNode.removeChild(c)}}u.nodeType?b.push(u):v.merge(b,u)}c&&(u=c=y=null);if(!v.support.appendChecked){for(s=0;(u=b[s])!=null;s++){v.nodeName(u,"input")?_t(u):typeof u.getElementsByTagName!="undefined"&&v.grep(u.getElementsByTagName("input"),_t)}}if(n){m=function(e){if(!e.type||xt.test(e.type)){return r?r.push(e.parentNode?e.parentNode.removeChild(e):e):n.appendChild(e)}};for(s=0;(u=b[s])!=null;s++){if(!v.nodeName(u,"script")||!m(u)){n.appendChild(u),typeof u.getElementsByTagName!="undefined"&&(g=v.grep(v.merge([],u.getElementsByTagName("script")),m),b.splice.apply(b,[s+1,0].concat(g)),s+=g.length)}}}return b},cleanData:function(e,t){var n,r,i,s,o=0,u=v.expando,a=v.cache,f=v.support.deleteExpando,l=v.event.special;for(;(i=e[o])!=null;o++){if(t||v.acceptData(i)){r=i[u],n=r&&a[r];if(n){if(n.events){for(s in n.events){l[s]?v.event.remove(i,s):v.removeEvent(i,s,n.handle)}}a[r]&&(delete a[r],f?delete i[u]:i.removeAttribute?i.removeAttribute(u):i[u]=null,v.deletedIds.push(r))}}}}}),function(){var e,t;v.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},e=v.uaMatch(o.userAgent),t={},e.browser&&(t[e.browser]=!0,t.version=e.version),t.chrome?t.webkit=!0:t.webkit&&(t.safari=!0),v.browser=t,v.sub=function(){function e(t,n){return new e.fn.init(t,n)}v.extend(!0,e,this),e.superclass=this,e.fn=e.prototype=this(),e.fn.constructor=e,e.sub=this.sub,e.fn.init=function(r,i){return i&&i instanceof v&&!(i instanceof e)&&(i=e(i)),v.fn.init.call(this,r,i,t)},e.fn.init.prototype=e.fn;var t=e(i);return e}}();var Dt,Pt,Ht,Bt=/alpha\([^)]*\)/i,jt=/opacity=([^)]*)/,Ft=/^(top|right|bottom|left)$/,It=/^(none|table(?!-c[ea]).+)/,qt=/^margin/,Rt=new RegExp("^("+m+")(.*)$","i"),Ut=new RegExp("^("+m+")(?!px)[a-z%]+$","i"),zt=new RegExp("^([-+])=("+m+")","i"),Wt={BODY:"block"},Xt={position:"absolute",visibility:"hidden",display:"block"},Vt={letterSpacing:0,fontWeight:400},$t=["Top","Right","Bottom","Left"],Jt=["Webkit","O","Moz","ms"],Kt=v.fn.toggle;v.fn.extend({css:function(e,n){return v.access(this,function(e,n,r){return r!==t?v.style(e,n,r):v.css(e,n)},e,n,arguments.length>1)},show:function(){return Yt(this,!0)},hide:function(){return Yt(this)},toggle:function(e,t){var n=typeof e=="boolean";return v.isFunction(e)&&v.isFunction(t)?Kt.apply(this,arguments):this.each(function(){(n?e:Gt(this))?v(this).show():v(this).hide()})}}),v.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Dt(e,"opacity");return n===""?"1":n}}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":v.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,r,i){if(!e||e.nodeType===3||e.nodeType===8||!e.style){return}var s,o,u,a=v.camelCase(n),f=e.style;n=v.cssProps[a]||(v.cssProps[a]=Qt(f,a)),u=v.cssHooks[n]||v.cssHooks[a];if(r===t){return u&&"get" in u&&(s=u.get(e,!1,i))!==t?s:f[n]}o=typeof r,o==="string"&&(s=zt.exec(r))&&(r=(s[1]+1)*s[2]+parseFloat(v.css(e,n)),o="number");if(r==null||o==="number"&&isNaN(r)){return}o==="number"&&!v.cssNumber[a]&&(r+="px");if(!u||!("set" in u)||(r=u.set(e,r,i))!==t){try{f[n]=r}catch(l){}}},css:function(e,n,r,i){var s,o,u,a=v.camelCase(n);return n=v.cssProps[a]||(v.cssProps[a]=Qt(e.style,a)),u=v.cssHooks[n]||v.cssHooks[a],u&&"get" in u&&(s=u.get(e,!0,i)),s===t&&(s=Dt(e,n)),s==="normal"&&n in Vt&&(s=Vt[n]),r||i!==t?(o=parseFloat(s),r||v.isNumeric(o)?o||0:s):s},swap:function(e,t,n){var r,i,s={};for(i in t){s[i]=e.style[i],e.style[i]=t[i]}r=n.call(e);for(i in t){e.style[i]=s[i]}return r}}),e.getComputedStyle?Dt=function(t,n){var r,i,s,o,u=e.getComputedStyle(t,null),a=t.style;return u&&(r=u.getPropertyValue(n)||u[n],r===""&&!v.contains(t.ownerDocument,t)&&(r=v.style(t,n)),Ut.test(r)&&qt.test(n)&&(i=a.width,s=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=r,r=u.width,a.width=i,a.minWidth=s,a.maxWidth=o)),r}:i.documentElement.currentStyle&&(Dt=function(e,t){var n,r,i=e.currentStyle&&e.currentStyle[t],s=e.style;return i==null&&s&&s[t]&&(i=s[t]),Ut.test(i)&&!Ft.test(t)&&(n=s.left,r=e.runtimeStyle&&e.runtimeStyle.left,r&&(e.runtimeStyle.left=e.currentStyle.left),s.left=t==="fontSize"?"1em":i,i=s.pixelLeft+"px",s.left=n,r&&(e.runtimeStyle.left=r)),i===""?"auto":i}),v.each(["height","width"],function(e,t){v.cssHooks[t]={get:function(e,n,r){if(n){return e.offsetWidth===0&&It.test(Dt(e,"display"))?v.swap(e,Xt,function(){return tn(e,t,r)}):tn(e,t,r)}},set:function(e,n,r){return Zt(e,n,r?en(e,t,r,v.support.boxSizing&&v.css(e,"boxSizing")==="border-box"):0)}}}),v.support.opacity||(v.cssHooks.opacity={get:function(e,t){return jt.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?0.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=v.isNumeric(t)?"alpha(opacity="+t*100+")":"",s=r&&r.filter||n.filter||"";n.zoom=1;if(t>=1&&v.trim(s.replace(Bt,""))===""&&n.removeAttribute){n.removeAttribute("filter");if(r&&!r.filter){return}}n.filter=Bt.test(s)?s.replace(Bt,i):s+" "+i}}),v(function(){v.support.reliableMarginRight||(v.cssHooks.marginRight={get:function(e,t){return v.swap(e,{display:"inline-block"},function(){if(t){return Dt(e,"marginRight")}})}}),!v.support.pixelPosition&&v.fn.position&&v.each(["top","left"],function(e,t){v.cssHooks[t]={get:function(e,n){if(n){var r=Dt(e,t);return Ut.test(r)?v(e).position()[t]+"px":r}}}})}),v.expr&&v.expr.filters&&(v.expr.filters.hidden=function(e){return e.offsetWidth===0&&e.offsetHeight===0||!v.support.reliableHiddenOffsets&&(e.style&&e.style.display||Dt(e,"display"))==="none"},v.expr.filters.visible=function(e){return !v.expr.filters.hidden(e)}),v.each({margin:"",padding:"",border:"Width"},function(e,t){v.cssHooks[e+t]={expand:function(n){var r,i=typeof n=="string"?n.split(" "):[n],s={};for(r=0;r<4;r++){s[e+$t[r]+t]=i[r]||i[r-2]||i[0]}return s}},qt.test(e)||(v.cssHooks[e+t].set=Zt)});var rn=/%20/g,sn=/\[\]$/,on=/\r?\n/g,un=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,an=/^(?:select|textarea)/i;v.fn.extend({serialize:function(){return v.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?v.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||an.test(this.nodeName)||un.test(this.type))}).map(function(e,t){var n=v(this).val();return n==null?null:v.isArray(n)?v.map(n,function(e,n){return{name:t.name,value:e.replace(on,"\r\n")}}):{name:t.name,value:n.replace(on,"\r\n")}}).get()}}),v.param=function(e,n){var r,i=[],s=function(e,t){t=v.isFunction(t)?t():t==null?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};n===t&&(n=v.ajaxSettings&&v.ajaxSettings.traditional);if(v.isArray(e)||e.jquery&&!v.isPlainObject(e)){v.each(e,function(){s(this.name,this.value)})}else{for(r in e){fn(r,e[r],n,s)}}return i.join("&").replace(rn,"+")};var ln,cn,hn=/#.*$/,pn=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,dn=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,vn=/^(?:GET|HEAD)$/,mn=/^\/\//,gn=/\?/,yn=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,bn=/([?&])_=[^&]*/,wn=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,En=v.fn.load,Sn={},xn={},Tn=["*/"]+["*"];try{cn=s.href}catch(Nn){cn=i.createElement("a"),cn.href="",cn=cn.href}ln=wn.exec(cn.toLowerCase())||[],v.fn.load=function(e,n,r){if(typeof e!="string"&&En){return En.apply(this,arguments)}if(!this.length){return this}var i,s,o,u=this,a=e.indexOf(" ");return a>=0&&(i=e.slice(a,e.length),e=e.slice(0,a)),v.isFunction(n)?(r=n,n=t):n&&typeof n=="object"&&(s="POST"),v.ajax({url:e,type:s,dataType:"html",data:n,complete:function(e,t){r&&u.each(r,o||[e.responseText,t,e])}}).done(function(e){o=arguments,u.html(i?v("<div>").append(e.replace(yn,"")).find(i):e)}),this},v.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(e,t){v.fn[t]=function(e){return this.on(t,e)}}),v.each(["get","post"],function(e,n){v[n]=function(e,r,i,s){return v.isFunction(r)&&(s=s||i,i=r,r=t),v.ajax({type:n,url:e,data:r,success:i,dataType:s})}}),v.extend({getScript:function(e,n){return v.get(e,t,n,"script")},getJSON:function(e,t,n){return v.get(e,t,n,"json")},ajaxSetup:function(e,t){return t?Ln(e,v.ajaxSettings):(t=e,e=v.ajaxSettings),Ln(e,t),e},ajaxSettings:{url:cn,isLocal:dn.test(ln[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":Tn},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":v.parseJSON,"text xml":v.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:Cn(Sn),ajaxTransport:Cn(xn),ajax:function(e,n){function T(e,n,s,a){var l,y,b,w,S,T=n;if(E===2){return}E=2,u&&clearTimeout(u),o=t,i=a||"",x.readyState=e>0?4:0,s&&(w=An(c,x,s));if(e>=200&&e<300||e===304){c.ifModified&&(S=x.getResponseHeader("Last-Modified"),S&&(v.lastModified[r]=S),S=x.getResponseHeader("Etag"),S&&(v.etag[r]=S)),e===304?(T="notmodified",l=!0):(l=On(c,w),T=l.state,y=l.data,b=l.error,l=!b)}else{b=T;if(!T||e){T="error",e<0&&(e=0)}}x.status=e,x.statusText=(n||T)+"",l?d.resolveWith(h,[y,T,x]):d.rejectWith(h,[x,T,b]),x.statusCode(g),g=t,f&&p.trigger("ajax"+(l?"Success":"Error"),[x,c,l?y:b]),m.fireWith(h,[x,T]),f&&(p.trigger("ajaxComplete",[x,c]),--v.active||v.event.trigger("ajaxStop"))}typeof e=="object"&&(n=e,e=t),n=n||{};var r,i,s,o,u,a,f,l,c=v.ajaxSetup({},n),h=c.context||c,p=h!==c&&(h.nodeType||h instanceof v)?v(h):v.event,d=v.Deferred(),m=v.Callbacks("once memory"),g=c.statusCode||{},b={},w={},E=0,S="canceled",x={readyState:0,setRequestHeader:function(e,t){if(!E){var n=e.toLowerCase();e=w[n]=w[n]||e,b[e]=t}return this},getAllResponseHeaders:function(){return E===2?i:null},getResponseHeader:function(e){var n;if(E===2){if(!s){s={};while(n=pn.exec(i)){s[n[1].toLowerCase()]=n[2]}}n=s[e.toLowerCase()]}return n===t?null:n},overrideMimeType:function(e){return E||(c.mimeType=e),this},abort:function(e){return e=e||S,o&&o.abort(e),T(0,e),this}};d.promise(x),x.success=x.done,x.error=x.fail,x.complete=m.add,x.statusCode=function(e){if(e){var t;if(E<2){for(t in e){g[t]=[g[t],e[t]]}}else{t=e[x.status],x.always(t)}}return this},c.url=((e||c.url)+"").replace(hn,"").replace(mn,ln[1]+"//"),c.dataTypes=v.trim(c.dataType||"*").toLowerCase().split(y),c.crossDomain==null&&(a=wn.exec(c.url.toLowerCase()),c.crossDomain=!(!a||a[1]===ln[1]&&a[2]===ln[2]&&(a[3]||(a[1]==="http:"?80:443))==(ln[3]||(ln[1]==="http:"?80:443)))),c.data&&c.processData&&typeof c.data!="string"&&(c.data=v.param(c.data,c.traditional)),kn(Sn,c,n,x);if(E===2){return x}f=c.global,c.type=c.type.toUpperCase(),c.hasContent=!vn.test(c.type),f&&v.active++===0&&v.event.trigger("ajaxStart");if(!c.hasContent){c.data&&(c.url+=(gn.test(c.url)?"&":"?")+c.data,delete c.data),r=c.url;if(c.cache===!1){var N=v.now(),C=c.url.replace(bn,"$1_="+N);c.url=C+(C===c.url?(gn.test(c.url)?"&":"?")+"_="+N:"")}}(c.data&&c.hasContent&&c.contentType!==!1||n.contentType)&&x.setRequestHeader("Content-Type",c.contentType),c.ifModified&&(r=r||c.url,v.lastModified[r]&&x.setRequestHeader("If-Modified-Since",v.lastModified[r]),v.etag[r]&&x.setRequestHeader("If-None-Match",v.etag[r])),x.setRequestHeader("Accept",c.dataTypes[0]&&c.accepts[c.dataTypes[0]]?c.accepts[c.dataTypes[0]]+(c.dataTypes[0]!=="*"?", "+Tn+"; q=0.01":""):c.accepts["*"]);for(l in c.headers){x.setRequestHeader(l,c.headers[l])}if(!c.beforeSend||c.beforeSend.call(h,x,c)!==!1&&E!==2){S="abort";for(l in {success:1,error:1,complete:1}){x[l](c[l])}o=kn(xn,c,n,x);if(!o){T(-1,"No Transport")}else{x.readyState=1,f&&p.trigger("ajaxSend",[x,c]),c.async&&c.timeout>0&&(u=setTimeout(function(){x.abort("timeout")},c.timeout));try{E=1,o.send(b,T)}catch(k){if(!(E<2)){throw k}T(-1,k)}}return x}return x.abort()},active:0,lastModified:{},etag:{}});var Mn=[],_n=/\?/,Dn=/(=)\?(?=&|$)|\?\?/,Pn=v.now();v.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Mn.pop()||v.expando+"_"+Pn++;return this[e]=!0,e}}),v.ajaxPrefilter("json jsonp",function(n,r,i){var s,o,u,a=n.data,f=n.url,l=n.jsonp!==!1,c=l&&Dn.test(f),h=l&&!c&&typeof a=="string"&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&Dn.test(a);if(n.dataTypes[0]==="jsonp"||c||h){return s=n.jsonpCallback=v.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,o=e[s],c?n.url=f.replace(Dn,"$1"+s):h?n.data=a.replace(Dn,"$1"+s):l&&(n.url+=(_n.test(f)?"&":"?")+n.jsonp+"="+s),n.converters["script json"]=function(){return u||v.error(s+" was not called"),u[0]},n.dataTypes[0]="json",e[s]=function(){u=arguments},i.always(function(){e[s]=o,n[s]&&(n.jsonpCallback=r.jsonpCallback,Mn.push(s)),u&&v.isFunction(o)&&o(u[0]),u=o=t}),"script"}}),v.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(e){return v.globalEval(e),e}}}),v.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),v.ajaxTransport("script",function(e){if(e.crossDomain){var n,r=i.head||i.getElementsByTagName("head")[0]||i.documentElement;return{send:function(s,o){n=i.createElement("script"),n.async="async",e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,i){if(i||!n.readyState||/loaded|complete/.test(n.readyState)){n.onload=n.onreadystatechange=null,r&&n.parentNode&&r.removeChild(n),n=t,i||o(200,"success")}},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(0,1)}}}});var Hn,Bn=e.ActiveXObject?function(){for(var e in Hn){Hn[e](0,1)}}:!1,jn=0;v.ajaxSettings.xhr=e.ActiveXObject?function(){return !this.isLocal&&Fn()||In()}:Fn,function(e){v.extend(v.support,{ajax:!!e,cors:!!e&&"withCredentials" in e})}(v.ajaxSettings.xhr()),v.support.ajax&&v.ajaxTransport(function(n){if(!n.crossDomain||v.support.cors){var r;return{send:function(i,s){var o,u,a=n.xhr();n.username?a.open(n.type,n.url,n.async,n.username,n.password):a.open(n.type,n.url,n.async);if(n.xhrFields){for(u in n.xhrFields){a[u]=n.xhrFields[u]}}n.mimeType&&a.overrideMimeType&&a.overrideMimeType(n.mimeType),!n.crossDomain&&!i["X-Requested-With"]&&(i["X-Requested-With"]="XMLHttpRequest");try{for(u in i){a.setRequestHeader(u,i[u])}}catch(f){}a.send(n.hasContent&&n.data||null),r=function(e,i){var u,f,l,c,h;try{if(r&&(i||a.readyState===4)){r=t,o&&(a.onreadystatechange=v.noop,Bn&&delete Hn[o]);if(i){a.readyState!==4&&a.abort()}else{u=a.status,l=a.getAllResponseHeaders(),c={},h=a.responseXML,h&&h.documentElement&&(c.xml=h);try{c.text=a.responseText}catch(p){}try{f=a.statusText}catch(p){f=""}!u&&n.isLocal&&!n.crossDomain?u=c.text?200:404:u===1223&&(u=204)}}}catch(d){i||s(-1,d)}c&&s(u,f,c,l)},n.async?a.readyState===4?setTimeout(r,0):(o=++jn,Bn&&(Hn||(Hn={},v(e).unload(Bn)),Hn[o]=r),a.onreadystatechange=r):r()},abort:function(){r&&r(0,1)}}}});var qn,Rn,Un=/^(?:toggle|show|hide)$/,zn=new RegExp("^(?:([-+])=|)("+m+")([a-z%]*)$","i"),Wn=/queueHooks$/,Xn=[Gn],Vn={"*":[function(e,t){var n,r,i=this.createTween(e,t),s=zn.exec(t),o=i.cur(),u=+o||0,a=1,f=20;if(s){n=+s[2],r=s[3]||(v.cssNumber[e]?"":"px");if(r!=="px"&&u){u=v.css(i.elem,e,!0)||n||1;do{a=a||".5",u/=a,v.style(i.elem,e,u+r)}while(a!==(a=i.cur()/o)&&a!==1&&--f)}i.unit=r,i.start=u,i.end=s[1]?u+(s[1]+1)*n:n}return i}]};v.Animation=v.extend(Kn,{tweener:function(e,t){v.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;r<i;r++){n=e[r],Vn[n]=Vn[n]||[],Vn[n].unshift(t)}},prefilter:function(e,t){t?Xn.unshift(e):Xn.push(e)}}),v.Tween=Yn,Yn.prototype={constructor:Yn,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(v.cssNumber[n]?"":"px")},cur:function(){var e=Yn.propHooks[this.prop];return e&&e.get?e.get(this):Yn.propHooks._default.get(this)},run:function(e){var t,n=Yn.propHooks[this.prop];return this.options.duration?this.pos=t=v.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Yn.propHooks._default.set(this),this}},Yn.prototype.init.prototype=Yn.prototype,Yn.propHooks={_default:{get:function(e){var t;return e.elem[e.prop]==null||!!e.elem.style&&e.elem.style[e.prop]!=null?(t=v.css(e.elem,e.prop,!1,""),!t||t==="auto"?0:t):e.elem[e.prop]},set:function(e){v.fx.step[e.prop]?v.fx.step[e.prop](e):e.elem.style&&(e.elem.style[v.cssProps[e.prop]]!=null||v.cssHooks[e.prop])?v.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},Yn.propHooks.scrollTop=Yn.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},v.each(["toggle","show","hide"],function(e,t){var n=v.fn[t];v.fn[t]=function(r,i,s){return r==null||typeof r=="boolean"||!e&&v.isFunction(r)&&v.isFunction(i)?n.apply(this,arguments):this.animate(Zn(t,!0),r,i,s)}}),v.fn.extend({fadeTo:function(e,t,n,r){return this.filter(Gt).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=v.isEmptyObject(e),s=v.speed(t,n,r),o=function(){var t=Kn(this,v.extend({},e),s);i&&t.stop(!0)};return i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,n,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return typeof e!="string"&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=e!=null&&e+"queueHooks",s=v.timers,o=v._data(this);if(n){o[n]&&o[n].stop&&i(o[n])}else{for(n in o){o[n]&&o[n].stop&&Wn.test(n)&&i(o[n])}}for(n=s.length;n--;){s[n].elem===this&&(e==null||s[n].queue===e)&&(s[n].anim.stop(r),t=!1,s.splice(n,1))}(t||!r)&&v.dequeue(this,e)})}}),v.each({slideDown:Zn("show"),slideUp:Zn("hide"),slideToggle:Zn("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){v.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),v.speed=function(e,t,n){var r=e&&typeof e=="object"?v.extend({},e):{complete:n||!n&&t||v.isFunction(e)&&e,duration:e,easing:n&&t||t&&!v.isFunction(t)&&t};r.duration=v.fx.off?0:typeof r.duration=="number"?r.duration:r.duration in v.fx.speeds?v.fx.speeds[r.duration]:v.fx.speeds._default;if(r.queue==null||r.queue===!0){r.queue="fx"}return r.old=r.complete,r.complete=function(){v.isFunction(r.old)&&r.old.call(this),r.queue&&v.dequeue(this,r.queue)},r},v.easing={linear:function(e){return e},swing:function(e){return 0.5-Math.cos(e*Math.PI)/2}},v.timers=[],v.fx=Yn.prototype.init,v.fx.tick=function(){var e,n=v.timers,r=0;qn=v.now();for(;r<n.length;r++){e=n[r],!e()&&n[r]===e&&n.splice(r--,1)}n.length||v.fx.stop(),qn=t},v.fx.timer=function(e){e()&&v.timers.push(e)&&!Rn&&(Rn=setInterval(v.fx.tick,v.fx.interval))},v.fx.interval=13,v.fx.stop=function(){clearInterval(Rn),Rn=null},v.fx.speeds={slow:600,fast:200,_default:400},v.fx.step={},v.expr&&v.expr.filters&&(v.expr.filters.animated=function(e){return v.grep(v.timers,function(t){return e===t.elem}).length});var er=/^(?:body|html)$/i;v.fn.offset=function(e){if(arguments.length){return e===t?this:this.each(function(t){v.offset.setOffset(this,e,t)})}var n,r,i,s,o,u,a,f={top:0,left:0},l=this[0],c=l&&l.ownerDocument;if(!c){return}return(r=c.body)===l?v.offset.bodyOffset(l):(n=c.documentElement,v.contains(n,l)?(typeof l.getBoundingClientRect!="undefined"&&(f=l.getBoundingClientRect()),i=tr(c),s=n.clientTop||r.clientTop||0,o=n.clientLeft||r.clientLeft||0,u=i.pageYOffset||n.scrollTop,a=i.pageXOffset||n.scrollLeft,{top:f.top+u-s,left:f.left+a-o}):f)},v.offset={bodyOffset:function(e){var t=e.offsetTop,n=e.offsetLeft;return v.support.doesNotIncludeMarginInBodyOffset&&(t+=parseFloat(v.css(e,"marginTop"))||0,n+=parseFloat(v.css(e,"marginLeft"))||0),{top:t,left:n}},setOffset:function(e,t,n){var r=v.css(e,"position");r==="static"&&(e.style.position="relative");var i=v(e),s=i.offset(),o=v.css(e,"top"),u=v.css(e,"left"),a=(r==="absolute"||r==="fixed")&&v.inArray("auto",[o,u])>-1,f={},l={},c,h;a?(l=i.position(),c=l.top,h=l.left):(c=parseFloat(o)||0,h=parseFloat(u)||0),v.isFunction(t)&&(t=t.call(e,n,s)),t.top!=null&&(f.top=t.top-s.top+c),t.left!=null&&(f.left=t.left-s.left+h),"using" in t?t.using.call(e,f):i.css(f)}},v.fn.extend({position:function(){if(!this[0]){return}var e=this[0],t=this.offsetParent(),n=this.offset(),r=er.test(t[0].nodeName)?{top:0,left:0}:t.offset();return n.top-=parseFloat(v.css(e,"marginTop"))||0,n.left-=parseFloat(v.css(e,"marginLeft"))||0,r.top+=parseFloat(v.css(t[0],"borderTopWidth"))||0,r.left+=parseFloat(v.css(t[0],"borderLeftWidth"))||0,{top:n.top-r.top,left:n.left-r.left}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||i.body;while(e&&!er.test(e.nodeName)&&v.css(e,"position")==="static"){e=e.offsetParent}return e||i.body})}}),v.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var r=/Y/.test(n);v.fn[e]=function(i){return v.access(this,function(e,i,s){var o=tr(e);if(s===t){return o?n in o?o[n]:o.document.documentElement[i]:e[i]}o?o.scrollTo(r?v(o).scrollLeft():s,r?s:v(o).scrollTop()):e[i]=s},e,i,arguments.length,null)}}),v.each({Height:"height",Width:"width"},function(e,n){v.each({padding:"inner"+e,content:n,"":"outer"+e},function(r,i){v.fn[i]=function(i,s){var o=arguments.length&&(r||typeof i!="boolean"),u=r||(i===!0||s===!0?"margin":"border");return v.access(this,function(n,r,i){var s;return v.isWindow(n)?n.document.documentElement["client"+e]:n.nodeType===9?(s=n.documentElement,Math.max(n.body["scroll"+e],s["scroll"+e],n.body["offset"+e],s["offset"+e],s["client"+e])):i===t?v.css(n,r,i,u):v.style(n,r,i,u)},n,o?i:t,o,null)}})}),e.jQuery=e.$=v,typeof define=="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return v})})(window);(function(){function Z(b,n,m){if(b===n){return b!==0||1/b==1/n}if(b==null||n==null){return b===n}if(b._chain){b=b._wrapped}if(n._chain){n=n._wrapped}if(b.isEqual&&aj.isFunction(b.isEqual)){return b.isEqual(n)}if(n.isEqual&&aj.isFunction(n.isEqual)){return n.isEqual(b)}var l=af.call(b);if(l!=af.call(n)){return false}switch(l){case"[object String]":return b==String(n);case"[object Number]":return b!=+b?n!=+n:b==0?1/b==1/n:b==+n;case"[object Date]":case"[object Boolean]":return +b==+n;case"[object RegExp]":return b.source==n.source&&b.global==n.global&&b.multiline==n.multiline&&b.ignoreCase==n.ignoreCase}if(typeof b!="object"||typeof n!="object"){return false}for(var k=m.length;k--;){if(m[k]==b){return true}}m.push(b);var k=0,j=true;if(l=="[object Array]"){if(k=b.length,j=k==n.length){for(;k--;){if(!(j=k in b==k in n&&Z(b[k],n[k],m))){break}}}}else{if("constructor" in b!="constructor" in n||b.constructor!=n.constructor){return false}for(var i in b){if(aj.has(b,i)&&(k++,!(j=aj.has(n,i)&&Z(b[i],n[i],m)))){break}}if(j){for(i in n){if(aj.has(n,i)&&!k--){break}}j=!k}}m.pop();return j}var X=this,P=X._,ad={},ag=Array.prototype,ac=Object.prototype,ai=ag.slice,M=ag.unshift,af=ac.toString,g=ac.hasOwnProperty,N=ag.forEach,h=ag.map,f=ag.reduce,d=ag.reduceRight,ab=ag.filter,Y=ag.every,W=ag.some,aa=ag.indexOf,V=ag.lastIndexOf,ac=Array.isArray,e=Object.keys,U=Function.prototype.bind,aj=function(b){return new ae(b)};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=aj}exports._=aj}else{X._=aj}aj.VERSION="1.3.1";var ah=aj.each=aj.forEach=function(b,l,k){if(b!=null){if(N&&b.forEach===N){b.forEach(l,k)}else{if(b.length===+b.length){for(var j=0,i=b.length;j<i;j++){if(j in b&&l.call(k,b[j],j,b)===ad){break}}}else{for(j in b){if(aj.has(b,j)&&l.call(k,b[j],j,b)===ad){break}}}}}};aj.map=aj.collect=function(j,l,i){var k=[];if(j==null){return k}if(h&&j.map===h){return j.map(l,i)}ah(j,function(b,n,m){k[k.length]=l.call(i,b,n,m)});if(j.length===+j.length){k.length=j.length}return k};aj.reduce=aj.foldl=aj.inject=function(b,l,k,j){var i=arguments.length>2;b==null&&(b=[]);if(f&&b.reduce===f){return j&&(l=aj.bind(l,j)),i?b.reduce(l,k):b.reduce(l)}ah(b,function(n,m,o){i?k=l.call(j,k,n,m,o):(k=n,i=true)});if(!i){throw new TypeError("Reduce of empty array with no initial value")}return k};aj.reduceRight=aj.foldr=function(b,m,l,k){var j=arguments.length>2;b==null&&(b=[]);if(d&&b.reduceRight===d){return k&&(m=aj.bind(m,k)),j?b.reduceRight(m,l):b.reduceRight(m)}var i=aj.toArray(b).reverse();k&&!j&&(m=aj.bind(m,k));return j?aj.reduce(i,m,l,k):aj.reduce(i,m)};aj.find=aj.detect=function(j,l,i){var k;T(j,function(b,n,m){if(l.call(i,b,n,m)){return k=b,true}});return k};aj.filter=aj.select=function(j,l,i){var k=[];if(j==null){return k}if(ab&&j.filter===ab){return j.filter(l,i)}ah(j,function(b,n,m){l.call(i,b,n,m)&&(k[k.length]=b)});return k};aj.reject=function(j,l,i){var k=[];if(j==null){return k}ah(j,function(b,n,m){l.call(i,b,n,m)||(k[k.length]=b)});return k};aj.every=aj.all=function(j,l,i){var k=true;if(j==null){return k}if(Y&&j.every===Y){return j.every(l,i)}ah(j,function(b,n,m){if(!(k=k&&l.call(i,b,n,m))){return ad}});return k};var T=aj.some=aj.any=function(b,k,j){k||(k=aj.identity);var i=false;if(b==null){return i}if(W&&b.some===W){return b.some(k,j)}ah(b,function(m,l,n){if(i||(i=k.call(j,m,l,n))){return ad}});return !!i};aj.include=aj.contains=function(j,k){var i=false;if(j==null){return i}return aa&&j.indexOf===aa?j.indexOf(k)!=-1:i=T(j,function(b){return b===k})};aj.invoke=function(b,j){var i=ai.call(arguments,2);return aj.map(b,function(k){return(aj.isFunction(j)?j||k:k[j]).apply(k,i)})};aj.pluck=function(b,i){return aj.map(b,function(j){return j[i]})};aj.max=function(b,k,j){if(!k&&aj.isArray(b)){return Math.max.apply(Math,b)}if(!k&&aj.isEmpty(b)){return -Infinity}var i={computed:-Infinity};ah(b,function(m,l,n){l=k?k.call(j,m,l,n):m;l>=i.computed&&(i={value:m,computed:l})});return i.value};aj.min=function(b,k,j){if(!k&&aj.isArray(b)){return Math.min.apply(Math,b)}if(!k&&aj.isEmpty(b)){return Infinity}var i={computed:Infinity};ah(b,function(m,l,n){l=k?k.call(j,m,l,n):m;l<i.computed&&(i={value:m,computed:l})});return i.value};aj.shuffle=function(j){var i=[],k;ah(j,function(b,l){l==0?i[0]=b:(k=Math.floor(Math.random()*(l+1)),i[l]=i[k],i[k]=b)});return i};aj.sortBy=function(b,j,i){return aj.pluck(aj.map(b,function(l,k,m){return{value:l,criteria:j.call(i,l,k,m)}}).sort(function(l,k){var n=l.criteria,m=k.criteria;return n<m?-1:n>m?1:0}),"value")};aj.groupBy=function(b,k){var j={},i=aj.isFunction(k)?k:function(l){return l[k]};ah(b,function(m,l){var n=i(m,l);(j[n]||(j[n]=[])).push(m)});return j};aj.sortedIndex=function(b,m,l){l||(l=aj.identity);for(var k=0,j=b.length;k<j;){var i=k+j>>1;l(b[i])<l(m)?k=i+1:j=i}return k};aj.toArray=function(b){return !b?[]:b.toArray?b.toArray():aj.isArray(b)?ai.call(b):aj.isArguments(b)?ai.call(b):aj.values(b)};aj.size=function(b){return aj.toArray(b).length};aj.first=aj.head=function(j,i,k){return i!=null&&!k?ai.call(j,0,i):j[0]};aj.initial=function(j,i,k){return ai.call(j,0,j.length-(i==null||k?1:i))};aj.last=function(j,i,k){return i!=null&&!k?ai.call(j,Math.max(j.length-i,0)):j[j.length-1]};aj.rest=aj.tail=function(j,i,k){return ai.call(j,i==null||k?1:i)};aj.compact=function(b){return aj.filter(b,function(i){return !!i})};aj.flatten=function(b,i){return aj.reduce(b,function(j,k){if(aj.isArray(k)){return j.concat(i?k:aj.flatten(k))}j[j.length]=k;return j},[])};aj.without=function(b){return aj.difference(b,ai.call(arguments,1))};aj.uniq=aj.unique=function(b,k,j){var j=j?aj.map(b,j):b,i=[];aj.reduce(j,function(n,m,l){if(0==l||(k===true?aj.last(n)!=m:!aj.include(n,m))){n[n.length]=m,i[i.length]=b[l]}return n},[]);return i};aj.union=function(){return aj.uniq(aj.flatten(arguments,true))};aj.intersection=aj.intersect=function(b){var i=ai.call(arguments,1);return aj.filter(aj.uniq(b),function(j){return aj.every(i,function(k){return aj.indexOf(k,j)>=0})})};aj.difference=function(b){var i=aj.flatten(ai.call(arguments,1));return aj.filter(b,function(j){return !aj.include(i,j)})};aj.zip=function(){for(var b=ai.call(arguments),k=aj.max(aj.pluck(b,"length")),j=Array(k),i=0;i<k;i++){j[i]=aj.pluck(b,""+i)}return j};aj.indexOf=function(b,k,j){if(b==null){return -1}var i;if(j){return j=aj.sortedIndex(b,k),b[j]===k?j:-1}if(aa&&b.indexOf===aa){return b.indexOf(k)}for(j=0,i=b.length;j<i;j++){if(j in b&&b[j]===k){return j}}return -1};aj.lastIndexOf=function(j,i){if(j==null){return -1}if(V&&j.lastIndexOf===V){return j.lastIndexOf(i)}for(var k=j.length;k--;){if(k in j&&j[k]===i){return k}}return -1};aj.range=function(j,i,n){arguments.length<=1&&(i=j||0,j=0);for(var n=arguments[2]||1,m=Math.max(Math.ceil((i-j)/n),0),l=0,k=Array(m);l<m;){k[l++]=j,j+=n}return k};var R=function(){};aj.bind=function(b,k){var j,i;if(b.bind===U&&U){return U.apply(b,ai.call(arguments,1))}if(!aj.isFunction(b)){throw new TypeError}i=ai.call(arguments,2);return j=function(){if(!(this instanceof j)){return b.apply(k,i.concat(ai.call(arguments)))}R.prototype=b.prototype;var l=new R,m=b.apply(l,i.concat(ai.call(arguments)));return Object(m)===m?m:l}};aj.bindAll=function(b){var i=ai.call(arguments,1);i.length==0&&(i=aj.functions(b));ah(i,function(j){b[j]=aj.bind(b[j],b)});return b};aj.memoize=function(b,j){var i={};j||(j=aj.identity);return function(){var k=j.apply(this,arguments);return aj.has(i,k)?i[k]:i[k]=b.apply(this,arguments)}};aj.delay=function(j,i){var k=ai.call(arguments,2);return setTimeout(function(){return j.apply(j,k)},i)};aj.defer=function(b){return aj.delay.apply(aj,[b,1].concat(ai.call(arguments,1)))};aj.throttle=function(b,p){var o,n,m,l,k,j=aj.debounce(function(){k=l=false},p);return function(){o=this;n=arguments;var i;m||(m=setTimeout(function(){m=null;k&&b.apply(o,n);j()},p));l?k=true:b.apply(o,n);j();l=true}};aj.debounce=function(j,i){var k;return function(){var l=this,b=arguments;clearTimeout(k);k=setTimeout(function(){k=null;j.apply(l,b)},i)}};aj.once=function(j){var i=false,k;return function(){if(i){return k}i=true;return k=j.apply(this,arguments)}};aj.wrap=function(j,i){return function(){var b=[j].concat(ai.call(arguments,0));return i.apply(this,b)}};aj.compose=function(){var b=arguments;return function(){for(var i=arguments,j=b.length-1;j>=0;j--){i=[b[j].apply(this,i)]}return i[0]}};aj.after=function(j,i){return j<=0?i():function(){if(--j<1){return i.apply(this,arguments)}}};aj.keys=e||function(b){if(b!==Object(b)){throw new TypeError("Invalid object")}var j=[],i;for(i in b){aj.has(b,i)&&(j[j.length]=i)}return j};aj.values=function(b){return aj.map(b,aj.identity)};aj.functions=aj.methods=function(b){var j=[],i;for(i in b){aj.isFunction(b[i])&&j.push(i)}return j.sort()};aj.extend=function(b){ah(ai.call(arguments,1),function(i){for(var j in i){b[j]=i[j]}});return b};aj.defaults=function(b){ah(ai.call(arguments,1),function(i){for(var j in i){b[j]==null&&(b[j]=i[j])}});return b};aj.clone=function(b){return !aj.isObject(b)?b:aj.isArray(b)?b.slice():aj.extend({},b)};aj.tap=function(j,i){i(j);return j};aj.isEqual=function(j,i){return Z(j,i,[])};aj.isEmpty=function(b){if(aj.isArray(b)||aj.isString(b)){return b.length===0}for(var i in b){if(aj.has(b,i)){return false}}return true};aj.isElement=function(b){return !!(b&&b.nodeType==1)};aj.isArray=ac||function(b){return af.call(b)=="[object Array]"};aj.isObject=function(b){return b===Object(b)};aj.isArguments=function(b){return af.call(b)=="[object Arguments]"};if(!aj.isArguments(arguments)){aj.isArguments=function(b){return !(!b||!aj.has(b,"callee"))}}aj.isFunction=function(b){return af.call(b)=="[object Function]"};aj.isString=function(b){return af.call(b)=="[object String]"};aj.isNumber=function(b){return af.call(b)=="[object Number]"};aj.isNaN=function(b){return b!==b};aj.isBoolean=function(b){return b===true||b===false||af.call(b)=="[object Boolean]"};aj.isDate=function(b){return af.call(b)=="[object Date]"};aj.isRegExp=function(b){return af.call(b)=="[object RegExp]"};aj.isNull=function(b){return b===null};aj.isUndefined=function(b){return b===void 0};aj.has=function(j,i){return g.call(j,i)};aj.noConflict=function(){X._=P;return this};aj.identity=function(b){return b};aj.times=function(j,i,l){for(var k=0;k<j;k++){i.call(l,k)}};aj.escape=function(b){return(""+b).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};aj.mixin=function(b){ah(aj.functions(b),function(i){c(i,aj[i]=b[i])})};var a=0;aj.uniqueId=function(j){var i=a++;return j?j+i:i};aj.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var S=/.^/,Q=function(b){return b.replace(/\\\\/g,"\\").replace(/\\'/g,"'")};aj.template=function(b,k){var j=aj.templateSettings,j="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+b.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(j.escape||S,function(m,l){return"',_.escape("+Q(l)+"),'"}).replace(j.interpolate||S,function(m,l){return"',"+Q(l)+",'"}).replace(j.evaluate||S,function(m,l){return"');"+Q(l).replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",i=new Function("obj","_",j);return k?i(k,aj):function(l){return i.call(this,l,aj)}};aj.chain=function(b){return aj(b).chain()};var ae=function(b){this._wrapped=b};aj.prototype=ae.prototype;var O=function(b,i){return i?aj(b).chain():b},c=function(b,i){ae.prototype[b]=function(){var j=ai.call(arguments);M.call(j,this._wrapped);return O(i.apply(aj,j),this._chain)}};aj.mixin(aj);ah("pop,push,reverse,shift,sort,splice,unshift".split(","),function(j){var i=ag[j];ae.prototype[j]=function(){var k=this._wrapped;i.apply(k,arguments);var b=k.length;(j=="shift"||j=="splice")&&b===0&&delete k[0];return O(k,this._chain)}});ah(["concat","join","slice"],function(j){var i=ag[j];ae.prototype[j]=function(){return O(i.apply(this._wrapped,arguments),this._chain)}});ae.prototype.chain=function(){this._chain=true;return this};ae.prototype.value=function(){return this._wrapped}}).call(this);$u=_.noConflict();jQuery.urldecode=function(a){return decodeURIComponent(a).replace(/\+/g," ")};jQuery.urlencode=encodeURIComponent;jQuery.getQueryParameters=function(e){if(typeof e=="undefined"){e=document.location.search}var g=e.substr(e.indexOf("?")+1).split("&");var a={};for(var d=0;d<g.length;d++){var c=g[d].split("=",2);var b=jQuery.urldecode(c[0]);var f=jQuery.urldecode(c[1]);if(b in a){a[b].push(f)}else{a[b]=[f]}}return a};jQuery.fn.highlightText=function(c,b){function a(e){if(e.nodeType==3){var f=e.nodeValue;var g=f.toLowerCase().indexOf(c);if(g>=0&&!jQuery(e.parentNode).hasClass(b)){var d=document.createElement("span");d.className=b;d.appendChild(document.createTextNode(f.substr(g,c.length)));e.parentNode.insertBefore(d,e.parentNode.insertBefore(document.createTextNode(f.substr(g+c.length)),e.nextSibling));e.nodeValue=f.substr(0,g)}}else{if(!jQuery(e).is("button, select, textarea")){jQuery.each(e.childNodes,function(){a(this)})}}}return this.each(function(){a(this)})};var Documentation={init:function(){this.fixFirefoxAnchorBug();this.highlightSearchWords();this.initIndexTable()},TRANSLATIONS:{},PLURAL_EXPR:function(a){return a==1?0:1},LOCALE:"unknown",gettext:function(a){var b=Documentation.TRANSLATIONS[a];if(typeof b=="undefined"){return a}return(typeof b=="string")?b:b[0]},ngettext:function(b,a,d){var c=Documentation.TRANSLATIONS[b];if(typeof c=="undefined"){return(d==1)?b:a}return c[Documentation.PLURALEXPR(d)]},addTranslations:function(a){for(var b in a.messages){this.TRANSLATIONS[b]=a.messages[b]}this.PLURAL_EXPR=new Function("n","return +("+a.plural_expr+")");this.LOCALE=a.locale},addContextElements:function(){$("div[id] > :header:first").each(function(){$('<a class="headerlink">\u00B6</a>').attr("href","#"+this.id).attr("title",_("Permalink to this headline")).appendTo(this)});$("dt[id]").each(function(){$('<a class="headerlink">\u00B6</a>').attr("href","#"+this.id).attr("title",_("Permalink to this definition")).appendTo(this)})},fixFirefoxAnchorBug:function(){if(document.location.hash&&$.browser.mozilla){window.setTimeout(function(){document.location.href+=""},10)}},highlightSearchWords:function(){var c=$.getQueryParameters();var b=(c.highlight)?c.highlight[0].split(/\s+/):[];if(b.length){var a=$("div.body");if(!a.length){a=$("body")}window.setTimeout(function(){$.each(b,function(){a.highlightText(this.toLowerCase(),"highlighted")})},10);$('<p class="highlight-link"><a href="javascript:Documentation.hideSearchWords()">'+_("Hide Search Matches")+"</a></p>").appendTo($("#searchbox"))}},initIndexTable:function(){var a=$("img.toggler").click(function(){var c=$(this).attr("src");var b=$(this).attr("id").substr(7);$("tr.cg-"+b).toggle();if(c.substr(-9)=="minus.png"){$(this).attr("src",c.substr(0,c.length-9)+"plus.png")}else{$(this).attr("src",c.substr(0,c.length-8)+"minus.png")}}).css("display","");if(DOCUMENTATION_OPTIONS.COLLAPSE_INDEX){a.click()}},hideSearchWords:function(){$("#searchbox .highlight-link").fadeOut(300);$("span.highlighted").removeClass("highlighted")},makeURL:function(a){return DOCUMENTATION_OPTIONS.URL_ROOT+"/"+a},getCurrentURL:function(){var c=document.location.pathname;var b=c.split(/\//);$.each(DOCUMENTATION_OPTIONS.URL_ROOT.split(/\//),function(){if(this==".."){b.pop()}});var a=b.join("/");return c.substring(a.lastIndexOf("/")+1,c.length-1)}};_=Documentation.gettext;$(document).ready(function(){Documentation.init()});/*! jQuery v1.9.1 | (c) 2005, 2012 jQuery Foundation, Inc. | jquery.org/license
//@ sourceMappingURL=jquery.min.map
*/
(function(e,t){var n,r,i=typeof t,o=e.document,a=e.location,s=e.jQuery,u=e.$,l={},c=[],p="1.9.1",f=c.concat,d=c.push,h=c.slice,g=c.indexOf,m=l.toString,y=l.hasOwnProperty,v=p.trim,b=function(e,t){return new b.fn.init(e,t,r)},x=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,w=/\S+/g,T=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,N=/^(?:(<[\w\W]+>)[^>]*|#([\w-]*))$/,C=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,k=/^[\],:{}\s]*$/,E=/(?:^|:|,)(?:\s*\[)+/g,S=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,A=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,j=/^-ms-/,D=/-([\da-z])/gi,L=function(e,t){return t.toUpperCase()},H=function(e){(o.addEventListener||"load"===e.type||"complete"===o.readyState)&&(q(),b.ready())},q=function(){o.addEventListener?(o.removeEventListener("DOMContentLoaded",H,!1),e.removeEventListener("load",H,!1)):(o.detachEvent("onreadystatechange",H),e.detachEvent("onload",H))};b.fn=b.prototype={jquery:p,constructor:b,init:function(e,n,r){var i,a;if(!e){return this}if("string"==typeof e){if(i="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:N.exec(e),!i||!i[1]&&n){return !n||n.jquery?(n||r).find(e):this.constructor(n).find(e)}if(i[1]){if(n=n instanceof b?n[0]:n,b.merge(this,b.parseHTML(i[1],n&&n.nodeType?n.ownerDocument||n:o,!0)),C.test(i[1])&&b.isPlainObject(n)){for(i in n){b.isFunction(this[i])?this[i](n[i]):this.attr(i,n[i])}}return this}if(a=o.getElementById(i[2]),a&&a.parentNode){if(a.id!==i[2]){return r.find(e)}this.length=1,this[0]=a}return this.context=o,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):b.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),b.makeArray(e,this))},selector:"",length:0,size:function(){return this.length},toArray:function(){return h.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=b.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return b.each(this,e,t)},ready:function(e){return b.ready.promise().done(e),this},slice:function(){return this.pushStack(h.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},map:function(e){return this.pushStack(b.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:d,sort:[].sort,splice:[].splice},b.fn.init.prototype=b.fn,b.extend=b.fn.extend=function(){var e,n,r,i,o,a,s=arguments[0]||{},u=1,l=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[1]||{},u=2),"object"==typeof s||b.isFunction(s)||(s={}),l===u&&(s=this,--u);l>u;u++){if(null!=(o=arguments[u])){for(i in o){e=s[i],r=o[i],s!==r&&(c&&r&&(b.isPlainObject(r)||(n=b.isArray(r)))?(n?(n=!1,a=e&&b.isArray(e)?e:[]):a=e&&b.isPlainObject(e)?e:{},s[i]=b.extend(c,a,r)):r!==t&&(s[i]=r))}}}return s},b.extend({noConflict:function(t){return e.$===b&&(e.$=u),t&&e.jQuery===b&&(e.jQuery=s),b},isReady:!1,readyWait:1,holdReady:function(e){e?b.readyWait++:b.ready(!0)},ready:function(e){if(e===!0?!--b.readyWait:!b.isReady){if(!o.body){return setTimeout(b.ready)}b.isReady=!0,e!==!0&&--b.readyWait>0||(n.resolveWith(o,[b]),b.fn.trigger&&b(o).trigger("ready").off("ready"))}},isFunction:function(e){return"function"===b.type(e)},isArray:Array.isArray||function(e){return"array"===b.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return !isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[m.call(e)]||"object":typeof e},isPlainObject:function(e){if(!e||"object"!==b.type(e)||e.nodeType||b.isWindow(e)){return !1}try{if(e.constructor&&!y.call(e,"constructor")&&!y.call(e.constructor.prototype,"isPrototypeOf")){return !1}}catch(n){return !1}var r;for(r in e){}return r===t||y.call(e,r)},isEmptyObject:function(e){var t;for(t in e){return !1}return !0},error:function(e){throw Error(e)},parseHTML:function(e,t,n){if(!e||"string"!=typeof e){return null}"boolean"==typeof t&&(n=t,t=!1),t=t||o;var r=C.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=b.buildFragment([e],t,i),i&&b(i).remove(),b.merge([],r.childNodes))},parseJSON:function(n){return e.JSON&&e.JSON.parse?e.JSON.parse(n):null===n?n:"string"==typeof n&&(n=b.trim(n),n&&k.test(n.replace(S,"@").replace(A,"]").replace(E,"")))?Function("return "+n)():(b.error("Invalid JSON: "+n),t)},parseXML:function(n){var r,i;if(!n||"string"!=typeof n){return null}try{e.DOMParser?(i=new DOMParser,r=i.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))}catch(o){r=t}return r&&r.documentElement&&!r.getElementsByTagName("parsererror").length||b.error("Invalid XML: "+n),r},noop:function(){},globalEval:function(t){t&&b.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(j,"ms-").replace(D,L)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,o=e.length,a=M(e);if(n){if(a){for(;o>i;i++){if(r=t.apply(e[i],n),r===!1){break}}}else{for(i in e){if(r=t.apply(e[i],n),r===!1){break}}}}else{if(a){for(;o>i;i++){if(r=t.call(e[i],i,e[i]),r===!1){break}}}else{for(i in e){if(r=t.call(e[i],i,e[i]),r===!1){break}}}}return e},trim:v&&!v.call("\ufeff\u00a0")?function(e){return null==e?"":v.call(e)}:function(e){return null==e?"":(e+"").replace(T,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(M(Object(e))?b.merge(n,"string"==typeof e?[e]:e):d.call(n,e)),n},inArray:function(e,t,n){var r;if(t){if(g){return g.call(t,e,n)}for(r=t.length,n=n?0>n?Math.max(0,r+n):n:0;r>n;n++){if(n in t&&t[n]===e){return n}}}return -1},merge:function(e,n){var r=n.length,i=e.length,o=0;if("number"==typeof r){for(;r>o;o++){e[i++]=n[o]}}else{while(n[o]!==t){e[i++]=n[o++]}}return e.length=i,e},grep:function(e,t,n){var r,i=[],o=0,a=e.length;for(n=!!n;a>o;o++){r=!!t(e[o],o),n!==r&&i.push(e[o])}return i},map:function(e,t,n){var r,i=0,o=e.length,a=M(e),s=[];if(a){for(;o>i;i++){r=t(e[i],i,n),null!=r&&(s[s.length]=r)}}else{for(i in e){r=t(e[i],i,n),null!=r&&(s[s.length]=r)}}return f.apply([],s)},guid:1,proxy:function(e,n){var r,i,o;return"string"==typeof n&&(o=e[n],n=e,e=o),b.isFunction(e)?(r=h.call(arguments,2),i=function(){return e.apply(n||this,r.concat(h.call(arguments)))},i.guid=e.guid=e.guid||b.guid++,i):t},access:function(e,n,r,i,o,a,s){var u=0,l=e.length,c=null==r;if("object"===b.type(r)){o=!0;for(u in r){b.access(e,n,u,r[u],!0,a,s)}}else{if(i!==t&&(o=!0,b.isFunction(i)||(s=!0),c&&(s?(n.call(e,i),n=null):(c=n,n=function(e,t,n){return c.call(b(e),n)})),n)){for(;l>u;u++){n(e[u],r,s?i:i.call(e[u],u,n(e[u],r)))}}}return o?e:c?n.call(e):l?n(e[0],r):a},now:function(){return(new Date).getTime()}}),b.ready.promise=function(t){if(!n){if(n=b.Deferred(),"complete"===o.readyState){setTimeout(b.ready)}else{if(o.addEventListener){o.addEventListener("DOMContentLoaded",H,!1),e.addEventListener("load",H,!1)}else{o.attachEvent("onreadystatechange",H),e.attachEvent("onload",H);var r=!1;try{r=null==e.frameElement&&o.documentElement}catch(i){}r&&r.doScroll&&function a(){if(!b.isReady){try{r.doScroll("left")}catch(e){return setTimeout(a,50)}q(),b.ready()}}()}}}return n.promise(t)},b.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){l["[object "+t+"]"]=t.toLowerCase()});function M(e){var t=e.length,n=b.type(e);return b.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||"function"!==n&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}r=b(o);var _={};function F(e){var t=_[e]={};return b.each(e.match(w)||[],function(e,n){t[n]=!0}),t}b.Callbacks=function(e){e="string"==typeof e?_[e]||F(e):b.extend({},e);var n,r,i,o,a,s,u=[],l=!e.once&&[],c=function(t){for(r=e.memory&&t,i=!0,a=s||0,s=0,o=u.length,n=!0;u&&o>a;a++){if(u[a].apply(t[0],t[1])===!1&&e.stopOnFalse){r=!1;break}}n=!1,u&&(l?l.length&&c(l.shift()):r?u=[]:p.disable())},p={add:function(){if(u){var t=u.length;(function i(t){b.each(t,function(t,n){var r=b.type(n);"function"===r?e.unique&&p.has(n)||u.push(n):n&&n.length&&"string"!==r&&i(n)})})(arguments),n?o=u.length:r&&(s=t,c(r))}return this},remove:function(){return u&&b.each(arguments,function(e,t){var r;while((r=b.inArray(t,u,r))>-1){u.splice(r,1),n&&(o>=r&&o--,a>=r&&a--)}}),this},has:function(e){return e?b.inArray(e,u)>-1:!(!u||!u.length)},empty:function(){return u=[],this},disable:function(){return u=l=r=t,this},disabled:function(){return !u},lock:function(){return l=t,r||p.disable(),this},locked:function(){return !l},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],!u||i&&!l||(n?l.push(t):c(t)),this},fire:function(){return p.fireWith(this,arguments),this},fired:function(){return !!i}};return p},b.extend({Deferred:function(e){var t=[["resolve","done",b.Callbacks("once memory"),"resolved"],["reject","fail",b.Callbacks("once memory"),"rejected"],["notify","progress",b.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return b.Deferred(function(n){b.each(t,function(t,o){var a=o[0],s=b.isFunction(e[t])&&e[t];i[o[1]](function(){var e=s&&s.apply(this,arguments);e&&b.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[a+"With"](this===r?n.promise():this,s?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?b.extend(e,r):r}},i={};return r.pipe=r.then,b.each(t,function(e,o){var a=o[2],s=o[3];r[o[1]]=a.add,s&&a.add(function(){n=s},t[1^e][2].disable,t[2][2].lock),i[o[0]]=function(){return i[o[0]+"With"](this===i?r:this,arguments),this},i[o[0]+"With"]=a.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=h.call(arguments),r=n.length,i=1!==r||e&&b.isFunction(e.promise)?r:0,o=1===i?e:b.Deferred(),a=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?h.call(arguments):r,n===s?o.notifyWith(t,n):--i||o.resolveWith(t,n)}},s,u,l;if(r>1){for(s=Array(r),u=Array(r),l=Array(r);r>t;t++){n[t]&&b.isFunction(n[t].promise)?n[t].promise().done(a(t,l,n)).fail(o.reject).progress(a(t,u,s)):--i}}return i||o.resolveWith(l,n),o.promise()}}),b.support=function(){var t,n,r,a,s,u,l,c,p,f,d=o.createElement("div");if(d.setAttribute("className","t"),d.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=d.getElementsByTagName("*"),r=d.getElementsByTagName("a")[0],!n||!r||!n.length){return{}}s=o.createElement("select"),l=s.appendChild(o.createElement("option")),a=d.getElementsByTagName("input")[0],r.style.cssText="top:1px;float:left;opacity:.5",t={getSetAttribute:"t"!==d.className,leadingWhitespace:3===d.firstChild.nodeType,tbody:!d.getElementsByTagName("tbody").length,htmlSerialize:!!d.getElementsByTagName("link").length,style:/top/.test(r.getAttribute("style")),hrefNormalized:"/a"===r.getAttribute("href"),opacity:/^0.5/.test(r.style.opacity),cssFloat:!!r.style.cssFloat,checkOn:!!a.value,optSelected:l.selected,enctype:!!o.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==o.createElement("nav").cloneNode(!0).outerHTML,boxModel:"CSS1Compat"===o.compatMode,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},a.checked=!0,t.noCloneChecked=a.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!l.disabled;try{delete d.test}catch(h){t.deleteExpando=!1}a=o.createElement("input"),a.setAttribute("value",""),t.input=""===a.getAttribute("value"),a.value="t",a.setAttribute("type","radio"),t.radioValue="t"===a.value,a.setAttribute("checked","t"),a.setAttribute("name","t"),u=o.createDocumentFragment(),u.appendChild(a),t.appendChecked=a.checked,t.checkClone=u.cloneNode(!0).cloneNode(!0).lastChild.checked,d.attachEvent&&(d.attachEvent("onclick",function(){t.noCloneEvent=!1}),d.cloneNode(!0).click());for(f in {submit:!0,change:!0,focusin:!0}){d.setAttribute(c="on"+f,"t"),t[f+"Bubbles"]=c in e||d.attributes[c].expando===!1}return d.style.backgroundClip="content-box",d.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===d.style.backgroundClip,b(function(){var n,r,a,s="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",u=o.getElementsByTagName("body")[0];u&&(n=o.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",u.appendChild(n).appendChild(d),d.innerHTML="<table><tr><td></td><td>t</td></tr></table>",a=d.getElementsByTagName("td"),a[0].style.cssText="padding:0;margin:0;border:0;display:none",p=0===a[0].offsetHeight,a[0].style.display="",a[1].style.display="none",t.reliableHiddenOffsets=p&&0===a[0].offsetHeight,d.innerHTML="",d.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",t.boxSizing=4===d.offsetWidth,t.doesNotIncludeMarginInBodyOffset=1!==u.offsetTop,e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(d,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(d,null)||{width:"4px"}).width,r=d.appendChild(o.createElement("div")),r.style.cssText=d.style.cssText=s,r.style.marginRight=r.style.width="0",d.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),typeof d.style.zoom!==i&&(d.innerHTML="",d.style.cssText=s+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=3===d.offsetWidth,d.style.display="block",d.innerHTML="<div></div>",d.firstChild.style.width="5px",t.shrinkWrapBlocks=3!==d.offsetWidth,t.inlineBlockNeedsLayout&&(u.style.zoom=1)),u.removeChild(n),n=d=a=r=null)}),n=s=u=l=r=a=null,t}();var O=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,B=/([A-Z])/g;function P(e,n,r,i){if(b.acceptData(e)){var o,a,s=b.expando,u="string"==typeof n,l=e.nodeType,p=l?b.cache:e,f=l?e[s]:e[s]&&s;if(f&&p[f]&&(i||p[f].data)||!u||r!==t){return f||(l?e[s]=f=c.pop()||b.guid++:f=s),p[f]||(p[f]={},l||(p[f].toJSON=b.noop)),("object"==typeof n||"function"==typeof n)&&(i?p[f]=b.extend(p[f],n):p[f].data=b.extend(p[f].data,n)),o=p[f],i||(o.data||(o.data={}),o=o.data),r!==t&&(o[b.camelCase(n)]=r),u?(a=o[n],null==a&&(a=o[b.camelCase(n)])):a=o,a}}}function R(e,t,n){if(b.acceptData(e)){var r,i,o,a=e.nodeType,s=a?b.cache:e,u=a?e[b.expando]:b.expando;if(s[u]){if(t&&(o=n?s[u]:s[u].data)){b.isArray(t)?t=t.concat(b.map(t,b.camelCase)):t in o?t=[t]:(t=b.camelCase(t),t=t in o?[t]:t.split(" "));for(r=0,i=t.length;i>r;r++){delete o[t[r]]}if(!(n?$:b.isEmptyObject)(o)){return}}(n||(delete s[u].data,$(s[u])))&&(a?b.cleanData([e],!0):b.support.deleteExpando||s!=s.window?delete s[u]:s[u]=null)}}}b.extend({cache:{},expando:"jQuery"+(p+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return e=e.nodeType?b.cache[e[b.expando]]:e[b.expando],!!e&&!$(e)},data:function(e,t,n){return P(e,t,n)},removeData:function(e,t){return R(e,t)},_data:function(e,t,n){return P(e,t,n,!0)},_removeData:function(e,t){return R(e,t,!0)},acceptData:function(e){if(e.nodeType&&1!==e.nodeType&&9!==e.nodeType){return !1}var t=e.nodeName&&b.noData[e.nodeName.toLowerCase()];return !t||t!==!0&&e.getAttribute("classid")===t}}),b.fn.extend({data:function(e,n){var r,i,o=this[0],a=0,s=null;if(e===t){if(this.length&&(s=b.data(o),1===o.nodeType&&!b._data(o,"parsedAttrs"))){for(r=o.attributes;r.length>a;a++){i=r[a].name,i.indexOf("data-")||(i=b.camelCase(i.slice(5)),W(o,i,s[i]))}b._data(o,"parsedAttrs",!0)}return s}return"object"==typeof e?this.each(function(){b.data(this,e)}):b.access(this,function(n){return n===t?o?W(o,e,b.data(o,e)):null:(this.each(function(){b.data(this,e,n)}),t)},null,n,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){b.removeData(this,e)})}});function W(e,n,r){if(r===t&&1===e.nodeType){var i="data-"+n.replace(B,"-$1").toLowerCase();if(r=e.getAttribute(i),"string"==typeof r){try{r="true"===r?!0:"false"===r?!1:"null"===r?null:+r+""===r?+r:O.test(r)?b.parseJSON(r):r}catch(o){}b.data(e,n,r)}else{r=t}}return r}function $(e){var t;for(t in e){if(("data"!==t||!b.isEmptyObject(e[t]))&&"toJSON"!==t){return !1}}return !0}b.extend({queue:function(e,n,r){var i;return e?(n=(n||"fx")+"queue",i=b._data(e,n),r&&(!i||b.isArray(r)?i=b._data(e,n,b.makeArray(r)):i.push(r)),i||[]):t},dequeue:function(e,t){t=t||"fx";var n=b.queue(e,t),r=n.length,i=n.shift(),o=b._queueHooks(e,t),a=function(){b.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),o.cur=i,i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,a,o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return b._data(e,n)||b._data(e,n,{empty:b.Callbacks("once memory").add(function(){b._removeData(e,t+"queue"),b._removeData(e,n)})})}}),b.fn.extend({queue:function(e,n){var r=2;return"string"!=typeof e&&(n=e,e="fx",r--),r>arguments.length?b.queue(this[0],e):n===t?this:this.each(function(){var t=b.queue(this,e,n);b._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&b.dequeue(this,e)})},dequeue:function(e){return this.each(function(){b.dequeue(this,e)})},delay:function(e,t){return e=b.fx?b.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var r,i=1,o=b.Deferred(),a=this,s=this.length,u=function(){--i||o.resolveWith(a,[a])};"string"!=typeof e&&(n=e,e=t),e=e||"fx";while(s--){r=b._data(a[s],e+"queueHooks"),r&&r.empty&&(i++,r.empty.add(u))}return u(),o.promise(n)}});var I,z,X=/[\t\r\n]/g,U=/\r/g,V=/^(?:input|select|textarea|button|object)$/i,Y=/^(?:a|area)$/i,J=/^(?:checked|selected|autofocus|autoplay|async|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped)$/i,G=/^(?:checked|selected)$/i,Q=b.support.getSetAttribute,K=b.support.input;b.fn.extend({attr:function(e,t){return b.access(this,b.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){b.removeAttr(this,e)})},prop:function(e,t){return b.access(this,b.prop,e,t,arguments.length>1)},removeProp:function(e){return e=b.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,r,i,o,a=0,s=this.length,u="string"==typeof e&&e;if(b.isFunction(e)){return this.each(function(t){b(this).addClass(e.call(this,t,this.className))})}if(u){for(t=(e||"").match(w)||[];s>a;a++){if(n=this[a],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(X," "):" ")){o=0;while(i=t[o++]){0>r.indexOf(" "+i+" ")&&(r+=i+" ")}n.className=b.trim(r)}}}return this},removeClass:function(e){var t,n,r,i,o,a=0,s=this.length,u=0===arguments.length||"string"==typeof e&&e;if(b.isFunction(e)){return this.each(function(t){b(this).removeClass(e.call(this,t,this.className))})}if(u){for(t=(e||"").match(w)||[];s>a;a++){if(n=this[a],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(X," "):"")){o=0;while(i=t[o++]){while(r.indexOf(" "+i+" ")>=0){r=r.replace(" "+i+" "," ")}}n.className=e?b.trim(r):""}}}return this},toggleClass:function(e,t){var n=typeof e,r="boolean"==typeof t;return b.isFunction(e)?this.each(function(n){b(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n){var o,a=0,s=b(this),u=t,l=e.match(w)||[];while(o=l[a++]){u=r?u:!s.hasClass(o),s[u?"addClass":"removeClass"](o)}}else{(n===i||"boolean"===n)&&(this.className&&b._data(this,"__className__",this.className),this.className=this.className||e===!1?"":b._data(this,"__className__")||"")}})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;r>n;n++){if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(X," ").indexOf(t)>=0){return !0}}return !1},val:function(e){var n,r,i,o=this[0];if(arguments.length){return i=b.isFunction(e),this.each(function(n){var o,a=b(this);1===this.nodeType&&(o=i?e.call(this,n,a.val()):e,null==o?o="":"number"==typeof o?o+="":b.isArray(o)&&(o=b.map(o,function(e){return null==e?"":e+""})),r=b.valHooks[this.type]||b.valHooks[this.nodeName.toLowerCase()],r&&"set" in r&&r.set(this,o,"value")!==t||(this.value=o))})}if(o){return r=b.valHooks[o.type]||b.valHooks[o.nodeName.toLowerCase()],r&&"get" in r&&(n=r.get(o,"value"))!==t?n:(n=o.value,"string"==typeof n?n.replace(U,""):null==n?"":n)}}}),b.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return !t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,o="select-one"===e.type||0>i,a=o?null:[],s=o?i+1:r.length,u=0>i?s:o?i:0;for(;s>u;u++){if(n=r[u],!(!n.selected&&u!==i||(b.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&b.nodeName(n.parentNode,"optgroup"))){if(t=b(n).val(),o){return t}a.push(t)}}return a},set:function(e,t){var n=b.makeArray(t);return b(e).find("option").each(function(){this.selected=b.inArray(b(this).val(),n)>=0}),n.length||(e.selectedIndex=-1),n}}},attr:function(e,n,r){var o,a,s,u=e.nodeType;if(e&&3!==u&&8!==u&&2!==u){return typeof e.getAttribute===i?b.prop(e,n,r):(a=1!==u||!b.isXMLDoc(e),a&&(n=n.toLowerCase(),o=b.attrHooks[n]||(J.test(n)?z:I)),r===t?o&&a&&"get" in o&&null!==(s=o.get(e,n))?s:(typeof e.getAttribute!==i&&(s=e.getAttribute(n)),null==s?t:s):null!==r?o&&a&&"set" in o&&(s=o.set(e,r,n))!==t?s:(e.setAttribute(n,r+""),r):(b.removeAttr(e,n),t))}},removeAttr:function(e,t){var n,r,i=0,o=t&&t.match(w);if(o&&1===e.nodeType){while(n=o[i++]){r=b.propFix[n]||n,J.test(n)?!Q&&G.test(n)?e[b.camelCase("default-"+n)]=e[r]=!1:e[r]=!1:b.attr(e,n,""),e.removeAttribute(Q?n:r)}}},attrHooks:{type:{set:function(e,t){if(!b.support.radioValue&&"radio"===t&&b.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,n,r){var i,o,a,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s){return a=1!==s||!b.isXMLDoc(e),a&&(n=b.propFix[n]||n,o=b.propHooks[n]),r!==t?o&&"set" in o&&(i=o.set(e,r,n))!==t?i:e[n]=r:o&&"get" in o&&null!==(i=o.get(e,n))?i:e[n]}},propHooks:{tabIndex:{get:function(e){var n=e.getAttributeNode("tabindex");return n&&n.specified?parseInt(n.value,10):V.test(e.nodeName)||Y.test(e.nodeName)&&e.href?0:t}}}}),z={get:function(e,n){var r=b.prop(e,n),i="boolean"==typeof r&&e.getAttribute(n),o="boolean"==typeof r?K&&Q?null!=i:G.test(n)?e[b.camelCase("default-"+n)]:!!i:e.getAttributeNode(n);return o&&o.value!==!1?n.toLowerCase():t},set:function(e,t,n){return t===!1?b.removeAttr(e,n):K&&Q||!G.test(n)?e.setAttribute(!Q&&b.propFix[n]||n,n):e[b.camelCase("default-"+n)]=e[n]=!0,n}},K&&Q||(b.attrHooks.value={get:function(e,n){var r=e.getAttributeNode(n);return b.nodeName(e,"input")?e.defaultValue:r&&r.specified?r.value:t},set:function(e,n,r){return b.nodeName(e,"input")?(e.defaultValue=n,t):I&&I.set(e,n,r)}}),Q||(I=b.valHooks.button={get:function(e,n){var r=e.getAttributeNode(n);return r&&("id"===n||"name"===n||"coords"===n?""!==r.value:r.specified)?r.value:t},set:function(e,n,r){var i=e.getAttributeNode(r);return i||e.setAttributeNode(i=e.ownerDocument.createAttribute(r)),i.value=n+="","value"===r||n===e.getAttribute(r)?n:t}},b.attrHooks.contenteditable={get:I.get,set:function(e,t,n){I.set(e,""===t?!1:t,n)}},b.each(["width","height"],function(e,n){b.attrHooks[n]=b.extend(b.attrHooks[n],{set:function(e,r){return""===r?(e.setAttribute(n,"auto"),r):t}})})),b.support.hrefNormalized||(b.each(["href","src","width","height"],function(e,n){b.attrHooks[n]=b.extend(b.attrHooks[n],{get:function(e){var r=e.getAttribute(n,2);return null==r?t:r}})}),b.each(["href","src"],function(e,t){b.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}})),b.support.style||(b.attrHooks.style={get:function(e){return e.style.cssText||t},set:function(e,t){return e.style.cssText=t+""}}),b.support.optSelected||(b.propHooks.selected=b.extend(b.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),b.support.enctype||(b.propFix.enctype="encoding"),b.support.checkOn||b.each(["radio","checkbox"],function(){b.valHooks[this]={get:function(e){return null===e.getAttribute("value")?"on":e.value}}}),b.each(["radio","checkbox"],function(){b.valHooks[this]=b.extend(b.valHooks[this],{set:function(e,n){return b.isArray(n)?e.checked=b.inArray(b(e).val(),n)>=0:t}})});var Z=/^(?:input|select|textarea)$/i,et=/^key/,tt=/^(?:mouse|contextmenu)|click/,nt=/^(?:focusinfocus|focusoutblur)$/,rt=/^([^.]*)(?:\.(.+)|)$/;function it(){return !0}function ot(){return !1}b.event={global:{},add:function(e,n,r,o,a){var s,u,l,c,p,f,d,h,g,m,y,v=b._data(e);if(v){r.handler&&(c=r,r=c.handler,a=c.selector),r.guid||(r.guid=b.guid++),(u=v.events)||(u=v.events={}),(f=v.handle)||(f=v.handle=function(e){return typeof b===i||e&&b.event.triggered===e.type?t:b.event.dispatch.apply(f.elem,arguments)},f.elem=e),n=(n||"").match(w)||[""],l=n.length;while(l--){s=rt.exec(n[l])||[],g=y=s[1],m=(s[2]||"").split(".").sort(),p=b.event.special[g]||{},g=(a?p.delegateType:p.bindType)||g,p=b.event.special[g]||{},d=b.extend({type:g,origType:y,data:o,handler:r,guid:r.guid,selector:a,needsContext:a&&b.expr.match.needsContext.test(a),namespace:m.join(".")},c),(h=u[g])||(h=u[g]=[],h.delegateCount=0,p.setup&&p.setup.call(e,o,m,f)!==!1||(e.addEventListener?e.addEventListener(g,f,!1):e.attachEvent&&e.attachEvent("on"+g,f))),p.add&&(p.add.call(e,d),d.handler.guid||(d.handler.guid=r.guid)),a?h.splice(h.delegateCount++,0,d):h.push(d),b.event.global[g]=!0}e=null}},remove:function(e,t,n,r,i){var o,a,s,u,l,c,p,f,d,h,g,m=b.hasData(e)&&b._data(e);if(m&&(c=m.events)){t=(t||"").match(w)||[""],l=t.length;while(l--){if(s=rt.exec(t[l])||[],d=g=s[1],h=(s[2]||"").split(".").sort(),d){p=b.event.special[d]||{},d=(r?p.delegateType:p.bindType)||d,f=c[d]||[],s=s[2]&&RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),u=o=f.length;while(o--){a=f[o],!i&&g!==a.origType||n&&n.guid!==a.guid||s&&!s.test(a.namespace)||r&&r!==a.selector&&("**"!==r||!a.selector)||(f.splice(o,1),a.selector&&f.delegateCount--,p.remove&&p.remove.call(e,a))}u&&!f.length&&(p.teardown&&p.teardown.call(e,h,m.handle)!==!1||b.removeEvent(e,d,m.handle),delete c[d])}else{for(d in c){b.event.remove(e,d+t[l],n,r,!0)}}}b.isEmptyObject(c)&&(delete m.handle,b._removeData(e,"events"))}},trigger:function(n,r,i,a){var s,u,l,c,p,f,d,h=[i||o],g=y.call(n,"type")?n.type:n,m=y.call(n,"namespace")?n.namespace.split("."):[];if(l=f=i=i||o,3!==i.nodeType&&8!==i.nodeType&&!nt.test(g+b.event.triggered)&&(g.indexOf(".")>=0&&(m=g.split("."),g=m.shift(),m.sort()),u=0>g.indexOf(":")&&"on"+g,n=n[b.expando]?n:new b.Event(g,"object"==typeof n&&n),n.isTrigger=!0,n.namespace=m.join("."),n.namespace_re=n.namespace?RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,n.result=t,n.target||(n.target=i),r=null==r?[n]:b.makeArray(r,[n]),p=b.event.special[g]||{},a||!p.trigger||p.trigger.apply(i,r)!==!1)){if(!a&&!p.noBubble&&!b.isWindow(i)){for(c=p.delegateType||g,nt.test(c+g)||(l=l.parentNode);l;l=l.parentNode){h.push(l),f=l}f===(i.ownerDocument||o)&&h.push(f.defaultView||f.parentWindow||e)}d=0;while((l=h[d++])&&!n.isPropagationStopped()){n.type=d>1?c:p.bindType||g,s=(b._data(l,"events")||{})[n.type]&&b._data(l,"handle"),s&&s.apply(l,r),s=u&&l[u],s&&b.acceptData(l)&&s.apply&&s.apply(l,r)===!1&&n.preventDefault()}if(n.type=g,!(a||n.isDefaultPrevented()||p._default&&p._default.apply(i.ownerDocument,r)!==!1||"click"===g&&b.nodeName(i,"a")||!b.acceptData(i)||!u||!i[g]||b.isWindow(i))){f=i[u],f&&(i[u]=null),b.event.triggered=g;try{i[g]()}catch(v){}b.event.triggered=t,f&&(i[u]=f)}return n.result}},dispatch:function(e){e=b.event.fix(e);var n,r,i,o,a,s=[],u=h.call(arguments),l=(b._data(this,"events")||{})[e.type]||[],c=b.event.special[e.type]||{};if(u[0]=e,e.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,e)!==!1){s=b.event.handlers.call(this,e,l),n=0;while((o=s[n++])&&!e.isPropagationStopped()){e.currentTarget=o.elem,a=0;while((i=o.handlers[a++])&&!e.isImmediatePropagationStopped()){(!e.namespace_re||e.namespace_re.test(i.namespace))&&(e.handleObj=i,e.data=i.data,r=((b.event.special[i.origType]||{}).handle||i.handler).apply(o.elem,u),r!==t&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation()))}}return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers:function(e,n){var r,i,o,a,s=[],u=n.delegateCount,l=e.target;if(u&&l.nodeType&&(!e.button||"click"!==e.type)){for(;l!=this;l=l.parentNode||this){if(1===l.nodeType&&(l.disabled!==!0||"click"!==e.type)){for(o=[],a=0;u>a;a++){i=n[a],r=i.selector+" ",o[r]===t&&(o[r]=i.needsContext?b(r,this).index(l)>=0:b.find(r,this,null,[l]).length),o[r]&&o.push(i)}o.length&&s.push({elem:l,handlers:o})}}}return n.length>u&&s.push({elem:this,handlers:n.slice(u)}),s},fix:function(e){if(e[b.expando]){return e}var t,n,r,i=e.type,a=e,s=this.fixHooks[i];s||(this.fixHooks[i]=s=tt.test(i)?this.mouseHooks:et.test(i)?this.keyHooks:{}),r=s.props?this.props.concat(s.props):this.props,e=new b.Event(a),t=r.length;while(t--){n=r[t],e[n]=a[n]}return e.target||(e.target=a.srcElement||o),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,s.filter?s.filter(e,a):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var r,i,a,s=n.button,u=n.fromElement;return null==e.pageX&&null!=n.clientX&&(i=e.target.ownerDocument||o,a=i.documentElement,r=i.body,e.pageX=n.clientX+(a&&a.scrollLeft||r&&r.scrollLeft||0)-(a&&a.clientLeft||r&&r.clientLeft||0),e.pageY=n.clientY+(a&&a.scrollTop||r&&r.scrollTop||0)-(a&&a.clientTop||r&&r.clientTop||0)),!e.relatedTarget&&u&&(e.relatedTarget=u===e.target?n.toElement:u),e.which||s===t||(e.which=1&s?1:2&s?3:4&s?2:0),e}},special:{load:{noBubble:!0},click:{trigger:function(){return b.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):t}},focus:{trigger:function(){if(this!==o.activeElement&&this.focus){try{return this.focus(),!1}catch(e){}}},delegateType:"focusin"},blur:{trigger:function(){return this===o.activeElement&&this.blur?(this.blur(),!1):t},delegateType:"focusout"},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=b.extend(new b.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?b.event.trigger(i,null,t):b.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},b.removeEvent=o.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&(typeof e[r]===i&&(e[r]=null),e.detachEvent(r,n))},b.Event=function(e,n){return this instanceof b.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?it:ot):this.type=e,n&&b.extend(this,n),this.timeStamp=e&&e.timeStamp||b.now(),this[b.expando]=!0,t):new b.Event(e,n)},b.Event.prototype={isDefaultPrevented:ot,isPropagationStopped:ot,isImmediatePropagationStopped:ot,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=it,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=it,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=it,this.stopPropagation()}},b.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){b.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,o=e.handleObj;return(!i||i!==r&&!b.contains(r,i))&&(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),b.support.submitBubbles||(b.event.special.submit={setup:function(){return b.nodeName(this,"form")?!1:(b.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,r=b.nodeName(n,"input")||b.nodeName(n,"button")?n.form:t;r&&!b._data(r,"submitBubbles")&&(b.event.add(r,"submit._submit",function(e){e._submit_bubble=!0}),b._data(r,"submitBubbles",!0))}),t)},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&b.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return b.nodeName(this,"form")?!1:(b.event.remove(this,"._submit"),t)}}),b.support.changeBubbles||(b.event.special.change={setup:function(){return Z.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(b.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),b.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),b.event.simulate("change",this,e,!0)})),!1):(b.event.add(this,"beforeactivate._change",function(e){var t=e.target;Z.test(t.nodeName)&&!b._data(t,"changeBubbles")&&(b.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||b.event.simulate("change",this.parentNode,e,!0)}),b._data(t,"changeBubbles",!0))}),t)},handle:function(e){var n=e.target;return this!==n||e.isSimulated||e.isTrigger||"radio"!==n.type&&"checkbox"!==n.type?e.handleObj.handler.apply(this,arguments):t},teardown:function(){return b.event.remove(this,"._change"),!Z.test(this.nodeName)}}),b.support.focusinBubbles||b.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){b.event.simulate(t,e.target,b.event.fix(e),!0)};b.event.special[t]={setup:function(){0===n++&&o.addEventListener(e,r,!0)},teardown:function(){0===--n&&o.removeEventListener(e,r,!0)}}}),b.fn.extend({on:function(e,n,r,i,o){var a,s;if("object"==typeof e){"string"!=typeof n&&(r=r||n,n=t);for(a in e){this.on(a,n,r,e[a],o)}return this}if(null==r&&null==i?(i=n,r=n=t):null==i&&("string"==typeof n?(i=r,r=t):(i=r,r=n,n=t)),i===!1){i=ot}else{if(!i){return this}}return 1===o&&(s=i,i=function(e){return b().off(e),s.apply(this,arguments)},i.guid=s.guid||(s.guid=b.guid++)),this.each(function(){b.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,n,r){var i,o;if(e&&e.preventDefault&&e.handleObj){return i=e.handleObj,b(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this}if("object"==typeof e){for(o in e){this.off(o,n,e[o])}return this}return(n===!1||"function"==typeof n)&&(r=n,n=t),r===!1&&(r=ot),this.each(function(){b.event.remove(this,e,r,n)})},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},trigger:function(e,t){return this.each(function(){b.event.trigger(e,t,this)})},triggerHandler:function(e,n){var r=this[0];return r?b.event.trigger(e,n,r,!0):t}}),function(e,t){var n,r,i,o,a,s,u,l,c,p,f,d,h,g,m,y,v,x="sizzle"+-new Date,w=e.document,T={},N=0,C=0,k=it(),E=it(),S=it(),A=typeof t,j=1<<31,D=[],L=D.pop,H=D.push,q=D.slice,M=D.indexOf||function(e){var t=0,n=this.length;for(;n>t;t++){if(this[t]===e){return t}}return -1},_="[\\x20\\t\\r\\n\\f]",F="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",O=F.replace("w","w#"),B="([*^$|!~]?=)",P="\\["+_+"*("+F+")"+_+"*(?:"+B+_+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+O+")|)|)"+_+"*\\]",R=":("+F+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+P.replace(3,8)+")*)|.*)\\)|)",W=RegExp("^"+_+"+|((?:^|[^\\\\])(?:\\\\.)*)"+_+"+$","g"),$=RegExp("^"+_+"*,"+_+"*"),I=RegExp("^"+_+"*([\\x20\\t\\r\\n\\f>+~])"+_+"*"),z=RegExp(R),X=RegExp("^"+O+"$"),U={ID:RegExp("^#("+F+")"),CLASS:RegExp("^\\.("+F+")"),NAME:RegExp("^\\[name=['\"]?("+F+")['\"]?\\]"),TAG:RegExp("^("+F.replace("w","w*")+")"),ATTR:RegExp("^"+P),PSEUDO:RegExp("^"+R),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+_+"*(even|odd|(([+-]|)(\\d*)n|)"+_+"*(?:([+-]|)"+_+"*(\\d+)|))"+_+"*\\)|)","i"),needsContext:RegExp("^"+_+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+_+"*((?:-\\d)?\\d*)"+_+"*\\)|)(?=[^-]|$)","i")},V=/[\x20\t\r\n\f]*[+~]/,Y=/^[^{]+\{\s*\[native code/,J=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,G=/^(?:input|select|textarea|button)$/i,Q=/^h\d$/i,K=/'|\\/g,Z=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,et=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,tt=function(e,t){var n="0x"+t-65536;return n!==n?t:0>n?String.fromCharCode(n+65536):String.fromCharCode(55296|n>>10,56320|1023&n)};try{q.call(w.documentElement.childNodes,0)[0].nodeType}catch(nt){q=function(e){var t,n=[];while(t=this[e++]){n.push(t)}return n}}function rt(e){return Y.test(e+"")}function it(){var e,t=[];return e=function(n,r){return t.push(n+=" ")>i.cacheLength&&delete e[t.shift()],e[n]=r}}function ot(e){return e[x]=!0,e}function at(e){var t=p.createElement("div");try{return e(t)}catch(n){return !1}finally{t=null}}function st(e,t,n,r){var i,o,a,s,u,l,f,g,m,v;if((t?t.ownerDocument||t:w)!==p&&c(t),t=t||p,n=n||[],!e||"string"!=typeof e){return n}if(1!==(s=t.nodeType)&&9!==s){return[]}if(!d&&!r){if(i=J.exec(e)){if(a=i[1]){if(9===s){if(o=t.getElementById(a),!o||!o.parentNode){return n}if(o.id===a){return n.push(o),n}}else{if(t.ownerDocument&&(o=t.ownerDocument.getElementById(a))&&y(t,o)&&o.id===a){return n.push(o),n}}}else{if(i[2]){return H.apply(n,q.call(t.getElementsByTagName(e),0)),n}if((a=i[3])&&T.getByClassName&&t.getElementsByClassName){return H.apply(n,q.call(t.getElementsByClassName(a),0)),n}}}if(T.qsa&&!h.test(e)){if(f=!0,g=x,m=t,v=9===s&&e,1===s&&"object"!==t.nodeName.toLowerCase()){l=ft(e),(f=t.getAttribute("id"))?g=f.replace(K,"\\$&"):t.setAttribute("id",g),g="[id='"+g+"'] ",u=l.length;while(u--){l[u]=g+dt(l[u])}m=V.test(e)&&t.parentNode||t,v=l.join(",")}if(v){try{return H.apply(n,q.call(m.querySelectorAll(v),0)),n}catch(b){}finally{f||t.removeAttribute("id")}}}}return wt(e.replace(W,"$1"),t,n,r)}a=st.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},c=st.setDocument=function(e){var n=e?e.ownerDocument||e:w;return n!==p&&9===n.nodeType&&n.documentElement?(p=n,f=n.documentElement,d=a(n),T.tagNameNoComments=at(function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length}),T.attributes=at(function(e){e.innerHTML="<select></select>";var t=typeof e.lastChild.getAttribute("multiple");return"boolean"!==t&&"string"!==t}),T.getByClassName=at(function(e){return e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",e.getElementsByClassName&&e.getElementsByClassName("e").length?(e.lastChild.className="e",2===e.getElementsByClassName("e").length):!1}),T.getByName=at(function(e){e.id=x+0,e.innerHTML="<a name='"+x+"'></a><div name='"+x+"'></div>",f.insertBefore(e,f.firstChild);var t=n.getElementsByName&&n.getElementsByName(x).length===2+n.getElementsByName(x+0).length;return T.getIdNotName=!n.getElementById(x),f.removeChild(e),t}),i.attrHandle=at(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!==A&&"#"===e.firstChild.getAttribute("href")})?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},T.getIdNotName?(i.find.ID=function(e,t){if(typeof t.getElementById!==A&&!d){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},i.filter.ID=function(e){var t=e.replace(et,tt);return function(e){return e.getAttribute("id")===t}}):(i.find.ID=function(e,n){if(typeof n.getElementById!==A&&!d){var r=n.getElementById(e);return r?r.id===e||typeof r.getAttributeNode!==A&&r.getAttributeNode("id").value===e?[r]:t:[]}},i.filter.ID=function(e){var t=e.replace(et,tt);return function(e){var n=typeof e.getAttributeNode!==A&&e.getAttributeNode("id");return n&&n.value===t}}),i.find.TAG=T.tagNameNoComments?function(e,n){return typeof n.getElementsByTagName!==A?n.getElementsByTagName(e):t}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){while(n=o[i++]){1===n.nodeType&&r.push(n)}return r}return o},i.find.NAME=T.getByName&&function(e,n){return typeof n.getElementsByName!==A?n.getElementsByName(name):t},i.find.CLASS=T.getByClassName&&function(e,n){return typeof n.getElementsByClassName===A||d?t:n.getElementsByClassName(e)},g=[],h=[":focus"],(T.qsa=rt(n.querySelectorAll))&&(at(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||h.push("\\["+_+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),e.querySelectorAll(":checked").length||h.push(":checked")}),at(function(e){e.innerHTML="<input type='hidden' i=''/>",e.querySelectorAll("[i^='']").length&&h.push("[*^$]="+_+"*(?:\"\"|'')"),e.querySelectorAll(":enabled").length||h.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),h.push(",.*:")})),(T.matchesSelector=rt(m=f.matchesSelector||f.mozMatchesSelector||f.webkitMatchesSelector||f.oMatchesSelector||f.msMatchesSelector))&&at(function(e){T.disconnectedMatch=m.call(e,"div"),m.call(e,"[s!='']:x"),g.push("!=",R)}),h=RegExp(h.join("|")),g=RegExp(g.join("|")),y=rt(f.contains)||f.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t){while(t=t.parentNode){if(t===e){return !0}}}return !1},v=f.compareDocumentPosition?function(e,t){var r;return e===t?(u=!0,0):(r=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t))?1&r||e.parentNode&&11===e.parentNode.nodeType?e===n||y(w,e)?-1:t===n||y(w,t)?1:0:4&r?-1:1:e.compareDocumentPosition?-1:1}:function(e,t){var r,i=0,o=e.parentNode,a=t.parentNode,s=[e],l=[t];if(e===t){return u=!0,0}if(!o||!a){return e===n?-1:t===n?1:o?-1:a?1:0}if(o===a){return ut(e,t)}r=e;while(r=r.parentNode){s.unshift(r)}r=t;while(r=r.parentNode){l.unshift(r)}while(s[i]===l[i]){i++}return i?ut(s[i],l[i]):s[i]===w?-1:l[i]===w?1:0},u=!1,[0,0].sort(v),T.detectDuplicates=u,p):p},st.matches=function(e,t){return st(e,null,null,t)},st.matchesSelector=function(e,t){if((e.ownerDocument||e)!==p&&c(e),t=t.replace(Z,"='$1']"),!(!T.matchesSelector||d||g&&g.test(t)||h.test(t))){try{var n=m.call(e,t);if(n||T.disconnectedMatch||e.document&&11!==e.document.nodeType){return n}}catch(r){}}return st(t,p,null,[e]).length>0},st.contains=function(e,t){return(e.ownerDocument||e)!==p&&c(e),y(e,t)},st.attr=function(e,t){var n;return(e.ownerDocument||e)!==p&&c(e),d||(t=t.toLowerCase()),(n=i.attrHandle[t])?n(e):d||T.attributes?e.getAttribute(t):((n=e.getAttributeNode(t))||e.getAttribute(t))&&e[t]===!0?t:n&&n.specified?n.value:null},st.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},st.uniqueSort=function(e){var t,n=[],r=1,i=0;if(u=!T.detectDuplicates,e.sort(v),u){for(;t=e[r];r++){t===e[r-1]&&(i=n.push(r))}while(i--){e.splice(n[i],1)}}return e};function ut(e,t){var n=t&&e,r=n&&(~t.sourceIndex||j)-(~e.sourceIndex||j);if(r){return r}if(n){while(n=n.nextSibling){if(n===t){return -1}}}return e?1:-1}function lt(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function ct(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function pt(e){return ot(function(t){return t=+t,ot(function(n,r){var i,o=e([],n.length,t),a=o.length;while(a--){n[i=o[a]]&&(n[i]=!(r[i]=n[i]))}})})}o=st.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent){return e.textContent}for(e=e.firstChild;e;e=e.nextSibling){n+=o(e)}}else{if(3===i||4===i){return e.nodeValue}}}else{for(;t=e[r];r++){n+=o(t)}}return n},i=st.selectors={cacheLength:50,createPseudo:ot,match:U,find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(et,tt),e[3]=(e[4]||e[5]||"").replace(et,tt),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||st.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&st.error(e[0]),e},PSEUDO:function(e){var t,n=!e[5]&&e[2];return U.CHILD.test(e[0])?null:(e[4]?e[2]=e[4]:n&&z.test(n)&&(t=ft(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){return"*"===e?function(){return !0}:(e=e.replace(et,tt).toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===e})},CLASS:function(e){var t=k[e+" "];return t||(t=RegExp("(^|"+_+")"+e+"("+_+"|$)"))&&k(e,function(e){return t.test(e.className||typeof e.getAttribute!==A&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=st.attr(r,e);return null==i?"!="===t:t?(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i+" ").indexOf(n)>-1:"|="===t?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===r&&0===i?function(e){return !!e.parentNode}:function(t,n,u){var l,c,p,f,d,h,g=o!==a?"nextSibling":"previousSibling",m=t.parentNode,y=s&&t.nodeName.toLowerCase(),v=!u&&!s;if(m){if(o){while(g){p=t;while(p=p[g]){if(s?p.nodeName.toLowerCase()===y:1===p.nodeType){return !1}}h=g="only"===e&&!h&&"nextSibling"}return !0}if(h=[a?m.firstChild:m.lastChild],a&&v){c=m[x]||(m[x]={}),l=c[e]||[],d=l[0]===N&&l[1],f=l[0]===N&&l[2],p=d&&m.childNodes[d];while(p=++d&&p&&p[g]||(f=d=0)||h.pop()){if(1===p.nodeType&&++f&&p===t){c[e]=[N,d,f];break}}}else{if(v&&(l=(t[x]||(t[x]={}))[e])&&l[0]===N){f=l[1]}else{while(p=++d&&p&&p[g]||(f=d=0)||h.pop()){if((s?p.nodeName.toLowerCase()===y:1===p.nodeType)&&++f&&(v&&((p[x]||(p[x]={}))[e]=[N,f]),p===t)){break}}}}return f-=i,f===r||0===f%r&&f/r>=0}}},PSEUDO:function(e,t){var n,r=i.pseudos[e]||i.setFilters[e.toLowerCase()]||st.error("unsupported pseudo: "+e);return r[x]?r(t):r.length>1?(n=[e,e,"",t],i.setFilters.hasOwnProperty(e.toLowerCase())?ot(function(e,n){var i,o=r(e,t),a=o.length;while(a--){i=M.call(e,o[a]),e[i]=!(n[i]=o[a])}}):function(e){return r(e,0,n)}):r}},pseudos:{not:ot(function(e){var t=[],n=[],r=s(e.replace(W,"$1"));return r[x]?ot(function(e,t,n,i){var o,a=r(e,null,i,[]),s=e.length;while(s--){(o=a[s])&&(e[s]=!(t[s]=o))}}):function(e,i,o){return t[0]=e,r(t,null,o,n),!n.pop()}}),has:ot(function(e){return function(t){return st(e,t).length>0}}),contains:ot(function(e){return function(t){return(t.textContent||t.innerText||o(t)).indexOf(e)>-1}}),lang:ot(function(e){return X.test(e||"")||st.error("unsupported lang: "+e),e=e.replace(et,tt).toLowerCase(),function(t){var n;do{if(n=d?t.getAttribute("xml:lang")||t.getAttribute("lang"):t.lang){return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-")}}while((t=t.parentNode)&&1===t.nodeType);return !1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===f},focus:function(e){return e===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling){if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType){return !1}}return !0},parent:function(e){return !i.pseudos.empty(e)},header:function(e){return Q.test(e.nodeName)},input:function(e){return G.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:pt(function(){return[0]}),last:pt(function(e,t){return[t-1]}),eq:pt(function(e,t,n){return[0>n?n+t:n]}),even:pt(function(e,t){var n=0;for(;t>n;n+=2){e.push(n)}return e}),odd:pt(function(e,t){var n=1;for(;t>n;n+=2){e.push(n)}return e}),lt:pt(function(e,t,n){var r=0>n?n+t:n;for(;--r>=0;){e.push(r)}return e}),gt:pt(function(e,t,n){var r=0>n?n+t:n;for(;t>++r;){e.push(r)}return e})}};for(n in {radio:!0,checkbox:!0,file:!0,password:!0,image:!0}){i.pseudos[n]=lt(n)}for(n in {submit:!0,reset:!0}){i.pseudos[n]=ct(n)}function ft(e,t){var n,r,o,a,s,u,l,c=E[e+" "];if(c){return t?0:c.slice(0)}s=e,u=[],l=i.preFilter;while(s){(!n||(r=$.exec(s)))&&(r&&(s=s.slice(r[0].length)||s),u.push(o=[])),n=!1,(r=I.exec(s))&&(n=r.shift(),o.push({value:n,type:r[0].replace(W," ")}),s=s.slice(n.length));for(a in i.filter){!(r=U[a].exec(s))||l[a]&&!(r=l[a](r))||(n=r.shift(),o.push({value:n,type:a,matches:r}),s=s.slice(n.length))}if(!n){break}}return t?s.length:s?st.error(e):E(e,u).slice(0)}function dt(e){var t=0,n=e.length,r="";for(;n>t;t++){r+=e[t].value}return r}function ht(e,t,n){var i=t.dir,o=n&&"parentNode"===i,a=C++;return t.first?function(t,n,r){while(t=t[i]){if(1===t.nodeType||o){return e(t,n,r)}}}:function(t,n,s){var u,l,c,p=N+" "+a;if(s){while(t=t[i]){if((1===t.nodeType||o)&&e(t,n,s)){return !0}}}else{while(t=t[i]){if(1===t.nodeType||o){if(c=t[x]||(t[x]={}),(l=c[i])&&l[0]===p){if((u=l[1])===!0||u===r){return u===!0}}else{if(l=c[i]=[p],l[1]=e(t,n,s)||r,l[1]===!0){return !0}}}}}}}function gt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--){if(!e[i](t,n,r)){return !1}}return !0}:e[0]}function mt(e,t,n,r,i){var o,a=[],s=0,u=e.length,l=null!=t;for(;u>s;s++){(o=e[s])&&(!n||n(o,r,i))&&(a.push(o),l&&t.push(s))}return a}function yt(e,t,n,r,i,o){return r&&!r[x]&&(r=yt(r)),i&&!i[x]&&(i=yt(i,o)),ot(function(o,a,s,u){var l,c,p,f=[],d=[],h=a.length,g=o||xt(t||"*",s.nodeType?[s]:s,[]),m=!e||!o&&t?g:mt(g,f,e,s,u),y=n?i||(o?e:h||r)?[]:a:m;if(n&&n(m,y,s,u),r){l=mt(y,d),r(l,[],s,u),c=l.length;while(c--){(p=l[c])&&(y[d[c]]=!(m[d[c]]=p))}}if(o){if(i||e){if(i){l=[],c=y.length;while(c--){(p=y[c])&&l.push(m[c]=p)}i(null,y=[],l,u)}c=y.length;while(c--){(p=y[c])&&(l=i?M.call(o,p):f[c])>-1&&(o[l]=!(a[l]=p))}}}else{y=mt(y===a?y.splice(h,y.length):y),i?i(null,a,y,u):H.apply(a,y)}})}function vt(e){var t,n,r,o=e.length,a=i.relative[e[0].type],s=a||i.relative[" "],u=a?1:0,c=ht(function(e){return e===t},s,!0),p=ht(function(e){return M.call(t,e)>-1},s,!0),f=[function(e,n,r){return !a&&(r||n!==l)||((t=n).nodeType?c(e,n,r):p(e,n,r))}];for(;o>u;u++){if(n=i.relative[e[u].type]){f=[ht(gt(f),n)]}else{if(n=i.filter[e[u].type].apply(null,e[u].matches),n[x]){for(r=++u;o>r;r++){if(i.relative[e[r].type]){break}}return yt(u>1&&gt(f),u>1&&dt(e.slice(0,u-1)).replace(W,"$1"),n,r>u&&vt(e.slice(u,r)),o>r&&vt(e=e.slice(r)),o>r&&dt(e))}f.push(n)}}return gt(f)}function bt(e,t){var n=0,o=t.length>0,a=e.length>0,s=function(s,u,c,f,d){var h,g,m,y=[],v=0,b="0",x=s&&[],w=null!=d,T=l,C=s||a&&i.find.TAG("*",d&&u.parentNode||u),k=N+=null==T?1:Math.random()||0.1;for(w&&(l=u!==p&&u,r=n);null!=(h=C[b]);b++){if(a&&h){g=0;while(m=e[g++]){if(m(h,u,c)){f.push(h);break}}w&&(N=k,r=++n)}o&&((h=!m&&h)&&v--,s&&x.push(h))}if(v+=b,o&&b!==v){g=0;while(m=t[g++]){m(x,y,u,c)}if(s){if(v>0){while(b--){x[b]||y[b]||(y[b]=L.call(f))}}y=mt(y)}H.apply(f,y),w&&!s&&y.length>0&&v+t.length>1&&st.uniqueSort(f)}return w&&(N=k,l=T),x};return o?ot(s):s}s=st.compile=function(e,t){var n,r=[],i=[],o=S[e+" "];if(!o){t||(t=ft(e)),n=t.length;while(n--){o=vt(t[n]),o[x]?r.push(o):i.push(o)}o=S(e,bt(i,r))}return o};function xt(e,t,n){var r=0,i=t.length;for(;i>r;r++){st(e,t[r],n)}return n}function wt(e,t,n,r){var o,a,u,l,c,p=ft(e);if(!r&&1===p.length){if(a=p[0]=p[0].slice(0),a.length>2&&"ID"===(u=a[0]).type&&9===t.nodeType&&!d&&i.relative[a[1].type]){if(t=i.find.ID(u.matches[0].replace(et,tt),t)[0],!t){return n}e=e.slice(a.shift().value.length)}o=U.needsContext.test(e)?0:a.length;while(o--){if(u=a[o],i.relative[l=u.type]){break}if((c=i.find[l])&&(r=c(u.matches[0].replace(et,tt),V.test(a[0].type)&&t.parentNode||t))){if(a.splice(o,1),e=r.length&&dt(a),!e){return H.apply(n,q.call(r,0)),n}break}}}return s(e,p)(r,t,d,n,V.test(e)),n}i.pseudos.nth=i.pseudos.eq;function Tt(){}i.filters=Tt.prototype=i.pseudos,i.setFilters=new Tt,c(),st.attr=b.attr,b.find=st,b.expr=st.selectors,b.expr[":"]=b.expr.pseudos,b.unique=st.uniqueSort,b.text=st.getText,b.isXMLDoc=st.isXML,b.contains=st.contains}(e);var at=/Until$/,st=/^(?:parents|prev(?:Until|All))/,ut=/^.[^:#\[\.,]*$/,lt=b.expr.match.needsContext,ct={children:!0,contents:!0,next:!0,prev:!0};b.fn.extend({find:function(e){var t,n,r,i=this.length;if("string"!=typeof e){return r=this,this.pushStack(b(e).filter(function(){for(t=0;i>t;t++){if(b.contains(r[t],this)){return !0}}}))}for(n=[],t=0;i>t;t++){b.find(e,this[t],n)}return n=this.pushStack(i>1?b.unique(n):n),n.selector=(this.selector?this.selector+" ":"")+e,n},has:function(e){var t,n=b(e,this),r=n.length;return this.filter(function(){for(t=0;r>t;t++){if(b.contains(this,n[t])){return !0}}})},not:function(e){return this.pushStack(ft(this,e,!1))},filter:function(e){return this.pushStack(ft(this,e,!0))},is:function(e){return !!e&&("string"==typeof e?lt.test(e)?b(e,this.context).index(this[0])>=0:b.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){var n,r=0,i=this.length,o=[],a=lt.test(e)||"string"!=typeof e?b(e,t||this.context):0;for(;i>r;r++){n=this[r];while(n&&n.ownerDocument&&n!==t&&11!==n.nodeType){if(a?a.index(n)>-1:b.find.matchesSelector(n,e)){o.push(n);break}n=n.parentNode}}return this.pushStack(o.length>1?b.unique(o):o)},index:function(e){return e?"string"==typeof e?b.inArray(this[0],b(e)):b.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n="string"==typeof e?b(e,t):b.makeArray(e&&e.nodeType?[e]:e),r=b.merge(this.get(),n);return this.pushStack(b.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),b.fn.andSelf=b.fn.addBack;function pt(e,t){do{e=e[t]}while(e&&1!==e.nodeType);return e}b.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return b.dir(e,"parentNode")},parentsUntil:function(e,t,n){return b.dir(e,"parentNode",n)},next:function(e){return pt(e,"nextSibling")},prev:function(e){return pt(e,"previousSibling")},nextAll:function(e){return b.dir(e,"nextSibling")},prevAll:function(e){return b.dir(e,"previousSibling")},nextUntil:function(e,t,n){return b.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return b.dir(e,"previousSibling",n)},siblings:function(e){return b.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return b.sibling(e.firstChild)},contents:function(e){return b.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:b.merge([],e.childNodes)}},function(e,t){b.fn[e]=function(n,r){var i=b.map(this,t,n);return at.test(e)||(r=n),r&&"string"==typeof r&&(i=b.filter(r,i)),i=this.length>1&&!ct[e]?b.unique(i):i,this.length>1&&st.test(e)&&(i=i.reverse()),this.pushStack(i)}}),b.extend({filter:function(e,t,n){return n&&(e=":not("+e+")"),1===t.length?b.find.matchesSelector(t[0],e)?[t[0]]:[]:b.find.matches(e,t)},dir:function(e,n,r){var i=[],o=e[n];while(o&&9!==o.nodeType&&(r===t||1!==o.nodeType||!b(o).is(r))){1===o.nodeType&&i.push(o),o=o[n]}return i},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling){1===e.nodeType&&e!==t&&n.push(e)}return n}});function ft(e,t,n){if(t=t||0,b.isFunction(t)){return b.grep(e,function(e,r){var i=!!t.call(e,r,e);return i===n})}if(t.nodeType){return b.grep(e,function(e){return e===t===n})}if("string"==typeof t){var r=b.grep(e,function(e){return 1===e.nodeType});if(ut.test(t)){return b.filter(t,r,!n)}t=b.filter(t,r)}return b.grep(e,function(e){return b.inArray(e,t)>=0===n})}function dt(e){var t=ht.split("|"),n=e.createDocumentFragment();if(n.createElement){while(t.length){n.createElement(t.pop())}}return n}var ht="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",gt=/ jQuery\d+="(?:null|\d+)"/g,mt=RegExp("<(?:"+ht+")[\\s/>]","i"),yt=/^\s+/,vt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,bt=/<([\w:]+)/,xt=/<tbody/i,wt=/<|&#?\w+;/,Tt=/<(?:script|style|link)/i,Nt=/^(?:checkbox|radio)$/i,Ct=/checked\s*(?:[^=]|=\s*.checked.)/i,kt=/^$|\/(?:java|ecma)script/i,Et=/^true\/(.*)/,St=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,At={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:b.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},jt=dt(o),Dt=jt.appendChild(o.createElement("div"));At.optgroup=At.option,At.tbody=At.tfoot=At.colgroup=At.caption=At.thead,At.th=At.td,b.fn.extend({text:function(e){return b.access(this,function(e){return e===t?b.text(this):this.empty().append((this[0]&&this[0].ownerDocument||o).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(b.isFunction(e)){return this.each(function(t){b(this).wrapAll(e.call(this,t))})}if(this[0]){var t=b(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstChild&&1===e.firstChild.nodeType){e=e.firstChild}return e}).append(this)}return this},wrapInner:function(e){return b.isFunction(e)?this.each(function(t){b(this).wrapInner(e.call(this,t))}):this.each(function(){var t=b(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=b.isFunction(e);return this.each(function(n){b(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){b.nodeName(this,"body")||b(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.insertBefore(e,this.firstChild)})},before:function(){return this.domManip(arguments,!1,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,!1,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=0;for(;null!=(n=this[r]);r++){(!e||b.filter(e,[n]).length>0)&&(t||1!==n.nodeType||b.cleanData(Ot(n)),n.parentNode&&(t&&b.contains(n.ownerDocument,n)&&Mt(Ot(n,"script")),n.parentNode.removeChild(n)))}return this},empty:function(){var e,t=0;for(;null!=(e=this[t]);t++){1===e.nodeType&&b.cleanData(Ot(e,!1));while(e.firstChild){e.removeChild(e.firstChild)}e.options&&b.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return b.clone(this,e,t)})},html:function(e){return b.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t){return 1===n.nodeType?n.innerHTML.replace(gt,""):t}if(!("string"!=typeof e||Tt.test(e)||!b.support.htmlSerialize&&mt.test(e)||!b.support.leadingWhitespace&&yt.test(e)||At[(bt.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(vt,"<$1></$2>");try{for(;i>r;r++){n=this[r]||{},1===n.nodeType&&(b.cleanData(Ot(n,!1)),n.innerHTML=e)}n=0}catch(o){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){var t=b.isFunction(e);return t||"string"==typeof e||(e=b(e).not(this).detach()),this.domManip([e],!0,function(e){var t=this.nextSibling,n=this.parentNode;n&&(b(this).remove(),n.insertBefore(e,t))})},detach:function(e){return this.remove(e,!0)},domManip:function(e,n,r){e=f.apply([],e);var i,o,a,s,u,l,c=0,p=this.length,d=this,h=p-1,g=e[0],m=b.isFunction(g);if(m||!(1>=p||"string"!=typeof g||b.support.checkClone)&&Ct.test(g)){return this.each(function(i){var o=d.eq(i);m&&(e[0]=g.call(this,i,n?o.html():t)),o.domManip(e,n,r)})}if(p&&(l=b.buildFragment(e,this[0].ownerDocument,!1,this),i=l.firstChild,1===l.childNodes.length&&(l=i),i)){for(n=n&&b.nodeName(i,"tr"),s=b.map(Ot(l,"script"),Ht),a=s.length;p>c;c++){o=l,c!==h&&(o=b.clone(o,!0,!0),a&&b.merge(s,Ot(o,"script"))),r.call(n&&b.nodeName(this[c],"table")?Lt(this[c],"tbody"):this[c],o,c)}if(a){for(u=s[s.length-1].ownerDocument,b.map(s,qt),c=0;a>c;c++){o=s[c],kt.test(o.type||"")&&!b._data(o,"globalEval")&&b.contains(u,o)&&(o.src?b.ajax({url:o.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):b.globalEval((o.text||o.textContent||o.innerHTML||"").replace(St,"")))}}l=i=null}return this}});function Lt(e,t){return e.getElementsByTagName(t)[0]||e.appendChild(e.ownerDocument.createElement(t))}function Ht(e){var t=e.getAttributeNode("type");return e.type=(t&&t.specified)+"/"+e.type,e}function qt(e){var t=Et.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function Mt(e,t){var n,r=0;for(;null!=(n=e[r]);r++){b._data(n,"globalEval",!t||b._data(t[r],"globalEval"))}}function _t(e,t){if(1===t.nodeType&&b.hasData(e)){var n,r,i,o=b._data(e),a=b._data(t,o),s=o.events;if(s){delete a.handle,a.events={};for(n in s){for(r=0,i=s[n].length;i>r;r++){b.event.add(t,n,s[n][r])}}}a.data&&(a.data=b.extend({},a.data))}}function Ft(e,t){var n,r,i;if(1===t.nodeType){if(n=t.nodeName.toLowerCase(),!b.support.noCloneEvent&&t[b.expando]){i=b._data(t);for(r in i.events){b.removeEvent(t,r,i.handle)}t.removeAttribute(b.expando)}"script"===n&&t.text!==e.text?(Ht(t).text=e.text,qt(t)):"object"===n?(t.parentNode&&(t.outerHTML=e.outerHTML),b.support.html5Clone&&e.innerHTML&&!b.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===n&&Nt.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===n?t.defaultSelected=t.selected=e.defaultSelected:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}}b.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){b.fn[e]=function(e){var n,r=0,i=[],o=b(e),a=o.length-1;for(;a>=r;r++){n=r===a?this:this.clone(!0),b(o[r])[t](n),d.apply(i,n.get())}return this.pushStack(i)}});function Ot(e,n){var r,o,a=0,s=typeof e.getElementsByTagName!==i?e.getElementsByTagName(n||"*"):typeof e.querySelectorAll!==i?e.querySelectorAll(n||"*"):t;if(!s){for(s=[],r=e.childNodes||e;null!=(o=r[a]);a++){!n||b.nodeName(o,n)?s.push(o):b.merge(s,Ot(o,n))}}return n===t||n&&b.nodeName(e,n)?b.merge([e],s):s}function Bt(e){Nt.test(e.type)&&(e.defaultChecked=e.checked)}b.extend({clone:function(e,t,n){var r,i,o,a,s,u=b.contains(e.ownerDocument,e);if(b.support.html5Clone||b.isXMLDoc(e)||!mt.test("<"+e.nodeName+">")?o=e.cloneNode(!0):(Dt.innerHTML=e.outerHTML,Dt.removeChild(o=Dt.firstChild)),!(b.support.noCloneEvent&&b.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||b.isXMLDoc(e))){for(r=Ot(o),s=Ot(e),a=0;null!=(i=s[a]);++a){r[a]&&Ft(i,r[a])}}if(t){if(n){for(s=s||Ot(e),r=r||Ot(o),a=0;null!=(i=s[a]);a++){_t(i,r[a])}}else{_t(e,o)}}return r=Ot(o,"script"),r.length>0&&Mt(r,!u&&Ot(e,"script")),r=s=i=null,o},buildFragment:function(e,t,n,r){var i,o,a,s,u,l,c,p=e.length,f=dt(t),d=[],h=0;for(;p>h;h++){if(o=e[h],o||0===o){if("object"===b.type(o)){b.merge(d,o.nodeType?[o]:o)}else{if(wt.test(o)){s=s||f.appendChild(t.createElement("div")),u=(bt.exec(o)||["",""])[1].toLowerCase(),c=At[u]||At._default,s.innerHTML=c[1]+o.replace(vt,"<$1></$2>")+c[2],i=c[0];while(i--){s=s.lastChild}if(!b.support.leadingWhitespace&&yt.test(o)&&d.push(t.createTextNode(yt.exec(o)[0])),!b.support.tbody){o="table"!==u||xt.test(o)?"<table>"!==c[1]||xt.test(o)?0:s:s.firstChild,i=o&&o.childNodes.length;while(i--){b.nodeName(l=o.childNodes[i],"tbody")&&!l.childNodes.length&&o.removeChild(l)}}b.merge(d,s.childNodes),s.textContent="";while(s.firstChild){s.removeChild(s.firstChild)}s=f.lastChild}else{d.push(t.createTextNode(o))}}}}s&&f.removeChild(s),b.support.appendChecked||b.grep(Ot(d,"input"),Bt),h=0;while(o=d[h++]){if((!r||-1===b.inArray(o,r))&&(a=b.contains(o.ownerDocument,o),s=Ot(f.appendChild(o),"script"),a&&Mt(s),n)){i=0;while(o=s[i++]){kt.test(o.type||"")&&n.push(o)}}}return s=null,f},cleanData:function(e,t){var n,r,o,a,s=0,u=b.expando,l=b.cache,p=b.support.deleteExpando,f=b.event.special;for(;null!=(n=e[s]);s++){if((t||b.acceptData(n))&&(o=n[u],a=o&&l[o])){if(a.events){for(r in a.events){f[r]?b.event.remove(n,r):b.removeEvent(n,r,a.handle)}}l[o]&&(delete l[o],p?delete n[u]:typeof n.removeAttribute!==i?n.removeAttribute(u):n[u]=null,c.push(o))}}}});var Pt,Rt,Wt,$t=/alpha\([^)]*\)/i,It=/opacity\s*=\s*([^)]*)/,zt=/^(top|right|bottom|left)$/,Xt=/^(none|table(?!-c[ea]).+)/,Ut=/^margin/,Vt=RegExp("^("+x+")(.*)$","i"),Yt=RegExp("^("+x+")(?!px)[a-z%]+$","i"),Jt=RegExp("^([+-])=("+x+")","i"),Gt={BODY:"block"},Qt={position:"absolute",visibility:"hidden",display:"block"},Kt={letterSpacing:0,fontWeight:400},Zt=["Top","Right","Bottom","Left"],en=["Webkit","O","Moz","ms"];function tn(e,t){if(t in e){return t}var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=en.length;while(i--){if(t=en[i]+n,t in e){return t}}return r}function nn(e,t){return e=t||e,"none"===b.css(e,"display")||!b.contains(e.ownerDocument,e)}function rn(e,t){var n,r,i,o=[],a=0,s=e.length;for(;s>a;a++){r=e[a],r.style&&(o[a]=b._data(r,"olddisplay"),n=r.style.display,t?(o[a]||"none"!==n||(r.style.display=""),""===r.style.display&&nn(r)&&(o[a]=b._data(r,"olddisplay",un(r.nodeName)))):o[a]||(i=nn(r),(n&&"none"!==n||!i)&&b._data(r,"olddisplay",i?n:b.css(r,"display"))))}for(a=0;s>a;a++){r=e[a],r.style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?o[a]||"":"none"))}return e}b.fn.extend({css:function(e,n){return b.access(this,function(e,n,r){var i,o,a={},s=0;if(b.isArray(n)){for(o=Rt(e),i=n.length;i>s;s++){a[n[s]]=b.css(e,n[s],!1,o)}return a}return r!==t?b.style(e,n,r):b.css(e,n)},e,n,arguments.length>1)},show:function(){return rn(this,!0)},hide:function(){return rn(this)},toggle:function(e){var t="boolean"==typeof e;return this.each(function(){(t?e:nn(this))?b(this).show():b(this).hide()})}}),b.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Wt(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":b.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,r,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,a,s,u=b.camelCase(n),l=e.style;if(n=b.cssProps[u]||(b.cssProps[u]=tn(l,u)),s=b.cssHooks[n]||b.cssHooks[u],r===t){return s&&"get" in s&&(o=s.get(e,!1,i))!==t?o:l[n]}if(a=typeof r,"string"===a&&(o=Jt.exec(r))&&(r=(o[1]+1)*o[2]+parseFloat(b.css(e,n)),a="number"),!(null==r||"number"===a&&isNaN(r)||("number"!==a||b.cssNumber[u]||(r+="px"),b.support.clearCloneStyle||""!==r||0!==n.indexOf("background")||(l[n]="inherit"),s&&"set" in s&&(r=s.set(e,r,i))===t))){try{l[n]=r}catch(c){}}}},css:function(e,n,r,i){var o,a,s,u=b.camelCase(n);return n=b.cssProps[u]||(b.cssProps[u]=tn(e.style,u)),s=b.cssHooks[n]||b.cssHooks[u],s&&"get" in s&&(a=s.get(e,!0,r)),a===t&&(a=Wt(e,n,i)),"normal"===a&&n in Kt&&(a=Kt[n]),""===r||r?(o=parseFloat(a),r===!0||b.isNumeric(o)?o||0:a):a},swap:function(e,t,n,r){var i,o,a={};for(o in t){a[o]=e.style[o],e.style[o]=t[o]}i=n.apply(e,r||[]);for(o in t){e.style[o]=a[o]}return i}}),e.getComputedStyle?(Rt=function(t){return e.getComputedStyle(t,null)},Wt=function(e,n,r){var i,o,a,s=r||Rt(e),u=s?s.getPropertyValue(n)||s[n]:t,l=e.style;return s&&(""!==u||b.contains(e.ownerDocument,e)||(u=b.style(e,n)),Yt.test(u)&&Ut.test(n)&&(i=l.width,o=l.minWidth,a=l.maxWidth,l.minWidth=l.maxWidth=l.width=u,u=s.width,l.width=i,l.minWidth=o,l.maxWidth=a)),u}):o.documentElement.currentStyle&&(Rt=function(e){return e.currentStyle},Wt=function(e,n,r){var i,o,a,s=r||Rt(e),u=s?s[n]:t,l=e.style;return null==u&&l&&l[n]&&(u=l[n]),Yt.test(u)&&!zt.test(n)&&(i=l.left,o=e.runtimeStyle,a=o&&o.left,a&&(o.left=e.currentStyle.left),l.left="fontSize"===n?"1em":u,u=l.pixelLeft+"px",l.left=i,a&&(o.left=a)),""===u?"auto":u});function on(e,t,n){var r=Vt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function an(e,t,n,r,i){var o=n===(r?"border":"content")?4:"width"===t?1:0,a=0;for(;4>o;o+=2){"margin"===n&&(a+=b.css(e,n+Zt[o],!0,i)),r?("content"===n&&(a-=b.css(e,"padding"+Zt[o],!0,i)),"margin"!==n&&(a-=b.css(e,"border"+Zt[o]+"Width",!0,i))):(a+=b.css(e,"padding"+Zt[o],!0,i),"padding"!==n&&(a+=b.css(e,"border"+Zt[o]+"Width",!0,i)))}return a}function sn(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,o=Rt(e),a=b.support.boxSizing&&"border-box"===b.css(e,"boxSizing",!1,o);if(0>=i||null==i){if(i=Wt(e,t,o),(0>i||null==i)&&(i=e.style[t]),Yt.test(i)){return i}r=a&&(b.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+an(e,t,n||(a?"border":"content"),r,o)+"px"}function un(e){var t=o,n=Gt[e];return n||(n=ln(e,t),"none"!==n&&n||(Pt=(Pt||b("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(Pt[0].contentWindow||Pt[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=ln(e,t),Pt.detach()),Gt[e]=n),n}function ln(e,t){var n=b(t.createElement(e)).appendTo(t.body),r=b.css(n[0],"display");return n.remove(),r}b.each(["height","width"],function(e,n){b.cssHooks[n]={get:function(e,r,i){return r?0===e.offsetWidth&&Xt.test(b.css(e,"display"))?b.swap(e,Qt,function(){return sn(e,n,i)}):sn(e,n,i):t},set:function(e,t,r){var i=r&&Rt(e);return on(e,t,r?an(e,n,r,b.support.boxSizing&&"border-box"===b.css(e,"boxSizing",!1,i),i):0)}}}),b.support.opacity||(b.cssHooks.opacity={get:function(e,t){return It.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?0.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=b.isNumeric(t)?"alpha(opacity="+100*t+")":"",o=r&&r.filter||n.filter||"";n.zoom=1,(t>=1||""===t)&&""===b.trim(o.replace($t,""))&&n.removeAttribute&&(n.removeAttribute("filter"),""===t||r&&!r.filter)||(n.filter=$t.test(o)?o.replace($t,i):o+" "+i)}}),b(function(){b.support.reliableMarginRight||(b.cssHooks.marginRight={get:function(e,n){return n?b.swap(e,{display:"inline-block"},Wt,[e,"marginRight"]):t}}),!b.support.pixelPosition&&b.fn.position&&b.each(["top","left"],function(e,n){b.cssHooks[n]={get:function(e,r){return r?(r=Wt(e,n),Yt.test(r)?b(e).position()[n]+"px":r):t}}})}),b.expr&&b.expr.filters&&(b.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight||!b.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||b.css(e,"display"))},b.expr.filters.visible=function(e){return !b.expr.filters.hidden(e)}),b.each({margin:"",padding:"",border:"Width"},function(e,t){b.cssHooks[e+t]={expand:function(n){var r=0,i={},o="string"==typeof n?n.split(" "):[n];for(;4>r;r++){i[e+Zt[r]+t]=o[r]||o[r-2]||o[0]}return i}},Ut.test(e)||(b.cssHooks[e+t].set=on)});var cn=/%20/g,pn=/\[\]$/,fn=/\r?\n/g,dn=/^(?:submit|button|image|reset|file)$/i,hn=/^(?:input|select|textarea|keygen)/i;b.fn.extend({serialize:function(){return b.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=b.prop(this,"elements");return e?b.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!b(this).is(":disabled")&&hn.test(this.nodeName)&&!dn.test(e)&&(this.checked||!Nt.test(e))}).map(function(e,t){var n=b(this).val();return null==n?null:b.isArray(n)?b.map(n,function(e){return{name:t.name,value:e.replace(fn,"\r\n")}}):{name:t.name,value:n.replace(fn,"\r\n")}}).get()}}),b.param=function(e,n){var r,i=[],o=function(e,t){t=b.isFunction(t)?t():null==t?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(n===t&&(n=b.ajaxSettings&&b.ajaxSettings.traditional),b.isArray(e)||e.jquery&&!b.isPlainObject(e)){b.each(e,function(){o(this.name,this.value)})}else{for(r in e){gn(r,e[r],n,o)}}return i.join("&").replace(cn,"+")};function gn(e,t,n,r){var i;if(b.isArray(t)){b.each(t,function(t,i){n||pn.test(e)?r(e,i):gn(e+"["+("object"==typeof i?t:"")+"]",i,n,r)})}else{if(n||"object"!==b.type(t)){r(e,t)}else{for(i in t){gn(e+"["+i+"]",t[i],n,r)}}}}b.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){b.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),b.fn.hover=function(e,t){return this.mouseenter(e).mouseleave(t||e)};var mn,yn,vn=b.now(),bn=/\?/,xn=/#.*$/,wn=/([?&])_=[^&]*/,Tn=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Nn=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Cn=/^(?:GET|HEAD)$/,kn=/^\/\//,En=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,Sn=b.fn.load,An={},jn={},Dn="*/".concat("*");try{yn=a.href}catch(Ln){yn=o.createElement("a"),yn.href="",yn=yn.href}mn=En.exec(yn.toLowerCase())||[];function Hn(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,o=t.toLowerCase().match(w)||[];if(b.isFunction(n)){while(r=o[i++]){"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}}}function qn(e,n,r,i){var o={},a=e===jn;function s(u){var l;return o[u]=!0,b.each(e[u]||[],function(e,u){var c=u(n,r,i);return"string"!=typeof c||a||o[c]?a?!(l=c):t:(n.dataTypes.unshift(c),s(c),!1)}),l}return s(n.dataTypes[0])||!o["*"]&&s("*")}function Mn(e,n){var r,i,o=b.ajaxSettings.flatOptions||{};for(i in n){n[i]!==t&&((o[i]?e:r||(r={}))[i]=n[i])}return r&&b.extend(!0,e,r),e}b.fn.load=function(e,n,r){if("string"!=typeof e&&Sn){return Sn.apply(this,arguments)}var i,o,a,s=this,u=e.indexOf(" ");return u>=0&&(i=e.slice(u,e.length),e=e.slice(0,u)),b.isFunction(n)?(r=n,n=t):n&&"object"==typeof n&&(a="POST"),s.length>0&&b.ajax({url:e,type:a,dataType:"html",data:n}).done(function(e){o=arguments,s.html(i?b("<div>").append(b.parseHTML(e)).find(i):e)}).complete(r&&function(e,t){s.each(r,o||[e.responseText,t,e])}),this},b.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){b.fn[t]=function(e){return this.on(t,e)}}),b.each(["get","post"],function(e,n){b[n]=function(e,r,i,o){return b.isFunction(r)&&(o=o||i,i=r,r=t),b.ajax({url:e,type:n,dataType:o,data:r,success:i})}}),b.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:yn,type:"GET",isLocal:Nn.test(mn[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Dn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":b.parseJSON,"text xml":b.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Mn(Mn(e,b.ajaxSettings),t):Mn(b.ajaxSettings,e)},ajaxPrefilter:Hn(An),ajaxTransport:Hn(jn),ajax:function(e,n){"object"==typeof e&&(n=e,e=t),n=n||{};var r,i,o,a,s,u,l,c,p=b.ajaxSetup({},n),f=p.context||p,d=p.context&&(f.nodeType||f.jquery)?b(f):b.event,h=b.Deferred(),g=b.Callbacks("once memory"),m=p.statusCode||{},y={},v={},x=0,T="canceled",N={readyState:0,getResponseHeader:function(e){var t;if(2===x){if(!c){c={};while(t=Tn.exec(a)){c[t[1].toLowerCase()]=t[2]}}t=c[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===x?a:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return x||(e=v[n]=v[n]||e,y[e]=t),this},overrideMimeType:function(e){return x||(p.mimeType=e),this},statusCode:function(e){var t;if(e){if(2>x){for(t in e){m[t]=[m[t],e[t]]}}else{N.always(e[N.status])}}return this},abort:function(e){var t=e||T;return l&&l.abort(t),k(0,t),this}};if(h.promise(N).complete=g.add,N.success=N.done,N.error=N.fail,p.url=((e||p.url||yn)+"").replace(xn,"").replace(kn,mn[1]+"//"),p.type=n.method||n.type||p.method||p.type,p.dataTypes=b.trim(p.dataType||"*").toLowerCase().match(w)||[""],null==p.crossDomain&&(r=En.exec(p.url.toLowerCase()),p.crossDomain=!(!r||r[1]===mn[1]&&r[2]===mn[2]&&(r[3]||("http:"===r[1]?80:443))==(mn[3]||("http:"===mn[1]?80:443)))),p.data&&p.processData&&"string"!=typeof p.data&&(p.data=b.param(p.data,p.traditional)),qn(An,p,n,N),2===x){return N}u=p.global,u&&0===b.active++&&b.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Cn.test(p.type),o=p.url,p.hasContent||(p.data&&(o=p.url+=(bn.test(o)?"&":"?")+p.data,delete p.data),p.cache===!1&&(p.url=wn.test(o)?o.replace(wn,"$1_="+vn++):o+(bn.test(o)?"&":"?")+"_="+vn++)),p.ifModified&&(b.lastModified[o]&&N.setRequestHeader("If-Modified-Since",b.lastModified[o]),b.etag[o]&&N.setRequestHeader("If-None-Match",b.etag[o])),(p.data&&p.hasContent&&p.contentType!==!1||n.contentType)&&N.setRequestHeader("Content-Type",p.contentType),N.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+Dn+"; q=0.01":""):p.accepts["*"]);for(i in p.headers){N.setRequestHeader(i,p.headers[i])}if(p.beforeSend&&(p.beforeSend.call(f,N,p)===!1||2===x)){return N.abort()}T="abort";for(i in {success:1,error:1,complete:1}){N[i](p[i])}if(l=qn(jn,p,n,N)){N.readyState=1,u&&d.trigger("ajaxSend",[N,p]),p.async&&p.timeout>0&&(s=setTimeout(function(){N.abort("timeout")},p.timeout));try{x=1,l.send(y,k)}catch(C){if(!(2>x)){throw C}k(-1,C)}}else{k(-1,"No Transport")}function k(e,n,r,i){var c,y,v,w,T,C=n;2!==x&&(x=2,s&&clearTimeout(s),l=t,a=i||"",N.readyState=e>0?4:0,r&&(w=_n(p,N,r)),e>=200&&300>e||304===e?(p.ifModified&&(T=N.getResponseHeader("Last-Modified"),T&&(b.lastModified[o]=T),T=N.getResponseHeader("etag"),T&&(b.etag[o]=T)),204===e?(c=!0,C="nocontent"):304===e?(c=!0,C="notmodified"):(c=Fn(p,w),C=c.state,y=c.data,v=c.error,c=!v)):(v=C,(e||!C)&&(C="error",0>e&&(e=0))),N.status=e,N.statusText=(n||C)+"",c?h.resolveWith(f,[y,C,N]):h.rejectWith(f,[N,C,v]),N.statusCode(m),m=t,u&&d.trigger(c?"ajaxSuccess":"ajaxError",[N,p,c?y:v]),g.fireWith(f,[N,C]),u&&(d.trigger("ajaxComplete",[N,p]),--b.active||b.event.trigger("ajaxStop")))}return N},getScript:function(e,n){return b.get(e,t,n,"script")},getJSON:function(e,t,n){return b.get(e,t,n,"json")}});function _n(e,n,r){var i,o,a,s,u=e.contents,l=e.dataTypes,c=e.responseFields;for(s in c){s in r&&(n[c[s]]=r[s])}while("*"===l[0]){l.shift(),o===t&&(o=e.mimeType||n.getResponseHeader("Content-Type"))}if(o){for(s in u){if(u[s]&&u[s].test(o)){l.unshift(s);break}}}if(l[0] in r){a=l[0]}else{for(s in r){if(!l[0]||e.converters[s+" "+l[0]]){a=s;break}i||(i=s)}a=a||i}return a?(a!==l[0]&&l.unshift(a),r[a]):t}function Fn(e,t){var n,r,i,o,a={},s=0,u=e.dataTypes.slice(),l=u[0];if(e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u[1]){for(i in e.converters){a[i.toLowerCase()]=e.converters[i]}}for(;r=u[++s];){if("*"!==r){if("*"!==l&&l!==r){if(i=a[l+" "+r]||a["* "+r],!i){for(n in a){if(o=n.split(" "),o[1]===r&&(i=a[l+" "+o[0]]||a["* "+o[0]])){i===!0?i=a[n]:a[n]!==!0&&(r=o[0],u.splice(s--,0,r));break}}}if(i!==!0){if(i&&e["throws"]){t=i(t)}else{try{t=i(t)}catch(c){return{state:"parsererror",error:i?c:"No conversion from "+l+" to "+r}}}}}l=r}}return{state:"success",data:t}}b.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return b.globalEval(e),e}}}),b.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),b.ajaxTransport("script",function(e){if(e.crossDomain){var n,r=o.head||b("head")[0]||o.documentElement;return{send:function(t,i){n=o.createElement("script"),n.async=!0,e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,t){(t||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),n=null,t||i(200,"success"))},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(t,!0)}}}});var On=[],Bn=/(=)\?(?=&|$)|\?\?/;b.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=On.pop()||b.expando+"_"+vn++;return this[e]=!0,e}}),b.ajaxPrefilter("json jsonp",function(n,r,i){var o,a,s,u=n.jsonp!==!1&&(Bn.test(n.url)?"url":"string"==typeof n.data&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&Bn.test(n.data)&&"data");return u||"jsonp"===n.dataTypes[0]?(o=n.jsonpCallback=b.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,u?n[u]=n[u].replace(Bn,"$1"+o):n.jsonp!==!1&&(n.url+=(bn.test(n.url)?"&":"?")+n.jsonp+"="+o),n.converters["script json"]=function(){return s||b.error(o+" was not called"),s[0]},n.dataTypes[0]="json",a=e[o],e[o]=function(){s=arguments},i.always(function(){e[o]=a,n[o]&&(n.jsonpCallback=r.jsonpCallback,On.push(o)),s&&b.isFunction(a)&&a(s[0]),s=a=t}),"script"):t});var Pn,Rn,Wn=0,$n=e.ActiveXObject&&function(){var e;for(e in Pn){Pn[e](t,!0)}};function In(){try{return new e.XMLHttpRequest}catch(t){}}function zn(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}b.ajaxSettings.xhr=e.ActiveXObject?function(){return !this.isLocal&&In()||zn()}:In,Rn=b.ajaxSettings.xhr(),b.support.cors=!!Rn&&"withCredentials" in Rn,Rn=b.support.ajax=!!Rn,Rn&&b.ajaxTransport(function(n){if(!n.crossDomain||b.support.cors){var r;return{send:function(i,o){var a,s,u=n.xhr();if(n.username?u.open(n.type,n.url,n.async,n.username,n.password):u.open(n.type,n.url,n.async),n.xhrFields){for(s in n.xhrFields){u[s]=n.xhrFields[s]}}n.mimeType&&u.overrideMimeType&&u.overrideMimeType(n.mimeType),n.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");try{for(s in i){u.setRequestHeader(s,i[s])}}catch(l){}u.send(n.hasContent&&n.data||null),r=function(e,i){var s,l,c,p;try{if(r&&(i||4===u.readyState)){if(r=t,a&&(u.onreadystatechange=b.noop,$n&&delete Pn[a]),i){4!==u.readyState&&u.abort()}else{p={},s=u.status,l=u.getAllResponseHeaders(),"string"==typeof u.responseText&&(p.text=u.responseText);try{c=u.statusText}catch(f){c=""}s||!n.isLocal||n.crossDomain?1223===s&&(s=204):s=p.text?200:404}}}catch(d){i||o(-1,d)}p&&o(s,c,p,l)},n.async?4===u.readyState?setTimeout(r):(a=++Wn,$n&&(Pn||(Pn={},b(e).unload($n)),Pn[a]=r),u.onreadystatechange=r):r()},abort:function(){r&&r(t,!0)}}}});var Xn,Un,Vn=/^(?:toggle|show|hide)$/,Yn=RegExp("^(?:([+-])=|)("+x+")([a-z%]*)$","i"),Jn=/queueHooks$/,Gn=[nr],Qn={"*":[function(e,t){var n,r,i=this.createTween(e,t),o=Yn.exec(t),a=i.cur(),s=+a||0,u=1,l=20;if(o){if(n=+o[2],r=o[3]||(b.cssNumber[e]?"":"px"),"px"!==r&&s){s=b.css(i.elem,e,!0)||n||1;do{u=u||".5",s/=u,b.style(i.elem,e,s+r)}while(u!==(u=i.cur()/a)&&1!==u&&--l)}i.unit=r,i.start=s,i.end=o[1]?s+(o[1]+1)*n:n}return i}]};function Kn(){return setTimeout(function(){Xn=t}),Xn=b.now()}function Zn(e,t){b.each(t,function(t,n){var r=(Qn[t]||[]).concat(Qn["*"]),i=0,o=r.length;for(;o>i;i++){if(r[i].call(e,t,n)){return}}})}function er(e,t,n){var r,i,o=0,a=Gn.length,s=b.Deferred().always(function(){delete u.elem}),u=function(){if(i){return !1}var t=Xn||Kn(),n=Math.max(0,l.startTime+l.duration-t),r=n/l.duration||0,o=1-r,a=0,u=l.tweens.length;for(;u>a;a++){l.tweens[a].run(o)}return s.notifyWith(e,[l,o,n]),1>o&&u?n:(s.resolveWith(e,[l]),!1)},l=s.promise({elem:e,props:b.extend({},t),opts:b.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Xn||Kn(),duration:n.duration,tweens:[],createTween:function(t,n){var r=b.Tween(e,l.opts,t,n,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(r),r},stop:function(t){var n=0,r=t?l.tweens.length:0;if(i){return this}for(i=!0;r>n;n++){l.tweens[n].run(1)}return t?s.resolveWith(e,[l,t]):s.rejectWith(e,[l,t]),this}}),c=l.props;for(tr(c,l.opts.specialEasing);a>o;o++){if(r=Gn[o].call(l,e,c,l.opts)){return r}}return Zn(l,c),b.isFunction(l.opts.start)&&l.opts.start.call(e,l),b.fx.timer(b.extend(u,{elem:e,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function tr(e,t){var n,r,i,o,a;for(i in e){if(r=b.camelCase(i),o=t[r],n=e[i],b.isArray(n)&&(o=n[1],n=e[i]=n[0]),i!==r&&(e[r]=n,delete e[i]),a=b.cssHooks[r],a&&"expand" in a){n=a.expand(n),delete e[r];for(i in n){i in e||(e[i]=n[i],t[i]=o)}}else{t[r]=o}}}b.Animation=b.extend(er,{tweener:function(e,t){b.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;i>r;r++){n=e[r],Qn[n]=Qn[n]||[],Qn[n].unshift(t)}},prefilter:function(e,t){t?Gn.unshift(e):Gn.push(e)}});function nr(e,t,n){var r,i,o,a,s,u,l,c,p,f=this,d=e.style,h={},g=[],m=e.nodeType&&nn(e);n.queue||(c=b._queueHooks(e,"fx"),null==c.unqueued&&(c.unqueued=0,p=c.empty.fire,c.empty.fire=function(){c.unqueued||p()}),c.unqueued++,f.always(function(){f.always(function(){c.unqueued--,b.queue(e,"fx").length||c.empty.fire()})})),1===e.nodeType&&("height" in t||"width" in t)&&(n.overflow=[d.overflow,d.overflowX,d.overflowY],"inline"===b.css(e,"display")&&"none"===b.css(e,"float")&&(b.support.inlineBlockNeedsLayout&&"inline"!==un(e.nodeName)?d.zoom=1:d.display="inline-block")),n.overflow&&(d.overflow="hidden",b.support.shrinkWrapBlocks||f.always(function(){d.overflow=n.overflow[0],d.overflowX=n.overflow[1],d.overflowY=n.overflow[2]}));for(i in t){if(a=t[i],Vn.exec(a)){if(delete t[i],u=u||"toggle"===a,a===(m?"hide":"show")){continue}g.push(i)}}if(o=g.length){s=b._data(e,"fxshow")||b._data(e,"fxshow",{}),"hidden" in s&&(m=s.hidden),u&&(s.hidden=!m),m?b(e).show():f.done(function(){b(e).hide()}),f.done(function(){var t;b._removeData(e,"fxshow");for(t in h){b.style(e,t,h[t])}});for(i=0;o>i;i++){r=g[i],l=f.createTween(r,m?s[r]:0),h[r]=s[r]||b.style(e,r),r in s||(s[r]=l.start,m&&(l.end=l.start,l.start="width"===r||"height"===r?1:0))}}}function rr(e,t,n,r,i){return new rr.prototype.init(e,t,n,r,i)}b.Tween=rr,rr.prototype={constructor:rr,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(b.cssNumber[n]?"":"px")},cur:function(){var e=rr.propHooks[this.prop];return e&&e.get?e.get(this):rr.propHooks._default.get(this)},run:function(e){var t,n=rr.propHooks[this.prop];return this.pos=t=this.options.duration?b.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):rr.propHooks._default.set(this),this}},rr.prototype.init.prototype=rr.prototype,rr.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=b.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){b.fx.step[e.prop]?b.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[b.cssProps[e.prop]]||b.cssHooks[e.prop])?b.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},rr.propHooks.scrollTop=rr.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},b.each(["toggle","show","hide"],function(e,t){var n=b.fn[t];b.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(ir(t,!0),e,r,i)}}),b.fn.extend({fadeTo:function(e,t,n,r){return this.filter(nn).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=b.isEmptyObject(e),o=b.speed(t,n,r),a=function(){var t=er(this,b.extend({},e),o);a.finish=function(){t.stop(!0)},(i||b._data(this,"finish"))&&t.stop(!0)};return a.finish=a,i||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(e,n,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return"string"!=typeof e&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=null!=e&&e+"queueHooks",o=b.timers,a=b._data(this);if(n){a[n]&&a[n].stop&&i(a[n])}else{for(n in a){a[n]&&a[n].stop&&Jn.test(n)&&i(a[n])}}for(n=o.length;n--;){o[n].elem!==this||null!=e&&o[n].queue!==e||(o[n].anim.stop(r),t=!1,o.splice(n,1))}(t||!r)&&b.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=b._data(this),r=n[e+"queue"],i=n[e+"queueHooks"],o=b.timers,a=r?r.length:0;for(n.finish=!0,b.queue(this,e,[]),i&&i.cur&&i.cur.finish&&i.cur.finish.call(this),t=o.length;t--;){o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1))}for(t=0;a>t;t++){r[t]&&r[t].finish&&r[t].finish.call(this)}delete n.finish})}});function ir(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t){n=Zt[i],r["margin"+n]=r["padding"+n]=e}return t&&(r.opacity=r.width=e),r}b.each({slideDown:ir("show"),slideUp:ir("hide"),slideToggle:ir("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){b.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),b.speed=function(e,t,n){var r=e&&"object"==typeof e?b.extend({},e):{complete:n||!n&&t||b.isFunction(e)&&e,duration:e,easing:n&&t||t&&!b.isFunction(t)&&t};return r.duration=b.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in b.fx.speeds?b.fx.speeds[r.duration]:b.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){b.isFunction(r.old)&&r.old.call(this),r.queue&&b.dequeue(this,r.queue)},r},b.easing={linear:function(e){return e},swing:function(e){return 0.5-Math.cos(e*Math.PI)/2}},b.timers=[],b.fx=rr.prototype.init,b.fx.tick=function(){var e,n=b.timers,r=0;for(Xn=b.now();n.length>r;r++){e=n[r],e()||n[r]!==e||n.splice(r--,1)}n.length||b.fx.stop(),Xn=t},b.fx.timer=function(e){e()&&b.timers.push(e)&&b.fx.start()},b.fx.interval=13,b.fx.start=function(){Un||(Un=setInterval(b.fx.tick,b.fx.interval))},b.fx.stop=function(){clearInterval(Un),Un=null},b.fx.speeds={slow:600,fast:200,_default:400},b.fx.step={},b.expr&&b.expr.filters&&(b.expr.filters.animated=function(e){return b.grep(b.timers,function(t){return e===t.elem}).length}),b.fn.offset=function(e){if(arguments.length){return e===t?this:this.each(function(t){b.offset.setOffset(this,e,t)})}var n,r,o={top:0,left:0},a=this[0],s=a&&a.ownerDocument;if(s){return n=s.documentElement,b.contains(n,a)?(typeof a.getBoundingClientRect!==i&&(o=a.getBoundingClientRect()),r=or(s),{top:o.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:o.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)}):o}},b.offset={setOffset:function(e,t,n){var r=b.css(e,"position");"static"===r&&(e.style.position="relative");var i=b(e),o=i.offset(),a=b.css(e,"top"),s=b.css(e,"left"),u=("absolute"===r||"fixed"===r)&&b.inArray("auto",[a,s])>-1,l={},c={},p,f;u?(c=i.position(),p=c.top,f=c.left):(p=parseFloat(a)||0,f=parseFloat(s)||0),b.isFunction(t)&&(t=t.call(e,n,o)),null!=t.top&&(l.top=t.top-o.top+p),null!=t.left&&(l.left=t.left-o.left+f),"using" in t?t.using.call(e,l):i.css(l)}},b.fn.extend({position:function(){if(this[0]){var e,t,n={top:0,left:0},r=this[0];return"fixed"===b.css(r,"position")?t=r.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),b.nodeName(e[0],"html")||(n=e.offset()),n.top+=b.css(e[0],"borderTopWidth",!0),n.left+=b.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-b.css(r,"marginTop",!0),left:t.left-n.left-b.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||o.documentElement;while(e&&!b.nodeName(e,"html")&&"static"===b.css(e,"position")){e=e.offsetParent}return e||o.documentElement})}}),b.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var r=/Y/.test(n);b.fn[e]=function(i){return b.access(this,function(e,i,o){var a=or(e);return o===t?a?n in a?a[n]:a.document.documentElement[i]:e[i]:(a?a.scrollTo(r?b(a).scrollLeft():o,r?o:b(a).scrollTop()):e[i]=o,t)},e,i,arguments.length,null)}});function or(e){return b.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}b.each({Height:"height",Width:"width"},function(e,n){b.each({padding:"inner"+e,content:n,"":"outer"+e},function(r,i){b.fn[i]=function(i,o){var a=arguments.length&&(r||"boolean"!=typeof i),s=r||(i===!0||o===!0?"margin":"border");return b.access(this,function(n,r,i){var o;return b.isWindow(n)?n.document.documentElement["client"+e]:9===n.nodeType?(o=n.documentElement,Math.max(n.body["scroll"+e],o["scroll"+e],n.body["offset"+e],o["offset"+e],o["client"+e])):i===t?b.css(n,r,s):b.style(n,r,i,s)},n,a?i:t,a,null)}})}),e.jQuery=e.$=b,"function"==typeof define&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return b})})(window);var $jqTheme=jQuery.noConflict(true);if(!jQuery){throw new Error("Bootstrap requires jQuery")}+function(d){function c(){var f=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var g in e){if(void 0!==f.style[g]){return{end:e[g]}}}}d.fn.emulateTransitionEnd=function(a){var h=!1,g=this;d(this).one(d.support.transition.end,function(){h=!0});var f=function(){h||d(g).trigger(d.support.transition.end)};return setTimeout(f,a),this},d(function(){d.support.transition=c()})}(window.$jqTheme||window.jQuery),+function(f){var e='[data-dismiss="alert"]',h=function(a){f(a).on("click",e,this.close)};h.prototype.close=function(a){function l(){i.trigger("closed.bs.alert").remove()}var k=f(this),j=k.attr("data-target");j||(j=k.attr("href"),j=j&&j.replace(/.*(?=#[^\s]*$)/,""));var i=f(j);a&&a.preventDefault(),i.length||(i=k.hasClass("alert")?k:k.parent()),i.trigger(a=f.Event("close.bs.alert")),a.isDefaultPrevented()||(i.removeClass("in"),f.support.transition&&i.hasClass("fade")?i.one(f.support.transition.end,l).emulateTransitionEnd(150):l())};var g=f.fn.alert;f.fn.alert=function(a){return this.each(function(){var c=f(this),b=c.data("bs.alert");b||c.data("bs.alert",b=new h(this)),"string"==typeof a&&b[a].call(c)})},f.fn.alert.Constructor=h,f.fn.alert.noConflict=function(){return f.fn.alert=g,this},f(document).on("click.bs.alert.data-api",e,h.prototype.close)}(window.$jqTheme||window.jQuery),+function(e){var d=function(b,a){this.$element=e(b),this.options=e.extend({},d.DEFAULTS,a)};d.DEFAULTS={loadingText:"loading..."},d.prototype.setState=function(h){var g="disabled",k=this.$element,j=k.is("input")?"val":"html",i=k.data();h+="Text",i.resetText||k.data("resetText",k[j]()),k[j](i[h]||this.options[h]),setTimeout(function(){"loadingText"==h?k.addClass(g).attr(g,g):k.removeClass(g).removeAttr(g)},0)},d.prototype.toggle=function(){var g=this.$element.closest('[data-toggle="buttons"]');if(g.length){var c=this.$element.find("input").prop("checked",!this.$element.hasClass("active")).trigger("change");"radio"===c.prop("type")&&g.find(".active").removeClass("active")}this.$element.toggleClass("active")};var f=e.fn.button;e.fn.button=function(a){return this.each(function(){var g=e(this),c=g.data("bs.button"),b="object"==typeof a&&a;c||g.data("bs.button",c=new d(this,b)),"toggle"==a?c.toggle():a&&c.setState(a)})},e.fn.button.Constructor=d,e.fn.button.noConflict=function(){return e.fn.button=f,this},e(document).on("click.bs.button.data-api","[data-toggle^=button]",function(a){var g=e(a.target);g.hasClass("btn")||(g=g.closest(".btn")),g.button("toggle"),a.preventDefault()})}(window.$jqTheme||window.jQuery),+function(e){var d=function(a,g){this.$element=e(a),this.$indicators=this.$element.find(".carousel-indicators"),this.options=g,this.paused=this.sliding=this.interval=this.$active=this.$items=null,"hover"==this.options.pause&&this.$element.on("mouseenter",e.proxy(this.pause,this)).on("mouseleave",e.proxy(this.cycle,this))};d.DEFAULTS={interval:5000,pause:"hover",wrap:!0},d.prototype.cycle=function(a){return a||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},d.prototype.getActiveIndex=function(){return this.$active=this.$element.find(".item.active"),this.$items=this.$active.parent().children(),this.$items.index(this.$active)},d.prototype.to=function(a){var h=this,g=this.getActiveIndex();return a>this.$items.length-1||0>a?void 0:this.sliding?this.$element.one("slid",function(){h.to(a)}):g==a?this.pause().cycle():this.slide(a>g?"next":"prev",e(this.$items[a]))},d.prototype.pause=function(a){return a||(this.paused=!0),this.$element.find(".next, .prev").length&&e.support.transition.end&&(this.$element.trigger(e.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},d.prototype.next=function(){return this.sliding?void 0:this.slide("next")},d.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},d.prototype.slide=function(r,q){var p=this.$element.find(".item.active"),o=q||p[r](),n=this.interval,m="next"==r?"left":"right",l="next"==r?"first":"last",k=this;if(!o.length){if(!this.options.wrap){return}o=this.$element.find(".item")[l]()}this.sliding=!0,n&&this.pause();var a=e.Event("slide.bs.carousel",{relatedTarget:o[0],direction:m});if(!o.hasClass("active")){if(this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),this.$element.one("slid",function(){var c=e(k.$indicators.children()[k.getActiveIndex()]);c&&c.addClass("active")})),e.support.transition&&this.$element.hasClass("slide")){if(this.$element.trigger(a),a.isDefaultPrevented()){return}o.addClass(r),o[0].offsetWidth,p.addClass(m),o.addClass(m),p.one(e.support.transition.end,function(){o.removeClass([r,m].join(" ")).addClass("active"),p.removeClass(["active",m].join(" ")),k.sliding=!1,setTimeout(function(){k.$element.trigger("slid")},0)}).emulateTransitionEnd(600)}else{if(this.$element.trigger(a),a.isDefaultPrevented()){return}p.removeClass("active"),o.addClass("active"),this.sliding=!1,this.$element.trigger("slid")}return n&&this.cycle(),this}};var f=e.fn.carousel;e.fn.carousel=function(a){return this.each(function(){var i=e(this),h=i.data("bs.carousel"),c=e.extend({},d.DEFAULTS,i.data(),"object"==typeof a&&a),b="string"==typeof a?a:c.slide;h||i.data("bs.carousel",h=new d(this,c)),"number"==typeof a?h.to(a):b?h[b]():c.interval&&h.pause().cycle()})},e.fn.carousel.Constructor=d,e.fn.carousel.noConflict=function(){return e.fn.carousel=f,this},e(document).on("click.bs.carousel.data-api","[data-slide], [data-slide-to]",function(a){var l,k=e(this),j=e(k.attr("data-target")||(l=k.attr("href"))&&l.replace(/.*(?=#[^\s]+$)/,"")),i=e.extend({},j.data(),k.data()),h=k.attr("data-slide-to");h&&(i.interval=!1),j.carousel(i),(h=k.attr("data-slide-to"))&&j.data("bs.carousel").to(h),a.preventDefault()}),e(window).on("load",function(){e('[data-ride="carousel"]').each(function(){var a=e(this);a.carousel(a.data())})})}(window.$jqTheme||window.jQuery),+function(e){var d=function(b,a){this.$element=e(b),this.options=e.extend({},d.DEFAULTS,a),this.transitioning=null,this.options.parent&&(this.$parent=e(this.options.parent)),this.options.toggle&&this.toggle()};d.DEFAULTS={toggle:!0},d.prototype.dimension=function(){var b=this.$element.hasClass("width");return b?"width":"height"},d.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var a=e.Event("show.bs.collapse");if(this.$element.trigger(a),!a.isDefaultPrevented()){var l=this.$parent&&this.$parent.find("> .panel > .in");if(l&&l.length){var k=l.data("bs.collapse");if(k&&k.transitioning){return}l.collapse("hide"),k||l.data("bs.collapse",null)}var j=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[j](0),this.transitioning=1;var i=function(){this.$element.removeClass("collapsing").addClass("in")[j]("auto"),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!e.support.transition){return i.call(this)}var h=e.camelCase(["scroll",j].join("-"));this.$element.one(e.support.transition.end,e.proxy(i,this)).emulateTransitionEnd(350)[j](this.$element[0][h])}}},d.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var a=e.Event("hide.bs.collapse");if(this.$element.trigger(a),!a.isDefaultPrevented()){var h=this.dimension();this.$element[h](this.$element[h]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse").removeClass("in"),this.transitioning=1;var g=function(){this.transitioning=0,this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse")};return e.support.transition?(this.$element[h](0).one(e.support.transition.end,e.proxy(g,this)).emulateTransitionEnd(350),void 0):g.call(this)}}},d.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};var f=e.fn.collapse;e.fn.collapse=function(a){return this.each(function(){var g=e(this),c=g.data("bs.collapse"),b=e.extend({},d.DEFAULTS,g.data(),"object"==typeof a&&a);c||g.data("bs.collapse",c=new d(this,b)),"string"==typeof a&&c[a]()})},e.fn.collapse.Constructor=d,e.fn.collapse.noConflict=function(){return e.fn.collapse=f,this},e(document).on("click.bs.collapse.data-api","[data-toggle=collapse]",function(r){var q,p=e(this),o=p.attr("data-target")||r.preventDefault()||(q=p.attr("href"))&&q.replace(/.*(?=#[^\s]+$)/,""),n=e(o),m=n.data("bs.collapse"),l=m?"toggle":p.data(),k=p.attr("data-parent"),a=k&&e(k);m&&m.transitioning||(a&&a.find('[data-toggle=collapse][data-parent="'+k+'"]').not(p).addClass("collapsed"),p[n.hasClass("in")?"addClass":"removeClass"]("collapsed")),n.collapse(l)})}(window.$jqTheme||window.jQuery),+function(i){function h(){i(m).remove(),i(l).each(function(a){var c=n(i(this));c.hasClass("open")&&(c.trigger(a=i.Event("hide.bs.dropdown")),a.isDefaultPrevented()||c.removeClass("open").trigger("hidden.bs.dropdown"))})}function n(a){var f=a.attr("data-target");f||(f=a.attr("href"),f=f&&/#/.test(f)&&f.replace(/.*(?=#[^\s]*$)/,""));var e=f&&i(f);return e&&e.length?e:a.parent()}var m=".dropdown-backdrop",l="[data-toggle=dropdown]",k=function(a){i(a).on("click.bs.dropdown",this.toggle)};k.prototype.toggle=function(o){var c=i(this);if(!c.is(".disabled, :disabled")){var b=n(c),a=b.hasClass("open");if(h(),!a){if("ontouchstart" in document.documentElement&&!b.closest(".navbar-nav").length&&i('<div class="dropdown-backdrop"/>').insertAfter(i(this)).on("click",h),b.trigger(o=i.Event("show.bs.dropdown")),o.isDefaultPrevented()){return}b.toggleClass("open").trigger("shown.bs.dropdown"),c.focus()}return !1}},k.prototype.keydown=function(a){if(/(38|40|27)/.test(a.keyCode)){var q=i(this);if(a.preventDefault(),a.stopPropagation(),!q.is(".disabled, :disabled")){var p=n(q),o=p.hasClass("open");if(!o||o&&27==a.keyCode){return 27==a.which&&p.find(l).focus(),q.click()}var e=i("[role=menu] li:not(.divider):visible a",p);if(e.length){var c=e.index(e.filter(":focus"));38==a.keyCode&&c>0&&c--,40==a.keyCode&&c<e.length-1&&c++,~c||(c=0),e.eq(c).focus()}}}};var j=i.fn.dropdown;i.fn.dropdown=function(a){return this.each(function(){var e=i(this),b=e.data("dropdown");b||e.data("dropdown",b=new k(this)),"string"==typeof a&&b[a].call(e)})},i.fn.dropdown.Constructor=k,i.fn.dropdown.noConflict=function(){return i.fn.dropdown=j,this},i(document).on("click.bs.dropdown.data-api",h).on("click.bs.dropdown.data-api",".dropdown form",function(b){b.stopPropagation()}).on("click.bs.dropdown.data-api",l,k.prototype.toggle).on("keydown.bs.dropdown.data-api",l+", [role=menu]",k.prototype.keydown)}(window.$jqTheme||window.jQuery),+function(e){var d=function(a,g){this.options=g,this.$element=e(a),this.$backdrop=this.isShown=null,this.options.remote&&this.$element.load(this.options.remote)};d.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},d.prototype.toggle=function(b){return this[this.isShown?"hide":"show"](b)},d.prototype.show=function(a){var h=this,g=e.Event("show.bs.modal",{relatedTarget:a});this.$element.trigger(g),this.isShown||g.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.$element.on("click.dismiss.modal",'[data-dismiss="modal"]',e.proxy(this.hide,this)),this.backdrop(function(){var c=e.support.transition&&h.$element.hasClass("fade");h.$element.parent().length||h.$element.appendTo(document.body),h.$element.show(),c&&h.$element[0].offsetWidth,h.$element.addClass("in").attr("aria-hidden",!1),h.enforceFocus();var b=e.Event("shown.bs.modal",{relatedTarget:a});c?h.$element.find(".modal-dialog").one(e.support.transition.end,function(){h.$element.focus().trigger(b)}).emulateTransitionEnd(300):h.$element.focus().trigger(b)}))},d.prototype.hide=function(a){a&&a.preventDefault(),a=e.Event("hide.bs.modal"),this.$element.trigger(a),this.isShown&&!a.isDefaultPrevented()&&(this.isShown=!1,this.escape(),e(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.modal"),e.support.transition&&this.$element.hasClass("fade")?this.$element.one(e.support.transition.end,e.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal())},d.prototype.enforceFocus=function(){e(document).off("focusin.bs.modal").on("focusin.bs.modal",e.proxy(function(b){this.$element[0]===b.target||this.$element.has(b.target).length||this.$element.focus()},this))},d.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",e.proxy(function(b){27==b.which&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},d.prototype.hideModal=function(){var b=this;this.$element.hide(),this.backdrop(function(){b.removeBackdrop(),b.$element.trigger("hidden.bs.modal")})},d.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},d.prototype.backdrop=function(a){var h=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var g=e.support.transition&&h;if(this.$backdrop=e('<div class="modal-backdrop '+h+'" />').appendTo(document.body),this.$element.on("click.dismiss.modal",e.proxy(function(b){b.target===b.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),g&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!a){return}g?this.$backdrop.one(e.support.transition.end,a).emulateTransitionEnd(150):a()}else{!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,a).emulateTransitionEnd(150):a()):a&&a()}};var f=e.fn.modal;e.fn.modal=function(b,a){return this.each(function(){var i=e(this),h=i.data("bs.modal"),c=e.extend({},d.DEFAULTS,i.data(),"object"==typeof b&&b);h||i.data("bs.modal",h=new d(this,c)),"string"==typeof b?h[b](a):c.show&&h.show(a)})},e.fn.modal.Constructor=d,e.fn.modal.noConflict=function(){return e.fn.modal=f,this},e(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(a){var j=e(this),i=j.attr("href"),h=e(j.attr("data-target")||i&&i.replace(/.*(?=#[^\s]+$)/,"")),g=h.data("modal")?"toggle":e.extend({remote:!/#/.test(i)&&i},h.data(),j.data());a.preventDefault(),h.modal(g,this).one("hide",function(){j.is(":visible")&&j.focus()})}),e(document).on("show.bs.modal",".modal",function(){e(document.body).addClass("modal-open")}).on("hidden.bs.modal",".modal",function(){e(document.body).removeClass("modal-open")})}(window.$jqTheme||window.jQuery),+function(e){var d=function(g,c){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",g,c)};d.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},d.prototype.init=function(a,p,o){this.enabled=!0,this.type=a,this.$element=e(p),this.options=this.getOptions(o);for(var n=this.options.trigger.split(" "),m=n.length;m--;){var l=n[m];if("click"==l){this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this))}else{if("manual"!=l){var k="hover"==l?"mouseenter":"focus",j="hover"==l?"mouseleave":"blur";this.$element.on(k+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(j+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},d.prototype.getDefaults=function(){return d.DEFAULTS},d.prototype.getOptions=function(a){return a=e.extend({},this.getDefaults(),this.$element.data(),a),a.delay&&"number"==typeof a.delay&&(a.delay={show:a.delay,hide:a.delay}),a},d.prototype.getDelegateOptions=function(){var a={},g=this.getDefaults();return this._options&&e.each(this._options,function(b,c){g[b]!=c&&(a[b]=c)}),a},d.prototype.enter=function(a){var g=a instanceof this.constructor?a:e(a.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(g.timeout),g.hoverState="in",g.options.delay&&g.options.delay.show?(g.timeout=setTimeout(function(){"in"==g.hoverState&&g.show()},g.options.delay.show),void 0):g.show()},d.prototype.leave=function(a){var g=a instanceof this.constructor?a:e(a.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(g.timeout),g.hoverState="out",g.options.delay&&g.options.delay.hide?(g.timeout=setTimeout(function(){"out"==g.hoverState&&g.hide()},g.options.delay.hide),void 0):g.hide()},d.prototype.show=function(){var D=e.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){if(this.$element.trigger(D),D.isDefaultPrevented()){return}var C=this.tip();this.setContent(),this.options.animation&&C.addClass("fade");var B="function"==typeof this.options.placement?this.options.placement.call(this,C[0],this.$element[0]):this.options.placement,A=/\s?auto?\s?/i,z=A.test(B);z&&(B=B.replace(A,"")||"top"),C.detach().css({top:0,left:0,display:"block"}).addClass(B),this.options.container?C.appendTo(this.options.container):C.insertAfter(this.$element);var y=this.getPosition(),x=C[0].offsetWidth,w=C[0].offsetHeight;if(z){var v=this.$element.parent(),u=B,t=document.documentElement.scrollTop||document.body.scrollTop,s="body"==this.options.container?window.innerWidth:v.outerWidth(),r="body"==this.options.container?window.innerHeight:v.outerHeight(),q="body"==this.options.container?0:v.offset().left;B="bottom"==B&&y.top+y.height+w-t>r?"top":"top"==B&&y.top-t-w<0?"bottom":"right"==B&&y.right+x>s?"left":"left"==B&&y.left-x<q?"right":B,C.removeClass(u).addClass(B)}var a=this.getCalculatedOffset(B,y,x,w);this.applyPlacement(a,B),this.$element.trigger("shown.bs."+this.type)}},d.prototype.applyPlacement=function(v,u){var t,s=this.tip(),r=s[0].offsetWidth,q=s[0].offsetHeight,p=parseInt(s.css("margin-top"),10),o=parseInt(s.css("margin-left"),10);isNaN(p)&&(p=0),isNaN(o)&&(o=0),v.top=v.top+p,v.left=v.left+o,s.offset(v).addClass("in");var n=s[0].offsetWidth,m=s[0].offsetHeight;if("top"==u&&m!=q&&(t=!0,v.top=v.top+q-m),/bottom|top/.test(u)){var l=0;v.left<0&&(l=-2*v.left,v.left=0,s.offset(v),n=s[0].offsetWidth,m=s[0].offsetHeight),this.replaceArrow(l-r+n,n,"left")}else{this.replaceArrow(m-q,m,"top")}t&&s.offset(v)},d.prototype.replaceArrow=function(h,g,i){this.arrow().css(i,h?50*(1-h/g)+"%":"")},d.prototype.setContent=function(){var g=this.tip(),c=this.getTitle();g.find(".tooltip-inner")[this.options.html?"html":"text"](c),g.removeClass("fade in top bottom left right")},d.prototype.hide=function(){function a(){"in"!=i.hoverState&&h.detach()}var i=this,h=this.tip(),g=e.Event("hide.bs."+this.type);return this.$element.trigger(g),g.isDefaultPrevented()?void 0:(h.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?h.one(e.support.transition.end,a).emulateTransitionEnd(150):a(),this.$element.trigger("hidden.bs."+this.type),this)},d.prototype.fixTitle=function(){var b=this.$element;(b.attr("title")||"string"!=typeof b.attr("data-original-title"))&&b.attr("data-original-title",b.attr("title")||"").attr("title","")},d.prototype.hasContent=function(){return this.getTitle()},d.prototype.getPosition=function(){var a=this.$element[0];return e.extend({},"function"==typeof a.getBoundingClientRect?a.getBoundingClientRect():{width:a.offsetWidth,height:a.offsetHeight},this.$element.offset())},d.prototype.getCalculatedOffset=function(h,g,j,i){return"bottom"==h?{top:g.top+g.height,left:g.left+g.width/2-j/2}:"top"==h?{top:g.top-i,left:g.left+g.width/2-j/2}:"left"==h?{top:g.top+g.height/2-i/2,left:g.left-j}:{top:g.top+g.height/2-i/2,left:g.left+g.width}},d.prototype.getTitle=function(){var h,g=this.$element,i=this.options;return h=g.attr("data-original-title")||("function"==typeof i.title?i.title.call(g[0]):i.title)},d.prototype.tip=function(){return this.$tip=this.$tip||e(this.options.template)},d.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},d.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},d.prototype.enable=function(){this.enabled=!0},d.prototype.disable=function(){this.enabled=!1},d.prototype.toggleEnabled=function(){this.enabled=!this.enabled},d.prototype.toggle=function(a){var g=a?e(a.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type):this;g.tip().hasClass("in")?g.leave(g):g.enter(g)},d.prototype.destroy=function(){this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var f=e.fn.tooltip;e.fn.tooltip=function(a){return this.each(function(){var g=e(this),c=g.data("bs.tooltip"),b="object"==typeof a&&a;c||g.data("bs.tooltip",c=new d(this,b)),"string"==typeof a&&c[a]()})},e.fn.tooltip.Constructor=d,e.fn.tooltip.noConflict=function(){return e.fn.tooltip=f,this}}(window.$jqTheme||window.jQuery),+function(e){var d=function(g,c){this.init("popover",g,c)};if(!e.fn.tooltip){throw new Error("Popover requires tooltip.js")}d.DEFAULTS=e.extend({},e.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),d.prototype=e.extend({},e.fn.tooltip.Constructor.prototype),d.prototype.constructor=d,d.prototype.getDefaults=function(){return d.DEFAULTS},d.prototype.setContent=function(){var h=this.tip(),g=this.getTitle(),i=this.getContent();h.find(".popover-title")[this.options.html?"html":"text"](g),h.find(".popover-content")[this.options.html?"html":"text"](i),h.removeClass("fade top bottom left right in"),h.find(".popover-title").html()||h.find(".popover-title").hide()},d.prototype.hasContent=function(){return this.getTitle()||this.getContent()},d.prototype.getContent=function(){var g=this.$element,c=this.options;return g.attr("data-content")||("function"==typeof c.content?c.content.call(g[0]):c.content)},d.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},d.prototype.tip=function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip};var f=e.fn.popover;e.fn.popover=function(a){return this.each(function(){var g=e(this),c=g.data("bs.popover"),b="object"==typeof a&&a;c||g.data("bs.popover",c=new d(this,b)),"string"==typeof a&&c[a]()})},e.fn.popover.Constructor=d,e.fn.popover.noConflict=function(){return e.fn.popover=f,this}}(window.$jqTheme||window.jQuery),+function(e){function d(h,g){var b,a=e.proxy(this.process,this);this.$element=e(h).is("body")?e(window):e(h),this.$body=e("body"),this.$scrollElement=this.$element.on("scroll.bs.scroll-spy.data-api",a),this.options=e.extend({},d.DEFAULTS,g),this.selector=(this.options.target||(b=e(h).attr("href"))&&b.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.offsets=e([]),this.targets=e([]),this.activeTarget=null,this.refresh(),this.process()}d.DEFAULTS={offset:10},d.prototype.refresh=function(){var a=this.$element[0]==window?"offset":"position";this.offsets=e([]),this.targets=e([]);var g=this;this.$body.find(this.selector).map(function(){var h=e(this),c=h.data("target")||h.attr("href"),b=/^#\w/.test(c)&&e(c);return b&&b.length&&[[b[a]().top+(!e.isWindow(g.$scrollElement.get(0))&&g.$scrollElement.scrollTop()),c]]||null}).sort(function(h,c){return h[0]-c[0]}).each(function(){g.offsets.push(this[0]),g.targets.push(this[1])})},d.prototype.process=function(){var i,h=this.$scrollElement.scrollTop()+this.options.offset,n=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,m=n-this.$scrollElement.height(),l=this.offsets,k=this.targets,j=this.activeTarget;if(h>=m){return j!=(i=k.last()[0])&&this.activate(i)}for(i=l.length;i--;){j!=k[i]&&h>=l[i]&&(!l[i+1]||h<=l[i+1])&&this.activate(k[i])}},d.prototype.activate=function(a){this.activeTarget=a,e(this.selector).parents(".active").removeClass("active");var h=this.selector+'[data-target="'+a+'"],'+this.selector+'[href="'+a+'"]',g=e(h).parents("li").addClass("active");g.parent(".dropdown-menu").length&&(g=g.closest("li.dropdown").addClass("active")),g.trigger("activate")};var f=e.fn.scrollspy;e.fn.scrollspy=function(a){return this.each(function(){var g=e(this),c=g.data("bs.scrollspy"),b="object"==typeof a&&a;c||g.data("bs.scrollspy",c=new d(this,b)),"string"==typeof a&&c[a]()})},e.fn.scrollspy.Constructor=d,e.fn.scrollspy.noConflict=function(){return e.fn.scrollspy=f,this},e(window).on("load",function(){e('[data-spy="scroll"]').each(function(){var a=e(this);a.scrollspy(a.data())})})}(window.$jqTheme||window.jQuery),+function(e){var d=function(a){this.element=e(a)};d.prototype.show=function(){var a=this.element,l=a.closest("ul:not(.dropdown-menu)"),k=a.attr("data-target");if(k||(k=a.attr("href"),k=k&&k.replace(/.*(?=#[^\s]*$)/,"")),!a.parent("li").hasClass("active")){var j=l.find(".active:last a")[0],i=e.Event("show.bs.tab",{relatedTarget:j});if(a.trigger(i),!i.isDefaultPrevented()){var h=e(k);this.activate(a.parent("li"),l),this.activate(h,h.parent(),function(){a.trigger({type:"shown.bs.tab",relatedTarget:j})})}}},d.prototype.activate=function(a,l,k){function j(){i.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),a.addClass("active"),h?(a[0].offsetWidth,a.addClass("in")):a.removeClass("fade"),a.parent(".dropdown-menu")&&a.closest("li.dropdown").addClass("active"),k&&k()}var i=l.find("> .active"),h=k&&e.support.transition&&i.hasClass("fade");h?i.one(e.support.transition.end,j).emulateTransitionEnd(150):j(),i.removeClass("in")};var f=e.fn.tab;e.fn.tab=function(a){return this.each(function(){var c=e(this),b=c.data("bs.tab");b||c.data("bs.tab",b=new d(this)),"string"==typeof a&&b[a]()})},e.fn.tab.Constructor=d,e.fn.tab.noConflict=function(){return e.fn.tab=f,this},e(document).on("click.bs.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(a){a.preventDefault(),e(this).tab("show")})}(window.$jqTheme||window.jQuery),+function(e){var d=function(b,a){this.options=e.extend({},d.DEFAULTS,a),this.$window=e(window).on("scroll.bs.affix.data-api",e.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",e.proxy(this.checkPositionWithEventLoop,this)),this.$element=e(b),this.affixed=this.unpin=null,this.checkPosition()};d.RESET="affix affix-top affix-bottom",d.DEFAULTS={offset:0},d.prototype.checkPositionWithEventLoop=function(){setTimeout(e.proxy(this.checkPosition,this),1)},d.prototype.checkPosition=function(){if(this.$element.is(":visible")){var n=e(document).height(),m=this.$window.scrollTop(),l=this.$element.offset(),k=this.options.offset,j=k.top,b=k.bottom;"object"!=typeof k&&(b=j=k),"function"==typeof j&&(j=k.top()),"function"==typeof b&&(b=k.bottom());var a=null!=this.unpin&&m+this.unpin<=l.top?!1:null!=b&&l.top+this.$element.height()>=n-b?"bottom":null!=j&&j>=m?"top":!1;this.affixed!==a&&(this.unpin&&this.$element.css("top",""),this.affixed=a,this.unpin="bottom"==a?l.top-m:null,this.$element.removeClass(d.RESET).addClass("affix"+(a?"-"+a:"")),"bottom"==a&&this.$element.offset({top:document.body.offsetHeight-b-this.$element.height()}))}};var f=e.fn.affix;e.fn.affix=function(a){return this.each(function(){var g=e(this),c=g.data("bs.affix"),b="object"==typeof a&&a;c||g.data("bs.affix",c=new d(this,b)),"string"==typeof a&&c[a]()})},e.fn.affix.Constructor=d,e.fn.affix.noConflict=function(){return e.fn.affix=f,this},e(window).on("load",function(){e('[data-spy="affix"]').each(function(){var a=e(this),g=a.data();g.offset=g.offset||{},g.offsetBottom&&(g.offset.bottom=g.offsetBottom),g.offsetTop&&(g.offset.top=g.offsetTop),a.affix(g)})})}(window.$jqTheme||window.jQuery);(function(a){var b=function(e,g){var d,f,c;d=function(h,j){j=j||0;var i=h.find("> li > a.internal, > ul, > li > ul");i.each(function(m,n){var l=a(n),k=n.tagName.toLowerCase(),p=l.children("li"),o=a(l.parent("li"),l.parent().parent("li"));if(k==="ul"&&j>=g&&p.length>0){o.addClass("dropdown-submenu").children("a").first().attr("tabindex",-1);l.addClass("dropdown-menu")}d(l,j+1)})};d(e)};patchTables=function(){a("table.docutils").removeClass("docutils").addClass("table").attr("border",0)};a(window).load(function(){if(a("#navbar.navbar-fixed-top").length>0){var d=a("#navbar").height(),c=function(){scrollBy(0,-d-10)};if(location.hash){setTimeout(c,1)}window.addEventListener("hashchange",c)}});a(document).ready(function(){a(".dropdown-menu").each(function(){a(this).find("ul").each(function(e,f){var d=a(f);d.addClass("unstyled")})});if(a("ul.globaltoc li").length){b(a("ul.globaltoc"),1)}else{a(".globaltoc-container").remove()}a(".bs-sidenav ul").addClass("nav nav-list");a(".bs-sidenav ul.pager").removeClass("nav nav-list");a(".bs-sidenav > ul > li > a").addClass("nav-header");b(a("ul.localtoc"),2);a(".dropdown-menu ul").not(".dropdown-menu").each(function(){var e=a(this),f=e.parent(),d=f[0].tagName.toLowerCase(),g=e.children().detach();if(d==="ul"){e.replaceWith(g)}else{if(d==="li"){f.after(g);e.remove()}}});$localLi=a("ul.localtoc li");if($localLi.length>2){$localLi.first().after('<li class="divider"></li>')}a(".dropdown-toggle").dropdown();patchTables();a("div.note").addClass("alert alert-info");a("div.warning").addClass("alert alert-danger alert-error");a("tt.docutils.literal").not(".xref").each(function(d,f){if(!a(f).parent().hasClass("reference")){a(f).replaceWith(function(){return a("<code />").html(a(this).html())})}});var c=a(".nav #sourcelink");c.parent().html(c.html())})}($jqTheme||window.jQuery));var Stemmer=function(){var h={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"};var e={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""};var i="[^aeiou]";var k="[aeiouy]";var a=i+"[^aeiouy]*";var g=k+"[aeiou]*";var f="^("+a+")?"+g+a;var b="^("+a+")?"+g+a+"("+g+")?$";var d="^("+a+")?"+g+a+g+a;var j="^("+a+")?"+k;this.stemWord=function(q){var l;var s;var r;var c=q;if(q.length<3){return q}var t;var o;var n;var m;r=q.substr(0,1);if(r=="y"){q=r.toUpperCase()+q.substr(1)}t=/^(.+?)(ss|i)es$/;o=/^(.+?)([^s])s$/;if(t.test(q)){q=q.replace(t,"$1$2")}else{if(o.test(q)){q=q.replace(o,"$1$2")}}t=/^(.+?)eed$/;o=/^(.+?)(ed|ing)$/;if(t.test(q)){var p=t.exec(q);t=new RegExp(f);if(t.test(p[1])){t=/.$/;q=q.replace(t,"")}}else{if(o.test(q)){var p=o.exec(q);l=p[1];o=new RegExp(j);if(o.test(l)){q=l;o=/(at|bl|iz)$/;n=new RegExp("([^aeiouylsz])\\1$");m=new RegExp("^"+a+k+"[^aeiouwxy]$");if(o.test(q)){q=q+"e"}else{if(n.test(q)){t=/.$/;q=q.replace(t,"")}else{if(m.test(q)){q=q+"e"}}}}}}t=/^(.+?)y$/;if(t.test(q)){var p=t.exec(q);l=p[1];t=new RegExp(j);if(t.test(l)){q=l+"i"}}t=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/;if(t.test(q)){var p=t.exec(q);l=p[1];s=p[2];t=new RegExp(f);if(t.test(l)){q=l+h[s]}}t=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/;if(t.test(q)){var p=t.exec(q);l=p[1];s=p[2];t=new RegExp(f);if(t.test(l)){q=l+e[s]}}t=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/;o=/^(.+?)(s|t)(ion)$/;if(t.test(q)){var p=t.exec(q);l=p[1];t=new RegExp(d);if(t.test(l)){q=l}}else{if(o.test(q)){var p=o.exec(q);l=p[1]+p[2];o=new RegExp(d);if(o.test(l)){q=l}}}t=/^(.+?)e$/;if(t.test(q)){var p=t.exec(q);l=p[1];t=new RegExp(d);o=new RegExp(b);n=new RegExp("^"+a+k+"[^aeiouwxy]$");if(t.test(l)||(o.test(l)&&!(n.test(l)))){q=l}}t=/ll$/;o=new RegExp(d);if(t.test(q)&&o.test(q)){t=/.$/;q=q.replace(t,"")}if(r=="y"){q=r.toLowerCase()+q.substr(1)}return q}};var Scorer={objNameMatch:11,objPartialMatch:6,objPrio:{0:15,1:5,2:-5},objPrioDefault:0,title:15,term:5};var Search={_index:null,_queued_query:null,_pulse_status:-1,init:function(){var b=$.getQueryParameters();if(b.q){var a=b.q[0];$('input[name="q"]')[0].value=a;this.performSearch(a)}},loadIndex:function(a){$.ajax({type:"GET",url:a,data:null,dataType:"script",cache:true,complete:function(c,b){if(b!="success"){document.getElementById("searchindexloader").src=a}}})},setIndex:function(a){var b;this._index=a;if((b=this._queued_query)!==null){this._queued_query=null;Search.query(b)}},hasIndex:function(){return this._index!==null},deferQuery:function(a){this._queued_query=a},stopPulse:function(){this._pulse_status=0},startPulse:function(){if(this._pulse_status>=0){return}function a(){var c;Search._pulse_status=(Search._pulse_status+1)%4;var b="";for(c=0;c<Search._pulse_status;c++){b+="."}Search.dots.text(b);if(Search._pulse_status>-1){window.setTimeout(a,500)}}a()},performSearch:function(a){this.out=$("#search-results");this.title=$("<h2>"+_("Searching")+"</h2>").appendTo(this.out);this.dots=$("<span></span>").appendTo(this.title);this.status=$('<p style="display: none"></p>').appendTo(this.out);this.output=$('<ul class="search"/>').appendTo(this.out);$("#search-progress").text(_("Preparing search..."));this.startPulse();if(this.hasIndex()){this.query(a)}else{this.deferQuery(a)}},query:function(d){var o;var h=["a","and","are","as","at","be","but","by","for","if","in","into","is","it","near","no","not","of","on","or","such","that","the","their","then","there","these","they","this","to","was","will","with"];var k=new Stemmer();var j=[];var g=[];var f=[];var q=d.split(/\s+/);var s=[];for(o=0;o<q.length;o++){if(q[o]!==""){s.push(q[o].toLowerCase())}if($u.indexOf(h,q[o].toLowerCase())!=-1||q[o].match(/^\d+$/)||q[o]===""){continue}var p=k.stemWord(q[o].toLowerCase());var a;if(p[0]=="-"){a=g;p=p.substr(1)}else{a=j;f.push(q[o].toLowerCase())}if(!$u.contains(a,p)){a.push(p)}}var l="?highlight="+$.urlencode(f.join(" "));var e=this._index.terms;var b=this._index.titleterms;var m=[];$("#search-progress").empty();for(o=0;o<s.length;o++){var r=[].concat(s.slice(0,o),s.slice(o+1,s.length));m=m.concat(this.performObjectSearch(s[o],r))}m=m.concat(this.performTermsSearch(j,g,e,Scorer.term)).concat(this.performTermsSearch(j,g,b,Scorer.title));if(Scorer.score){for(o=0;o<m.length;o++){m[o][4]=Scorer.score(m[o])}}m.sort(function(t,i){var v=t[4];var u=i[4];if(v>u){return 1}else{if(v<u){return -1}else{v=t[1].toLowerCase();u=i[1].toLowerCase();return(v>u)?-1:((v<u)?1:0)}}});var n=m.length;function c(){if(m.length){var t=m.pop();var i=$('<li style="display:none"></li>');if(DOCUMENTATION_OPTIONS.FILE_SUFFIX===""){var u=t[0]+"/";if(u.match(/\/index\/$/)){u=u.substring(0,u.length-6)}else{if(u=="index/"){u=""}}i.append($("<a/>").attr("href",DOCUMENTATION_OPTIONS.URL_ROOT+u+l+t[2]).html(t[1]))}else{i.append($("<a/>").attr("href",t[0]+DOCUMENTATION_OPTIONS.FILE_SUFFIX+l+t[2]).html(t[1]))}if(t[3]){i.append($("<span> ("+t[3].replace(/Python/,"Unreal")+")</span>"));Search.output.append(i);i.slideDown(5,function(){c()})}else{if(DOCUMENTATION_OPTIONS.HAS_SOURCE){$.ajax({url:DOCUMENTATION_OPTIONS.URL_ROOT+"_sources/"+t[0]+".txt",dataType:"text",complete:function(x,v){var w=x.responseText;if(w!==""){i.append(Search.makeSearchSummary(w,j,f))}Search.output.append(i);i.slideDown(5,function(){c()})}})}else{Search.output.append(i);i.slideDown(5,function(){c()})}}}else{Search.stopPulse();Search.title.text(_("Search Results"));if(!n){Search.status.text(_("Your search did not match any documents. Please make sure that all words are spelled correctly and that you've selected enough categories."))}else{Search.status.text(_("Search finished, found %s page(s) matching the search query.").replace("%s",n))}Search.status.fadeIn(500)}}c()},performObjectSearch:function(q,r){var p=this._index.filenames;var a=this._index.objects;var g=this._index.objnames;var t=this._index.titles;var n;var j=[];for(var l in a){for(var u in a[l]){var m=(l?l+".":"")+u;if(m.toLowerCase().indexOf(q)>-1){var o=0;var k=m.split(".");if(m==q||k[k.length-1]==q){o+=Scorer.objNameMatch}else{if(k[k.length-1].indexOf(q)>-1){o+=Scorer.objPartialMatch}}var f=a[l][u];var b=g[f[1]][2];var s=t[f[0]];if(r.length>0){var e=(l+" "+u+" "+b+" "+s).toLowerCase();var c=true;for(n=0;n<r.length;n++){if(e.indexOf(r[n])==-1){c=false;break}}if(!c){continue}}var h=b+_(", in ")+s;var d=f[3];if(d===""){d=m}else{if(d=="-"){d=g[f[1]][1]+"-"+m}}if(Scorer.objPrio.hasOwnProperty(f[2])){o+=Scorer.objPrio[f[2]]}else{o+=Scorer.objPrioDefault}j.push([p[f[0]],m,"#"+d,h,o])}}}return j},performTermsSearch:function(o,n,h,e){var m=this._index.filenames;var l=this._index.titles;var k,f,d,c;var p={};var g=[];for(k=0;k<o.length;k++){var b=o[k];if((c=h[b])===undefined){break}if(c.length===undefined){c=[c]}for(f=0;f<c.length;f++){d=c[f];if(d in p){p[d].push(b)}else{p[d]=[b]}}}for(d in p){var a=true;if(p[d].length!=o.length){continue}for(k=0;k<n.length;k++){if(h[n[k]]==d||$u.contains(h[n[k]]||[],d)){a=false;break}}if(a){g.push([m[d],l[d],"",null,e])}}return g},makeSearchSummary:function(d,b,g){var c=d.toLowerCase();var f=0;$.each(b,function(){var h=c.indexOf(this.toLowerCase());if(h>-1){f=h}});f=Math.max(f-120,0);var a=((f>0)?"...":"")+$.trim(d.substr(f,240))+((f+240-d.length)?"...":"");var e=$('<div class="context"></div>').text(a);$.each(g,function(){e=e.highlightText(this,"highlighted")});return e}};$(document).ready(function(){Search.init()});/*!                                                              
 * LeapJS v0.6.2                                                  
 * http://github.com/leapmotion/leapjs/                                        
 *                                                                             
 * Copyright 2013 LeapMotion, Inc. and other contributors                      
 * Released under the Apache-2.0 license                                     
 * http://github.com/leapmotion/leapjs/blob/master/LICENSE.txt                 
 */
!function(h,g,l){function k(e,d){if(!g[e]){if(!h[e]){var b="function"==typeof require&&require;if(!d&&b){return b(e,!0)}if(j){return j(e,!0)}throw new Error("Cannot find module '"+e+"'")}var a=g[e]={exports:{}};h[e][0].call(a.exports,function(c){var f=h[e][1][c];return k(f?f:c)},a,a.exports)}return g[e].exports}for(var j="function"==typeof require&&require,i=0;i<l.length;i++){k(l[i])}return k}({1:[function(i,h){var n=(i("./pointable"),i("gl-matrix")),m=n.vec3,l=n.mat3,k=n.mat4,j=(i("underscore"),h.exports=function(e,d){this.finger=e,this._center=null,this._matrix=null,this.type=d.type,this.prevJoint=d.prevJoint,this.nextJoint=d.nextJoint,this.width=d.width;var f=new Array(3);m.sub(f,d.nextJoint,d.prevJoint),this.length=m.length(f),this.basis=d.basis});j.prototype.left=function(){return this._left?this._left:(this._left=l.determinant(this.basis[0].concat(this.basis[1]).concat(this.basis[2]))<0,this._left)},j.prototype.matrix=function(){if(this._matrix){return this._matrix}var d=this.basis,c=this._matrix=k.create();return c[0]=d[0][0],c[1]=d[0][1],c[2]=d[0][2],c[4]=d[1][0],c[5]=d[1][1],c[6]=d[1][2],c[8]=d[2][0],c[9]=d[2][1],c[10]=d[2][2],c[3]=this.center()[0],c[7]=this.center()[1],c[11]=this.center()[2],this.left()&&(c[0]*=-1,c[1]*=-1,c[2]*=-1),this._matrix},j.prototype.lerp=function(d,c){m.lerp(d,this.prevJoint,this.nextJoint,c)},j.prototype.center=function(){if(this._center){return this._center}var b=m.create();return this.lerp(b,0.5),this._center=b,b},j.prototype.direction=function(){return[-1*this.basis[2][0],-1*this.basis[2][1],-1*this.basis[2][2]]}},{"./pointable":14,"gl-matrix":23,underscore:24}],2:[function(e,d){var f=d.exports=function(b){this.pos=0,this._buf=[],this.size=b};f.prototype.get=function(b){return void 0==b&&(b=0),b>=this.size?void 0:b>=this._buf.length?void 0:this._buf[(this.pos-b-1)%this.size]},f.prototype.push=function(b){return this._buf[this.pos%this.size]=b,this.pos++}},{}],3:[function(h,g){var l=h("../protocol").chooseProtocol,k=h("events").EventEmitter,j=h("underscore"),i=g.exports=function(b){this.opts=j.defaults(b||{},{host:"127.0.0.1",enableGestures:!1,scheme:this.getScheme(),port:this.getPort(),background:!1,optimizeHMD:!1,requestProtocolVersion:i.defaultProtocolVersion}),this.host=this.opts.host,this.port=this.opts.port,this.scheme=this.opts.scheme,this.protocolVersionVerified=!1,this.background=null,this.optimizeHMD=null,this.on("ready",function(){this.enableGestures(this.opts.enableGestures),this.setBackground(this.opts.background),this.setOptimizeHMD(this.opts.optimizeHMD)})};i.defaultProtocolVersion=6,i.prototype.getUrl=function(){return this.scheme+"//"+this.host+":"+this.port+"/v"+this.opts.requestProtocolVersion+".json"},i.prototype.getScheme=function(){return"ws:"},i.prototype.getPort=function(){return 6437},i.prototype.setBackground=function(b){this.opts.background=b,this.protocol&&this.protocol.sendBackground&&this.background!==this.opts.background&&(this.background=this.opts.background,this.protocol.sendBackground(this,this.opts.background))},i.prototype.setOptimizeHMD=function(b){this.opts.optimizeHMD=b,this.protocol&&this.protocol.sendOptimizeHMD&&this.optimizeHMD!==this.opts.optimizeHMD&&(this.optimizeHMD=this.opts.optimizeHMD,this.protocol.sendOptimizeHMD(this,this.opts.optimizeHMD))},i.prototype.handleOpen=function(){this.connected||(this.connected=!0,this.emit("connect"))},i.prototype.enableGestures=function(b){this.gesturesEnabled=b?!0:!1,this.send(this.protocol.encode({enableGestures:this.gesturesEnabled}))},i.prototype.handleClose=function(b){this.connected&&(this.disconnect(),1001===b&&this.opts.requestProtocolVersion>1&&(this.protocolVersionVerified?this.protocolVersionVerified=!1:this.opts.requestProtocolVersion--),this.startReconnection())},i.prototype.startReconnection=function(){var b=this;this.reconnectionTimer||(this.reconnectionTimer=setInterval(function(){b.reconnect()},500))},i.prototype.stopReconnection=function(){this.reconnectionTimer=clearInterval(this.reconnectionTimer)},i.prototype.disconnect=function(b){return b||this.stopReconnection(),this.socket?(this.socket.close(),delete this.socket,delete this.protocol,delete this.background,delete this.optimizeHMD,delete this.focusedState,this.connected&&(this.connected=!1,this.emit("disconnect")),!0):void 0},i.prototype.reconnect=function(){this.connected?this.stopReconnection():(this.disconnect(!0),this.connect())},i.prototype.handleData=function(e){var c,f=JSON.parse(e);void 0===this.protocol?(c=this.protocol=l(f),this.protocolVersionVerified=!0,this.emit("ready")):c=this.protocol(f),this.emit(c.type,c)},i.prototype.connect=function(){return this.socket?void 0:(this.socket=this.setupSocket(),!0)},i.prototype.send=function(b){this.socket.send(b)},i.prototype.reportFocus=function(b){this.connected&&this.focusedState!==b&&(this.focusedState=b,this.emit(this.focusedState?"focus":"blur"),this.protocol&&this.protocol.sendFocused&&this.protocol.sendFocused(this,this.focusedState))},j.extend(i.prototype,k.prototype)},{"../protocol":15,events:21,underscore:24}],4:[function(g,f){var j=f.exports=g("./base"),i=g("underscore"),h=f.exports=function(d){j.call(this,d);var c=this;this.on("ready",function(){c.startFocusLoop()}),this.on("disconnect",function(){c.stopFocusLoop()})};i.extend(h.prototype,j.prototype),h.__proto__=j,h.prototype.useSecure=function(){return"https:"===location.protocol},h.prototype.getScheme=function(){return this.useSecure()?"wss:":"ws:"},h.prototype.getPort=function(){return this.useSecure()?6436:6437},h.prototype.setupSocket=function(){var d=this,c=new WebSocket(this.getUrl());return c.onopen=function(){d.handleOpen()},c.onclose=function(a){d.handleClose(a.code,a.reason)},c.onmessage=function(a){d.handleData(a.data)},c.onerror=function(){d.useSecure()&&"wss:"===d.scheme&&(d.scheme="ws:",d.port=6437,d.disconnect(),d.connect())},c},h.prototype.startFocusLoop=function(){if(!this.focusDetectorTimer){var l=this,k=null;k="undefined"!=typeof document.hidden?"hidden":"undefined"!=typeof document.mozHidden?"mozHidden":"undefined"!=typeof document.msHidden?"msHidden":"undefined"!=typeof document.webkitHidden?"webkitHidden":void 0,void 0===l.windowVisible&&(l.windowVisible=void 0===k?!0:document[k]===!1);var o=window.addEventListener("focus",function(){l.windowVisible=!0,m()}),n=window.addEventListener("blur",function(){l.windowVisible=!1,m()});this.on("disconnect",function(){window.removeEventListener("focus",o),window.removeEventListener("blur",n)});var m=function(){var a=void 0===k?!0:document[k]===!1;l.reportFocus(a&&l.windowVisible)};m(),this.focusDetectorTimer=setInterval(m,100)}},h.prototype.stopFocusLoop=function(){this.focusDetectorTimer&&(clearTimeout(this.focusDetectorTimer),delete this.focusDetectorTimer)}},{"./base":3,underscore:24}],5:[function(F,E){var D=F("__browserify_process"),C=F("./frame"),B=F("./hand"),A=F("./pointable"),z=F("./finger"),y=F("./circular_buffer"),x=F("./pipeline"),w=F("events").EventEmitter,v=F("./gesture").gestureListener,u=F("./dialog"),t=F("underscore"),s=E.exports=function(a){var d="undefined"!=typeof D&&D.versions&&D.versions.node,c=this;a=t.defaults(a||{},{inNode:d}),this.inNode=a.inNode,a=t.defaults(a||{},{frameEventName:this.useAnimationLoop()?"animationFrame":"deviceFrame",suppressAnimationLoop:!this.useAnimationLoop(),loopWhileDisconnected:!1,useAllPlugins:!1,checkVersion:!0}),this.animationFrameRequested=!1,this.onAnimationFrame=function(){c.emit("animationFrame",c.lastConnectionFrame),c.loopWhileDisconnected&&(c.connection.focusedState||c.connection.opts.background)?window.requestAnimationFrame(c.onAnimationFrame):c.animationFrameRequested=!1},this.suppressAnimationLoop=a.suppressAnimationLoop,this.loopWhileDisconnected=a.loopWhileDisconnected,this.frameEventName=a.frameEventName,this.useAllPlugins=a.useAllPlugins,this.history=new y(200),this.lastFrame=C.Invalid,this.lastValidFrame=C.Invalid,this.lastConnectionFrame=C.Invalid,this.accumulatedGestures=[],this.checkVersion=a.checkVersion,this.connectionType=void 0===a.connectionType?F(this.inBrowser()?"./connection/browser":"./connection/node"):a.connectionType,this.connection=new this.connectionType(a),this.streamingCount=0,this.devices={},this.plugins={},this._pluginPipelineSteps={},this._pluginExtendedMethods={},a.useAllPlugins&&this.useRegisteredPlugins(),this.setupFrameEvents(a),this.setupConnectionEvents()};s.prototype.gesture=function(e,d){var f=v(this,e);return void 0!==d&&f.stop(d),f},s.prototype.setBackground=function(b){return this.connection.setBackground(b),this},s.prototype.setOptimizeHMD=function(b){return this.connection.setOptimizeHMD(b),this},s.prototype.inBrowser=function(){return !this.inNode},s.prototype.useAnimationLoop=function(){return this.inBrowser()&&!this.inBackgroundPage()},s.prototype.inBackgroundPage=function(){return"undefined"!=typeof chrome&&chrome.extension&&chrome.extension.getBackgroundPage&&chrome.extension.getBackgroundPage()===window},s.prototype.connect=function(){return this.connection.connect(),this},s.prototype.streaming=function(){return this.streamingCount>0},s.prototype.connected=function(){return !!this.connection.connected},s.prototype.runAnimationLoop=function(){this.suppressAnimationLoop||this.animationFrameRequested||(this.animationFrameRequested=!0,window.requestAnimationFrame(this.onAnimationFrame))},s.prototype.disconnect=function(){return this.connection.disconnect(),this},s.prototype.frame=function(b){return this.history.get(b)||C.Invalid},s.prototype.loop=function(b){return b&&("function"==typeof b?this.on(this.frameEventName,b):this.setupFrameEvents(b)),this.connect()},s.prototype.addStep=function(b){this.pipeline||(this.pipeline=new x(this)),this.pipeline.addStep(b)},s.prototype.processFrame=function(b){b.gestures&&(this.accumulatedGestures=this.accumulatedGestures.concat(b.gestures)),this.lastConnectionFrame=b,this.runAnimationLoop(),this.emit("deviceFrame",b)},s.prototype.processFinishedFrame=function(d){if(this.lastFrame=d,d.valid&&(this.lastValidFrame=d),d.controller=this,d.historyIdx=this.history.push(d),d.gestures){d.gestures=this.accumulatedGestures,this.accumulatedGestures=[];for(var c=0;c!=d.gestures.length;c++){this.emit("gesture",d.gestures[c],d)}}this.pipeline&&(d=this.pipeline.run(d),d||(d=C.Invalid)),this.emit("frame",d),this.emitHandEvents(d)},s.prototype.emitHandEvents=function(d){for(var c=0;c<d.hands.length;c++){this.emit("hand",d.hands[c])}},s.prototype.setupFrameEvents=function(b){b.frame&&this.on("frame",b.frame),b.hand&&this.on("hand",b.hand)},s.prototype.setupConnectionEvents=function(){var e=this;this.connection.on("frame",function(a){e.processFrame(a)}),this.on(this.frameEventName,function(a){e.processFinishedFrame(a)});var d=function(){if(e.connection.opts.requestProtocolVersion<5&&0==e.streamingCount){e.streamingCount=1;var a={attached:!0,streaming:!0,type:"unknown",id:"Lx00000000000"};e.devices[a.id]=a,e.emit("deviceAttached",a),e.emit("deviceStreaming",a),e.emit("streamingStarted",a),e.connection.removeListener("frame",d)}},f=function(){if(e.streamingCount>0){for(var a in e.devices){e.emit("deviceStopped",e.devices[a]),e.emit("deviceRemoved",e.devices[a])}e.emit("streamingStopped",e.devices[a]),e.streamingCount=0;for(var a in e.devices){delete e.devices[a]}}};this.connection.on("focus",function(){e.emit("focus")}),this.connection.on("blur",function(){e.emit("blur")}),this.connection.on("protocol",function(a){a.on("beforeFrameCreated",function(c){e.emit("beforeFrameCreated",c)}),a.on("afterFrameCreated",function(g,h){e.emit("afterFrameCreated",g,h)}),e.emit("protocol",a)}),this.connection.on("ready",function(){e.checkVersion&&!e.inNode&&e.checkOutOfDate(),e.emit("ready")}),this.connection.on("connect",function(){e.emit("connect"),e.connection.removeListener("frame",d),e.connection.on("frame",d)}),this.connection.on("disconnect",function(){e.emit("disconnect"),f()}),this.connection.on("deviceConnect",function(a){a.state?(e.emit("deviceConnected"),e.connection.removeListener("frame",d),e.connection.on("frame",d)):(e.emit("deviceDisconnected"),f())}),this.connection.on("deviceEvent",function(a){var j=a.state,i=e.devices[j.id],h={};for(var g in j){i&&i.hasOwnProperty(g)&&i[g]==j[g]||(h[g]=!0)}e.devices[j.id]=j,h.attached&&e.emit(j.attached?"deviceAttached":"deviceRemoved",j),h.streaming&&(j.streaming?(e.streamingCount++,e.emit("deviceStreaming",j),1==e.streamingCount&&e.emit("streamingStarted",j),h.attached||e.emit("deviceConnected")):h.attached&&j.attached||(e.streamingCount--,e.emit("deviceStopped",j),0==e.streamingCount&&e.emit("streamingStopped",j),e.emit("deviceDisconnected")))}),this.on("newListener",function(b){("deviceConnected"==b||"deviceDisconnected"==b)&&console.warn(b+" events are depricated.  Consider using 'streamingStarted/streamingStopped' or 'deviceStreaming/deviceStopped' instead")})},s.prototype.checkOutOfDate=function(){console.assert(this.connection&&this.connection.protocol);var e=this.connection.protocol.serviceVersion,d=this.connection.protocol.version,f=this.connectionType.defaultProtocolVersion;return f>d?(console.warn("Your Protocol Version is v"+d+", this app was designed for v"+f),u.warnOutOfDate({sV:e,pV:d}),!0):!1},s._pluginFactories={},s.plugin=function(d,c){return this._pluginFactories[d]&&console.warn('Plugin "'+d+'" already registered'),this._pluginFactories[d]=c},s.plugins=function(){return t.keys(this._pluginFactories)};var r=function(e,d,f){-1!=["beforeFrameCreated","afterFrameCreated"].indexOf(d)?this.on(d,f):(this.pipeline||(this.pipeline=new x(this)),this._pluginPipelineSteps[e]||(this._pluginPipelineSteps[e]=[]),this._pluginPipelineSteps[e].push(this.pipeline.addWrappedStep(d,f)))},q=function(e,d,g){var f;switch(this._pluginExtendedMethods[e]||(this._pluginExtendedMethods[e]=[]),d){case"frame":f=C;break;case"hand":f=B;break;case"pointable":f=A,t.extend(z.prototype,g),t.extend(z.Invalid,g);break;case"finger":f=z;break;default:throw e+' specifies invalid object type "'+d+'" for prototypical extension'}t.extend(f.prototype,g),t.extend(f.Invalid,g),this._pluginExtendedMethods[e].push([f,g])};s.prototype.use=function(h,g){var l,k,j,i;if(k="function"==typeof h?h:s._pluginFactories[h],!k){throw"Leap Plugin "+h+" not found."}if(g||(g={}),this.plugins[h]){return t.extend(this.plugins[h],g),this}this.plugins[h]=g,i=k.call(this,g);for(j in i){l=i[j],"function"==typeof l?r.call(this,h,j,l):q.call(this,h,j,l)}return this},s.prototype.stopUsing=function(i){var h,n,m=this._pluginPipelineSteps[i],l=this._pluginExtendedMethods[i],k=0;if(this.plugins[i]){if(m){for(k=0;k<m.length;k++){this.pipeline.removeStep(m[k])}}if(l){for(k=0;k<l.length;k++){h=l[k][0],n=l[k][1];for(var j in n){delete h.prototype[j],delete h.Invalid[j]}}}return delete this.plugins[i],this}},s.prototype.useRegisteredPlugins=function(){for(var b in s._pluginFactories){this.use(b)}},t.extend(s.prototype,w.prototype)},{"./circular_buffer":2,"./connection/browser":4,"./connection/node":20,"./dialog":6,"./finger":7,"./frame":8,"./gesture":9,"./hand":10,"./pipeline":13,"./pointable":14,__browserify_process:22,events:21,underscore:24}],6:[function(f,e){var h=f("__browserify_process"),g=e.exports=function(d,c){this.options=c||{},this.message=d,this.createElement()};g.prototype.createElement=function(){this.element=document.createElement("div"),this.element.className="leapjs-dialog",this.element.style.position="fixed",this.element.style.top="8px",this.element.style.left=0,this.element.style.right=0,this.element.style.textAlign="center",this.element.style.zIndex=1000;var b=document.createElement("div");this.element.appendChild(b),b.style.className="leapjs-dialog",b.style.display="inline-block",b.style.margin="auto",b.style.padding="8px",b.style.color="#222",b.style.background="#eee",b.style.borderRadius="4px",b.style.border="1px solid #999",b.style.textAlign="left",b.style.cursor="pointer",b.style.whiteSpace="nowrap",b.style.transition="box-shadow 1s linear",b.innerHTML=this.message,this.options.onclick&&b.addEventListener("click",this.options.onclick),this.options.onmouseover&&b.addEventListener("mouseover",this.options.onmouseover),this.options.onmouseout&&b.addEventListener("mouseout",this.options.onmouseout),this.options.onmousemove&&b.addEventListener("mousemove",this.options.onmousemove)},g.prototype.show=function(){return document.body.appendChild(this.element),this},g.prototype.hide=function(){return document.body.removeChild(this.element),this},g.warnOutOfDate=function(i){i||(i={});var d="http://developer.leapmotion.com?";i.returnTo=window.location.href;for(var m in i){d+=m+"="+encodeURIComponent(i[m])+"&"}var l,k=function(b){if("leapjs-decline-upgrade"!=b.target.id){var n=window.open(d,"_blank","height=800,width=1000,location=1,menubar=1,resizable=1,status=1,toolbar=1,scrollbars=1");window.focus&&n.focus()}return l.hide(),!0},j="This site requires Leap Motion Tracking V2.<button id='leapjs-accept-upgrade'  style='color: #444; transition: box-shadow 100ms linear; cursor: pointer; vertical-align: baseline; margin-left: 16px;'>Upgrade</button><button id='leapjs-decline-upgrade' style='color: #444; transition: box-shadow 100ms linear; cursor: pointer; vertical-align: baseline; margin-left: 8px; '>Not Now</button>";return l=new g(j,{onclick:k,onmousemove:function(b){b.target==document.getElementById("leapjs-decline-upgrade")?(document.getElementById("leapjs-decline-upgrade").style.color="#000",document.getElementById("leapjs-decline-upgrade").style.boxShadow="0px 0px 2px #5daa00",document.getElementById("leapjs-accept-upgrade").style.color="#444",document.getElementById("leapjs-accept-upgrade").style.boxShadow="none"):(document.getElementById("leapjs-accept-upgrade").style.color="#000",document.getElementById("leapjs-accept-upgrade").style.boxShadow="0px 0px 2px #5daa00",document.getElementById("leapjs-decline-upgrade").style.color="#444",document.getElementById("leapjs-decline-upgrade").style.boxShadow="none")},onmouseout:function(){document.getElementById("leapjs-decline-upgrade").style.color="#444",document.getElementById("leapjs-decline-upgrade").style.boxShadow="none",document.getElementById("leapjs-accept-upgrade").style.color="#444",document.getElementById("leapjs-accept-upgrade").style.boxShadow="none"}}),l.show()},g.hasWarnedBones=!1,g.warnBones=function(){this.hasWarnedBones||(this.hasWarnedBones=!0,console.warn("Your Leap Service is out of date"),"undefined"!=typeof h&&h.versions&&h.versions.node||this.warnOutOfDate({reason:"bones"}))}},{__browserify_process:22}],7:[function(i,h){var n=i("./pointable"),m=i("./bone"),l=i("./dialog"),k=i("underscore"),j=h.exports=function(b){n.call(this,b),this.dipPosition=b.dipPosition,this.pipPosition=b.pipPosition,this.mcpPosition=b.mcpPosition,this.carpPosition=b.carpPosition,this.extended=b.extended,this.type=b.type,this.finger=!0,this.positions=[this.carpPosition,this.mcpPosition,this.pipPosition,this.dipPosition,this.tipPosition],b.bases?this.addBones(b):l.warnBones()};k.extend(j.prototype,n.prototype),j.prototype.addBones=function(b){this.metacarpal=new m(this,{type:0,width:this.width,prevJoint:this.carpPosition,nextJoint:this.mcpPosition,basis:b.bases[0]}),this.proximal=new m(this,{type:1,width:this.width,prevJoint:this.mcpPosition,nextJoint:this.pipPosition,basis:b.bases[1]}),this.medial=new m(this,{type:2,width:this.width,prevJoint:this.pipPosition,nextJoint:this.dipPosition,basis:b.bases[2]}),this.distal=new m(this,{type:3,width:this.width,prevJoint:this.dipPosition,nextJoint:b.btipPosition,basis:b.bases[3]}),this.bones=[this.metacarpal,this.proximal,this.medial,this.distal]},j.prototype.toString=function(){return"Finger [ id:"+this.id+" "+this.length+"mmx | width:"+this.width+"mm | direction:"+this.direction+" ]"},j.Invalid={valid:!1}},{"./bone":1,"./dialog":6,"./pointable":14,underscore:24}],8:[function(x,w){var v=x("./hand"),u=x("./pointable"),t=x("./gesture").createGesture,s=x("gl-matrix"),r=s.mat3,q=s.vec3,p=x("./interaction_box"),o=x("./finger"),n=x("underscore"),m=w.exports=function(e){if(this.valid=!0,this.id=e.id,this.timestamp=e.timestamp,this.hands=[],this.handsMap={},this.pointables=[],this.tools=[],this.fingers=[],e.interactionBox&&(this.interactionBox=new p(e.interactionBox)),this.gestures=[],this.pointablesMap={},this._translation=e.t,this._rotation=n.flatten(e.r),this._scaleFactor=e.s,this.data=e,this.type="frame",this.currentFrameRate=e.currentFrameRate,e.gestures){for(var d=0,f=e.gestures.length;d!=f;d++){this.gestures.push(t(e.gestures[d]))}}this.postprocessData(e)};m.prototype.postprocessData=function(j){j||(j=this.data);for(var c=0,B=j.hands.length;c!=B;c++){var A=new v(j.hands[c]);A.frame=this,this.hands.push(A),this.handsMap[A.id]=A}j.pointables=n.sortBy(j.pointables,function(b){return b.id});for(var z=0,y=j.pointables.length;z!=y;z++){var k=j.pointables[z],d=k.dipPosition?new o(k):new u(k);d.frame=this,this.addPointable(d)}},m.prototype.addPointable=function(d){if(this.pointables.push(d),this.pointablesMap[d.id]=d,(d.tool?this.tools:this.fingers).push(d),void 0!==d.handId&&this.handsMap.hasOwnProperty(d.handId)){var c=this.handsMap[d.handId];switch(c.pointables.push(d),(d.tool?c.tools:c.fingers).push(d),d.type){case 0:c.thumb=d;break;case 1:c.indexFinger=d;break;case 2:c.middleFinger=d;break;case 3:c.ringFinger=d;break;case 4:c.pinky=d}}},m.prototype.tool=function(d){var c=this.pointable(d);return c.tool?c:u.Invalid},m.prototype.pointable=function(b){return this.pointablesMap[b]||u.Invalid},m.prototype.finger=function(d){var c=this.pointable(d);return c.tool?u.Invalid:c},m.prototype.hand=function(b){return this.handsMap[b]||v.Invalid},m.prototype.rotationAngle=function(h,g){if(!this.valid||!h.valid){return 0}var l=this.rotationMatrix(h),k=0.5*(l[0]+l[4]+l[8]-1),j=Math.acos(k);if(j=isNaN(j)?0:j,void 0!==g){var i=this.rotationAxis(h);j*=q.dot(i,q.normalize(q.create(),g))}return j},m.prototype.rotationAxis=function(b){return this.valid&&b.valid?q.normalize(q.create(),[this._rotation[7]-b._rotation[5],this._rotation[2]-b._rotation[6],this._rotation[3]-b._rotation[1]]):q.create()},m.prototype.rotationMatrix=function(d){if(!this.valid||!d.valid){return r.create()}var c=r.transpose(r.create(),this._rotation);return r.multiply(r.create(),d._rotation,c)},m.prototype.scaleFactor=function(b){return this.valid&&b.valid?Math.exp(this._scaleFactor-b._scaleFactor):1},m.prototype.translation=function(b){return this.valid&&b.valid?q.subtract(q.create(),this._translation,b._translation):q.create()},m.prototype.toString=function(){var b="Frame [ id:"+this.id+" | timestamp:"+this.timestamp+" | Hand count:("+this.hands.length+") | Pointable count:("+this.pointables.length+")";return this.gestures&&(b+=" | Gesture count:("+this.gestures.length+")"),b+=" ]"},m.prototype.dump=function(){var i="";i+="Frame Info:<br/>",i+=this.toString(),i+="<br/><br/>Hands:<br/>";for(var h=0,z=this.hands.length;h!=z;h++){i+="  "+this.hands[h].toString()+"<br/>"}i+="<br/><br/>Pointables:<br/>";for(var y=0,l=this.pointables.length;y!=l;y++){i+="  "+this.pointables[y].toString()+"<br/>"}if(this.gestures){i+="<br/><br/>Gestures:<br/>";for(var k=0,j=this.gestures.length;k!=j;k++){i+="  "+this.gestures[k].toString()+"<br/>"}}return i+="<br/><br/>Raw JSON:<br/>",i+=JSON.stringify(this.data)},m.Invalid={valid:!1,hands:[],fingers:[],tools:[],gestures:[],pointables:[],pointable:function(){return u.Invalid},finger:function(){return u.Invalid},hand:function(){return v.Invalid},toString:function(){return"invalid frame"},dump:function(){return this.toString()},rotationAngle:function(){return 0},rotationMatrix:function(){return r.create()},rotationAxis:function(){return q.create()},scaleFactor:function(){return 1},translation:function(){return q.create()}}},{"./finger":7,"./gesture":9,"./hand":10,"./interaction_box":12,"./pointable":14,"gl-matrix":23,underscore:24}],9:[function(x,w,v){var u=x("gl-matrix"),t=u.vec3,s=x("events").EventEmitter,r=x("underscore"),q=(v.createGesture=function(d){var c;switch(d.type){case"circle":c=new p(d);break;case"swipe":c=new o(d);break;case"screenTap":c=new n(d);break;case"keyTap":c=new m(d);break;default:throw"unknown gesture type"}return c.id=d.id,c.handIds=d.handIds.slice(),c.pointableIds=d.pointableIds.slice(),c.duration=d.duration,c.state=d.state,c.type=d.type,c},v.gestureListener=function(g,f){var j={},i={};g.on("gesture",function(b,d){if(b.type==f){if(("start"==b.state||"stop"==b.state)&&void 0===i[b.id]){var c=new q(b,d);i[b.id]=c,r.each(j,function(k,e){c.on(e,k)})}i[b.id].update(b,d),"stop"==b.state&&delete i[b.id]}});var h={start:function(b){return j.start=b,h},stop:function(b){return j.stop=b,h},complete:function(b){return j.stop=b,h},update:function(b){return j.update=b,h}};return h},v.Gesture=function(d,c){this.gestures=[d],this.frames=[c]});q.prototype.update=function(d,c){this.lastGesture=d,this.lastFrame=c,this.gestures.push(d),this.frames.push(c),this.emit(d.state,this)},q.prototype.translation=function(){return t.subtract(t.create(),this.lastGesture.startPosition,this.lastGesture.position)},r.extend(q.prototype,s.prototype);var p=function(b){this.center=b.center,this.normal=b.normal,this.progress=b.progress,this.radius=b.radius};p.prototype.toString=function(){return"CircleGesture ["+JSON.stringify(this)+"]"};var o=function(b){this.startPosition=b.startPosition,this.position=b.position,this.direction=b.direction,this.speed=b.speed};o.prototype.toString=function(){return"SwipeGesture ["+JSON.stringify(this)+"]"};var n=function(b){this.position=b.position,this.direction=b.direction,this.progress=b.progress};n.prototype.toString=function(){return"ScreenTapGesture ["+JSON.stringify(this)+"]"};var m=function(b){this.position=b.position,this.direction=b.direction,this.progress=b.progress};m.prototype.toString=function(){return"KeyTapGesture ["+JSON.stringify(this)+"]"}},{events:21,"gl-matrix":23,underscore:24}],10:[function(r,q){var p=r("./pointable"),o=r("./bone"),n=r("gl-matrix"),m=n.mat3,l=n.vec3,k=r("underscore"),j=q.exports=function(b){this.id=b.id,this.palmPosition=b.palmPosition,this.direction=b.direction,this.palmVelocity=b.palmVelocity,this.palmNormal=b.palmNormal,this.sphereCenter=b.sphereCenter,this.sphereRadius=b.sphereRadius,this.valid=!0,this.pointables=[],this.fingers=[],this.arm=b.armBasis?new o(this,{type:4,width:b.armWidth,prevJoint:b.elbow,nextJoint:b.wrist,basis:b.armBasis}):null,this.tools=[],this._translation=b.t,this._rotation=k.flatten(b.r),this._scaleFactor=b.s,this.timeVisible=b.timeVisible,this.stabilizedPalmPosition=b.stabilizedPalmPosition,this.type=b.type,this.grabStrength=b.grabStrength,this.pinchStrength=b.pinchStrength,this.confidence=b.confidence};j.prototype.finger=function(d){var c=this.frame.finger(d);return c&&c.handId==this.id?c:p.Invalid},j.prototype.rotationAngle=function(i,g){if(!this.valid||!i.valid){return 0}var w=i.hand(this.id);if(!w.valid){return 0}var v=this.rotationMatrix(i),u=0.5*(v[0]+v[4]+v[8]-1),t=Math.acos(u);if(t=isNaN(t)?0:t,void 0!==g){var s=this.rotationAxis(i);t*=l.dot(s,l.normalize(l.create(),g))}return t},j.prototype.rotationAxis=function(d){if(!this.valid||!d.valid){return l.create()}var c=d.hand(this.id);return c.valid?l.normalize(l.create(),[this._rotation[7]-c._rotation[5],this._rotation[2]-c._rotation[6],this._rotation[3]-c._rotation[1]]):l.create()},j.prototype.rotationMatrix=function(f){if(!this.valid||!f.valid){return m.create()}var e=f.hand(this.id);if(!e.valid){return m.create()}var h=m.transpose(m.create(),this._rotation),g=m.multiply(m.create(),e._rotation,h);return g},j.prototype.scaleFactor=function(d){if(!this.valid||!d.valid){return 1}var c=d.hand(this.id);return c.valid?Math.exp(this._scaleFactor-c._scaleFactor):1},j.prototype.translation=function(d){if(!this.valid||!d.valid){return l.create()}var c=d.hand(this.id);return c.valid?[this._translation[0]-c._translation[0],this._translation[1]-c._translation[1],this._translation[2]-c._translation[2]]:l.create()},j.prototype.toString=function(){return"Hand ("+this.type+") [ id: "+this.id+" | palm velocity:"+this.palmVelocity+" | sphere center:"+this.sphereCenter+" ] "},j.prototype.pitch=function(){return Math.atan2(this.direction[1],-this.direction[2])},j.prototype.yaw=function(){return Math.atan2(this.direction[0],-this.direction[2])},j.prototype.roll=function(){return Math.atan2(this.palmNormal[0],-this.palmNormal[1])},j.Invalid={valid:!1,fingers:[],tools:[],pointables:[],left:!1,pointable:function(){return p.Invalid},finger:function(){return p.Invalid},toString:function(){return"invalid frame"},dump:function(){return this.toString()},rotationAngle:function(){return 0},rotationMatrix:function(){return m.create()},rotationAxis:function(){return l.create()},scaleFactor:function(){return 1},translation:function(){return l.create()}}},{"./bone":1,"./pointable":14,"gl-matrix":23,underscore:24}],11:[function(d,c){c.exports={Controller:d("./controller"),Frame:d("./frame"),Gesture:d("./gesture"),Hand:d("./hand"),Pointable:d("./pointable"),Finger:d("./finger"),InteractionBox:d("./interaction_box"),CircularBuffer:d("./circular_buffer"),UI:d("./ui"),JSONProtocol:d("./protocol").JSONProtocol,glMatrix:d("gl-matrix"),mat3:d("gl-matrix").mat3,vec3:d("gl-matrix").vec3,loopController:void 0,version:d("./version.js"),loop:function(f,e){return !f||void 0!==e||f.frame||f.hand||(e=f,f={}),this.loopController?f&&this.loopController.setupFrameEvents(f):this.loopController=new this.Controller(f),this.loopController.loop(e),this.loopController},plugin:function(f,e){this.Controller.plugin(f,e)}}},{"./circular_buffer":2,"./controller":5,"./finger":7,"./frame":8,"./gesture":9,"./hand":10,"./interaction_box":12,"./pointable":14,"./protocol":15,"./ui":16,"./version.js":19,"gl-matrix":23}],12:[function(g,f){var j=g("gl-matrix"),i=j.vec3,h=f.exports=function(b){this.valid=!0,this.center=b.center,this.size=b.size,this.width=b.size[0],this.height=b.size[1],this.depth=b.size[2]};h.prototype.denormalizePoint=function(b){return i.fromValues((b[0]-0.5)*this.size[0]+this.center[0],(b[1]-0.5)*this.size[1]+this.center[1],(b[2]-0.5)*this.size[2]+this.center[2])},h.prototype.normalizePoint=function(e,d){var k=i.fromValues((e[0]-this.center[0])/this.size[0]+0.5,(e[1]-this.center[1])/this.size[1]+0.5,(e[2]-this.center[2])/this.size[2]+0.5);return d&&(k[0]=Math.min(Math.max(k[0],0),1),k[1]=Math.min(Math.max(k[1],0),1),k[2]=Math.min(Math.max(k[2],0),1)),k},h.prototype.toString=function(){return"InteractionBox [ width:"+this.width+" | height:"+this.height+" | depth:"+this.depth+" ]"},h.Invalid={valid:!1}},{"gl-matrix":23}],13:[function(e,d){var f=d.exports=function(b){this.steps=[],this.controller=b};f.prototype.addStep=function(b){this.steps.push(b)},f.prototype.run=function(h){for(var g=this.steps.length,i=0;i!=g&&h;i++){h=this.steps[i](h)}return h},f.prototype.removeStep=function(g){var c=this.steps.indexOf(g);if(-1===c){throw"Step not found in pipeline"}this.steps.splice(c,1)},f.prototype.addWrappedStep=function(h,g){var j=this.controller,i=function(k){var c,b,a;for(c="frame"==h?[k]:k[h+"s"]||[],b=0,a=c.length;a>b;b++){g.call(j,c[b])}return k};return this.addStep(i),i}},{}],14:[function(f,e){var h=f("gl-matrix"),g=(h.vec3,e.exports=function(b){this.valid=!0,this.id=b.id,this.handId=b.handId,this.length=b.length,this.tool=b.tool,this.width=b.width,this.direction=b.direction,this.stabilizedTipPosition=b.stabilizedTipPosition,this.tipPosition=b.tipPosition,this.tipVelocity=b.tipVelocity,this.touchZone=b.touchZone,this.touchDistance=b.touchDistance,this.timeVisible=b.timeVisible});g.prototype.toString=function(){return"Pointable [ id:"+this.id+" "+this.length+"mmx | width:"+this.width+"mm | direction:"+this.direction+" ]"},g.prototype.hand=function(){return this.frame.hand(this.handId)},g.Invalid={valid:!1}},{"gl-matrix":23}],15:[function(j,i,p){var o=j("./frame"),n=(j("./hand"),j("./pointable"),j("./finger"),j("underscore")),m=j("events").EventEmitter,l=function(b){this.type=b.type,this.state=b.state};p.chooseProtocol=function(d){var c;switch(d.version){case 1:case 2:case 3:case 4:case 5:case 6:c=k(d),c.sendBackground=function(b,e){b.send(c.encode({background:e}))},c.sendFocused=function(b,e){b.send(c.encode({focused:e}))},c.sendOptimizeHMD=function(b,e){b.send(c.encode({optimizeHMD:e}))};break;default:throw"unrecognized version"}return c};var k=p.JSONProtocol=function(d){var c=function(b){if(b.event){return new l(b.event)}c.emit("beforeFrameCreated",b);var e=new o(b);return c.emit("afterFrameCreated",e,b),e};return c.encode=function(b){return JSON.stringify(b)},c.version=d.version,c.serviceVersion=d.serviceVersion,c.versionLong="Version "+d.version,c.type="protocol",n.extend(c,m.prototype),c}},{"./finger":7,"./frame":8,"./hand":10,"./pointable":14,events:21,underscore:24}],16:[function(e,d,f){f.UI={Region:e("./ui/region"),Cursor:e("./ui/cursor")}},{"./ui/cursor":17,"./ui/region":18}],17:[function(d,c){c.exports=function(){return function(f){var e=f.pointables.sort(function(h,g){return h.z-g.z})[0];return e&&e.valid&&(f.cursorPosition=e.tipPosition),f}}},{}],18:[function(g,f){var j=g("events").EventEmitter,i=g("underscore"),h=f.exports=function(d,c){this.start=new Vector(d),this.end=new Vector(c),this.enteredFrame=null};h.prototype.hasPointables=function(e){for(var d=0;d!=e.pointables.length;d++){var k=e.pointables[d].tipPosition;if(k.x>=this.start.x&&k.x<=this.end.x&&k.y>=this.start.y&&k.y<=this.end.y&&k.z>=this.start.z&&k.z<=this.end.z){return !0}}return !1},h.prototype.listener=function(d){var c=this;return d&&d.nearThreshold&&this.setupNearRegion(d.nearThreshold),function(b){return c.updatePosition(b)}},h.prototype.clipper=function(){var b=this;return function(a){return b.updatePosition(a),b.enteredFrame?a:null}},h.prototype.setupNearRegion=function(e){var d=this.nearRegion=new h([this.start.x-e,this.start.y-e,this.start.z-e],[this.end.x+e,this.end.y+e,this.end.z+e]),k=this;d.on("enter",function(b){k.emit("near",b)}),d.on("exit",function(b){k.emit("far",b)}),k.on("exit",function(b){k.emit("near",b)})},h.prototype.updatePosition=function(b){return this.nearRegion&&this.nearRegion.updatePosition(b),this.hasPointables(b)&&null==this.enteredFrame?(this.enteredFrame=b,this.emit("enter",this.enteredFrame)):this.hasPointables(b)||null==this.enteredFrame||(this.enteredFrame=null,this.emit("exit",this.enteredFrame)),b},h.prototype.normalize=function(b){return new Vector([(b.x-this.start.x)/(this.end.x-this.start.x),(b.y-this.start.y)/(this.end.y-this.start.y),(b.z-this.start.z)/(this.end.z-this.start.z)])},h.prototype.mapToXY=function(l,k,p){var o=this.normalize(l),n=o.x,m=o.y;return n>1?n=1:-1>n&&(n=-1),m>1?m=1:-1>m&&(m=-1),[(n+1)/2*k,(1-m)/2*p,o.z]},i.extend(h.prototype,j.prototype)},{events:21,underscore:24}],19:[function(d,c){c.exports={full:"0.6.2",major:0,minor:6,dot:2}},{}],20:[function(){},{}],21:[function(j,i,p){function o(e,d){if(e.indexOf){return e.indexOf(d)}for(var f=0;f<e.length;f++){if(d===e[f]){return f}}return -1}var n=j("__browserify_process");n.EventEmitter||(n.EventEmitter=function(){});var m=p.EventEmitter=n.EventEmitter,l="function"==typeof Array.isArray?Array.isArray:function(b){return"[object Array]"===Object.prototype.toString.call(b)},k=10;m.prototype.setMaxListeners=function(b){this._events||(this._events={}),this._events.maxListeners=b},m.prototype.emit=function(h){if("error"===h&&(!this._events||!this._events.error||l(this._events.error)&&!this._events.error.length)){throw arguments[1] instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.")}if(!this._events){return !1}var g=this._events[h];if(!g){return !1}if("function"==typeof g){switch(arguments.length){case 1:g.call(this);break;case 2:g.call(this,arguments[1]);break;case 3:g.call(this,arguments[1],arguments[2]);break;default:var t=Array.prototype.slice.call(arguments,1);g.apply(this,t)}return !0}if(l(g)){for(var t=Array.prototype.slice.call(arguments,1),s=g.slice(),r=0,q=s.length;q>r;r++){s[r].apply(this,t)}return !0}return !1},m.prototype.addListener=function(e,d){if("function"!=typeof d){throw new Error("addListener only takes instances of Function")}if(this._events||(this._events={}),this.emit("newListener",e,d),this._events[e]){if(l(this._events[e])){if(!this._events[e].warned){var f;f=void 0!==this._events.maxListeners?this._events.maxListeners:k,f&&f>0&&this._events[e].length>f&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),console.trace())}this._events[e].push(d)}else{this._events[e]=[this._events[e],d]}}else{this._events[e]=d}return this},m.prototype.on=m.prototype.addListener,m.prototype.once=function(f,e){var h=this;return h.on(f,function g(){h.removeListener(f,g),e.apply(this,arguments)}),this},m.prototype.removeListener=function(f,d){if("function"!=typeof d){throw new Error("removeListener only takes instances of Function")}if(!this._events||!this._events[f]){return this}var h=this._events[f];if(l(h)){var g=o(h,d);if(0>g){return this}h.splice(g,1),0==h.length&&delete this._events[f]}else{this._events[f]===d&&delete this._events[f]}return this},m.prototype.removeAllListeners=function(b){return 0===arguments.length?(this._events={},this):(b&&this._events&&this._events[b]&&(this._events[b]=null),this)},m.prototype.listeners=function(b){return this._events||(this._events={}),this._events[b]||(this._events[b]=[]),l(this._events[b])||(this._events[b]=[this._events[b]]),this._events[b]},m.listenerCount=function(e,d){var f;return f=e._events&&e._events[d]?"function"==typeof e._events[d]?1:e._events[d].length:0}},{__browserify_process:22}],22:[function(e,d){var f=d.exports={};f.nextTick=function(){var h="undefined"!=typeof window&&window.setImmediate,g="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(h){return function(b){return window.setImmediate(b)}}if(g){var i=[];return window.addEventListener("message",function(j){var c=j.source;if((c===window||null===c)&&"process-tick"===j.data&&(j.stopPropagation(),i.length>0)){var k=i.shift();k()}},!0),function(b){i.push(b),window.postMessage("process-tick","*")}}return function(b){setTimeout(b,0)}}(),f.title="browser",f.browser=!0,f.env={},f.argv=[],f.binding=function(){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(){throw new Error("process.chdir is not supported")}},{}],23:[function(e,d,f){!function(g){var c={};"undefined"==typeof f?"function"==typeof define&&"object"==typeof define.amd&&define.amd?(c.exports={},define(function(){return c.exports})):c.exports="undefined"!=typeof window?window:g:c.exports=f,function(B){if(!A){var A=0.000001}if(!z){var z="undefined"!=typeof Float32Array?Float32Array:Array}if(!y){var y=Math.random}var x={};x.setMatrixArrayType=function(b){z=b},"undefined"!=typeof B&&(B.glMatrix=x);var w=Math.PI/180;x.toRadian=function(b){return b*w};var v={};v.create=function(){var b=new z(2);return b[0]=0,b[1]=0,b},v.clone=function(i){var h=new z(2);return h[0]=i[0],h[1]=i[1],h},v.fromValues=function(i,h){var j=new z(2);return j[0]=i,j[1]=h,j},v.copy=function(i,h){return i[0]=h[0],i[1]=h[1],i},v.set=function(i,h,j){return i[0]=h,i[1]=j,i},v.add=function(i,h,j){return i[0]=h[0]+j[0],i[1]=h[1]+j[1],i},v.subtract=function(i,h,j){return i[0]=h[0]-j[0],i[1]=h[1]-j[1],i},v.sub=v.subtract,v.multiply=function(i,h,j){return i[0]=h[0]*j[0],i[1]=h[1]*j[1],i},v.mul=v.multiply,v.divide=function(i,h,j){return i[0]=h[0]/j[0],i[1]=h[1]/j[1],i},v.div=v.divide,v.min=function(i,h,j){return i[0]=Math.min(h[0],j[0]),i[1]=Math.min(h[1],j[1]),i},v.max=function(i,h,j){return i[0]=Math.max(h[0],j[0]),i[1]=Math.max(h[1],j[1]),i},v.scale=function(i,h,j){return i[0]=h[0]*j,i[1]=h[1]*j,i},v.scaleAndAdd=function(i,h,k,j){return i[0]=h[0]+k[0]*j,i[1]=h[1]+k[1]*j,i},v.distance=function(i,h){var k=h[0]-i[0],j=h[1]-i[1];return Math.sqrt(k*k+j*j)},v.dist=v.distance,v.squaredDistance=function(i,h){var k=h[0]-i[0],j=h[1]-i[1];return k*k+j*j},v.sqrDist=v.squaredDistance,v.length=function(i){var h=i[0],j=i[1];return Math.sqrt(h*h+j*j)},v.len=v.length,v.squaredLength=function(i){var h=i[0],j=i[1];return h*h+j*j},v.sqrLen=v.squaredLength,v.negate=function(i,h){return i[0]=-h[0],i[1]=-h[1],i},v.normalize=function(i,h){var l=h[0],k=h[1],j=l*l+k*k;return j>0&&(j=1/Math.sqrt(j),i[0]=h[0]*j,i[1]=h[1]*j),i},v.dot=function(i,h){return i[0]*h[0]+i[1]*h[1]},v.cross=function(i,h,k){var j=h[0]*k[1]-h[1]*k[0];return i[0]=i[1]=0,i[2]=j,i},v.lerp=function(i,h,m,l){var k=h[0],j=h[1];return i[0]=k+l*(m[0]-k),i[1]=j+l*(m[1]-j),i},v.random=function(i,h){h=h||1;var j=2*y()*Math.PI;return i[0]=Math.cos(j)*h,i[1]=Math.sin(j)*h,i},v.transformMat2=function(i,h,l){var k=h[0],j=h[1];return i[0]=l[0]*k+l[2]*j,i[1]=l[1]*k+l[3]*j,i},v.transformMat2d=function(i,h,l){var k=h[0],j=h[1];return i[0]=l[0]*k+l[2]*j+l[4],i[1]=l[1]*k+l[3]*j+l[5],i},v.transformMat3=function(i,h,l){var k=h[0],j=h[1];return i[0]=l[0]*k+l[3]*j+l[6],i[1]=l[1]*k+l[4]*j+l[7],i},v.transformMat4=function(i,h,l){var k=h[0],j=h[1];return i[0]=l[0]*k+l[4]*j+l[12],i[1]=l[1]*k+l[5]*j+l[13],i},v.forEach=function(){var b=v.create();return function(a,D,C,n,m,l){var k,j;for(D||(D=2),C||(C=0),j=n?Math.min(n*D+C,a.length):a.length,k=C;j>k;k+=D){b[0]=a[k],b[1]=a[k+1],m(b,b,l),a[k]=b[0],a[k+1]=b[1]}return a}}(),v.str=function(b){return"vec2("+b[0]+", "+b[1]+")"},"undefined"!=typeof B&&(B.vec2=v);var u={};u.create=function(){var b=new z(3);return b[0]=0,b[1]=0,b[2]=0,b},u.clone=function(i){var h=new z(3);return h[0]=i[0],h[1]=i[1],h[2]=i[2],h},u.fromValues=function(i,h,k){var j=new z(3);return j[0]=i,j[1]=h,j[2]=k,j},u.copy=function(i,h){return i[0]=h[0],i[1]=h[1],i[2]=h[2],i},u.set=function(i,h,k,j){return i[0]=h,i[1]=k,i[2]=j,i},u.add=function(i,h,j){return i[0]=h[0]+j[0],i[1]=h[1]+j[1],i[2]=h[2]+j[2],i},u.subtract=function(i,h,j){return i[0]=h[0]-j[0],i[1]=h[1]-j[1],i[2]=h[2]-j[2],i},u.sub=u.subtract,u.multiply=function(i,h,j){return i[0]=h[0]*j[0],i[1]=h[1]*j[1],i[2]=h[2]*j[2],i},u.mul=u.multiply,u.divide=function(i,h,j){return i[0]=h[0]/j[0],i[1]=h[1]/j[1],i[2]=h[2]/j[2],i},u.div=u.divide,u.min=function(i,h,j){return i[0]=Math.min(h[0],j[0]),i[1]=Math.min(h[1],j[1]),i[2]=Math.min(h[2],j[2]),i},u.max=function(i,h,j){return i[0]=Math.max(h[0],j[0]),i[1]=Math.max(h[1],j[1]),i[2]=Math.max(h[2],j[2]),i},u.scale=function(i,h,j){return i[0]=h[0]*j,i[1]=h[1]*j,i[2]=h[2]*j,i},u.scaleAndAdd=function(i,h,k,j){return i[0]=h[0]+k[0]*j,i[1]=h[1]+k[1]*j,i[2]=h[2]+k[2]*j,i},u.distance=function(i,h){var l=h[0]-i[0],k=h[1]-i[1],j=h[2]-i[2];return Math.sqrt(l*l+k*k+j*j)},u.dist=u.distance,u.squaredDistance=function(i,h){var l=h[0]-i[0],k=h[1]-i[1],j=h[2]-i[2];return l*l+k*k+j*j},u.sqrDist=u.squaredDistance,u.length=function(i){var h=i[0],k=i[1],j=i[2];return Math.sqrt(h*h+k*k+j*j)},u.len=u.length,u.squaredLength=function(i){var h=i[0],k=i[1],j=i[2];return h*h+k*k+j*j},u.sqrLen=u.squaredLength,u.negate=function(i,h){return i[0]=-h[0],i[1]=-h[1],i[2]=-h[2],i},u.normalize=function(i,h){var m=h[0],l=h[1],k=h[2],j=m*m+l*l+k*k;return j>0&&(j=1/Math.sqrt(j),i[0]=h[0]*j,i[1]=h[1]*j,i[2]=h[2]*j),i},u.dot=function(i,h){return i[0]*h[0]+i[1]*h[1]+i[2]*h[2]},u.cross=function(F,E,D){var C=E[0],n=E[1],m=E[2],l=D[0],k=D[1],j=D[2];return F[0]=n*j-m*k,F[1]=m*l-C*j,F[2]=C*k-n*l,F},u.lerp=function(i,h,n,m){var l=h[0],k=h[1],j=h[2];return i[0]=l+m*(n[0]-l),i[1]=k+m*(n[1]-k),i[2]=j+m*(n[2]-j),i},u.random=function(i,h){h=h||1;var l=2*y()*Math.PI,k=2*y()-1,j=Math.sqrt(1-k*k)*h;return i[0]=Math.cos(l)*j,i[1]=Math.sin(l)*j,i[2]=k*h,i},u.transformMat4=function(i,h,m){var l=h[0],k=h[1],j=h[2];return i[0]=m[0]*l+m[4]*k+m[8]*j+m[12],i[1]=m[1]*l+m[5]*k+m[9]*j+m[13],i[2]=m[2]*l+m[6]*k+m[10]*j+m[14],i},u.transformMat3=function(i,h,m){var l=h[0],k=h[1],j=h[2];return i[0]=l*m[0]+k*m[3]+j*m[6],i[1]=l*m[1]+k*m[4]+j*m[7],i[2]=l*m[2]+k*m[5]+j*m[8],i},u.transformQuat=function(P,O,N){var M=O[0],L=O[1],K=O[2],J=N[0],I=N[1],H=N[2],G=N[3],F=G*M+I*K-H*L,E=G*L+H*M-J*K,D=G*K+J*L-I*M,C=-J*M-I*L-H*K;return P[0]=F*G+C*-J+E*-H-D*-I,P[1]=E*G+C*-I+D*-J-F*-H,P[2]=D*G+C*-H+F*-I-E*-J,P},u.rotateX=function(i,h,m,l){var k=[],j=[];return k[0]=h[0]-m[0],k[1]=h[1]-m[1],k[2]=h[2]-m[2],j[0]=k[0],j[1]=k[1]*Math.cos(l)-k[2]*Math.sin(l),j[2]=k[1]*Math.sin(l)+k[2]*Math.cos(l),i[0]=j[0]+m[0],i[1]=j[1]+m[1],i[2]=j[2]+m[2],i},u.rotateY=function(i,h,m,l){var k=[],j=[];return k[0]=h[0]-m[0],k[1]=h[1]-m[1],k[2]=h[2]-m[2],j[0]=k[2]*Math.sin(l)+k[0]*Math.cos(l),j[1]=k[1],j[2]=k[2]*Math.cos(l)-k[0]*Math.sin(l),i[0]=j[0]+m[0],i[1]=j[1]+m[1],i[2]=j[2]+m[2],i},u.rotateZ=function(i,h,m,l){var k=[],j=[];return k[0]=h[0]-m[0],k[1]=h[1]-m[1],k[2]=h[2]-m[2],j[0]=k[0]*Math.cos(l)-k[1]*Math.sin(l),j[1]=k[0]*Math.sin(l)+k[1]*Math.cos(l),j[2]=k[2],i[0]=j[0]+m[0],i[1]=j[1]+m[1],i[2]=j[2]+m[2],i},u.forEach=function(){var b=u.create();return function(a,D,C,n,m,l){var k,j;for(D||(D=3),C||(C=0),j=n?Math.min(n*D+C,a.length):a.length,k=C;j>k;k+=D){b[0]=a[k],b[1]=a[k+1],b[2]=a[k+2],m(b,b,l),a[k]=b[0],a[k+1]=b[1],a[k+2]=b[2]}return a}}(),u.str=function(b){return"vec3("+b[0]+", "+b[1]+", "+b[2]+")"},"undefined"!=typeof B&&(B.vec3=u);var t={};t.create=function(){var b=new z(4);return b[0]=0,b[1]=0,b[2]=0,b[3]=0,b},t.clone=function(i){var h=new z(4);return h[0]=i[0],h[1]=i[1],h[2]=i[2],h[3]=i[3],h},t.fromValues=function(i,h,l,k){var j=new z(4);return j[0]=i,j[1]=h,j[2]=l,j[3]=k,j},t.copy=function(i,h){return i[0]=h[0],i[1]=h[1],i[2]=h[2],i[3]=h[3],i},t.set=function(i,h,l,k,j){return i[0]=h,i[1]=l,i[2]=k,i[3]=j,i},t.add=function(i,h,j){return i[0]=h[0]+j[0],i[1]=h[1]+j[1],i[2]=h[2]+j[2],i[3]=h[3]+j[3],i},t.subtract=function(i,h,j){return i[0]=h[0]-j[0],i[1]=h[1]-j[1],i[2]=h[2]-j[2],i[3]=h[3]-j[3],i},t.sub=t.subtract,t.multiply=function(i,h,j){return i[0]=h[0]*j[0],i[1]=h[1]*j[1],i[2]=h[2]*j[2],i[3]=h[3]*j[3],i},t.mul=t.multiply,t.divide=function(i,h,j){return i[0]=h[0]/j[0],i[1]=h[1]/j[1],i[2]=h[2]/j[2],i[3]=h[3]/j[3],i},t.div=t.divide,t.min=function(i,h,j){return i[0]=Math.min(h[0],j[0]),i[1]=Math.min(h[1],j[1]),i[2]=Math.min(h[2],j[2]),i[3]=Math.min(h[3],j[3]),i},t.max=function(i,h,j){return i[0]=Math.max(h[0],j[0]),i[1]=Math.max(h[1],j[1]),i[2]=Math.max(h[2],j[2]),i[3]=Math.max(h[3],j[3]),i},t.scale=function(i,h,j){return i[0]=h[0]*j,i[1]=h[1]*j,i[2]=h[2]*j,i[3]=h[3]*j,i},t.scaleAndAdd=function(i,h,k,j){return i[0]=h[0]+k[0]*j,i[1]=h[1]+k[1]*j,i[2]=h[2]+k[2]*j,i[3]=h[3]+k[3]*j,i},t.distance=function(i,h){var m=h[0]-i[0],l=h[1]-i[1],k=h[2]-i[2],j=h[3]-i[3];return Math.sqrt(m*m+l*l+k*k+j*j)},t.dist=t.distance,t.squaredDistance=function(i,h){var m=h[0]-i[0],l=h[1]-i[1],k=h[2]-i[2],j=h[3]-i[3];return m*m+l*l+k*k+j*j},t.sqrDist=t.squaredDistance,t.length=function(i){var h=i[0],l=i[1],k=i[2],j=i[3];return Math.sqrt(h*h+l*l+k*k+j*j)},t.len=t.length,t.squaredLength=function(i){var h=i[0],l=i[1],k=i[2],j=i[3];return h*h+l*l+k*k+j*j},t.sqrLen=t.squaredLength,t.negate=function(i,h){return i[0]=-h[0],i[1]=-h[1],i[2]=-h[2],i[3]=-h[3],i},t.normalize=function(i,h){var n=h[0],m=h[1],l=h[2],k=h[3],j=n*n+m*m+l*l+k*k;return j>0&&(j=1/Math.sqrt(j),i[0]=h[0]*j,i[1]=h[1]*j,i[2]=h[2]*j,i[3]=h[3]*j),i},t.dot=function(i,h){return i[0]*h[0]+i[1]*h[1]+i[2]*h[2]+i[3]*h[3]},t.lerp=function(j,i,D,C){var n=i[0],m=i[1],l=i[2],k=i[3];return j[0]=n+C*(D[0]-n),j[1]=m+C*(D[1]-m),j[2]=l+C*(D[2]-l),j[3]=k+C*(D[3]-k),j},t.random=function(i,h){return h=h||1,i[0]=y(),i[1]=y(),i[2]=y(),i[3]=y(),t.normalize(i,i),t.scale(i,i,h),i},t.transformMat4=function(i,h,n){var m=h[0],l=h[1],k=h[2],j=h[3];return i[0]=n[0]*m+n[4]*l+n[8]*k+n[12]*j,i[1]=n[1]*m+n[5]*l+n[9]*k+n[13]*j,i[2]=n[2]*m+n[6]*l+n[10]*k+n[14]*j,i[3]=n[3]*m+n[7]*l+n[11]*k+n[15]*j,i},t.transformQuat=function(P,O,N){var M=O[0],L=O[1],K=O[2],J=N[0],I=N[1],H=N[2],G=N[3],F=G*M+I*K-H*L,E=G*L+H*M-J*K,D=G*K+J*L-I*M,C=-J*M-I*L-H*K;return P[0]=F*G+C*-J+E*-H-D*-I,P[1]=E*G+C*-I+D*-J-F*-H,P[2]=D*G+C*-H+F*-I-E*-J,P},t.forEach=function(){var b=t.create();return function(a,D,C,n,m,l){var k,j;for(D||(D=4),C||(C=0),j=n?Math.min(n*D+C,a.length):a.length,k=C;j>k;k+=D){b[0]=a[k],b[1]=a[k+1],b[2]=a[k+2],b[3]=a[k+3],m(b,b,l),a[k]=b[0],a[k+1]=b[1],a[k+2]=b[2],a[k+3]=b[3]}return a}}(),t.str=function(b){return"vec4("+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+")"},"undefined"!=typeof B&&(B.vec4=t);var s={};s.create=function(){var b=new z(4);return b[0]=1,b[1]=0,b[2]=0,b[3]=1,b},s.clone=function(i){var h=new z(4);return h[0]=i[0],h[1]=i[1],h[2]=i[2],h[3]=i[3],h},s.copy=function(i,h){return i[0]=h[0],i[1]=h[1],i[2]=h[2],i[3]=h[3],i},s.identity=function(b){return b[0]=1,b[1]=0,b[2]=0,b[3]=1,b},s.transpose=function(i,h){if(i===h){var j=h[1];i[1]=h[2],i[2]=j}else{i[0]=h[0],i[1]=h[2],i[2]=h[1],i[3]=h[3]}return i},s.invert=function(i,h){var n=h[0],m=h[1],l=h[2],k=h[3],j=n*k-l*m;return j?(j=1/j,i[0]=k*j,i[1]=-m*j,i[2]=-l*j,i[3]=n*j,i):null},s.adjoint=function(i,h){var j=h[0];return i[0]=h[3],i[1]=-h[1],i[2]=-h[2],i[3]=j,i},s.determinant=function(b){return b[0]*b[3]-b[2]*b[1]},s.multiply=function(J,I,H){var G=I[0],F=I[1],E=I[2],D=I[3],C=H[0],n=H[1],m=H[2],l=H[3];return J[0]=G*C+E*n,J[1]=F*C+D*n,J[2]=G*m+E*l,J[3]=F*m+D*l,J},s.mul=s.multiply,s.rotate=function(F,E,D){var C=E[0],n=E[1],m=E[2],l=E[3],k=Math.sin(D),j=Math.cos(D);return F[0]=C*j+m*k,F[1]=n*j+l*k,F[2]=C*-k+m*j,F[3]=n*-k+l*j,F},s.scale=function(F,E,D){var C=E[0],n=E[1],m=E[2],l=E[3],k=D[0],j=D[1];return F[0]=C*k,F[1]=n*k,F[2]=m*j,F[3]=l*j,F},s.str=function(b){return"mat2("+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+")"},s.frob=function(b){return Math.sqrt(Math.pow(b[0],2)+Math.pow(b[1],2)+Math.pow(b[2],2)+Math.pow(b[3],2))},s.LDU=function(i,h,k,j){return i[2]=j[2]/j[0],k[0]=j[0],k[1]=j[1],k[3]=j[3]-i[2]*k[1],[i,h,k]},"undefined"!=typeof B&&(B.mat2=s);var r={};r.create=function(){var b=new z(6);return b[0]=1,b[1]=0,b[2]=0,b[3]=1,b[4]=0,b[5]=0,b},r.clone=function(i){var h=new z(6);return h[0]=i[0],h[1]=i[1],h[2]=i[2],h[3]=i[3],h[4]=i[4],h[5]=i[5],h},r.copy=function(i,h){return i[0]=h[0],i[1]=h[1],i[2]=h[2],i[3]=h[3],i[4]=h[4],i[5]=h[5],i},r.identity=function(b){return b[0]=1,b[1]=0,b[2]=0,b[3]=1,b[4]=0,b[5]=0,b},r.invert=function(F,E){var D=E[0],C=E[1],n=E[2],m=E[3],l=E[4],k=E[5],j=D*m-C*n;return j?(j=1/j,F[0]=m*j,F[1]=-C*j,F[2]=-n*j,F[3]=D*j,F[4]=(n*k-m*l)*j,F[5]=(C*l-D*k)*j,F):null},r.determinant=function(b){return b[0]*b[3]-b[1]*b[2]},r.multiply=function(Q,P,O){var N=P[0],M=P[1],L=P[2],K=P[3],J=P[4],I=P[5],H=O[0],G=O[1],F=O[2],E=O[3],D=O[4],C=O[5];return Q[0]=N*H+L*G,Q[1]=M*H+K*G,Q[2]=N*F+L*E,Q[3]=M*F+K*E,Q[4]=N*D+L*C+J,Q[5]=M*D+K*C+I,Q},r.mul=r.multiply,r.rotate=function(J,I,H){var G=I[0],F=I[1],E=I[2],D=I[3],C=I[4],n=I[5],m=Math.sin(H),l=Math.cos(H);return J[0]=G*l+E*m,J[1]=F*l+D*m,J[2]=G*-m+E*l,J[3]=F*-m+D*l,J[4]=C,J[5]=n,J},r.scale=function(J,I,H){var G=I[0],F=I[1],E=I[2],D=I[3],C=I[4],n=I[5],m=H[0],l=H[1];return J[0]=G*m,J[1]=F*m,J[2]=E*l,J[3]=D*l,J[4]=C,J[5]=n,J},r.translate=function(J,I,H){var G=I[0],F=I[1],E=I[2],D=I[3],C=I[4],n=I[5],m=H[0],l=H[1];return J[0]=G,J[1]=F,J[2]=E,J[3]=D,J[4]=G*m+E*l+C,J[5]=F*m+D*l+n,J},r.str=function(b){return"mat2d("+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+", "+b[4]+", "+b[5]+")"},r.frob=function(b){return Math.sqrt(Math.pow(b[0],2)+Math.pow(b[1],2)+Math.pow(b[2],2)+Math.pow(b[3],2)+Math.pow(b[4],2)+Math.pow(b[5],2)+1)},"undefined"!=typeof B&&(B.mat2d=r);var q={};q.create=function(){var b=new z(9);return b[0]=1,b[1]=0,b[2]=0,b[3]=0,b[4]=1,b[5]=0,b[6]=0,b[7]=0,b[8]=1,b},q.fromMat4=function(i,h){return i[0]=h[0],i[1]=h[1],i[2]=h[2],i[3]=h[4],i[4]=h[5],i[5]=h[6],i[6]=h[8],i[7]=h[9],i[8]=h[10],i},q.clone=function(i){var h=new z(9);return h[0]=i[0],h[1]=i[1],h[2]=i[2],h[3]=i[3],h[4]=i[4],h[5]=i[5],h[6]=i[6],h[7]=i[7],h[8]=i[8],h},q.copy=function(i,h){return i[0]=h[0],i[1]=h[1],i[2]=h[2],i[3]=h[3],i[4]=h[4],i[5]=h[5],i[6]=h[6],i[7]=h[7],i[8]=h[8],i},q.identity=function(b){return b[0]=1,b[1]=0,b[2]=0,b[3]=0,b[4]=1,b[5]=0,b[6]=0,b[7]=0,b[8]=1,b},q.transpose=function(i,h){if(i===h){var l=h[1],k=h[2],j=h[5];i[1]=h[3],i[2]=h[6],i[3]=l,i[5]=h[7],i[6]=k,i[7]=j}else{i[0]=h[0],i[1]=h[3],i[2]=h[6],i[3]=h[1],i[4]=h[4],i[5]=h[7],i[6]=h[2],i[7]=h[5],i[8]=h[8]}return i},q.invert=function(Q,P){var O=P[0],N=P[1],M=P[2],L=P[3],K=P[4],J=P[5],I=P[6],H=P[7],G=P[8],F=G*K-J*H,E=-G*L+J*I,D=H*L-K*I,C=O*F+N*E+M*D;return C?(C=1/C,Q[0]=F*C,Q[1]=(-G*N+M*H)*C,Q[2]=(J*N-M*K)*C,Q[3]=E*C,Q[4]=(G*O-M*I)*C,Q[5]=(-J*O+M*L)*C,Q[6]=D*C,Q[7]=(-H*O+N*I)*C,Q[8]=(K*O-N*L)*C,Q):null},q.adjoint=function(J,I){var H=I[0],G=I[1],F=I[2],E=I[3],D=I[4],C=I[5],n=I[6],m=I[7],l=I[8];return J[0]=D*l-C*m,J[1]=F*m-G*l,J[2]=G*C-F*D,J[3]=C*n-E*l,J[4]=H*l-F*n,J[5]=F*E-H*C,J[6]=E*m-D*n,J[7]=G*n-H*m,J[8]=H*D-G*E,J},q.determinant=function(H){var G=H[0],F=H[1],E=H[2],D=H[3],C=H[4],n=H[5],m=H[6],l=H[7],k=H[8];return G*(k*C-n*l)+F*(-k*D+n*m)+E*(l*D-C*m)},q.multiply=function(W,V,U){var T=V[0],S=V[1],R=V[2],Q=V[3],P=V[4],O=V[5],N=V[6],M=V[7],L=V[8],K=U[0],J=U[1],I=U[2],H=U[3],G=U[4],F=U[5],E=U[6],D=U[7],C=U[8];return W[0]=K*T+J*Q+I*N,W[1]=K*S+J*P+I*M,W[2]=K*R+J*O+I*L,W[3]=H*T+G*Q+F*N,W[4]=H*S+G*P+F*M,W[5]=H*R+G*O+F*L,W[6]=E*T+D*Q+C*N,W[7]=E*S+D*P+C*M,W[8]=E*R+D*O+C*L,W},q.mul=q.multiply,q.translate=function(P,O,N){var M=O[0],L=O[1],K=O[2],J=O[3],I=O[4],H=O[5],G=O[6],F=O[7],E=O[8],D=N[0],C=N[1];return P[0]=M,P[1]=L,P[2]=K,P[3]=J,P[4]=I,P[5]=H,P[6]=D*M+C*J+G,P[7]=D*L+C*I+F,P[8]=D*K+C*H+E,P},q.rotate=function(P,O,N){var M=O[0],L=O[1],K=O[2],J=O[3],I=O[4],H=O[5],G=O[6],F=O[7],E=O[8],D=Math.sin(N),C=Math.cos(N);return P[0]=C*M+D*J,P[1]=C*L+D*I,P[2]=C*K+D*H,P[3]=C*J-D*M,P[4]=C*I-D*L,P[5]=C*H-D*K,P[6]=G,P[7]=F,P[8]=E,P},q.scale=function(i,h,l){var k=l[0],j=l[1];return i[0]=k*h[0],i[1]=k*h[1],i[2]=k*h[2],i[3]=j*h[3],i[4]=j*h[4],i[5]=j*h[5],i[6]=h[6],i[7]=h[7],i[8]=h[8],i},q.fromMat2d=function(i,h){return i[0]=h[0],i[1]=h[1],i[2]=0,i[3]=h[2],i[4]=h[3],i[5]=0,i[6]=h[4],i[7]=h[5],i[8]=1,i},q.fromQuat=function(T,S){var R=S[0],Q=S[1],P=S[2],O=S[3],N=R+R,M=Q+Q,L=P+P,K=R*N,J=Q*N,I=Q*M,H=P*N,G=P*M,F=P*L,E=O*N,D=O*M,C=O*L;return T[0]=1-I-F,T[3]=J-C,T[6]=H+D,T[1]=J+C,T[4]=1-K-F,T[7]=G-E,T[2]=H-D,T[5]=G+E,T[8]=1-K-I,T},q.normalFromMat4=function(aj,ai){var ah=ai[0],ag=ai[1],af=ai[2],ae=ai[3],ad=ai[4],ac=ai[5],ab=ai[6],aa=ai[7],Z=ai[8],Y=ai[9],X=ai[10],W=ai[11],V=ai[12],U=ai[13],S=ai[14],Q=ai[15],O=ah*ac-ag*ad,M=ah*ab-af*ad,K=ah*aa-ae*ad,J=ag*ab-af*ac,I=ag*aa-ae*ac,H=af*aa-ae*ab,G=Z*U-Y*V,F=Z*S-X*V,T=Z*Q-W*V,R=Y*S-X*U,P=Y*Q-W*U,N=X*Q-W*S,L=O*N-M*P+K*R+J*T-I*F+H*G;return L?(L=1/L,aj[0]=(ac*N-ab*P+aa*R)*L,aj[1]=(ab*T-ad*N-aa*F)*L,aj[2]=(ad*P-ac*T+aa*G)*L,aj[3]=(af*P-ag*N-ae*R)*L,aj[4]=(ah*N-af*T+ae*F)*L,aj[5]=(ag*T-ah*P-ae*G)*L,aj[6]=(U*H-S*I+Q*J)*L,aj[7]=(S*K-V*H-Q*M)*L,aj[8]=(V*I-U*K+Q*O)*L,aj):null},q.str=function(b){return"mat3("+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+", "+b[4]+", "+b[5]+", "+b[6]+", "+b[7]+", "+b[8]+")"},q.frob=function(b){return Math.sqrt(Math.pow(b[0],2)+Math.pow(b[1],2)+Math.pow(b[2],2)+Math.pow(b[3],2)+Math.pow(b[4],2)+Math.pow(b[5],2)+Math.pow(b[6],2)+Math.pow(b[7],2)+Math.pow(b[8],2))},"undefined"!=typeof B&&(B.mat3=q);var p={};p.create=function(){var b=new z(16);return b[0]=1,b[1]=0,b[2]=0,b[3]=0,b[4]=0,b[5]=1,b[6]=0,b[7]=0,b[8]=0,b[9]=0,b[10]=1,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,b},p.clone=function(i){var h=new z(16);return h[0]=i[0],h[1]=i[1],h[2]=i[2],h[3]=i[3],h[4]=i[4],h[5]=i[5],h[6]=i[6],h[7]=i[7],h[8]=i[8],h[9]=i[9],h[10]=i[10],h[11]=i[11],h[12]=i[12],h[13]=i[13],h[14]=i[14],h[15]=i[15],h},p.copy=function(i,h){return i[0]=h[0],i[1]=h[1],i[2]=h[2],i[3]=h[3],i[4]=h[4],i[5]=h[5],i[6]=h[6],i[7]=h[7],i[8]=h[8],i[9]=h[9],i[10]=h[10],i[11]=h[11],i[12]=h[12],i[13]=h[13],i[14]=h[14],i[15]=h[15],i},p.identity=function(b){return b[0]=1,b[1]=0,b[2]=0,b[3]=0,b[4]=0,b[5]=1,b[6]=0,b[7]=0,b[8]=0,b[9]=0,b[10]=1,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,b},p.transpose=function(j,i){if(j===i){var D=i[1],C=i[2],n=i[3],m=i[6],l=i[7],k=i[11];j[1]=i[4],j[2]=i[8],j[3]=i[12],j[4]=D,j[6]=i[9],j[7]=i[13],j[8]=C,j[9]=m,j[11]=i[14],j[12]=n,j[13]=l,j[14]=k}else{j[0]=i[0],j[1]=i[4],j[2]=i[8],j[3]=i[12],j[4]=i[1],j[5]=i[5],j[6]=i[9],j[7]=i[13],j[8]=i[2],j[9]=i[6],j[10]=i[10],j[11]=i[14],j[12]=i[3],j[13]=i[7],j[14]=i[11],j[15]=i[15]}return j},p.invert=function(aj,ai){var ah=ai[0],ag=ai[1],af=ai[2],ae=ai[3],ad=ai[4],ac=ai[5],ab=ai[6],aa=ai[7],Z=ai[8],Y=ai[9],X=ai[10],W=ai[11],V=ai[12],U=ai[13],S=ai[14],Q=ai[15],O=ah*ac-ag*ad,M=ah*ab-af*ad,K=ah*aa-ae*ad,J=ag*ab-af*ac,I=ag*aa-ae*ac,H=af*aa-ae*ab,G=Z*U-Y*V,F=Z*S-X*V,T=Z*Q-W*V,R=Y*S-X*U,P=Y*Q-W*U,N=X*Q-W*S,L=O*N-M*P+K*R+J*T-I*F+H*G;return L?(L=1/L,aj[0]=(ac*N-ab*P+aa*R)*L,aj[1]=(af*P-ag*N-ae*R)*L,aj[2]=(U*H-S*I+Q*J)*L,aj[3]=(X*I-Y*H-W*J)*L,aj[4]=(ab*T-ad*N-aa*F)*L,aj[5]=(ah*N-af*T+ae*F)*L,aj[6]=(S*K-V*H-Q*M)*L,aj[7]=(Z*H-X*K+W*M)*L,aj[8]=(ad*P-ac*T+aa*G)*L,aj[9]=(ag*T-ah*P-ae*G)*L,aj[10]=(V*I-U*K+Q*O)*L,aj[11]=(Y*K-Z*I-W*O)*L,aj[12]=(ac*F-ad*R-ab*G)*L,aj[13]=(ah*R-ag*F+af*G)*L,aj[14]=(U*M-V*J-S*O)*L,aj[15]=(Z*J-Y*M+X*O)*L,aj):null},p.adjoint=function(T,S){var R=S[0],Q=S[1],P=S[2],O=S[3],N=S[4],M=S[5],L=S[6],K=S[7],J=S[8],I=S[9],H=S[10],G=S[11],F=S[12],E=S[13],D=S[14],C=S[15];return T[0]=M*(H*C-G*D)-I*(L*C-K*D)+E*(L*G-K*H),T[1]=-(Q*(H*C-G*D)-I*(P*C-O*D)+E*(P*G-O*H)),T[2]=Q*(L*C-K*D)-M*(P*C-O*D)+E*(P*K-O*L),T[3]=-(Q*(L*G-K*H)-M*(P*G-O*H)+I*(P*K-O*L)),T[4]=-(N*(H*C-G*D)-J*(L*C-K*D)+F*(L*G-K*H)),T[5]=R*(H*C-G*D)-J*(P*C-O*D)+F*(P*G-O*H),T[6]=-(R*(L*C-K*D)-N*(P*C-O*D)+F*(P*K-O*L)),T[7]=R*(L*G-K*H)-N*(P*G-O*H)+J*(P*K-O*L),T[8]=N*(I*C-G*E)-J*(M*C-K*E)+F*(M*G-K*I),T[9]=-(R*(I*C-G*E)-J*(Q*C-O*E)+F*(Q*G-O*I)),T[10]=R*(M*C-K*E)-N*(Q*C-O*E)+F*(Q*K-O*M),T[11]=-(R*(M*G-K*I)-N*(Q*G-O*I)+J*(Q*K-O*M)),T[12]=-(N*(I*D-H*E)-J*(M*D-L*E)+F*(M*H-L*I)),T[13]=R*(I*D-H*E)-J*(Q*D-P*E)+F*(Q*H-P*I),T[14]=-(R*(M*D-L*E)-N*(Q*D-P*E)+F*(Q*L-P*M)),T[15]=R*(M*H-L*I)-N*(Q*H-P*I)+J*(Q*L-P*M),T},p.determinant=function(af){var ae=af[0],ad=af[1],ac=af[2],ab=af[3],aa=af[4],Z=af[5],Y=af[6],X=af[7],W=af[8],V=af[9],U=af[10],T=af[11],S=af[12],R=af[13],Q=af[14],O=af[15],M=ae*Z-ad*aa,K=ae*Y-ac*aa,J=ae*X-ab*aa,I=ad*Y-ac*Z,H=ad*X-ab*Z,G=ac*X-ab*Y,F=W*R-V*S,E=W*Q-U*S,D=W*O-T*S,P=V*Q-U*R,N=V*O-T*R,L=U*O-T*Q;return M*L-K*N+J*P+I*D-H*E+G*F},p.multiply=function(Y,X,W){var V=X[0],U=X[1],T=X[2],S=X[3],R=X[4],Q=X[5],P=X[6],O=X[7],N=X[8],M=X[9],L=X[10],K=X[11],J=X[12],I=X[13],H=X[14],G=X[15],F=W[0],E=W[1],D=W[2],C=W[3];return Y[0]=F*V+E*R+D*N+C*J,Y[1]=F*U+E*Q+D*M+C*I,Y[2]=F*T+E*P+D*L+C*H,Y[3]=F*S+E*O+D*K+C*G,F=W[4],E=W[5],D=W[6],C=W[7],Y[4]=F*V+E*R+D*N+C*J,Y[5]=F*U+E*Q+D*M+C*I,Y[6]=F*T+E*P+D*L+C*H,Y[7]=F*S+E*O+D*K+C*G,F=W[8],E=W[9],D=W[10],C=W[11],Y[8]=F*V+E*R+D*N+C*J,Y[9]=F*U+E*Q+D*M+C*I,Y[10]=F*T+E*P+D*L+C*H,Y[11]=F*S+E*O+D*K+C*G,F=W[12],E=W[13],D=W[14],C=W[15],Y[12]=F*V+E*R+D*N+C*J,Y[13]=F*U+E*Q+D*M+C*I,Y[14]=F*T+E*P+D*L+C*H,Y[15]=F*S+E*O+D*K+C*G,Y},p.mul=p.multiply,p.translate=function(T,S,R){var Q,P,O,N,M,L,K,J,I,H,G,F,E=R[0],D=R[1],C=R[2];return S===T?(T[12]=S[0]*E+S[4]*D+S[8]*C+S[12],T[13]=S[1]*E+S[5]*D+S[9]*C+S[13],T[14]=S[2]*E+S[6]*D+S[10]*C+S[14],T[15]=S[3]*E+S[7]*D+S[11]*C+S[15]):(Q=S[0],P=S[1],O=S[2],N=S[3],M=S[4],L=S[5],K=S[6],J=S[7],I=S[8],H=S[9],G=S[10],F=S[11],T[0]=Q,T[1]=P,T[2]=O,T[3]=N,T[4]=M,T[5]=L,T[6]=K,T[7]=J,T[8]=I,T[9]=H,T[10]=G,T[11]=F,T[12]=Q*E+M*D+I*C+S[12],T[13]=P*E+L*D+H*C+S[13],T[14]=O*E+K*D+G*C+S[14],T[15]=N*E+J*D+F*C+S[15]),T},p.scale=function(i,h,m){var l=m[0],k=m[1],j=m[2];return i[0]=h[0]*l,i[1]=h[1]*l,i[2]=h[2]*l,i[3]=h[3]*l,i[4]=h[4]*k,i[5]=h[5]*k,i[6]=h[6]*k,i[7]=h[7]*k,i[8]=h[8]*j,i[9]=h[9]*j,i[10]=h[10]*j,i[11]=h[11]*j,i[12]=h[12],i[13]=h[13],i[14]=h[14],i[15]=h[15],i},p.rotate=function(al,ak,aj,ai){var ah,ag,af,ae,ad,ac,ab,aa,Z,Y,X,V,T,R,P,N,L,J,I,H,b,W,U,S,Q=ai[0],O=ai[1],M=ai[2],K=Math.sqrt(Q*Q+O*O+M*M);return Math.abs(K)<A?null:(K=1/K,Q*=K,O*=K,M*=K,ah=Math.sin(aj),ag=Math.cos(aj),af=1-ag,ae=ak[0],ad=ak[1],ac=ak[2],ab=ak[3],aa=ak[4],Z=ak[5],Y=ak[6],X=ak[7],V=ak[8],T=ak[9],R=ak[10],P=ak[11],N=Q*Q*af+ag,L=O*Q*af+M*ah,J=M*Q*af-O*ah,I=Q*O*af-M*ah,H=O*O*af+ag,b=M*O*af+Q*ah,W=Q*M*af+O*ah,U=O*M*af-Q*ah,S=M*M*af+ag,al[0]=ae*N+aa*L+V*J,al[1]=ad*N+Z*L+T*J,al[2]=ac*N+Y*L+R*J,al[3]=ab*N+X*L+P*J,al[4]=ae*I+aa*H+V*b,al[5]=ad*I+Z*H+T*b,al[6]=ac*I+Y*H+R*b,al[7]=ab*I+X*H+P*b,al[8]=ae*W+aa*U+V*S,al[9]=ad*W+Z*U+T*S,al[10]=ac*W+Y*U+R*S,al[11]=ab*W+X*U+P*S,ak!==al&&(al[12]=ak[12],al[13]=ak[13],al[14]=ak[14],al[15]=ak[15]),al)},p.rotateX=function(N,M,L){var K=Math.sin(L),J=Math.cos(L),I=M[4],H=M[5],G=M[6],F=M[7],E=M[8],D=M[9],C=M[10],n=M[11];return M!==N&&(N[0]=M[0],N[1]=M[1],N[2]=M[2],N[3]=M[3],N[12]=M[12],N[13]=M[13],N[14]=M[14],N[15]=M[15]),N[4]=I*J+E*K,N[5]=H*J+D*K,N[6]=G*J+C*K,N[7]=F*J+n*K,N[8]=E*J-I*K,N[9]=D*J-H*K,N[10]=C*J-G*K,N[11]=n*J-F*K,N},p.rotateY=function(N,M,L){var K=Math.sin(L),J=Math.cos(L),I=M[0],H=M[1],G=M[2],F=M[3],E=M[8],D=M[9],C=M[10],n=M[11];return M!==N&&(N[4]=M[4],N[5]=M[5],N[6]=M[6],N[7]=M[7],N[12]=M[12],N[13]=M[13],N[14]=M[14],N[15]=M[15]),N[0]=I*J-E*K,N[1]=H*J-D*K,N[2]=G*J-C*K,N[3]=F*J-n*K,N[8]=I*K+E*J,N[9]=H*K+D*J,N[10]=G*K+C*J,N[11]=F*K+n*J,N},p.rotateZ=function(N,M,L){var K=Math.sin(L),J=Math.cos(L),I=M[0],H=M[1],G=M[2],F=M[3],E=M[4],D=M[5],C=M[6],n=M[7];return M!==N&&(N[8]=M[8],N[9]=M[9],N[10]=M[10],N[11]=M[11],N[12]=M[12],N[13]=M[13],N[14]=M[14],N[15]=M[15]),N[0]=I*J+E*K,N[1]=H*J+D*K,N[2]=G*J+C*K,N[3]=F*J+n*K,N[4]=E*J-I*K,N[5]=D*J-H*K,N[6]=C*J-G*K,N[7]=n*J-F*K,N},p.fromRotationTranslation=function(U,T,S){var R=T[0],Q=T[1],P=T[2],O=T[3],N=R+R,M=Q+Q,L=P+P,K=R*N,J=R*M,I=R*L,H=Q*M,G=Q*L,F=P*L,E=O*N,D=O*M,C=O*L;return U[0]=1-(H+F),U[1]=J+C,U[2]=I-D,U[3]=0,U[4]=J-C,U[5]=1-(K+F),U[6]=G+E,U[7]=0,U[8]=I+D,U[9]=G-E,U[10]=1-(K+H),U[11]=0,U[12]=S[0],U[13]=S[1],U[14]=S[2],U[15]=1,U},p.fromQuat=function(T,S){var R=S[0],Q=S[1],P=S[2],O=S[3],N=R+R,M=Q+Q,L=P+P,K=R*N,J=Q*N,I=Q*M,H=P*N,G=P*M,F=P*L,E=O*N,D=O*M,C=O*L;return T[0]=1-I-F,T[1]=J+C,T[2]=H-D,T[3]=0,T[4]=J-C,T[5]=1-K-F,T[6]=G+E,T[7]=0,T[8]=H+D,T[9]=G-E,T[10]=1-K-I,T[11]=0,T[12]=0,T[13]=0,T[14]=0,T[15]=1,T},p.frustum=function(H,G,F,E,D,C,n){var m=1/(F-G),l=1/(D-E),k=1/(C-n);return H[0]=2*C*m,H[1]=0,H[2]=0,H[3]=0,H[4]=0,H[5]=2*C*l,H[6]=0,H[7]=0,H[8]=(F+G)*m,H[9]=(D+E)*l,H[10]=(n+C)*k,H[11]=-1,H[12]=0,H[13]=0,H[14]=n*C*2*k,H[15]=0,H},p.perspective=function(i,h,n,m,l){var k=1/Math.tan(h/2),j=1/(m-l);return i[0]=k/n,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=k,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=(l+m)*j,i[11]=-1,i[12]=0,i[13]=0,i[14]=2*l*m*j,i[15]=0,i},p.ortho=function(H,G,F,E,D,C,n){var m=1/(G-F),l=1/(E-D),k=1/(C-n);return H[0]=-2*m,H[1]=0,H[2]=0,H[3]=0,H[4]=0,H[5]=-2*l,H[6]=0,H[7]=0,H[8]=0,H[9]=0,H[10]=2*k,H[11]=0,H[12]=(G+F)*m,H[13]=(D+E)*l,H[14]=(n+C)*k,H[15]=1,H},p.lookAt=function(W,V,U,T){var S,R,Q,P,O,N,M,L,K,J,I=V[0],H=V[1],G=V[2],F=T[0],E=T[1],D=T[2],C=U[0],m=U[1],b=U[2];return Math.abs(I-C)<A&&Math.abs(H-m)<A&&Math.abs(G-b)<A?p.identity(W):(M=I-C,L=H-m,K=G-b,J=1/Math.sqrt(M*M+L*L+K*K),M*=J,L*=J,K*=J,S=E*K-D*L,R=D*M-F*K,Q=F*L-E*M,J=Math.sqrt(S*S+R*R+Q*Q),J?(J=1/J,S*=J,R*=J,Q*=J):(S=0,R=0,Q=0),P=L*Q-K*R,O=K*S-M*Q,N=M*R-L*S,J=Math.sqrt(P*P+O*O+N*N),J?(J=1/J,P*=J,O*=J,N*=J):(P=0,O=0,N=0),W[0]=S,W[1]=P,W[2]=M,W[3]=0,W[4]=R,W[5]=O,W[6]=L,W[7]=0,W[8]=Q,W[9]=N,W[10]=K,W[11]=0,W[12]=-(S*I+R*H+Q*G),W[13]=-(P*I+O*H+N*G),W[14]=-(M*I+L*H+K*G),W[15]=1,W)},p.str=function(b){return"mat4("+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+", "+b[4]+", "+b[5]+", "+b[6]+", "+b[7]+", "+b[8]+", "+b[9]+", "+b[10]+", "+b[11]+", "+b[12]+", "+b[13]+", "+b[14]+", "+b[15]+")"},p.frob=function(b){return Math.sqrt(Math.pow(b[0],2)+Math.pow(b[1],2)+Math.pow(b[2],2)+Math.pow(b[3],2)+Math.pow(b[4],2)+Math.pow(b[5],2)+Math.pow(b[6],2)+Math.pow(b[6],2)+Math.pow(b[7],2)+Math.pow(b[8],2)+Math.pow(b[9],2)+Math.pow(b[10],2)+Math.pow(b[11],2)+Math.pow(b[12],2)+Math.pow(b[13],2)+Math.pow(b[14],2)+Math.pow(b[15],2))},"undefined"!=typeof B&&(B.mat4=p);var o={};o.create=function(){var b=new z(4);return b[0]=0,b[1]=0,b[2]=0,b[3]=1,b},o.rotationTo=function(){var i=u.create(),h=u.fromValues(1,0,0),j=u.fromValues(0,1,0);return function(l,k,b){var a=u.dot(k,b);return -0.999999>a?(u.cross(i,h,k),u.length(i)<0.000001&&u.cross(i,j,k),u.normalize(i,i),o.setAxisAngle(l,i,Math.PI),l):a>0.999999?(l[0]=0,l[1]=0,l[2]=0,l[3]=1,l):(u.cross(i,k,b),l[0]=i[0],l[1]=i[1],l[2]=i[2],l[3]=1+a,o.normalize(l,l))}}(),o.setAxes=function(){var b=q.create();return function(a,j,i,h){return b[0]=i[0],b[3]=i[1],b[6]=i[2],b[1]=h[0],b[4]=h[1],b[7]=h[2],b[2]=-j[0],b[5]=-j[1],b[8]=-j[2],o.normalize(a,o.fromMat3(a,b))}}(),o.clone=t.clone,o.fromValues=t.fromValues,o.copy=t.copy,o.set=t.set,o.identity=function(b){return b[0]=0,b[1]=0,b[2]=0,b[3]=1,b},o.setAxisAngle=function(i,h,k){k=0.5*k;var j=Math.sin(k);return i[0]=j*h[0],i[1]=j*h[1],i[2]=j*h[2],i[3]=Math.cos(k),i},o.add=t.add,o.multiply=function(J,I,H){var G=I[0],F=I[1],E=I[2],D=I[3],C=H[0],n=H[1],m=H[2],l=H[3];return J[0]=G*l+D*C+F*m-E*n,J[1]=F*l+D*n+E*C-G*m,J[2]=E*l+D*m+G*n-F*C,J[3]=D*l-G*C-F*n-E*m,J},o.mul=o.multiply,o.scale=t.scale,o.rotateX=function(F,E,D){D*=0.5;var C=E[0],n=E[1],m=E[2],l=E[3],k=Math.sin(D),j=Math.cos(D);return F[0]=C*j+l*k,F[1]=n*j+m*k,F[2]=m*j-n*k,F[3]=l*j-C*k,F},o.rotateY=function(F,E,D){D*=0.5;var C=E[0],n=E[1],m=E[2],l=E[3],k=Math.sin(D),j=Math.cos(D);return F[0]=C*j-m*k,F[1]=n*j+l*k,F[2]=m*j+C*k,F[3]=l*j-n*k,F},o.rotateZ=function(F,E,D){D*=0.5;var C=E[0],n=E[1],m=E[2],l=E[3],k=Math.sin(D),j=Math.cos(D);return F[0]=C*j+n*k,F[1]=n*j-C*k,F[2]=m*j+l*k,F[3]=l*j-m*k,F},o.calculateW=function(i,h){var l=h[0],k=h[1],j=h[2];return i[0]=l,i[1]=k,i[2]=j,i[3]=-Math.sqrt(Math.abs(1-l*l-k*k-j*j)),i},o.dot=t.dot,o.lerp=t.lerp,o.slerp=function(S,R,Q,P){var O,N,M,L,K,J=R[0],I=R[1],H=R[2],G=R[3],F=Q[0],E=Q[1],D=Q[2],C=Q[3];return N=J*F+I*E+H*D+G*C,0>N&&(N=-N,F=-F,E=-E,D=-D,C=-C),1-N>0.000001?(O=Math.acos(N),M=Math.sin(O),L=Math.sin((1-P)*O)/M,K=Math.sin(P*O)/M):(L=1-P,K=P),S[0]=L*J+K*F,S[1]=L*I+K*E,S[2]=L*H+K*D,S[3]=L*G+K*C,S},o.invert=function(j,i){var D=i[0],C=i[1],n=i[2],m=i[3],l=D*D+C*C+n*n+m*m,k=l?1/l:0;return j[0]=-D*k,j[1]=-C*k,j[2]=-n*k,j[3]=m*k,j},o.conjugate=function(i,h){return i[0]=-h[0],i[1]=-h[1],i[2]=-h[2],i[3]=h[3],i},o.length=t.length,o.len=o.length,o.squaredLength=t.squaredLength,o.sqrLen=o.squaredLength,o.normalize=t.normalize,o.fromMat3=function(i,h){var n,m=h[0]+h[4]+h[8];if(m>0){n=Math.sqrt(m+1),i[3]=0.5*n,n=0.5/n,i[0]=(h[7]-h[5])*n,i[1]=(h[2]-h[6])*n,i[2]=(h[3]-h[1])*n}else{var l=0;h[4]>h[0]&&(l=1),h[8]>h[3*l+l]&&(l=2);var k=(l+1)%3,j=(l+2)%3;n=Math.sqrt(h[3*l+l]-h[3*k+k]-h[3*j+j]+1),i[l]=0.5*n,n=0.5/n,i[3]=(h[3*j+k]-h[3*k+j])*n,i[k]=(h[3*k+l]+h[3*l+k])*n,i[j]=(h[3*j+l]+h[3*l+j])*n}return i},o.str=function(b){return"quat("+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+")"},"undefined"!=typeof B&&(B.quat=o)}(c.exports)}(this)},{}],24:[function(e,d,f){(function(){var ay=this,ax=ay._,aw={},av=Array.prototype,au=Object.prototype,at=Function.prototype,ar=av.push,aq=av.slice,ap=av.concat,ao=au.toString,an=au.hasOwnProperty,am=av.forEach,al=av.map,ak=av.reduce,aj=av.reduceRight,ai=av.filter,ah=av.every,ag=av.some,af=av.indexOf,ae=av.lastIndexOf,ad=Array.isArray,ac=Object.keys,ab=at.bind,aa=function(g){return g instanceof aa?g:this instanceof aa?void (this._wrapped=g):new aa(g)};"undefined"!=typeof f?("undefined"!=typeof d&&d.exports&&(f=d.exports=aa),f._=aa):ay._=aa,aa.VERSION="1.4.4";var Z=aa.each=aa.forEach=function(i,h,m){if(null!=i){if(am&&i.forEach===am){i.forEach(h,m)}else{if(i.length===+i.length){for(var l=0,k=i.length;k>l;l++){if(h.call(m,i[l],l,i)===aw){return}}}else{for(var j in i){if(aa.has(i,j)&&h.call(m,i[j],j,i)===aw){return}}}}}};aa.map=aa.collect=function(h,g,j){var i=[];return null==h?i:al&&h.map===al?h.map(g,j):(Z(h,function(k,m,l){i[i.length]=g.call(j,k,m,l)}),i)};var Y="Reduce of empty array with no initial value";aa.reduce=aa.foldl=aa.inject=function(h,g,k,j){var i=arguments.length>2;if(null==h&&(h=[]),ak&&h.reduce===ak){return j&&(g=aa.bind(g,j)),i?h.reduce(g,k):h.reduce(g)}if(Z(h,function(l,n,m){i?k=g.call(j,k,l,n,m):(k=l,i=!0)}),!i){throw new TypeError(Y)}return k},aa.reduceRight=aa.foldr=function(i,h,n,m){var l=arguments.length>2;if(null==i&&(i=[]),aj&&i.reduceRight===aj){return m&&(h=aa.bind(h,m)),l?i.reduceRight(h,n):i.reduceRight(h)}var k=i.length;if(k!==+k){var j=aa.keys(i);k=j.length}if(Z(i,function(o,g,a){g=j?j[--k]:--k,l?n=h.call(m,n,i[g],g,a):(n=i[g],l=!0)}),!l){throw new TypeError(Y)}return n},aa.find=aa.detect=function(h,g,j){var i;return X(h,function(k,m,l){return g.call(j,k,m,l)?(i=k,!0):void 0}),i},aa.filter=aa.select=function(h,g,j){var i=[];return null==h?i:ai&&h.filter===ai?h.filter(g,j):(Z(h,function(k,m,l){g.call(j,k,m,l)&&(i[i.length]=k)}),i)},aa.reject=function(h,g,i){return aa.filter(h,function(j,l,k){return !g.call(i,j,l,k)},i)},aa.every=aa.all=function(h,g,j){g||(g=aa.identity);var i=!0;return null==h?i:ah&&h.every===ah?h.every(g,j):(Z(h,function(k,m,l){return(i=i&&g.call(j,k,m,l))?void 0:aw}),!!i)};var X=aa.some=aa.any=function(h,g,j){g||(g=aa.identity);var i=!1;return null==h?i:ag&&h.some===ag?h.some(g,j):(Z(h,function(k,m,l){return i||(i=g.call(j,k,m,l))?aw:void 0}),!!i)};aa.contains=aa.include=function(h,g){return null==h?!1:af&&h.indexOf===af?-1!=h.indexOf(g):X(h,function(i){return i===g})},aa.invoke=function(h,g){var j=aq.call(arguments,2),i=aa.isFunction(g);return aa.map(h,function(k){return(i?g:k[g]).apply(k,j)})},aa.pluck=function(h,g){return aa.map(h,function(i){return i[g]})},aa.where=function(h,g,i){return aa.isEmpty(g)?i?null:[]:aa[i?"find":"filter"](h,function(j){for(var k in g){if(g[k]!==j[k]){return !1}}return !0})},aa.findWhere=function(h,g){return aa.where(h,g,!0)},aa.max=function(h,g,j){if(!g&&aa.isArray(h)&&h[0]===+h[0]&&h.length<65535){return Math.max.apply(Math,h)}if(!g&&aa.isEmpty(h)){return -1/0}var i={computed:-1/0,value:-1/0};return Z(h,function(k,n,m){var l=g?g.call(j,k,n,m):k;l>=i.computed&&(i={value:k,computed:l})}),i.value},aa.min=function(h,g,j){if(!g&&aa.isArray(h)&&h[0]===+h[0]&&h.length<65535){return Math.min.apply(Math,h)}if(!g&&aa.isEmpty(h)){return 1/0}var i={computed:1/0,value:1/0};return Z(h,function(k,n,m){var l=g?g.call(j,k,n,m):k;l<i.computed&&(i={value:k,computed:l})}),i.value},aa.shuffle=function(h){var g,j=0,i=[];return Z(h,function(k){g=aa.random(j++),i[j-1]=i[g],i[g]=k}),i};var W=function(g){return aa.isFunction(g)?g:function(a){return a[g]}};aa.sortBy=function(h,g,j){var i=W(g);return aa.pluck(aa.map(h,function(l,k,m){return{value:l,index:k,criteria:i.call(j,l,k,m)}}).sort(function(l,k){var n=l.criteria,m=k.criteria;if(n!==m){if(n>m||void 0===n){return 1}if(m>n||void 0===m){return -1}}return l.index<k.index?-1:1}),"value")};var V=function(h,g,l,k){var j={},i=W(g||aa.identity);return Z(h,function(a,n){var m=i.call(l,a,n,h);k(j,m,a)}),j};aa.groupBy=function(h,g,i){return V(h,g,i,function(k,j,l){(aa.has(k,j)?k[j]:k[j]=[]).push(l)})},aa.countBy=function(h,g,i){return V(h,g,i,function(k,j){aa.has(k,j)||(k[j]=0),k[j]++})},aa.sortedIndex=function(j,i,p,o){p=null==p?aa.identity:W(p);for(var n=p.call(o,i),m=0,l=j.length;l>m;){var k=m+l>>>1;p.call(o,j[k])<n?m=k+1:l=k}return m},aa.toArray=function(g){return g?aa.isArray(g)?aq.call(g):g.length===+g.length?aa.map(g,aa.identity):aa.values(g):[]},aa.size=function(g){return null==g?0:g.length===+g.length?g.length:aa.keys(g).length},aa.first=aa.head=aa.take=function(h,g,i){return null==h?void 0:null==g||i?h[0]:aq.call(h,0,g)},aa.initial=function(h,g,i){return aq.call(h,0,h.length-(null==g||i?1:g))},aa.last=function(h,g,i){return null==h?void 0:null==g||i?h[h.length-1]:aq.call(h,Math.max(h.length-g,0))},aa.rest=aa.tail=aa.drop=function(h,g,i){return aq.call(h,null==g||i?1:g)},aa.compact=function(g){return aa.filter(g,aa.identity)};var U=function(h,g,i){return Z(h,function(j){aa.isArray(j)?g?ar.apply(i,j):U(j,g,i):i.push(j)}),i};aa.flatten=function(h,g){return U(h,g,[])},aa.without=function(g){return aa.difference(g,aq.call(arguments,1))},aa.uniq=aa.unique=function(i,h,n,m){aa.isFunction(h)&&(m=n,n=h,h=!1);var l=n?aa.map(i,n,m):i,k=[],j=[];return Z(l,function(g,a){(h?a&&j[j.length-1]===g:aa.contains(j,g))||(j.push(g),k.push(i[a]))}),k},aa.union=function(){return aa.uniq(ap.apply(av,arguments))},aa.intersection=function(h){var g=aq.call(arguments,1);return aa.filter(aa.uniq(h),function(i){return aa.every(g,function(a){return aa.indexOf(a,i)>=0})})},aa.difference=function(h){var g=ap.apply(av,aq.call(arguments,1));return aa.filter(h,function(i){return !aa.contains(g,i)})},aa.zip=function(){for(var h=aq.call(arguments),g=aa.max(aa.pluck(h,"length")),j=new Array(g),i=0;g>i;i++){j[i]=aa.pluck(h,""+i)}return j},aa.object=function(h,g){if(null==h){return{}}for(var k={},j=0,i=h.length;i>j;j++){g?k[h[j]]=g[j]:k[h[j][0]]=h[j][1]}return k},aa.indexOf=function(h,g,k){if(null==h){return -1}var j=0,i=h.length;if(k){if("number"!=typeof k){return j=aa.sortedIndex(h,g),h[j]===g?j:-1}j=0>k?Math.max(0,i+k):k}if(af&&h.indexOf===af){return h.indexOf(g,k)}for(;i>j;j++){if(h[j]===g){return j}}return -1},aa.lastIndexOf=function(h,g,k){if(null==h){return -1}var j=null!=k;if(ae&&h.lastIndexOf===ae){return j?h.lastIndexOf(g,k):h.lastIndexOf(g)}for(var i=j?k:h.length;i--;){if(h[i]===g){return i}}return -1},aa.range=function(h,g,l){arguments.length<=1&&(g=h||0,h=0),l=arguments[2]||1;for(var k=Math.max(Math.ceil((g-h)/l),0),j=0,i=new Array(k);k>j;){i[j++]=h,h+=l}return i},aa.bind=function(h,g){if(h.bind===ab&&ab){return ab.apply(h,aq.call(arguments,1))}var i=aq.call(arguments,2);return function(){return h.apply(g,i.concat(aq.call(arguments)))}},aa.partial=function(h){var g=aq.call(arguments,1);return function(){return h.apply(this,g.concat(aq.call(arguments)))}},aa.bindAll=function(h){var g=aq.call(arguments,1);return 0===g.length&&(g=aa.functions(h)),Z(g,function(a){h[a]=aa.bind(h[a],h)}),h},aa.memoize=function(h,g){var i={};return g||(g=aa.identity),function(){var a=g.apply(this,arguments);return aa.has(i,a)?i[a]:i[a]=h.apply(this,arguments)}},aa.delay=function(h,g){var i=aq.call(arguments,2);return setTimeout(function(){return h.apply(null,i)},g)},aa.defer=function(g){return aa.delay.apply(aa,[g,1].concat(aq.call(arguments,1)))},aa.throttle=function(j,i){var p,o,n,m,l=0,k=function(){l=new Date,n=null,m=j.apply(p,o)};return function(){var g=new Date,a=i-(g-l);return p=this,o=arguments,0>=a?(clearTimeout(n),n=null,l=g,m=j.apply(p,o)):n||(n=setTimeout(k,a)),m}},aa.debounce=function(h,g,k){var j,i;return function(){var n=this,m=arguments,l=function(){j=null,k||(i=h.apply(n,m))},a=k&&!j;return clearTimeout(j),j=setTimeout(l,g),a&&(i=h.apply(n,m)),i}},aa.once=function(h){var g,i=!1;return function(){return i?g:(i=!0,g=h.apply(this,arguments),h=null,g)}},aa.wrap=function(h,g){return function(){var a=[h];return ar.apply(a,arguments),g.apply(this,a)}},aa.compose=function(){var g=arguments;return function(){for(var a=arguments,h=g.length-1;h>=0;h--){a=[g[h].apply(this,a)]}return a[0]}},aa.after=function(h,g){return 0>=h?g():function(){return --h<1?g.apply(this,arguments):void 0}},aa.keys=ac||function(h){if(h!==Object(h)){throw new TypeError("Invalid object")}var g=[];for(var i in h){aa.has(h,i)&&(g[g.length]=i)}return g},aa.values=function(h){var g=[];for(var i in h){aa.has(h,i)&&g.push(h[i])}return g},aa.pairs=function(h){var g=[];for(var i in h){aa.has(h,i)&&g.push([i,h[i]])}return g},aa.invert=function(h){var g={};for(var i in h){aa.has(h,i)&&(g[h[i]]=i)}return g},aa.functions=aa.methods=function(h){var g=[];for(var i in h){aa.isFunction(h[i])&&g.push(i)}return g.sort()},aa.extend=function(g){return Z(aq.call(arguments,1),function(a){if(a){for(var h in a){g[h]=a[h]}}}),g},aa.pick=function(h){var g={},i=ap.apply(av,aq.call(arguments,1));return Z(i,function(a){a in h&&(g[a]=h[a])}),g},aa.omit=function(h){var g={},j=ap.apply(av,aq.call(arguments,1));for(var i in h){aa.contains(j,i)||(g[i]=h[i])}return g},aa.defaults=function(g){return Z(aq.call(arguments,1),function(a){if(a){for(var h in a){null==g[h]&&(g[h]=a[h])}}}),g},aa.clone=function(g){return aa.isObject(g)?aa.isArray(g)?g.slice():aa.extend({},g):g},aa.tap=function(h,g){return g(h),h};var T=function(v,u,t,s){if(v===u){return 0!==v||1/v==1/u}if(null==v||null==u){return v===u}v instanceof aa&&(v=v._wrapped),u instanceof aa&&(u=u._wrapped);var r=ao.call(v);if(r!=ao.call(u)){return !1}switch(r){case"[object String]":return v==String(u);case"[object Number]":return v!=+v?u!=+u:0==v?1/v==1/u:v==+u;case"[object Date]":case"[object Boolean]":return +v==+u;case"[object RegExp]":return v.source==u.source&&v.global==u.global&&v.multiline==u.multiline&&v.ignoreCase==u.ignoreCase}if("object"!=typeof v||"object"!=typeof u){return !1}for(var q=t.length;q--;){if(t[q]==v){return s[q]==u}}t.push(v),s.push(u);var p=0,o=!0;if("[object Array]"==r){if(p=v.length,o=p==u.length){for(;p--&&(o=T(v[p],u[p],t,s));){}}}else{var n=v.constructor,m=u.constructor;if(n!==m&&!(aa.isFunction(n)&&n instanceof n&&aa.isFunction(m)&&m instanceof m)){return !1}for(var l in v){if(aa.has(v,l)&&(p++,!(o=aa.has(u,l)&&T(v[l],u[l],t,s)))){break}}if(o){for(l in u){if(aa.has(u,l)&&!p--){break}}o=!p}}return t.pop(),s.pop(),o};aa.isEqual=function(h,g){return T(h,g,[],[])},aa.isEmpty=function(h){if(null==h){return !0}if(aa.isArray(h)||aa.isString(h)){return 0===h.length}for(var g in h){if(aa.has(h,g)){return !1}}return !0},aa.isElement=function(g){return !(!g||1!==g.nodeType)},aa.isArray=ad||function(g){return"[object Array]"==ao.call(g)},aa.isObject=function(g){return g===Object(g)},Z(["Arguments","Function","String","Number","Date","RegExp"],function(g){aa["is"+g]=function(a){return ao.call(a)=="[object "+g+"]"}}),aa.isArguments(arguments)||(aa.isArguments=function(g){return !(!g||!aa.has(g,"callee"))}),"function"!=typeof/./&&(aa.isFunction=function(g){return"function"==typeof g}),aa.isFinite=function(g){return isFinite(g)&&!isNaN(parseFloat(g))},aa.isNaN=function(g){return aa.isNumber(g)&&g!=+g},aa.isBoolean=function(g){return g===!0||g===!1||"[object Boolean]"==ao.call(g)},aa.isNull=function(g){return null===g},aa.isUndefined=function(g){return void 0===g},aa.has=function(h,g){return an.call(h,g)},aa.noConflict=function(){return ay._=ax,this},aa.identity=function(g){return g},aa.times=function(h,g,k){for(var j=Array(h),i=0;h>i;i++){j[i]=g.call(k,i)}return j},aa.random=function(h,g){return null==g&&(g=h,h=0),h+Math.floor(Math.random()*(g-h+1))};var S={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};S.unescape=aa.invert(S.escape);var R={escape:new RegExp("["+aa.keys(S.escape).join("")+"]","g"),unescape:new RegExp("("+aa.keys(S.unescape).join("|")+")","g")};aa.each(["escape","unescape"],function(g){aa[g]=function(a){return null==a?"":(""+a).replace(R[g],function(h){return S[g][h]})}}),aa.result=function(h,g){if(null==h){return null}var i=h[g];return aa.isFunction(i)?i.call(h):i},aa.mixin=function(g){Z(aa.functions(g),function(a){var h=aa[a]=g[a];aa.prototype[a]=function(){var i=[this._wrapped];return ar.apply(i,arguments),b.call(this,h.apply(aa,i))}})};var Q=0;aa.uniqueId=function(h){var g=++Q+"";return h?h+g:g},aa.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var P=/(.)^/,O={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},c=/\\|'|\r|\n|\t|\u2028|\u2029/g;aa.template=function(r,q,p){var o;p=aa.defaults({},p,aa.templateSettings);var n=new RegExp([(p.escape||P).source,(p.interpolate||P).source,(p.evaluate||P).source].join("|")+"|$","g"),m=0,l="__p+='";r.replace(n,function(a,t,s,i,g){return l+=r.slice(m,g).replace(c,function(h){return"\\"+O[h]}),t&&(l+="'+\n((__t=("+t+"))==null?'':_.escape(__t))+\n'"),s&&(l+="'+\n((__t=("+s+"))==null?'':__t)+\n'"),i&&(l+="';\n"+i+"\n__p+='"),m=g+a.length,a}),l+="';\n",p.variable||(l="with(obj||{}){\n"+l+"}\n"),l="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+l+"return __p;\n";try{o=new Function(p.variable||"obj","_",l)}catch(k){throw k.source=l,k}if(q){return o(q,aa)}var j=function(g){return o.call(this,g,aa)};return j.source="function("+(p.variable||"obj")+"){\n"+l+"}",j},aa.chain=function(g){return aa(g).chain()};var b=function(g){return this._chain?aa(g).chain():g};aa.mixin(aa),Z(["pop","push","reverse","shift","sort","splice","unshift"],function(h){var g=av[h];aa.prototype[h]=function(){var a=this._wrapped;return g.apply(a,arguments),"shift"!=h&&"splice"!=h||0!==a.length||delete a[0],b.call(this,a)}}),Z(["concat","join","slice"],function(h){var g=av[h];aa.prototype[h]=function(){return b.call(this,g.apply(this._wrapped,arguments))}}),aa.extend(aa.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this)},{}],25:[function(b){"undefined"!=typeof window&&"function"!=typeof window.requestAnimationFrame&&(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(c){setTimeout(c,1000/60)}),Leap=b("../lib/index")},{"../lib/index":11}]},{},[25]);"use strict";var THREE={REVISION:"62"};self.console=self.console||{info:function(){},log:function(){},debug:function(){},warn:function(){},error:function(){}};String.prototype.trim=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")};THREE.extend=function(h,g){if(Object.keys){for(var l=Object.keys(g),k=0,j=l.length;k<j;k++){var i=l[k];Object.defineProperty(h,i,Object.getOwnPropertyDescriptor(g,i))}}else{for(i in l={}.hasOwnProperty,g){l.call(g,i)&&(h[i]=g[i])}}return h};(function(){for(var e=0,d=["ms","moz","webkit","o"],f=0;f<d.length&&!self.requestAnimationFrame;++f){self.requestAnimationFrame=self[d[f]+"RequestAnimationFrame"],self.cancelAnimationFrame=self[d[f]+"CancelAnimationFrame"]||self[d[f]+"CancelRequestAnimationFrame"]}void 0===self.requestAnimationFrame&&void 0!==self.setTimeout&&(self.requestAnimationFrame=function(a){var j=Date.now(),i=Math.max(0,16-(j-e)),g=self.setTimeout(function(){a(j+i)},i);e=j+i;return g});void 0===self.cancelAnimationFrame&&void 0!==self.clearTimeout&&(self.cancelAnimationFrame=function(b){self.clearTimeout(b)})})();THREE.CullFaceNone=0;THREE.CullFaceBack=1;THREE.CullFaceFront=2;THREE.CullFaceFrontBack=3;THREE.FrontFaceDirectionCW=0;THREE.FrontFaceDirectionCCW=1;THREE.BasicShadowMap=0;THREE.PCFShadowMap=1;THREE.PCFSoftShadowMap=2;THREE.FrontSide=0;THREE.BackSide=1;THREE.DoubleSide=2;THREE.NoShading=0;THREE.FlatShading=1;THREE.SmoothShading=2;THREE.NoColors=0;THREE.FaceColors=1;THREE.VertexColors=2;THREE.NoBlending=0;THREE.NormalBlending=1;THREE.AdditiveBlending=2;THREE.SubtractiveBlending=3;THREE.MultiplyBlending=4;THREE.CustomBlending=5;THREE.AddEquation=100;THREE.SubtractEquation=101;THREE.ReverseSubtractEquation=102;THREE.ZeroFactor=200;THREE.OneFactor=201;THREE.SrcColorFactor=202;THREE.OneMinusSrcColorFactor=203;THREE.SrcAlphaFactor=204;THREE.OneMinusSrcAlphaFactor=205;THREE.DstAlphaFactor=206;THREE.OneMinusDstAlphaFactor=207;THREE.DstColorFactor=208;THREE.OneMinusDstColorFactor=209;THREE.SrcAlphaSaturateFactor=210;THREE.MultiplyOperation=0;THREE.MixOperation=1;THREE.AddOperation=2;THREE.UVMapping=function(){};THREE.CubeReflectionMapping=function(){};THREE.CubeRefractionMapping=function(){};THREE.SphericalReflectionMapping=function(){};THREE.SphericalRefractionMapping=function(){};THREE.RepeatWrapping=1000;THREE.ClampToEdgeWrapping=1001;THREE.MirroredRepeatWrapping=1002;THREE.NearestFilter=1003;THREE.NearestMipMapNearestFilter=1004;THREE.NearestMipMapLinearFilter=1005;THREE.LinearFilter=1006;THREE.LinearMipMapNearestFilter=1007;THREE.LinearMipMapLinearFilter=1008;THREE.UnsignedByteType=1009;THREE.ByteType=1010;THREE.ShortType=1011;THREE.UnsignedShortType=1012;THREE.IntType=1013;THREE.UnsignedIntType=1014;THREE.FloatType=1015;THREE.UnsignedShort4444Type=1016;THREE.UnsignedShort5551Type=1017;THREE.UnsignedShort565Type=1018;THREE.AlphaFormat=1019;THREE.RGBFormat=1020;THREE.RGBAFormat=1021;THREE.LuminanceFormat=1022;THREE.LuminanceAlphaFormat=1023;THREE.RGB_S3TC_DXT1_Format=2001;THREE.RGBA_S3TC_DXT1_Format=2002;THREE.RGBA_S3TC_DXT3_Format=2003;THREE.RGBA_S3TC_DXT5_Format=2004;THREE.Color=function(b){void 0!==b&&this.set(b);return this};THREE.Color.prototype={constructor:THREE.Color,r:1,g:1,b:1,set:function(b){b instanceof THREE.Color?this.copy(b):"number"===typeof b?this.setHex(b):"string"===typeof b&&this.setStyle(b);return this},setHex:function(b){b=Math.floor(b);this.r=(b>>16&255)/255;this.g=(b>>8&255)/255;this.b=(b&255)/255;return this},setRGB:function(e,d,f){this.r=e;this.g=d;this.b=f;return this},setHSL:function(f,e,h){if(0===e){this.r=this.g=this.b=h}else{var g=function(i,d,j){0>j&&(j+=1);1<j&&(j-=1);return j<1/6?i+6*(d-i)*j:0.5>j?d:j<2/3?i+6*(d-i)*(2/3-j):i},e=0.5>=h?h*(1+e):h+e-h*e,h=2*h-e;this.r=g(h,e,f+1/3);this.g=g(h,e,f);this.b=g(h,e,f-1/3)}return this},setStyle:function(b){if(/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.test(b)){return b=/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.exec(b),this.r=Math.min(255,parseInt(b[1],10))/255,this.g=Math.min(255,parseInt(b[2],10))/255,this.b=Math.min(255,parseInt(b[3],10))/255,this}if(/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.test(b)){return b=/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.exec(b),this.r=Math.min(100,parseInt(b[1],10))/100,this.g=Math.min(100,parseInt(b[2],10))/100,this.b=Math.min(100,parseInt(b[3],10))/100,this}if(/^\#([0-9a-f]{6})$/i.test(b)){return b=/^\#([0-9a-f]{6})$/i.exec(b),this.setHex(parseInt(b[1],16)),this}if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(b)){return b=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(b),this.setHex(parseInt(b[1]+b[1]+b[2]+b[2]+b[3]+b[3],16)),this}if(/^(\w+)$/i.test(b)){return this.setHex(THREE.ColorKeywords[b]),this}},copy:function(b){this.r=b.r;this.g=b.g;this.b=b.b;return this},copyGammaToLinear:function(b){this.r=b.r*b.r;this.g=b.g*b.g;this.b=b.b*b.b;return this},copyLinearToGamma:function(b){this.r=Math.sqrt(b.r);this.g=Math.sqrt(b.g);this.b=Math.sqrt(b.b);return this},convertGammaToLinear:function(){var e=this.r,d=this.g,f=this.b;this.r=e*e;this.g=d*d;this.b=f*f;return this},convertLinearToGamma:function(){this.r=Math.sqrt(this.r);this.g=Math.sqrt(this.g);this.b=Math.sqrt(this.b);return this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(){var b={h:0,s:0,l:0};return function(){var a=this.r,p=this.g,o=this.b,n=Math.max(a,p,o),m=Math.min(a,p,o),k,l=(m+n)/2;if(m===n){m=k=0}else{var j=n-m,m=0.5>=l?j/(n+m):j/(2-n-m);switch(n){case a:k=(p-o)/j+(p<o?6:0);break;case p:k=(o-a)/j+2;break;case o:k=(a-p)/j+4}k/=6}b.h=k;b.s=m;b.l=l;return b}}(),getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(f,e,h){var g=this.getHSL();g.h+=f;g.s+=e;g.l+=h;this.setHSL(g.h,g.s,g.l);return this},add:function(b){this.r+=b.r;this.g+=b.g;this.b+=b.b;return this},addColors:function(d,c){this.r=d.r+c.r;this.g=d.g+c.g;this.b=d.b+c.b;return this},addScalar:function(b){this.r+=b;this.g+=b;this.b+=b;return this},multiply:function(b){this.r*=b.r;this.g*=b.g;this.b*=b.b;return this},multiplyScalar:function(b){this.r*=b;this.g*=b;this.b*=b;return this},lerp:function(d,c){this.r+=(d.r-this.r)*c;this.g+=(d.g-this.g)*c;this.b+=(d.b-this.b)*c;return this},equals:function(b){return b.r===this.r&&b.g===this.g&&b.b===this.b},fromArray:function(b){this.r=b[0];this.g=b[1];this.b=b[2];return this},toArray:function(){return[this.r,this.g,this.b]},clone:function(){return(new THREE.Color).setRGB(this.r,this.g,this.b)}};THREE.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};THREE.Quaternion=function(f,e,h,g){this._x=f||0;this._y=e||0;this._z=h||0;this._w=void 0!==g?g:1};THREE.Quaternion.prototype={constructor:THREE.Quaternion,_x:0,_y:0,_z:0,_w:0,_euler:void 0,_updateEuler:function(){void 0!==this._euler&&this._euler.setFromQuaternion(this,void 0,!1)},get xfunction(){return this._x},set xfunction(b){this._x=b;this._updateEuler()},get yfunction(){return this._y},set yfunction(b){this._y=b;this._updateEuler()},get zfunction(){return this._z},set zfunction(b){this._z=b;this._updateEuler()},get wfunction(){return this._w},set wfunction(b){this._w=b;this._updateEuler()},set:function(f,e,h,g){this._x=f;this._y=e;this._z=h;this._w=g;this._updateEuler();return this},copy:function(b){this._x=b._x;this._y=b._y;this._z=b._z;this._w=b._w;this._updateEuler();return this},setFromEuler:function(j,i){if(!1===j instanceof THREE.Euler){throw Error("ERROR: Quaternion's .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code.")}var p=Math.cos(j._x/2),o=Math.cos(j._y/2),n=Math.cos(j._z/2),m=Math.sin(j._x/2),k=Math.sin(j._y/2),l=Math.sin(j._z/2);"XYZ"===j.order?(this._x=m*o*n+p*k*l,this._y=p*k*n-m*o*l,this._z=p*o*l+m*k*n,this._w=p*o*n-m*k*l):"YXZ"===j.order?(this._x=m*o*n+p*k*l,this._y=p*k*n-m*o*l,this._z=p*o*l-m*k*n,this._w=p*o*n+m*k*l):"ZXY"===j.order?(this._x=m*o*n-p*k*l,this._y=p*k*n+m*o*l,this._z=p*o*l+m*k*n,this._w=p*o*n-m*k*l):"ZYX"===j.order?(this._x=m*o*n-p*k*l,this._y=p*k*n+m*o*l,this._z=p*o*l-m*k*n,this._w=p*o*n+m*k*l):"YZX"===j.order?(this._x=m*o*n+p*k*l,this._y=p*k*n+m*o*l,this._z=p*o*l-m*k*n,this._w=p*o*n-m*k*l):"XZY"===j.order&&(this._x=m*o*n-p*k*l,this._y=p*k*n-m*o*l,this._z=p*o*l+m*k*n,this._w=p*o*n+m*k*l);!1!==i&&this._updateEuler();return this},setFromAxisAngle:function(f,e){var h=e/2,g=Math.sin(h);this._x=f.x*g;this._y=f.y*g;this._z=f.z*g;this._w=Math.cos(h);this._updateEuler();return this},setFromRotationMatrix:function(t){var s=t.elements,r=s[0],t=s[4],q=s[8],p=s[1],o=s[5],m=s[9],n=s[2],l=s[6],s=s[10],j=r+o+s;0<j?(r=0.5/Math.sqrt(j+1),this._w=0.25/r,this._x=(l-m)*r,this._y=(q-n)*r,this._z=(p-t)*r):r>o&&r>s?(r=2*Math.sqrt(1+r-o-s),this._w=(l-m)/r,this._x=0.25*r,this._y=(t+p)/r,this._z=(q+n)/r):o>s?(r=2*Math.sqrt(1+o-r-s),this._w=(q-n)/r,this._x=(t+p)/r,this._y=0.25*r,this._z=(m+l)/r):(r=2*Math.sqrt(1+s-r-o),this._w=(p-t)/r,this._x=(q+n)/r,this._y=(m+l)/r,this._z=0.25*r);this._updateEuler();return this},inverse:function(){this.conjugate().normalize();return this},conjugate:function(){this._x*=-1;this._y*=-1;this._z*=-1;this._updateEuler();return this},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var b=this.length();0===b?(this._z=this._y=this._x=0,this._w=1):(b=1/b,this._x*=b,this._y*=b,this._z*=b,this._w*=b);return this},multiply:function(d,c){return void 0!==c?(console.warn("DEPRECATED: Quaternion's .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(d,c)):this.multiplyQuaternions(this,d)},multiplyQuaternions:function(t,s){var r=t._x,q=t._y,p=t._z,o=t._w,m=s._x,n=s._y,l=s._z,j=s._w;this._x=r*j+o*m+q*l-p*n;this._y=q*j+o*n+p*m-r*l;this._z=p*j+o*l+r*n-q*m;this._w=o*j-r*m-q*n-p*l;this._updateEuler();return this},multiplyVector3:function(b){console.warn("DEPRECATED: Quaternion's .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.");return b.applyQuaternion(this)},slerp:function(r,q){var p=this._x,o=this._y,n=this._z,m=this._w,k=m*r._w+p*r._x+o*r._y+n*r._z;0>k?(this._w=-r._w,this._x=-r._x,this._y=-r._y,this._z=-r._z,k=-k):this.copy(r);if(1<=k){return this._w=m,this._x=p,this._y=o,this._z=n,this}var l=Math.acos(k),j=Math.sqrt(1-k*k);if(0.001>Math.abs(j)){return this._w=0.5*(m+this._w),this._x=0.5*(p+this._x),this._y=0.5*(o+this._y),this._z=0.5*(n+this._z),this}k=Math.sin((1-q)*l)/j;l=Math.sin(q*l)/j;this._w=m*k+this._w*l;this._x=p*k+this._x*l;this._y=o*k+this._y*l;this._z=n*k+this._z*l;this._updateEuler();return this},equals:function(b){return b._x===this._x&&b._y===this._y&&b._z===this._z&&b._w===this._w},fromArray:function(b){this._x=b[0];this._y=b[1];this._z=b[2];this._w=b[3];this._updateEuler();return this},toArray:function(){return[this._x,this._y,this._z,this._w]},clone:function(){return new THREE.Quaternion(this._x,this._y,this._z,this._w)}};THREE.Quaternion.slerp=function(f,e,h,g){return h.copy(f).slerp(e,g)};THREE.Vector2=function(d,c){this.x=d||0;this.y=c||0};THREE.Vector2.prototype={constructor:THREE.Vector2,set:function(d,c){this.x=d;this.y=c;return this},setX:function(b){this.x=b;return this},setY:function(b){this.y=b;return this},setComponent:function(d,c){switch(d){case 0:this.x=c;break;case 1:this.y=c;break;default:throw Error("index is out of range: "+d)}},getComponent:function(b){switch(b){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+b)}},copy:function(b){this.x=b.x;this.y=b.y;return this},add:function(d,c){if(void 0!==c){return console.warn("DEPRECATED: Vector2's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(d,c)}this.x+=d.x;this.y+=d.y;return this},addVectors:function(d,c){this.x=d.x+c.x;this.y=d.y+c.y;return this},addScalar:function(b){this.x+=b;this.y+=b;return this},sub:function(d,c){if(void 0!==c){return console.warn("DEPRECATED: Vector2's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(d,c)}this.x-=d.x;this.y-=d.y;return this},subVectors:function(d,c){this.x=d.x-c.x;this.y=d.y-c.y;return this},multiplyScalar:function(b){this.x*=b;this.y*=b;return this},divideScalar:function(b){0!==b?(b=1/b,this.x*=b,this.y*=b):this.y=this.x=0;return this},min:function(b){this.x>b.x&&(this.x=b.x);this.y>b.y&&(this.y=b.y);return this},max:function(b){this.x<b.x&&(this.x=b.x);this.y<b.y&&(this.y=b.y);return this},clamp:function(d,c){this.x<d.x?this.x=d.x:this.x>c.x&&(this.x=c.x);this.y<d.y?this.y=d.y:this.y>c.y&&(this.y=c.y);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(b){return this.x*b.x+this.y*b.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(b){return Math.sqrt(this.distanceToSquared(b))},distanceToSquared:function(d){var c=this.x-d.x,d=this.y-d.y;return c*c+d*d},setLength:function(d){var c=this.length();0!==c&&d!==c&&this.multiplyScalar(d/c);return this},lerp:function(d,c){this.x+=(d.x-this.x)*c;this.y+=(d.y-this.y)*c;return this},equals:function(b){return b.x===this.x&&b.y===this.y},fromArray:function(b){this.x=b[0];this.y=b[1];return this},toArray:function(){return[this.x,this.y]},clone:function(){return new THREE.Vector2(this.x,this.y)}};THREE.Vector3=function(e,d,f){this.x=e||0;this.y=d||0;this.z=f||0};THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(e,d,f){this.x=e;this.y=d;this.z=f;return this},setX:function(b){this.x=b;return this},setY:function(b){this.y=b;return this},setZ:function(b){this.z=b;return this},setComponent:function(d,c){switch(d){case 0:this.x=c;break;case 1:this.y=c;break;case 2:this.z=c;break;default:throw Error("index is out of range: "+d)}},getComponent:function(b){switch(b){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+b)}},copy:function(b){this.x=b.x;this.y=b.y;this.z=b.z;return this},add:function(d,c){if(void 0!==c){return console.warn("DEPRECATED: Vector3's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(d,c)}this.x+=d.x;this.y+=d.y;this.z+=d.z;return this},addScalar:function(b){this.x+=b;this.y+=b;this.z+=b;return this},addVectors:function(d,c){this.x=d.x+c.x;this.y=d.y+c.y;this.z=d.z+c.z;return this},sub:function(d,c){if(void 0!==c){return console.warn("DEPRECATED: Vector3's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(d,c)}this.x-=d.x;this.y-=d.y;this.z-=d.z;return this},subVectors:function(d,c){this.x=d.x-c.x;this.y=d.y-c.y;this.z=d.z-c.z;return this},multiply:function(d,c){if(void 0!==c){return console.warn("DEPRECATED: Vector3's .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(d,c)}this.x*=d.x;this.y*=d.y;this.z*=d.z;return this},multiplyScalar:function(b){this.x*=b;this.y*=b;this.z*=b;return this},multiplyVectors:function(d,c){this.x=d.x*c.x;this.y=d.y*c.y;this.z=d.z*c.z;return this},applyMatrix3:function(f){var e=this.x,h=this.y,g=this.z,f=f.elements;this.x=f[0]*e+f[3]*h+f[6]*g;this.y=f[1]*e+f[4]*h+f[7]*g;this.z=f[2]*e+f[5]*h+f[8]*g;return this},applyMatrix4:function(f){var e=this.x,h=this.y,g=this.z,f=f.elements;this.x=f[0]*e+f[4]*h+f[8]*g+f[12];this.y=f[1]*e+f[5]*h+f[9]*g+f[13];this.z=f[2]*e+f[6]*h+f[10]*g+f[14];return this},applyProjection:function(g){var f=this.x,j=this.y,i=this.z,g=g.elements,h=1/(g[3]*f+g[7]*j+g[11]*i+g[15]);this.x=(g[0]*f+g[4]*j+g[8]*i+g[12])*h;this.y=(g[1]*f+g[5]*j+g[9]*i+g[13])*h;this.z=(g[2]*f+g[6]*j+g[10]*i+g[14])*h;return this},applyQuaternion:function(t){var s=this.x,r=this.y,q=this.z,p=t.x,o=t.y,m=t.z,t=t.w,n=t*s+o*q-m*r,l=t*r+m*s-p*q,j=t*q+p*r-o*s,s=-p*s-o*r-m*q;this.x=n*t+s*-p+l*-m-j*-o;this.y=l*t+s*-o+j*-p-n*-m;this.z=j*t+s*-m+n*-o-l*-p;return this},transformDirection:function(f){var e=this.x,h=this.y,g=this.z,f=f.elements;this.x=f[0]*e+f[4]*h+f[8]*g;this.y=f[1]*e+f[5]*h+f[9]*g;this.z=f[2]*e+f[6]*h+f[10]*g;this.normalize();return this},divide:function(b){this.x/=b.x;this.y/=b.y;this.z/=b.z;return this},divideScalar:function(b){0!==b?(b=1/b,this.x*=b,this.y*=b,this.z*=b):this.z=this.y=this.x=0;return this},min:function(b){this.x>b.x&&(this.x=b.x);this.y>b.y&&(this.y=b.y);this.z>b.z&&(this.z=b.z);return this},max:function(b){this.x<b.x&&(this.x=b.x);this.y<b.y&&(this.y=b.y);this.z<b.z&&(this.z=b.z);return this},clamp:function(d,c){this.x<d.x?this.x=d.x:this.x>c.x&&(this.x=c.x);this.y<d.y?this.y=d.y:this.y>c.y&&(this.y=c.y);this.z<d.z?this.z=d.z:this.z>c.z&&(this.z=c.z);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(b){return this.x*b.x+this.y*b.y+this.z*b.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(d){var c=this.length();0!==c&&d!==c&&this.multiplyScalar(d/c);return this},lerp:function(d,c){this.x+=(d.x-this.x)*c;this.y+=(d.y-this.y)*c;this.z+=(d.z-this.z)*c;return this},cross:function(g,f){if(void 0!==f){return console.warn("DEPRECATED: Vector3's .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(g,f)}var j=this.x,i=this.y,h=this.z;this.x=i*g.z-h*g.y;this.y=h*g.x-j*g.z;this.z=j*g.y-i*g.x;return this},crossVectors:function(j,i){var p=j.x,o=j.y,n=j.z,m=i.x,k=i.y,l=i.z;this.x=o*l-n*k;this.y=n*m-p*l;this.z=p*k-o*m;return this},angleTo:function(b){b=this.dot(b)/(this.length()*b.length());return Math.acos(THREE.Math.clamp(b,-1,1))},distanceTo:function(b){return Math.sqrt(this.distanceToSquared(b))},distanceToSquared:function(e){var d=this.x-e.x,f=this.y-e.y,e=this.z-e.z;return d*d+f*f+e*e},setEulerFromRotationMatrix:function(){console.error("REMOVED: Vector3's setEulerFromRotationMatrix has been removed in favor of Euler.setFromRotationMatrix(), please update your code.")},setEulerFromQuaternion:function(){console.error("REMOVED: Vector3's setEulerFromQuaternion: has been removed in favor of Euler.setFromQuaternion(), please update your code.")},getPositionFromMatrix:function(b){this.x=b.elements[12];this.y=b.elements[13];this.z=b.elements[14];return this},getScaleFromMatrix:function(e){var d=this.set(e.elements[0],e.elements[1],e.elements[2]).length(),f=this.set(e.elements[4],e.elements[5],e.elements[6]).length(),e=this.set(e.elements[8],e.elements[9],e.elements[10]).length();this.x=d;this.y=f;this.z=e;return this},getColumnFromMatrix:function(f,e){var h=4*f,g=e.elements;this.x=g[h];this.y=g[h+1];this.z=g[h+2];return this},equals:function(b){return b.x===this.x&&b.y===this.y&&b.z===this.z},fromArray:function(b){this.x=b[0];this.y=b[1];this.z=b[2];return this},toArray:function(){return[this.x,this.y,this.z]},clone:function(){return new THREE.Vector3(this.x,this.y,this.z)}};THREE.extend(THREE.Vector3.prototype,{applyEuler:function(){var b=new THREE.Quaternion;return function(a){!1===a instanceof THREE.Euler&&console.error("ERROR: Vector3's .applyEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code.");this.applyQuaternion(b.setFromEuler(a));return this}}(),applyAxisAngle:function(){var b=new THREE.Quaternion;return function(a,d){this.applyQuaternion(b.setFromAxisAngle(a,d));return this}}(),projectOnVector:function(){var b=new THREE.Vector3;return function(a){b.copy(a).normalize();a=this.dot(b);return this.copy(b).multiplyScalar(a)}}(),projectOnPlane:function(){var b=new THREE.Vector3;return function(a){b.copy(this).projectOnVector(a);return this.sub(b)}}(),reflect:function(){var b=new THREE.Vector3;return function(a){b.copy(this).projectOnVector(a).multiplyScalar(2);return this.subVectors(b,this)}}()});THREE.Vector4=function(f,e,h,g){this.x=f||0;this.y=e||0;this.z=h||0;this.w=void 0!==g?g:1};THREE.Vector4.prototype={constructor:THREE.Vector4,set:function(f,e,h,g){this.x=f;this.y=e;this.z=h;this.w=g;return this},setX:function(b){this.x=b;return this},setY:function(b){this.y=b;return this},setZ:function(b){this.z=b;return this},setW:function(b){this.w=b;return this},setComponent:function(d,c){switch(d){case 0:this.x=c;break;case 1:this.y=c;break;case 2:this.z=c;break;case 3:this.w=c;break;default:throw Error("index is out of range: "+d)}},getComponent:function(b){switch(b){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+b)}},copy:function(b){this.x=b.x;this.y=b.y;this.z=b.z;this.w=void 0!==b.w?b.w:1;return this},add:function(d,c){if(void 0!==c){return console.warn("DEPRECATED: Vector4's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(d,c)}this.x+=d.x;this.y+=d.y;this.z+=d.z;this.w+=d.w;return this},addScalar:function(b){this.x+=b;this.y+=b;this.z+=b;this.w+=b;return this},addVectors:function(d,c){this.x=d.x+c.x;this.y=d.y+c.y;this.z=d.z+c.z;this.w=d.w+c.w;return this},sub:function(d,c){if(void 0!==c){return console.warn("DEPRECATED: Vector4's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(d,c)}this.x-=d.x;this.y-=d.y;this.z-=d.z;this.w-=d.w;return this},subVectors:function(d,c){this.x=d.x-c.x;this.y=d.y-c.y;this.z=d.z-c.z;this.w=d.w-c.w;return this},multiplyScalar:function(b){this.x*=b;this.y*=b;this.z*=b;this.w*=b;return this},applyMatrix4:function(g){var f=this.x,j=this.y,i=this.z,h=this.w,g=g.elements;this.x=g[0]*f+g[4]*j+g[8]*i+g[12]*h;this.y=g[1]*f+g[5]*j+g[9]*i+g[13]*h;this.z=g[2]*f+g[6]*j+g[10]*i+g[14]*h;this.w=g[3]*f+g[7]*j+g[11]*i+g[15]*h;return this},divideScalar:function(b){0!==b?(b=1/b,this.x*=b,this.y*=b,this.z*=b,this.w*=b):(this.z=this.y=this.x=0,this.w=1);return this},setAxisAngleFromQuaternion:function(d){this.w=2*Math.acos(d.w);var c=Math.sqrt(1-d.w*d.w);0.0001>c?(this.x=1,this.z=this.y=0):(this.x=d.x/c,this.y=d.y/c,this.z=d.z/c);return this},setAxisAngleFromRotationMatrix:function(t){var s,r,q,t=t.elements,p=t[0];q=t[4];var o=t[8],m=t[1],n=t[5],l=t[9];r=t[2];s=t[6];var j=t[10];if(0.01>Math.abs(q-m)&&0.01>Math.abs(o-r)&&0.01>Math.abs(l-s)){if(0.1>Math.abs(q+m)&&0.1>Math.abs(o+r)&&0.1>Math.abs(l+s)&&0.1>Math.abs(p+n+j-3)){return this.set(1,0,0,0),this}t=Math.PI;p=(p+1)/2;n=(n+1)/2;j=(j+1)/2;q=(q+m)/4;o=(o+r)/4;l=(l+s)/4;p>n&&p>j?0.01>p?(s=0,q=r=0.707106781):(s=Math.sqrt(p),r=q/s,q=o/s):n>j?0.01>n?(s=0.707106781,r=0,q=0.707106781):(r=Math.sqrt(n),s=q/r,q=l/r):0.01>j?(r=s=0.707106781,q=0):(q=Math.sqrt(j),s=o/q,r=l/q);this.set(s,r,q,t);return this}t=Math.sqrt((s-l)*(s-l)+(o-r)*(o-r)+(m-q)*(m-q));0.001>Math.abs(t)&&(t=1);this.x=(s-l)/t;this.y=(o-r)/t;this.z=(m-q)/t;this.w=Math.acos((p+n+j-1)/2);return this},min:function(b){this.x>b.x&&(this.x=b.x);this.y>b.y&&(this.y=b.y);this.z>b.z&&(this.z=b.z);this.w>b.w&&(this.w=b.w);return this},max:function(b){this.x<b.x&&(this.x=b.x);this.y<b.y&&(this.y=b.y);this.z<b.z&&(this.z=b.z);this.w<b.w&&(this.w=b.w);return this},clamp:function(d,c){this.x<d.x?this.x=d.x:this.x>c.x&&(this.x=c.x);this.y<d.y?this.y=d.y:this.y>c.y&&(this.y=c.y);this.z<d.z?this.z=d.z:this.z>c.z&&(this.z=c.z);this.w<d.w?this.w=d.w:this.w>c.w&&(this.w=c.w);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(b){return this.x*b.x+this.y*b.y+this.z*b.z+this.w*b.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(d){var c=this.length();0!==c&&d!==c&&this.multiplyScalar(d/c);return this},lerp:function(d,c){this.x+=(d.x-this.x)*c;this.y+=(d.y-this.y)*c;this.z+=(d.z-this.z)*c;this.w+=(d.w-this.w)*c;return this},equals:function(b){return b.x===this.x&&b.y===this.y&&b.z===this.z&&b.w===this.w},fromArray:function(b){this.x=b[0];this.y=b[1];this.z=b[2];this.w=b[3];return this},toArray:function(){return[this.x,this.y,this.z,this.w]},clone:function(){return new THREE.Vector4(this.x,this.y,this.z,this.w)}};THREE.Euler=function(f,e,h,g){this._x=f||0;this._y=e||0;this._z=h||0;this._order=g||THREE.Euler.DefaultOrder};THREE.Euler.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" ");THREE.Euler.DefaultOrder="XYZ";THREE.Euler.prototype={constructor:THREE.Euler,_x:0,_y:0,_z:0,_order:THREE.Euler.DefaultOrder,_quaternion:void 0,_updateQuaternion:function(){void 0!==this._quaternion&&this._quaternion.setFromEuler(this,!1)},get xfunction(){return this._x},set xfunction(b){this._x=b;this._updateQuaternion()},get yfunction(){return this._y},set yfunction(b){this._y=b;this._updateQuaternion()},get zfunction(){return this._z},set zfunction(b){this._z=b;this._updateQuaternion()},get orderfunction(){return this._order},set orderfunction(b){this._order=b;this._updateQuaternion()},set:function(f,e,h,g){this._x=f;this._y=e;this._z=h;this._order=g||this._order;this._updateQuaternion();return this},copy:function(b){this._x=b._x;this._y=b._y;this._z=b._z;this._order=b._order;this._updateQuaternion();return this},setFromRotationMatrix:function(B,A){function v(b){return Math.min(Math.max(b,-1),1)}var u=B.elements,t=u[0],s=u[4],q=u[8],r=u[1],p=u[5],o=u[9],j=u[2],n=u[6],u=u[10],A=A||this._order;"XYZ"===A?(this._y=Math.asin(v(q)),0.99999>Math.abs(q)?(this._x=Math.atan2(-o,u),this._z=Math.atan2(-s,t)):(this._x=Math.atan2(n,p),this._z=0)):"YXZ"===A?(this._x=Math.asin(-v(o)),0.99999>Math.abs(o)?(this._y=Math.atan2(q,u),this._z=Math.atan2(r,p)):(this._y=Math.atan2(-j,t),this._z=0)):"ZXY"===A?(this._x=Math.asin(v(n)),0.99999>Math.abs(n)?(this._y=Math.atan2(-j,u),this._z=Math.atan2(-s,p)):(this._y=0,this._z=Math.atan2(r,t))):"ZYX"===A?(this._y=Math.asin(-v(j)),0.99999>Math.abs(j)?(this._x=Math.atan2(n,u),this._z=Math.atan2(r,t)):(this._x=0,this._z=Math.atan2(-s,p))):"YZX"===A?(this._z=Math.asin(v(r)),0.99999>Math.abs(r)?(this._x=Math.atan2(-o,p),this._y=Math.atan2(-j,t)):(this._x=0,this._y=Math.atan2(q,u))):"XZY"===A?(this._z=Math.asin(-v(s)),0.99999>Math.abs(s)?(this._x=Math.atan2(n,p),this._y=Math.atan2(q,t)):(this._x=Math.atan2(-o,u),this._y=0)):console.warn("WARNING: Euler.setFromRotationMatrix() given unsupported order: "+A);this._order=A;this._updateQuaternion();return this},setFromQuaternion:function(j,i,p){function o(b){return Math.min(Math.max(b,-1),1)}var n=j.x*j.x,m=j.y*j.y,k=j.z*j.z,l=j.w*j.w,i=i||this._order;"XYZ"===i?(this._x=Math.atan2(2*(j.x*j.w-j.y*j.z),l-n-m+k),this._y=Math.asin(o(2*(j.x*j.z+j.y*j.w))),this._z=Math.atan2(2*(j.z*j.w-j.x*j.y),l+n-m-k)):"YXZ"===i?(this._x=Math.asin(o(2*(j.x*j.w-j.y*j.z))),this._y=Math.atan2(2*(j.x*j.z+j.y*j.w),l-n-m+k),this._z=Math.atan2(2*(j.x*j.y+j.z*j.w),l-n+m-k)):"ZXY"===i?(this._x=Math.asin(o(2*(j.x*j.w+j.y*j.z))),this._y=Math.atan2(2*(j.y*j.w-j.z*j.x),l-n-m+k),this._z=Math.atan2(2*(j.z*j.w-j.x*j.y),l-n+m-k)):"ZYX"===i?(this._x=Math.atan2(2*(j.x*j.w+j.z*j.y),l-n-m+k),this._y=Math.asin(o(2*(j.y*j.w-j.x*j.z))),this._z=Math.atan2(2*(j.x*j.y+j.z*j.w),l+n-m-k)):"YZX"===i?(this._x=Math.atan2(2*(j.x*j.w-j.z*j.y),l-n+m-k),this._y=Math.atan2(2*(j.y*j.w-j.x*j.z),l+n-m-k),this._z=Math.asin(o(2*(j.x*j.y+j.z*j.w)))):"XZY"===i?(this._x=Math.atan2(2*(j.x*j.w+j.y*j.z),l-n+m-k),this._y=Math.atan2(2*(j.x*j.z+j.y*j.w),l+n-m-k),this._z=Math.asin(o(2*(j.z*j.w-j.x*j.y)))):console.warn("WARNING: Euler.setFromQuaternion() given unsupported order: "+i);this._order=i;!1!==p&&this._updateQuaternion();return this},reorder:function(){var b=new THREE.Quaternion;return function(a){b.setFromEuler(this);this.setFromQuaternion(b,a)}}(),fromArray:function(b){this._x=b[0];this._y=b[1];this._z=b[2];void 0!==b[3]&&(this._order=b[3]);this._updateQuaternion();return this},toArray:function(){return[this._x,this._y,this._z,this._order]},equals:function(b){return b._x===this._x&&b._y===this._y&&b._z===this._z&&b._order===this._order},clone:function(){return new THREE.Euler(this._x,this._y,this._z,this._order)}};THREE.Line3=function(d,c){this.start=void 0!==d?d:new THREE.Vector3;this.end=void 0!==c?c:new THREE.Vector3};THREE.Line3.prototype={constructor:THREE.Line3,set:function(d,c){this.start.copy(d);this.end.copy(c);return this},copy:function(b){this.start.copy(b.start);this.end.copy(b.end);return this},center:function(b){return(b||new THREE.Vector3).addVectors(this.start,this.end).multiplyScalar(0.5)},delta:function(b){return(b||new THREE.Vector3).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,d){var f=d||new THREE.Vector3;return this.delta(f).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(){var d=new THREE.Vector3,c=new THREE.Vector3;return function(f,b){d.subVectors(f,this.start);c.subVectors(this.end,this.start);var a=c.dot(c),a=c.dot(d)/a;b&&(a=THREE.Math.clamp(a,0,1));return a}}(),closestPointToPoint:function(e,d,f){e=this.closestPointToPointParameter(e,d);f=f||new THREE.Vector3;return this.delta(f).multiplyScalar(e).add(this.start)},applyMatrix4:function(b){this.start.applyMatrix4(b);this.end.applyMatrix4(b);return this},equals:function(b){return b.start.equals(this.start)&&b.end.equals(this.end)},clone:function(){return(new THREE.Line3).copy(this)}};THREE.Box2=function(d,c){this.min=void 0!==d?d:new THREE.Vector2(Infinity,Infinity);this.max=void 0!==c?c:new THREE.Vector2(-Infinity,-Infinity)};THREE.Box2.prototype={constructor:THREE.Box2,set:function(d,c){this.min.copy(d);this.max.copy(c);return this},setFromPoints:function(f){if(0<f.length){var e=f[0];this.min.copy(e);this.max.copy(e);for(var h=1,g=f.length;h<g;h++){e=f[h],e.x<this.min.x?this.min.x=e.x:e.x>this.max.x&&(this.max.x=e.x),e.y<this.min.y?this.min.y=e.y:e.y>this.max.y&&(this.max.y=e.y)}}else{this.makeEmpty()}return this},setFromCenterAndSize:function(){var b=new THREE.Vector2;return function(a,f){var e=b.copy(f).multiplyScalar(0.5);this.min.copy(a).sub(e);this.max.copy(a).add(e);return this}}(),copy:function(b){this.min.copy(b.min);this.max.copy(b.max);return this},makeEmpty:function(){this.min.x=this.min.y=Infinity;this.max.x=this.max.y=-Infinity;return this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(b){return(b||new THREE.Vector2).addVectors(this.min,this.max).multiplyScalar(0.5)},size:function(b){return(b||new THREE.Vector2).subVectors(this.max,this.min)},expandByPoint:function(b){this.min.min(b);this.max.max(b);return this},expandByVector:function(b){this.min.sub(b);this.max.add(b);return this},expandByScalar:function(b){this.min.addScalar(-b);this.max.addScalar(b);return this},containsPoint:function(b){return b.x<this.min.x||b.x>this.max.x||b.y<this.min.y||b.y>this.max.y?!1:!0},containsBox:function(b){return this.min.x<=b.min.x&&b.max.x<=this.max.x&&this.min.y<=b.min.y&&b.max.y<=this.max.y?!0:!1},getParameter:function(b){return new THREE.Vector2((b.x-this.min.x)/(this.max.x-this.min.x),(b.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(b){return b.max.x<this.min.x||b.min.x>this.max.x||b.max.y<this.min.y||b.min.y>this.max.y?!1:!0},clampPoint:function(d,c){return(c||new THREE.Vector2).copy(d).clamp(this.min,this.max)},distanceToPoint:function(){var b=new THREE.Vector2;return function(a){return b.copy(a).clamp(this.min,this.max).sub(a).length()}}(),intersect:function(b){this.min.max(b.min);this.max.min(b.max);return this},union:function(b){this.min.min(b.min);this.max.max(b.max);return this},translate:function(b){this.min.add(b);this.max.add(b);return this},equals:function(b){return b.min.equals(this.min)&&b.max.equals(this.max)},clone:function(){return(new THREE.Box2).copy(this)}};THREE.Box3=function(d,c){this.min=void 0!==d?d:new THREE.Vector3(Infinity,Infinity,Infinity);this.max=void 0!==c?c:new THREE.Vector3(-Infinity,-Infinity,-Infinity)};THREE.Box3.prototype={constructor:THREE.Box3,set:function(d,c){this.min.copy(d);this.max.copy(c);return this},addPoint:function(b){b.x<this.min.x?this.min.x=b.x:b.x>this.max.x&&(this.max.x=b.x);b.y<this.min.y?this.min.y=b.y:b.y>this.max.y&&(this.max.y=b.y);b.z<this.min.z?this.min.z=b.z:b.z>this.max.z&&(this.max.z=b.z)},setFromPoints:function(e){if(0<e.length){var d=e[0];this.min.copy(d);this.max.copy(d);for(var d=1,f=e.length;d<f;d++){this.addPoint(e[d])}}else{this.makeEmpty()}return this},setFromCenterAndSize:function(){var b=new THREE.Vector3;return function(a,f){var e=b.copy(f).multiplyScalar(0.5);this.min.copy(a).sub(e);this.max.copy(a).add(e);return this}}(),setFromObject:function(){var b=new THREE.Vector3;return function(a){var d=this;a.updateMatrixWorld(!0);this.makeEmpty();a.traverse(function(c){if(void 0!==c.geometry&&void 0!==c.geometry.vertices){for(var j=c.geometry.vertices,i=0,g=j.length;i<g;i++){b.copy(j[i]),b.applyMatrix4(c.matrixWorld),d.expandByPoint(b)}}});return this}}(),copy:function(b){this.min.copy(b.min);this.max.copy(b.max);return this},makeEmpty:function(){this.min.x=this.min.y=this.min.z=Infinity;this.max.x=this.max.y=this.max.z=-Infinity;return this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(b){return(b||new THREE.Vector3).addVectors(this.min,this.max).multiplyScalar(0.5)},size:function(b){return(b||new THREE.Vector3).subVectors(this.max,this.min)},expandByPoint:function(b){this.min.min(b);this.max.max(b);return this},expandByVector:function(b){this.min.sub(b);this.max.add(b);return this},expandByScalar:function(b){this.min.addScalar(-b);this.max.addScalar(b);return this},containsPoint:function(b){return b.x<this.min.x||b.x>this.max.x||b.y<this.min.y||b.y>this.max.y||b.z<this.min.z||b.z>this.max.z?!1:!0},containsBox:function(b){return this.min.x<=b.min.x&&b.max.x<=this.max.x&&this.min.y<=b.min.y&&b.max.y<=this.max.y&&this.min.z<=b.min.z&&b.max.z<=this.max.z?!0:!1},getParameter:function(b){return new THREE.Vector3((b.x-this.min.x)/(this.max.x-this.min.x),(b.y-this.min.y)/(this.max.y-this.min.y),(b.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(b){return b.max.x<this.min.x||b.min.x>this.max.x||b.max.y<this.min.y||b.min.y>this.max.y||b.max.z<this.min.z||b.min.z>this.max.z?!1:!0},clampPoint:function(d,c){return(c||new THREE.Vector3).copy(d).clamp(this.min,this.max)},distanceToPoint:function(){var b=new THREE.Vector3;return function(a){return b.copy(a).clamp(this.min,this.max).sub(a).length()}}(),getBoundingSphere:function(){var b=new THREE.Vector3;return function(a){a=a||new THREE.Sphere;a.center=this.center();a.radius=0.5*this.size(b).length();return a}}(),intersect:function(b){this.min.max(b.min);this.max.min(b.max);return this},union:function(b){this.min.min(b.min);this.max.max(b.max);return this},applyMatrix4:function(){var b=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];return function(a){b[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(a);b[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(a);b[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(a);b[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(a);b[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(a);b[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(a);b[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(a);b[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(a);this.makeEmpty();this.setFromPoints(b);return this}}(),translate:function(b){this.min.add(b);this.max.add(b);return this},equals:function(b){return b.min.equals(this.min)&&b.max.equals(this.max)},clone:function(){return(new THREE.Box3).copy(this)}};THREE.Matrix3=function(r,q,p,o,n,m,k,l,j){this.elements=new Float32Array(9);this.set(void 0!==r?r:1,q||0,p||0,o||0,void 0!==n?n:1,m||0,k||0,l||0,void 0!==j?j:1)};THREE.Matrix3.prototype={constructor:THREE.Matrix3,set:function(t,s,r,q,p,o,m,n,l){var j=this.elements;j[0]=t;j[3]=s;j[6]=r;j[1]=q;j[4]=p;j[7]=o;j[2]=m;j[5]=n;j[8]=l;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},copy:function(b){b=b.elements;this.set(b[0],b[3],b[6],b[1],b[4],b[7],b[2],b[5],b[8]);return this},multiplyVector3:function(b){console.warn("DEPRECATED: Matrix3's .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.");return b.applyMatrix3(this)},multiplyVector3Array:function(){var b=new THREE.Vector3;return function(a){for(var f=0,e=a.length;f<e;f+=3){b.x=a[f],b.y=a[f+1],b.z=a[f+2],b.applyMatrix3(this),a[f]=b.x,a[f+1]=b.y,a[f+2]=b.z}return a}}(),multiplyScalar:function(d){var c=this.elements;c[0]*=d;c[3]*=d;c[6]*=d;c[1]*=d;c[4]*=d;c[7]*=d;c[2]*=d;c[5]*=d;c[8]*=d;return this},determinant:function(){var r=this.elements,q=r[0],p=r[1],o=r[2],n=r[3],m=r[4],k=r[5],l=r[6],j=r[7],r=r[8];return q*m*r-q*k*j-p*n*r+p*k*l+o*n*j-o*m*l},getInverse:function(f,e){var h=f.elements,g=this.elements;g[0]=h[10]*h[5]-h[6]*h[9];g[1]=-h[10]*h[1]+h[2]*h[9];g[2]=h[6]*h[1]-h[2]*h[5];g[3]=-h[10]*h[4]+h[6]*h[8];g[4]=h[10]*h[0]-h[2]*h[8];g[5]=-h[6]*h[0]+h[2]*h[4];g[6]=h[9]*h[4]-h[5]*h[8];g[7]=-h[9]*h[0]+h[1]*h[8];g[8]=h[5]*h[0]-h[1]*h[4];h=h[0]*g[0]+h[1]*g[3]+h[2]*g[6];if(0===h){if(e){throw Error("Matrix3.getInverse(): can't invert matrix, determinant is 0")}console.warn("Matrix3.getInverse(): can't invert matrix, determinant is 0");this.identity();return this}this.multiplyScalar(1/h);return this},transpose:function(){var d,c=this.elements;d=c[1];c[1]=c[3];c[3]=d;d=c[2];c[2]=c[6];c[6]=d;d=c[5];c[5]=c[7];c[7]=d;return this},getNormalMatrix:function(b){this.getInverse(b).transpose();return this},transposeIntoArray:function(d){var c=this.elements;d[0]=c[0];d[1]=c[3];d[2]=c[6];d[3]=c[1];d[4]=c[4];d[5]=c[7];d[6]=c[2];d[7]=c[5];d[8]=c[8];return this},clone:function(){var b=this.elements;return new THREE.Matrix3(b[0],b[3],b[6],b[1],b[4],b[7],b[2],b[5],b[8])}};THREE.Matrix4=function(J,I,H,G,F,E,C,D,B,A,u,v,o,L,K,q){var j=this.elements=new Float32Array(16);j[0]=void 0!==J?J:1;j[4]=I||0;j[8]=H||0;j[12]=G||0;j[1]=F||0;j[5]=void 0!==E?E:1;j[9]=C||0;j[13]=D||0;j[2]=B||0;j[6]=A||0;j[10]=void 0!==u?u:1;j[14]=v||0;j[3]=o||0;j[7]=L||0;j[11]=K||0;j[15]=void 0!==q?q:1};THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(J,I,H,G,F,E,C,D,B,A,u,v,o,L,K,q){var j=this.elements;j[0]=J;j[4]=I;j[8]=H;j[12]=G;j[1]=F;j[5]=E;j[9]=C;j[13]=D;j[2]=B;j[6]=A;j[10]=u;j[14]=v;j[3]=o;j[7]=L;j[11]=K;j[15]=q;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},copy:function(b){this.elements.set(b.elements);return this},extractPosition:function(b){console.warn("DEPRECATED: Matrix4's .extractPosition() has been renamed to .copyPosition().");return this.copyPosition(b)},copyPosition:function(d){var c=this.elements,d=d.elements;c[12]=d[12];c[13]=d[13];c[14]=d[14];return this},extractRotation:function(){var b=new THREE.Vector3;return function(a){var j=this.elements,a=a.elements,i=1/b.set(a[0],a[1],a[2]).length(),h=1/b.set(a[4],a[5],a[6]).length(),g=1/b.set(a[8],a[9],a[10]).length();j[0]=a[0]*i;j[1]=a[1]*i;j[2]=a[2]*i;j[4]=a[4]*h;j[5]=a[5]*h;j[6]=a[6]*h;j[8]=a[8]*g;j[9]=a[9]*g;j[10]=a[10]*g;return this}}(),makeRotationFromEuler:function(v){!1===v instanceof THREE.Euler&&console.error("ERROR: Matrix's .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code.");var u=this.elements,t=v.x,s=v.y,r=v.z,q=Math.cos(t),t=Math.sin(t),o=Math.cos(s),s=Math.sin(s),p=Math.cos(r),r=Math.sin(r);if("XYZ"===v.order){var v=q*p,n=q*r,l=t*p,j=t*r;u[0]=o*p;u[4]=-o*r;u[8]=s;u[1]=n+l*s;u[5]=v-j*s;u[9]=-t*o;u[2]=j-v*s;u[6]=l+n*s;u[10]=q*o}else{"YXZ"===v.order?(v=o*p,n=o*r,l=s*p,j=s*r,u[0]=v+j*t,u[4]=l*t-n,u[8]=q*s,u[1]=q*r,u[5]=q*p,u[9]=-t,u[2]=n*t-l,u[6]=j+v*t,u[10]=q*o):"ZXY"===v.order?(v=o*p,n=o*r,l=s*p,j=s*r,u[0]=v-j*t,u[4]=-q*r,u[8]=l+n*t,u[1]=n+l*t,u[5]=q*p,u[9]=j-v*t,u[2]=-q*s,u[6]=t,u[10]=q*o):"ZYX"===v.order?(v=q*p,n=q*r,l=t*p,j=t*r,u[0]=o*p,u[4]=l*s-n,u[8]=v*s+j,u[1]=o*r,u[5]=j*s+v,u[9]=n*s-l,u[2]=-s,u[6]=t*o,u[10]=q*o):"YZX"===v.order?(v=q*o,n=q*s,l=t*o,j=t*s,u[0]=o*p,u[4]=j-v*r,u[8]=l*r+n,u[1]=r,u[5]=q*p,u[9]=-t*p,u[2]=-s*p,u[6]=n*r+l,u[10]=v-j*r):"XZY"===v.order&&(v=q*o,n=q*s,l=t*o,j=t*s,u[0]=o*p,u[4]=-r,u[8]=s*p,u[1]=v*r+j,u[5]=q*p,u[9]=n*r-l,u[2]=l*r-n,u[6]=t*p,u[10]=j*r+v)}u[3]=0;u[7]=0;u[11]=0;u[12]=0;u[13]=0;u[14]=0;u[15]=1;return this},setRotationFromQuaternion:function(b){console.warn("DEPRECATED: Matrix4's .setRotationFromQuaternion() has been deprecated in favor of makeRotationFromQuaternion.  Please update your code.");return this.makeRotationFromQuaternion(b)},makeRotationFromQuaternion:function(v){var u=this.elements,t=v.x,s=v.y,r=v.z,q=v.w,o=t+t,p=s+s,n=r+r,v=t*o,l=t*p,t=t*n,j=s*p,s=s*n,r=r*n,o=q*o,p=q*p,q=q*n;u[0]=1-(j+r);u[4]=l-q;u[8]=t+p;u[1]=l+q;u[5]=1-(v+r);u[9]=s-o;u[2]=t-p;u[6]=s+o;u[10]=1-(v+j);u[3]=0;u[7]=0;u[11]=0;u[12]=0;u[13]=0;u[14]=0;u[15]=1;return this},lookAt:function(){var e=new THREE.Vector3,d=new THREE.Vector3,f=new THREE.Vector3;return function(g,c,b){var a=this.elements;f.subVectors(g,c).normalize();0===f.length()&&(f.z=1);e.crossVectors(b,f).normalize();0===e.length()&&(f.x+=0.0001,e.crossVectors(b,f).normalize());d.crossVectors(f,e);a[0]=e.x;a[4]=d.x;a[8]=f.x;a[1]=e.y;a[5]=d.y;a[9]=f.y;a[2]=e.z;a[6]=d.z;a[10]=f.z;return this}}(),multiply:function(d,c){return void 0!==c?(console.warn("DEPRECATED: Matrix4's .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(d,c)):this.multiplyMatrices(this,d)},multiplyMatrices:function(ar,aq){var ap=ar.elements,ao=aq.elements,an=this.elements,am=ap[0],ak=ap[4],al=ap[8],aj=ap[12],ai=ap[1],ag=ap[5],ah=ap[9],ae=ap[13],Y=ap[2],W=ap[6],af=ap[10],aa=ap[14],ac=ap[3],U=ap[7],P=ap[11],ap=ap[15],H=ao[0],ab=ao[4],X=ao[8],N=ao[12],T=ao[1],ad=ao[5],o=ao[9],Z=ao[13],V=ao[2],M=ao[6],L=ao[10],S=ao[14],Q=ao[3],j=ao[7],K=ao[11],ao=ao[15];an[0]=am*H+ak*T+al*V+aj*Q;an[4]=am*ab+ak*ad+al*M+aj*j;an[8]=am*X+ak*o+al*L+aj*K;an[12]=am*N+ak*Z+al*S+aj*ao;an[1]=ai*H+ag*T+ah*V+ae*Q;an[5]=ai*ab+ag*ad+ah*M+ae*j;an[9]=ai*X+ag*o+ah*L+ae*K;an[13]=ai*N+ag*Z+ah*S+ae*ao;an[2]=Y*H+W*T+af*V+aa*Q;an[6]=Y*ab+W*ad+af*M+aa*j;an[10]=Y*X+W*o+af*L+aa*K;an[14]=Y*N+W*Z+af*S+aa*ao;an[3]=ac*H+U*T+P*V+ap*Q;an[7]=ac*ab+U*ad+P*M+ap*j;an[11]=ac*X+U*o+P*L+ap*K;an[15]=ac*N+U*Z+P*S+ap*ao;return this},multiplyToArray:function(f,e,h){var g=this.elements;this.multiplyMatrices(f,e);h[0]=g[0];h[1]=g[1];h[2]=g[2];h[3]=g[3];h[4]=g[4];h[5]=g[5];h[6]=g[6];h[7]=g[7];h[8]=g[8];h[9]=g[9];h[10]=g[10];h[11]=g[11];h[12]=g[12];h[13]=g[13];h[14]=g[14];h[15]=g[15];return this},multiplyScalar:function(d){var c=this.elements;c[0]*=d;c[4]*=d;c[8]*=d;c[12]*=d;c[1]*=d;c[5]*=d;c[9]*=d;c[13]*=d;c[2]*=d;c[6]*=d;c[10]*=d;c[14]*=d;c[3]*=d;c[7]*=d;c[11]*=d;c[15]*=d;return this},multiplyVector3:function(b){console.warn("DEPRECATED: Matrix4's .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead.");return b.applyProjection(this)},multiplyVector4:function(b){console.warn("DEPRECATED: Matrix4's .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.");return b.applyMatrix4(this)},multiplyVector3Array:function(){var b=new THREE.Vector3;return function(a){for(var f=0,e=a.length;f<e;f+=3){b.x=a[f],b.y=a[f+1],b.z=a[f+2],b.applyProjection(this),a[f]=b.x,a[f+1]=b.y,a[f+2]=b.z}return a}}(),rotateAxis:function(b){console.warn("DEPRECATED: Matrix4's .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.");b.transformDirection(this)},crossVector:function(b){console.warn("DEPRECATED: Matrix4's .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.");return b.applyMatrix4(this)},determinant:function(){var D=this.elements,C=D[0],B=D[4],A=D[8],v=D[12],u=D[1],s=D[5],t=D[9],r=D[13],q=D[2],n=D[6],o=D[10],j=D[14];return D[3]*(+v*t*n-A*r*n-v*s*o+B*r*o+A*s*j-B*t*j)+D[7]*(+C*t*j-C*r*o+v*u*o-A*u*j+A*r*q-v*t*q)+D[11]*(+C*r*n-C*s*j-v*u*n+B*u*j+v*s*q-B*r*q)+D[15]*(-A*s*q-C*t*n+C*s*o+A*u*n-B*u*o+B*t*q)},transpose:function(){var d=this.elements,c;c=d[1];d[1]=d[4];d[4]=c;c=d[2];d[2]=d[8];d[8]=c;c=d[6];d[6]=d[9];d[9]=c;c=d[3];d[3]=d[12];d[12]=c;c=d[7];d[7]=d[13];d[13]=c;c=d[11];d[11]=d[14];d[14]=c;return this},flattenToArray:function(d){var c=this.elements;d[0]=c[0];d[1]=c[1];d[2]=c[2];d[3]=c[3];d[4]=c[4];d[5]=c[5];d[6]=c[6];d[7]=c[7];d[8]=c[8];d[9]=c[9];d[10]=c[10];d[11]=c[11];d[12]=c[12];d[13]=c[13];d[14]=c[14];d[15]=c[15];return d},flattenToArrayOffset:function(e,d){var f=this.elements;e[d]=f[0];e[d+1]=f[1];e[d+2]=f[2];e[d+3]=f[3];e[d+4]=f[4];e[d+5]=f[5];e[d+6]=f[6];e[d+7]=f[7];e[d+8]=f[8];e[d+9]=f[9];e[d+10]=f[10];e[d+11]=f[11];e[d+12]=f[12];e[d+13]=f[13];e[d+14]=f[14];e[d+15]=f[15];return e},getPosition:function(){var b=new THREE.Vector3;return function(){console.warn("DEPRECATED: Matrix4's .getPosition() has been removed. Use Vector3.getPositionFromMatrix( matrix ) instead.");var a=this.elements;return b.set(a[12],a[13],a[14])}}(),setPosition:function(d){var c=this.elements;c[12]=d.x;c[13]=d.y;c[14]=d.z;return this},getInverse:function(P,O){var N=this.elements,M=P.elements,L=M[0],K=M[4],I=M[8],J=M[12],H=M[1],G=M[5],E=M[9],F=M[13],C=M[2],v=M[6],o=M[10],D=M[14],A=M[3],B=M[7],j=M[11],M=M[15];N[0]=E*D*B-F*o*B+F*v*j-G*D*j-E*v*M+G*o*M;N[4]=J*o*B-I*D*B-J*v*j+K*D*j+I*v*M-K*o*M;N[8]=I*F*B-J*E*B+J*G*j-K*F*j-I*G*M+K*E*M;N[12]=J*E*v-I*F*v-J*G*o+K*F*o+I*G*D-K*E*D;N[1]=F*o*A-E*D*A-F*C*j+H*D*j+E*C*M-H*o*M;N[5]=I*D*A-J*o*A+J*C*j-L*D*j-I*C*M+L*o*M;N[9]=J*E*A-I*F*A-J*H*j+L*F*j+I*H*M-L*E*M;N[13]=I*F*C-J*E*C+J*H*o-L*F*o-I*H*D+L*E*D;N[2]=G*D*A-F*v*A+F*C*B-H*D*B-G*C*M+H*v*M;N[6]=J*v*A-K*D*A-J*C*B+L*D*B+K*C*M-L*v*M;N[10]=K*F*A-J*G*A+J*H*B-L*F*B-K*H*M+L*G*M;N[14]=J*G*C-K*F*C-J*H*v+L*F*v+K*H*D-L*G*D;N[3]=E*v*A-G*o*A-E*C*B+H*o*B+G*C*j-H*v*j;N[7]=K*o*A-I*v*A+I*C*B-L*o*B-K*C*j+L*v*j;N[11]=I*G*A-K*E*A-I*H*B+L*E*B+K*H*j-L*G*j;N[15]=K*E*C-I*G*C+I*H*v-L*E*v-K*H*o+L*G*o;N=L*N[0]+H*N[4]+C*N[8]+A*N[12];if(0==N){if(O){throw Error("Matrix4.getInverse(): can't invert matrix, determinant is 0")}console.warn("Matrix4.getInverse(): can't invert matrix, determinant is 0");this.identity();return this}this.multiplyScalar(1/N);return this},translate:function(){console.warn("DEPRECATED: Matrix4's .translate() has been removed.")},rotateX:function(){console.warn("DEPRECATED: Matrix4's .rotateX() has been removed.")},rotateY:function(){console.warn("DEPRECATED: Matrix4's .rotateY() has been removed.")},rotateZ:function(){console.warn("DEPRECATED: Matrix4's .rotateZ() has been removed.")},rotateByAxis:function(){console.warn("DEPRECATED: Matrix4's .rotateByAxis() has been removed.")},scale:function(f){var e=this.elements,h=f.x,g=f.y,f=f.z;e[0]*=h;e[4]*=g;e[8]*=f;e[1]*=h;e[5]*=g;e[9]*=f;e[2]*=h;e[6]*=g;e[10]*=f;e[3]*=h;e[7]*=g;e[11]*=f;return this},getMaxScaleOnAxis:function(){var b=this.elements;return Math.sqrt(Math.max(b[0]*b[0]+b[1]*b[1]+b[2]*b[2],Math.max(b[4]*b[4]+b[5]*b[5]+b[6]*b[6],b[8]*b[8]+b[9]*b[9]+b[10]*b[10])))},makeTranslation:function(e,d,f){this.set(1,0,0,e,0,1,0,d,0,0,1,f,0,0,0,1);return this},makeRotationX:function(d){var c=Math.cos(d),d=Math.sin(d);this.set(1,0,0,0,0,c,-d,0,0,d,c,0,0,0,0,1);return this},makeRotationY:function(d){var c=Math.cos(d),d=Math.sin(d);this.set(c,0,d,0,0,1,0,0,-d,0,c,0,0,0,0,1);return this},makeRotationZ:function(d){var c=Math.cos(d),d=Math.sin(d);this.set(c,-d,0,0,d,c,0,0,0,0,1,0,0,0,0,1);return this},makeRotationAxis:function(t,s){var r=Math.cos(s),q=Math.sin(s),p=1-r,o=t.x,m=t.y,n=t.z,l=p*o,j=p*m;this.set(l*o+r,l*m-q*n,l*n+q*m,0,l*m+q*n,j*m+r,j*n-q*o,0,l*n-q*m,j*n+q*o,p*n*n+r,0,0,0,0,1);return this},makeScale:function(e,d,f){this.set(e,0,0,0,0,d,0,0,0,0,f,0,0,0,0,1);return this},compose:function(e,d,f){this.makeRotationFromQuaternion(d);this.scale(f);this.setPosition(e);return this},decompose:function(){var d=new THREE.Vector3,c=new THREE.Matrix4;return function(p,o,n){var m=this.elements,j=d.set(m[0],m[1],m[2]).length(),l=d.set(m[4],m[5],m[6]).length(),b=d.set(m[8],m[9],m[10]).length();p.x=m[12];p.y=m[13];p.z=m[14];c.elements.set(this.elements);var p=1/j,m=1/l,a=1/b;c.elements[0]*=p;c.elements[1]*=p;c.elements[2]*=p;c.elements[4]*=m;c.elements[5]*=m;c.elements[6]*=m;c.elements[8]*=a;c.elements[9]*=a;c.elements[10]*=a;o.setFromRotationMatrix(c);n.x=j;n.y=l;n.z=b;return this}}(),makeFrustum:function(i,g,n,m,l,k){var j=this.elements;j[0]=2*l/(g-i);j[4]=0;j[8]=(g+i)/(g-i);j[12]=0;j[1]=0;j[5]=2*l/(m-n);j[9]=(m+n)/(m-n);j[13]=0;j[2]=0;j[6]=0;j[10]=-(k+l)/(k-l);j[14]=-2*k*l/(k-l);j[3]=0;j[7]=0;j[11]=-1;j[15]=0;return this},makePerspective:function(g,f,j,i){var g=j*Math.tan(THREE.Math.degToRad(0.5*g)),h=-g;return this.makeFrustum(h*f,g*f,h,g,j,i)},makeOrthographic:function(t,s,r,q,p,o){var m=this.elements,n=s-t,l=r-q,j=o-p;m[0]=2/n;m[4]=0;m[8]=0;m[12]=-((s+t)/n);m[1]=0;m[5]=2/l;m[9]=0;m[13]=-((r+q)/l);m[2]=0;m[6]=0;m[10]=-2/j;m[14]=-((o+p)/j);m[3]=0;m[7]=0;m[11]=0;m[15]=1;return this},fromArray:function(b){this.elements.set(b);return this},toArray:function(){var b=this.elements;return[b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8],b[9],b[10],b[11],b[12],b[13],b[14],b[15]]},clone:function(){var b=this.elements;return new THREE.Matrix4(b[0],b[4],b[8],b[12],b[1],b[5],b[9],b[13],b[2],b[6],b[10],b[14],b[3],b[7],b[11],b[15])}};THREE.Ray=function(d,c){this.origin=void 0!==d?d:new THREE.Vector3;this.direction=void 0!==c?c:new THREE.Vector3};THREE.Ray.prototype={constructor:THREE.Ray,set:function(d,c){this.origin.copy(d);this.direction.copy(c);return this},copy:function(b){this.origin.copy(b.origin);this.direction.copy(b.direction);return this},at:function(d,c){return(c||new THREE.Vector3).copy(this.direction).multiplyScalar(d).add(this.origin)},recast:function(){var b=new THREE.Vector3;return function(a){this.origin.copy(this.at(a,b));return this}}(),closestPointToPoint:function(f,e){var h=e||new THREE.Vector3;h.subVectors(f,this.origin);var g=h.dot(this.direction);return 0>g?h.copy(this.origin):h.copy(this.direction).multiplyScalar(g).add(this.origin)},distanceToPoint:function(){var b=new THREE.Vector3;return function(a){var d=b.subVectors(a,this.origin).dot(this.direction);if(0>d){return this.origin.distanceTo(a)}b.copy(this.direction).multiplyScalar(d).add(this.origin);return b.distanceTo(a)}}(),distanceSqToSegment:function(D,C,B,A){var v=D.clone().add(C).multiplyScalar(0.5),u=C.clone().sub(D).normalize(),s=0.5*D.distanceTo(C),t=this.origin.clone().sub(v),D=-this.direction.dot(u),C=t.dot(this.direction),r=-t.dot(u),q=t.lengthSq(),n=Math.abs(1-D*D),o,j;0<=n?(t=D*r-C,o=D*C-r,j=s*n,0<=t?o>=-j?o<=j?(s=1/n,t*=s,o*=s,D=t*(t+D*o+2*C)+o*(D*t+o+2*r)+q):(o=s,t=Math.max(0,-(D*o+C)),D=-t*t+o*(o+2*r)+q):(o=-s,t=Math.max(0,-(D*o+C)),D=-t*t+o*(o+2*r)+q):o<=-j?(t=Math.max(0,-(-D*s+C)),o=0<t?-s:Math.min(Math.max(-s,-r),s),D=-t*t+o*(o+2*r)+q):o<=j?(t=0,o=Math.min(Math.max(-s,-r),s),D=o*(o+2*r)+q):(t=Math.max(0,-(D*s+C)),o=0<t?s:Math.min(Math.max(-s,-r),s),D=-t*t+o*(o+2*r)+q)):(o=0<D?-s:s,t=Math.max(0,-(D*o+C)),D=-t*t+o*(o+2*r)+q);B&&B.copy(this.direction.clone().multiplyScalar(t).add(this.origin));A&&A.copy(u.clone().multiplyScalar(o).add(v));return D},isIntersectionSphere:function(b){return this.distanceToPoint(b.center)<=b.radius},isIntersectionPlane:function(d){var c=d.distanceToPoint(this.origin);return 0===c||0>d.normal.dot(this.direction)*c?!0:!1},distanceToPlane:function(d){var c=d.normal.dot(this.direction);if(0==c){return 0==d.distanceToPoint(this.origin)?0:null}d=-(this.origin.dot(d.normal)+d.constant)/c;return 0<=d?d:null},intersectPlane:function(e,d){var f=this.distanceToPlane(e);return null===f?null:this.at(f,d)},isIntersectionBox:function(){var b=new THREE.Vector3;return function(a){return null!==this.intersectBox(a,b)}}(),intersectBox:function(j,i){var p,o,n,m,k;o=1/this.direction.x;m=1/this.direction.y;k=1/this.direction.z;var l=this.origin;0<=o?(p=(j.min.x-l.x)*o,o*=j.max.x-l.x):(p=(j.max.x-l.x)*o,o*=j.min.x-l.x);0<=m?(n=(j.min.y-l.y)*m,m*=j.max.y-l.y):(n=(j.max.y-l.y)*m,m*=j.min.y-l.y);if(p>m||n>o){return null}if(n>p||p!==p){p=n}if(m<o||o!==o){o=m}0<=k?(n=(j.min.z-l.z)*k,k*=j.max.z-l.z):(n=(j.max.z-l.z)*k,k*=j.min.z-l.z);if(p>k||n>o){return null}if(n>p||p!==p){p=n}if(k<o||o!==o){o=k}return 0>o?null:this.at(0<=p?p:o,i)},intersectTriangle:function(){var f=new THREE.Vector3,e=new THREE.Vector3,h=new THREE.Vector3,g=new THREE.Vector3;return function(j,d,b,c,a){e.subVectors(d,j);h.subVectors(b,j);g.crossVectors(e,h);d=this.direction.dot(g);if(0<d){if(c){return null}c=1}else{if(0>d){c=-1,d=-d}else{return null}}f.subVectors(this.origin,j);j=c*this.direction.dot(h.crossVectors(f,h));if(0>j){return null}b=c*this.direction.dot(e.cross(f));if(0>b||j+b>d){return null}j=-c*f.dot(g);return 0>j?null:this.at(j/d,a)}}(),applyMatrix4:function(b){this.direction.add(this.origin).applyMatrix4(b);this.origin.applyMatrix4(b);this.direction.sub(this.origin);this.direction.normalize();return this},equals:function(b){return b.origin.equals(this.origin)&&b.direction.equals(this.direction)},clone:function(){return(new THREE.Ray).copy(this)}};THREE.Sphere=function(d,c){this.center=void 0!==d?d:new THREE.Vector3;this.radius=void 0!==c?c:0};THREE.Sphere.prototype={constructor:THREE.Sphere,set:function(d,c){this.center.copy(d);this.radius=c;return this},setFromPoints:function(){var b=new THREE.Box3;return function(a,l){var k=this.center;void 0!==l?k.copy(l):b.setFromPoints(a).center(k);for(var j=0,i=0,g=a.length;i<g;i++){j=Math.max(j,k.distanceToSquared(a[i]))}this.radius=Math.sqrt(j);return this}}(),copy:function(b){this.center.copy(b.center);this.radius=b.radius;return this},empty:function(){return 0>=this.radius},containsPoint:function(b){return b.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(b){return b.distanceTo(this.center)-this.radius},intersectsSphere:function(d){var c=this.radius+d.radius;return d.center.distanceToSquared(this.center)<=c*c},clampPoint:function(f,e){var h=this.center.distanceToSquared(f),g=e||new THREE.Vector3;g.copy(f);h>this.radius*this.radius&&(g.sub(this.center).normalize(),g.multiplyScalar(this.radius).add(this.center));return g},getBoundingBox:function(b){b=b||new THREE.Box3;b.set(this.center,this.center);b.expandByScalar(this.radius);return b},applyMatrix4:function(b){this.center.applyMatrix4(b);this.radius*=b.getMaxScaleOnAxis();return this},translate:function(b){this.center.add(b);return this},equals:function(b){return b.center.equals(this.center)&&b.radius===this.radius},clone:function(){return(new THREE.Sphere).copy(this)}};THREE.Frustum=function(h,g,l,k,j,i){this.planes=[void 0!==h?h:new THREE.Plane,void 0!==g?g:new THREE.Plane,void 0!==l?l:new THREE.Plane,void 0!==k?k:new THREE.Plane,void 0!==j?j:new THREE.Plane,void 0!==i?i:new THREE.Plane]};THREE.Frustum.prototype={constructor:THREE.Frustum,set:function(i,g,n,m,l,k){var j=this.planes;j[0].copy(i);j[1].copy(g);j[2].copy(n);j[3].copy(m);j[4].copy(l);j[5].copy(k);return this},copy:function(e){for(var d=this.planes,f=0;6>f;f++){d[f].copy(e.planes[f])}return this},setFromMatrix:function(J){var I=this.planes,H=J.elements,J=H[0],G=H[1],F=H[2],E=H[3],C=H[4],D=H[5],B=H[6],A=H[7],u=H[8],v=H[9],o=H[10],L=H[11],K=H[12],q=H[13],j=H[14],H=H[15];I[0].setComponents(E-J,A-C,L-u,H-K).normalize();I[1].setComponents(E+J,A+C,L+u,H+K).normalize();I[2].setComponents(E+G,A+D,L+v,H+q).normalize();I[3].setComponents(E-G,A-D,L-v,H-q).normalize();I[4].setComponents(E-F,A-B,L-o,H-j).normalize();I[5].setComponents(E+F,A+B,L+o,H+j).normalize();return this},intersectsObject:function(){var b=new THREE.Sphere;return function(a){var d=a.geometry;null===d.boundingSphere&&d.computeBoundingSphere();b.copy(d.boundingSphere);b.applyMatrix4(a.matrixWorld);return this.intersectsSphere(b)}}(),intersectsSphere:function(f){for(var e=this.planes,h=f.center,f=-f.radius,g=0;6>g;g++){if(e[g].distanceToPoint(h)<f){return !1}}return !0},intersectsBox:function(){var d=new THREE.Vector3,c=new THREE.Vector3;return function(j){for(var i=this.planes,g=0;6>g;g++){var b=i[g];d.x=0<b.normal.x?j.min.x:j.max.x;c.x=0<b.normal.x?j.max.x:j.min.x;d.y=0<b.normal.y?j.min.y:j.max.y;c.y=0<b.normal.y?j.max.y:j.min.y;d.z=0<b.normal.z?j.min.z:j.max.z;c.z=0<b.normal.z?j.max.z:j.min.z;var a=b.distanceToPoint(d),b=b.distanceToPoint(c);if(0>a&&0>b){return !1}}return !0}}(),containsPoint:function(e){for(var d=this.planes,f=0;6>f;f++){if(0>d[f].distanceToPoint(e)){return !1}}return !0},clone:function(){return(new THREE.Frustum).copy(this)}};THREE.Plane=function(d,c){this.normal=void 0!==d?d:new THREE.Vector3(1,0,0);this.constant=void 0!==c?c:0};THREE.Plane.prototype={constructor:THREE.Plane,set:function(d,c){this.normal.copy(d);this.constant=c;return this},setComponents:function(f,e,h,g){this.normal.set(f,e,h);this.constant=g;return this},setFromNormalAndCoplanarPoint:function(d,c){this.normal.copy(d);this.constant=-c.dot(this.normal);return this},setFromCoplanarPoints:function(){var d=new THREE.Vector3,c=new THREE.Vector3;return function(f,b,a){b=d.subVectors(a,b).cross(c.subVectors(f,b)).normalize();this.setFromNormalAndCoplanarPoint(b,f);return this}}(),copy:function(b){this.normal.copy(b.normal);this.constant=b.constant;return this},normalize:function(){var b=1/this.normal.length();this.normal.multiplyScalar(b);this.constant*=b;return this},negate:function(){this.constant*=-1;this.normal.negate();return this},distanceToPoint:function(b){return this.normal.dot(b)+this.constant},distanceToSphere:function(b){return this.distanceToPoint(b.center)-b.radius},projectPoint:function(d,c){return this.orthoPoint(d,c).sub(d).negate()},orthoPoint:function(e,d){var f=this.distanceToPoint(e);return(d||new THREE.Vector3).copy(this.normal).multiplyScalar(f)},isIntersectionLine:function(d){var c=this.distanceToPoint(d.start),d=this.distanceToPoint(d.end);return 0>c&&0<d||0>d&&0<c},intersectLine:function(){var b=new THREE.Vector3;return function(a,j){var i=j||new THREE.Vector3,h=a.delta(b),g=this.normal.dot(h);if(0==g){if(0==this.distanceToPoint(a.start)){return i.copy(a.start)}}else{return g=-(a.start.dot(this.normal)+this.constant)/g,0>g||1<g?void 0:i.copy(h).multiplyScalar(g).add(a.start)}}}(),coplanarPoint:function(b){return(b||new THREE.Vector3).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var d=new THREE.Vector3,c=new THREE.Vector3;return function(h,g){var g=g||(new THREE.Matrix3).getNormalMatrix(h),b=d.copy(this.normal).applyMatrix3(g),a=this.coplanarPoint(c);a.applyMatrix4(h);this.setFromNormalAndCoplanarPoint(b,a);return this}}(),translate:function(b){this.constant-=b.dot(this.normal);return this},equals:function(b){return b.normal.equals(this.normal)&&b.constant==this.constant},clone:function(){return(new THREE.Plane).copy(this)}};THREE.Math={PI2:2*Math.PI,generateUUID:function(){var f="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),e=Array(36),h=0,g;return function(){for(var a=0;36>a;a++){8==a||13==a||18==a||23==a?e[a]="-":14==a?e[a]="4":(2>=h&&(h=33554432+16777216*Math.random()|0),g=h&15,h>>=4,e[a]=f[19==a?g&3|8:g])}return e.join("")}}(),clamp:function(e,d,f){return e<d?d:e>f?f:e},clampBottom:function(d,c){return d<c?c:d},mapLinear:function(g,f,j,i,h){return i+(g-f)*(h-i)/(j-f)},smoothstep:function(e,d,f){if(e<=d){return 0}if(e>=f){return 1}e=(e-d)/(f-d);return e*e*(3-2*e)},smootherstep:function(e,d,f){if(e<=d){return 0}if(e>=f){return 1}e=(e-d)/(f-d);return e*e*e*(e*(6*e-15)+10)},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(d,c){return d+Math.floor(Math.random()*(c-d+1))},randFloat:function(d,c){return d+Math.random()*(c-d)},randFloatSpread:function(b){return b*(0.5-Math.random())},sign:function(b){return 0>b?-1:0<b?1:0},degToRad:function(){var b=Math.PI/180;return function(a){return a*b}}(),radToDeg:function(){var b=180/Math.PI;return function(a){return a*b}}()};THREE.Spline=function(D){function C(i,g,E,p,m,l,k){i=0.5*(E-i);p=0.5*(p-g);return(2*(g-E)+i+p)*k+(-3*(g-E)-2*i-p)*l+i*m+g}this.points=D;var B=[],A={x:0,y:0,z:0},v,u,s,t,r,q,n,o,j;this.initFromArray=function(d){this.points=[];for(var c=0;c<d.length;c++){this.points[c]={x:d[c][0],y:d[c][1],z:d[c][2]}}};this.getPoint=function(b){v=(this.points.length-1)*b;u=Math.floor(v);s=v-u;B[0]=0===u?u:u-1;B[1]=u;B[2]=u>this.points.length-2?this.points.length-1:u+1;B[3]=u>this.points.length-3?this.points.length-1:u+2;q=this.points[B[0]];n=this.points[B[1]];o=this.points[B[2]];j=this.points[B[3]];t=s*s;r=s*t;A.x=C(q.x,n.x,o.x,j.x,s,t,r);A.y=C(q.y,n.y,o.y,j.y,s,t,r);A.z=C(q.z,n.z,o.z,j.z,s,t,r);return A};this.getControlPointsArray=function(){var f,e,h=this.points.length,g=[];for(f=0;f<h;f++){e=this.points[f],g[f]=[e.x,e.y,e.z]}return g};this.getLength=function(I){var H,G,F,E=H=H=0,p=new THREE.Vector3,l=new THREE.Vector3,m=[],k=0;m[0]=0;I||(I=100);G=this.points.length*I;p.copy(this.points[0]);for(I=1;I<G;I++){H=I/G,F=this.getPoint(H),l.copy(F),k+=l.distanceTo(p),p.copy(F),H*=this.points.length-1,H=Math.floor(H),H!=E&&(m[H]=k,E=H)}m[m.length]=k;return{chunks:m,total:k}};this.reparametrizeByArcLength=function(K){var J,I,H,G,F,p,E=[],m=new THREE.Vector3,l=this.getLength();E.push(m.copy(this.points[0]).clone());for(J=1;J<this.points.length;J++){I=l.chunks[J]-l.chunks[J-1];p=Math.ceil(K*I/l.total);G=(J-1)/(this.points.length-1);F=J/(this.points.length-1);for(I=1;I<p-1;I++){H=G+I*(1/p)*(F-G),H=this.getPoint(H),E.push(m.copy(H).clone())}E.push(m.copy(this.points[J]).clone())}this.points=E}};THREE.Triangle=function(e,d,f){this.a=void 0!==e?e:new THREE.Vector3;this.b=void 0!==d?d:new THREE.Vector3;this.c=void 0!==f?f:new THREE.Vector3};THREE.Triangle.normal=function(){var b=new THREE.Vector3;return function(a,h,g,f){f=f||new THREE.Vector3;f.subVectors(g,h);b.subVectors(a,h);f.cross(b);a=f.lengthSq();return 0<a?f.multiplyScalar(1/Math.sqrt(a)):f.set(0,0,0)}}();THREE.Triangle.barycoordFromPoint=function(){var e=new THREE.Vector3,d=new THREE.Vector3,f=new THREE.Vector3;return function(n,m,l,c,j){e.subVectors(c,m);d.subVectors(l,m);f.subVectors(n,m);var n=e.dot(e),m=e.dot(d),l=e.dot(f),b=d.dot(d),c=d.dot(f),a=n*b-m*m,j=j||new THREE.Vector3;if(0==a){return j.set(-2,-1,-1)}a=1/a;b=(b*l-m*c)*a;n=(n*c-m*l)*a;return j.set(1-b-n,n,b)}}();THREE.Triangle.containsPoint=function(){var b=new THREE.Vector3;return function(a,h,g,f){a=THREE.Triangle.barycoordFromPoint(a,h,g,f,b);return 0<=a.x&&0<=a.y&&1>=a.x+a.y}}();THREE.Triangle.prototype={constructor:THREE.Triangle,set:function(e,d,f){this.a.copy(e);this.b.copy(d);this.c.copy(f);return this},setFromPointsAndIndices:function(f,e,h,g){this.a.copy(f[e]);this.b.copy(f[h]);this.c.copy(f[g]);return this},copy:function(b){this.a.copy(b.a);this.b.copy(b.b);this.c.copy(b.c);return this},area:function(){var d=new THREE.Vector3,c=new THREE.Vector3;return function(){d.subVectors(this.c,this.b);c.subVectors(this.a,this.b);return 0.5*d.cross(c).length()}}(),midpoint:function(b){return(b||new THREE.Vector3).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(b){return THREE.Triangle.normal(this.a,this.b,this.c,b)},plane:function(b){return(b||new THREE.Plane).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(d,c){return THREE.Triangle.barycoordFromPoint(d,this.a,this.b,this.c,c)},containsPoint:function(b){return THREE.Triangle.containsPoint(b,this.a,this.b,this.c)},equals:function(b){return b.a.equals(this.a)&&b.b.equals(this.b)&&b.c.equals(this.c)},clone:function(){return(new THREE.Triangle).copy(this)}};THREE.Vertex=function(b){console.warn("THREE.Vertex has been DEPRECATED. Use THREE.Vector3 instead.");return b};THREE.UV=function(d,c){console.warn("THREE.UV has been DEPRECATED. Use THREE.Vector2 instead.");return new THREE.Vector2(d,c)};THREE.Clock=function(b){this.autoStart=void 0!==b?b:!0;this.elapsedTime=this.oldTime=this.startTime=0;this.running=!1};THREE.Clock.prototype={constructor:THREE.Clock,start:function(){this.oldTime=this.startTime=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now();this.running=!0},stop:function(){this.getElapsedTime();this.running=!1},getElapsedTime:function(){this.getDelta();return this.elapsedTime},getDelta:function(){var d=0;this.autoStart&&!this.running&&this.start();if(this.running){var c=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now(),d=0.001*(c-this.oldTime);this.oldTime=c;this.elapsedTime+=d}return d}};THREE.EventDispatcher=function(){};THREE.EventDispatcher.prototype={constructor:THREE.EventDispatcher,apply:function(b){b.addEventListener=THREE.EventDispatcher.prototype.addEventListener;b.hasEventListener=THREE.EventDispatcher.prototype.hasEventListener;b.removeEventListener=THREE.EventDispatcher.prototype.removeEventListener;b.dispatchEvent=THREE.EventDispatcher.prototype.dispatchEvent},addEventListener:function(e,d){void 0===this._listeners&&(this._listeners={});var f=this._listeners;void 0===f[e]&&(f[e]=[]);-1===f[e].indexOf(d)&&f[e].push(d)},hasEventListener:function(e,d){if(void 0===this._listeners){return !1}var f=this._listeners;return void 0!==f[e]&&-1!==f[e].indexOf(d)?!0:!1},removeEventListener:function(f,e){if(void 0!==this._listeners){var h=this._listeners,g=h[f].indexOf(e);-1!==g&&h[f].splice(g,1)}},dispatchEvent:function(){var b=[];return function(a){if(void 0!==this._listeners){var h=this._listeners[a.type];if(void 0!==h){a.target=this;for(var g=h.length,f=0;f<g;f++){b[f]=h[f]}for(f=0;f<g;f++){b[f].call(this,a)}}}}}()};(function(v){v.Raycaster=function(a,h,g,f){this.ray=new v.Ray(a,h);this.near=g||0;this.far=f||Infinity};var u=new v.Sphere,t=new v.Ray;new v.Plane;new v.Vector3;var s=new v.Vector3,r=new v.Matrix4,q=function(d,c){return d.distance-c.distance},o=new v.Vector3,p=new v.Vector3,n=new v.Vector3,l=function(k,h,K){if(k instanceof v.Sprite){s.getPositionFromMatrix(k.matrixWorld);var J=h.ray.distanceToPoint(s);if(J>k.scale.x){return K}K.push({distance:J,point:k.position,face:null,object:k})}else{if(k instanceof v.LOD){s.getPositionFromMatrix(k.matrixWorld),J=h.ray.origin.distanceTo(s),l(k.getObjectForDistance(J),h,K)}else{if(k instanceof v.Mesh){var g=k.geometry;null===g.boundingSphere&&g.computeBoundingSphere();u.copy(g.boundingSphere);u.applyMatrix4(k.matrixWorld);if(!1===h.ray.isIntersectionSphere(u)){return K}r.getInverse(k.matrixWorld);t.copy(h.ray).applyMatrix4(r);if(null!==g.boundingBox&&!1===t.isIntersectionBox(g.boundingBox)){return K}if(g instanceof v.BufferGeometry){var b=k.material;if(void 0===b||!1===g.dynamic){return K}var c,H,G=h.precision;if(void 0!==g.attributes.index){for(var C=g.offsets,d=g.attributes.index.array,a=g.attributes.position.array,E=g.offsets.length,I=g.attributes.index.array.length/3,I=0;I<E;++I){for(var J=C[I].start,e=C[I].index,g=J,i=J+C[I].count;g<i;g+=3){J=e+d[g],c=e+d[g+1],H=e+d[g+2],o.set(a[3*J],a[3*J+1],a[3*J+2]),p.set(a[3*c],a[3*c+1],a[3*c+2]),n.set(a[3*H],a[3*H+1],a[3*H+2]),c=b.side===v.BackSide?t.intersectTriangle(n,p,o,!0):t.intersectTriangle(o,p,n,b.side!==v.DoubleSide),null!==c&&(c.applyMatrix4(k.matrixWorld),J=h.ray.origin.distanceTo(c),J<G||(J<h.near||J>h.far)||K.push({distance:J,point:c,face:null,faceIndex:null,object:k}))}}}else{a=g.attributes.position.array;I=g.attributes.position.array.length;for(g=0;g<I;g+=3){J=g,c=g+1,H=g+2,o.set(a[3*J],a[3*J+1],a[3*J+2]),p.set(a[3*c],a[3*c+1],a[3*c+2]),n.set(a[3*H],a[3*H+1],a[3*H+2]),c=b.side===v.BackSide?t.intersectTriangle(n,p,o,!0):t.intersectTriangle(o,p,n,b.side!==v.DoubleSide),null!==c&&(c.applyMatrix4(k.matrixWorld),J=h.ray.origin.distanceTo(c),J<G||(J<h.near||J>h.far)||K.push({distance:J,point:c,face:null,faceIndex:null,object:k}))}}}else{if(g instanceof v.Geometry){d=k.material instanceof v.MeshFaceMaterial;a=!0===d?k.material.materials:null;G=h.precision;C=g.vertices;E=0;for(I=g.faces.length;E<I;E++){e=g.faces[E],b=!0===d?a[e.materialIndex]:k.material,void 0!==b&&(J=C[e.a],c=C[e.b],H=C[e.c],c=b.side===v.BackSide?t.intersectTriangle(H,c,J,!0):t.intersectTriangle(J,c,H,b.side!==v.DoubleSide),null!==c&&(c.applyMatrix4(k.matrixWorld),J=h.ray.origin.distanceTo(c),J<G||(J<h.near||J>h.far)||K.push({distance:J,point:c,face:e,faceIndex:E,object:k})))}}}}else{if(k instanceof v.Line){G=h.linePrecision;b=G*G;g=k.geometry;null===g.boundingSphere&&g.computeBoundingSphere();u.copy(g.boundingSphere);u.applyMatrix4(k.matrixWorld);if(!1===h.ray.isIntersectionSphere(u)){return K}r.getInverse(k.matrixWorld);t.copy(h.ray).applyMatrix4(r);if(g instanceof v.Geometry){C=g.vertices;G=C.length;c=new v.Vector3;H=new v.Vector3;I=k.type===v.LineStrip?1:2;for(g=0;g<G-1;g+=I){t.distanceSqToSegment(C[g],C[g+1],H,c)>b||(J=t.origin.distanceTo(H),J<h.near||J>h.far||K.push({distance:J,point:c.clone().applyMatrix4(k.matrixWorld),face:null,faceIndex:null,object:k}))}}}}}}},j=function(g,f,k){for(var g=g.getDescendants(),i=0,h=g.length;i<h;i++){l(g[i],f,k)}};v.Raycaster.prototype.precision=0.0001;v.Raycaster.prototype.linePrecision=1;v.Raycaster.prototype.set=function(d,c){this.ray.set(d,c)};v.Raycaster.prototype.intersectObject=function(e,d){var f=[];!0===d&&j(e,this,f);l(e,this,f);f.sort(q);return f};v.Raycaster.prototype.intersectObjects=function(g,f){for(var k=[],i=0,h=g.length;i<h;i++){l(g[i],this,k),!0===f&&j(g[i],this,k)}k.sort(q);return k}})(THREE);THREE.Object3D=function(){this.id=THREE.Object3DIdCount++;this.uuid=THREE.Math.generateUUID();this.name="";this.parent=void 0;this.children=[];this.up=new THREE.Vector3(0,1,0);this.position=new THREE.Vector3;this.rotation=new THREE.Euler;this.quaternion=new THREE.Quaternion;this.scale=new THREE.Vector3(1,1,1);this.rotation._quaternion=this.quaternion;this.quaternion._euler=this.rotation;this.renderDepth=null;this.rotationAutoUpdate=!0;this.matrix=new THREE.Matrix4;this.matrixWorld=new THREE.Matrix4;this.visible=this.matrixWorldNeedsUpdate=this.matrixAutoUpdate=!0;this.receiveShadow=this.castShadow=!1;this.frustumCulled=!0;this.userData={}};THREE.Object3D.prototype={constructor:THREE.Object3D,get eulerOrderfunction(){console.warn("DEPRECATED: Object3D's .eulerOrder has been moved to Object3D's .rotation.order.");return this.rotation.order},set eulerOrderfunction(b){console.warn("DEPRECATED: Object3D's .eulerOrder has been moved to Object3D's .rotation.order.");this.rotation.order=b},get useQuaternionfunction(){console.warn("DEPRECATED: Object3D's .useQuaternion has been removed. The library now uses quaternions by default.")},set useQuaternionfunction(b){console.warn("DEPRECATED: Object3D's .useQuaternion has been removed. The library now uses quaternions by default.")},applyMatrix:function(){var b=new THREE.Matrix4;return function(a){this.matrix.multiplyMatrices(a,this.matrix);this.position.getPositionFromMatrix(this.matrix);this.scale.getScaleFromMatrix(this.matrix);b.extractRotation(this.matrix);this.quaternion.setFromRotationMatrix(b)}}(),setRotationFromAxisAngle:function(d,c){this.quaternion.setFromAxisAngle(d,c)},setRotationFromEuler:function(b){this.quaternion.setFromEuler(b,!0)},setRotationFromMatrix:function(b){this.quaternion.setFromRotationMatrix(b)},setRotationFromQuaternion:function(b){this.quaternion.copy(b)},rotateOnAxis:function(){var b=new THREE.Quaternion;return function(a,d){b.setFromAxisAngle(a,d);this.quaternion.multiply(b);return this}}(),rotateX:function(){var b=new THREE.Vector3(1,0,0);return function(a){return this.rotateOnAxis(b,a)}}(),rotateY:function(){var b=new THREE.Vector3(0,1,0);return function(a){return this.rotateOnAxis(b,a)}}(),rotateZ:function(){var b=new THREE.Vector3(0,0,1);return function(a){return this.rotateOnAxis(b,a)}}(),translateOnAxis:function(){var b=new THREE.Vector3;return function(a,d){b.copy(a);b.applyQuaternion(this.quaternion);this.position.add(b.multiplyScalar(d));return this}}(),translate:function(d,c){console.warn("DEPRECATED: Object3D's .translate() has been removed. Use .translateOnAxis( axis, distance ) instead. Note args have been changed.");return this.translateOnAxis(c,d)},translateX:function(){var b=new THREE.Vector3(1,0,0);return function(a){return this.translateOnAxis(b,a)}}(),translateY:function(){var b=new THREE.Vector3(0,1,0);return function(a){return this.translateOnAxis(b,a)}}(),translateZ:function(){var b=new THREE.Vector3(0,0,1);return function(a){return this.translateOnAxis(b,a)}}(),localToWorld:function(b){return b.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var b=new THREE.Matrix4;return function(a){return a.applyMatrix4(b.getInverse(this.matrixWorld))}}(),lookAt:function(){var b=new THREE.Matrix4;return function(a){b.lookAt(a,this.position,this.up);this.quaternion.setFromRotationMatrix(b)}}(),add:function(d){if(d===this){console.warn("THREE.Object3D.add: An object can't be added as a child of itself.")}else{if(d instanceof THREE.Object3D){void 0!==d.parent&&d.parent.remove(d);d.parent=this;d.dispatchEvent({type:"added"});this.children.push(d);for(var c=this;void 0!==c.parent;){c=c.parent}void 0!==c&&c instanceof THREE.Scene&&c.__addObject(d)}}},remove:function(d){var c=this.children.indexOf(d);if(-1!==c){d.parent=void 0;d.dispatchEvent({type:"removed"});this.children.splice(c,1);for(c=this;void 0!==c.parent;){c=c.parent}void 0!==c&&c instanceof THREE.Scene&&c.__removeObject(d)}},traverse:function(e){e(this);for(var d=0,f=this.children.length;d<f;d++){this.children[d].traverse(e)}},getObjectById:function(g,f){for(var j=0,i=this.children.length;j<i;j++){var h=this.children[j];if(h.id===g||!0===f&&(h=h.getObjectById(g,f),void 0!==h)){return h}}},getObjectByName:function(g,f){for(var j=0,i=this.children.length;j<i;j++){var h=this.children[j];if(h.name===g||!0===f&&(h=h.getObjectByName(g,f),void 0!==h)){return h}}},getChildByName:function(d,c){console.warn("DEPRECATED: Object3D's .getChildByName() has been renamed to .getObjectByName().");return this.getObjectByName(d,c)},getDescendants:function(e){void 0===e&&(e=[]);Array.prototype.push.apply(e,this.children);for(var d=0,f=this.children.length;d<f;d++){this.children[d].getDescendants(e)}return e},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){!0===this.matrixAutoUpdate&&this.updateMatrix();if(!0===this.matrixWorldNeedsUpdate||!0===e){void 0===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0}for(var d=0,f=this.children.length;d<f;d++){this.children[d].updateMatrixWorld(e)}},clone:function(e,d){void 0===e&&(e=new THREE.Object3D);void 0===d&&(d=!0);e.name=this.name;e.up.copy(this.up);e.position.copy(this.position);e.quaternion.copy(this.quaternion);e.scale.copy(this.scale);e.renderDepth=this.renderDepth;e.rotationAutoUpdate=this.rotationAutoUpdate;e.matrix.copy(this.matrix);e.matrixWorld.copy(this.matrixWorld);e.matrixAutoUpdate=this.matrixAutoUpdate;e.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate;e.visible=this.visible;e.castShadow=this.castShadow;e.receiveShadow=this.receiveShadow;e.frustumCulled=this.frustumCulled;e.userData=JSON.parse(JSON.stringify(this.userData));if(!0===d){for(var f=0;f<this.children.length;f++){e.add(this.children[f].clone())}}return e}};THREE.EventDispatcher.prototype.apply(THREE.Object3D.prototype);THREE.Object3DIdCount=0;THREE.Projector=function(){function aA(){if(ar===ao){var b=new THREE.RenderableVertex;aq.push(b);ao++;ar++;return b}return aq[ar++]}function az(d,c){return d.z!==c.z?c.z-d.z:d.id!==c.id?d.id-c.id:0}function ay(k,i){var r=0,q=1,p=k.z+k.w,n=i.z+i.w,l=-k.z+k.w,m=-i.z+i.w;if(0<=p&&0<=n&&0<=l&&0<=m){return !0}if(0>p&&0>n||0>l&&0>m){return !1}0>p?r=Math.max(r,p/(p-n)):0>n&&(q=Math.min(q,p/(p-n)));0>l?r=Math.max(r,l/(l-m)):0>m&&(q=Math.min(q,l/(l-m)));if(q<r){return !1}k.lerp(i,r);i.lerp(k,1-q);return !0}var ax,aw,av=[],at=0,au,ar,aq=[],ao=0,ap,am,aj=[],ai=0,an,ak,al=[],ah=0,ae,ab,Y=[],W=0,ad={objects:[],sprites:[],lights:[],elements:[]},U=new THREE.Vector3,Z=new THREE.Vector4,H=new THREE.Box3(new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,1,1)),X=new THREE.Box3,V=Array(3),S=new THREE.Matrix4,ac=new THREE.Matrix4,ag,T=new THREE.Matrix4,j=new THREE.Matrix3,P=new THREE.Matrix3,aB=new THREE.Vector3,af=new THREE.Frustum,aa=new THREE.Vector4,K=new THREE.Vector4;this.projectVector=function(d,c){c.matrixWorldInverse.getInverse(c.matrixWorld);ac.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse);return d.applyProjection(ac)};this.unprojectVector=function(d,c){c.projectionMatrixInverse.getInverse(c.projectionMatrix);ac.multiplyMatrices(c.matrixWorld,c.projectionMatrixInverse);return d.applyProjection(ac)};this.pickingRay=function(e,d){e.z=-1;var f=new THREE.Vector3(e.x,e.y,1);this.unprojectVector(e,d);this.unprojectVector(f,d);f.sub(e).normalize();return new THREE.Raycaster(e,f)};var L=function(d){if(aw===at){var c=new THREE.RenderableObject;av.push(c);at++;aw++;ax=c}else{ax=av[aw++]}ax.id=d.id;ax.object=d;null!==d.renderDepth?ax.z=d.renderDepth:(U.getPositionFromMatrix(d.matrixWorld),U.applyProjection(ac),ax.z=U.z);return ax},o=function(e){if(!1!==e.visible){e instanceof THREE.Light?ad.lights.push(e):e instanceof THREE.Mesh||e instanceof THREE.Line?(!1===e.frustumCulled||!0===af.intersectsObject(e))&&ad.objects.push(L(e)):e instanceof THREE.Sprite&&ad.sprites.push(L(e));for(var d=0,f=e.children.length;d<f;d++){o(e.children[d])}}};this.projectScene=function(B,A,u,s){var C=!1,q,l,k,e,i,b,g,n,p,t,v,c;ab=ak=am=0;ad.elements.length=0;!0===B.autoUpdate&&B.updateMatrixWorld();void 0===A.parent&&A.updateMatrixWorld();S.copy(A.matrixWorldInverse.getInverse(A.matrixWorld));ac.multiplyMatrices(A.projectionMatrix,S);P.getNormalMatrix(S);af.setFromMatrix(ac);aw=0;ad.objects.length=0;ad.sprites.length=0;ad.lights.length=0;o(B);!0===u&&ad.objects.sort(az);B=0;for(u=ad.objects.length;B<u;B++){if(g=ad.objects[B].object,ag=g.matrixWorld,ar=0,g instanceof THREE.Mesh){n=g.geometry;k=n.vertices;p=n.faces;n=n.faceVertexUvs;j.getNormalMatrix(ag);v=g.material instanceof THREE.MeshFaceMaterial;c=!0===v?g.material:null;q=0;for(l=k.length;q<l;q++){au=aA();au.positionWorld.copy(k[q]).applyMatrix4(ag);au.positionScreen.copy(au.positionWorld).applyMatrix4(ac);var r=1/au.positionScreen.w;au.positionScreen.x*=r;au.positionScreen.y*=r;au.positionScreen.z*=r;au.visible=!(-1>au.positionScreen.x||1<au.positionScreen.x||-1>au.positionScreen.y||1<au.positionScreen.y||-1>au.positionScreen.z||1<au.positionScreen.z)}k=0;for(q=p.length;k<q;k++){if(l=p[k],r=!0===v?c.materials[l.materialIndex]:g.material,void 0!==r&&(b=r.side,e=aq[l.a],i=aq[l.b],t=aq[l.c],V[0]=e.positionScreen,V[1]=i.positionScreen,V[2]=t.positionScreen,!0===e.visible||!0===i.visible||!0===t.visible||H.isIntersectionBox(X.setFromPoints(V)))){if(C=0>(t.positionScreen.x-e.positionScreen.x)*(i.positionScreen.y-e.positionScreen.y)-(t.positionScreen.y-e.positionScreen.y)*(i.positionScreen.x-e.positionScreen.x),b===THREE.DoubleSide||C===(b===THREE.FrontSide)){if(am===ai){var a=new THREE.RenderableFace3;aj.push(a);ai++;am++;ap=a}else{ap=aj[am++]}ap.id=g.id;ap.v1.copy(e);ap.v2.copy(i);ap.v3.copy(t);ap.normalModel.copy(l.normal);!1===C&&(b===THREE.BackSide||b===THREE.DoubleSide)&&ap.normalModel.negate();ap.normalModel.applyMatrix3(j).normalize();ap.normalModelView.copy(ap.normalModel).applyMatrix3(P);ap.centroidModel.copy(l.centroid).applyMatrix4(ag);t=l.vertexNormals;e=0;for(i=Math.min(t.length,3);e<i;e++){a=ap.vertexNormalsModel[e],a.copy(t[e]),!1===C&&(b===THREE.BackSide||b===THREE.DoubleSide)&&a.negate(),a.applyMatrix3(j).normalize(),ap.vertexNormalsModelView[e].copy(a).applyMatrix3(P)}ap.vertexNormalsLength=t.length;C=0;for(e=Math.min(n.length,3);C<e;C++){if(t=n[C][k],void 0!==t){i=0;for(b=t.length;i<b;i++){ap.uvs[C][i]=t[i]}}}ap.color=l.color;ap.material=r;aB.copy(ap.centroidModel).applyProjection(ac);ap.z=aB.z;ad.elements.push(ap)}}}}else{if(g instanceof THREE.Line){T.multiplyMatrices(ac,ag);k=g.geometry.vertices;e=aA();e.positionScreen.copy(k[0]).applyMatrix4(T);p=g.type===THREE.LinePieces?2:1;q=1;for(l=k.length;q<l;q++){e=aA(),e.positionScreen.copy(k[q]).applyMatrix4(T),0<(q+1)%p||(i=aq[ar-2],aa.copy(e.positionScreen),K.copy(i.positionScreen),!0===ay(aa,K)&&(aa.multiplyScalar(1/aa.w),K.multiplyScalar(1/K.w),ak===ah?(n=new THREE.RenderableLine,al.push(n),ah++,ak++,an=n):an=al[ak++],an.id=g.id,an.v1.positionScreen.copy(aa),an.v2.positionScreen.copy(K),an.z=Math.max(aa.z,K.z),an.material=g.material,g.material.vertexColors===THREE.VertexColors&&(an.vertexColors[0].copy(g.geometry.colors[q]),an.vertexColors[1].copy(g.geometry.colors[q-1])),ad.elements.push(an)))}}}}B=0;for(u=ad.sprites.length;B<u;B++){g=ad.sprites[B].object,ag=g.matrixWorld,g instanceof THREE.Sprite&&(Z.set(ag.elements[12],ag.elements[13],ag.elements[14],1),Z.applyMatrix4(ac),r=1/Z.w,Z.z*=r,-1<Z.z&&1>Z.z&&(ab===W?(p=new THREE.RenderableSprite,Y.push(p),W++,ab++,ae=p):ae=Y[ab++],ae.id=g.id,ae.x=Z.x*r,ae.y=Z.y*r,ae.z=Z.z,ae.object=g,ae.rotation=g.rotation,ae.scale.x=g.scale.x*Math.abs(ae.x-(Z.x+A.projectionMatrix.elements[0])/(Z.w+A.projectionMatrix.elements[12])),ae.scale.y=g.scale.y*Math.abs(ae.y-(Z.y+A.projectionMatrix.elements[5])/(Z.w+A.projectionMatrix.elements[13])),ae.material=g.material,ad.elements.push(ae)))}!0===s&&ad.elements.sort(az);return ad}};THREE.Face3=function(h,g,l,k,j,i){this.a=h;this.b=g;this.c=l;this.normal=k instanceof THREE.Vector3?k:new THREE.Vector3;this.vertexNormals=k instanceof Array?k:[];this.color=j instanceof THREE.Color?j:new THREE.Color;this.vertexColors=j instanceof Array?j:[];this.vertexTangents=[];this.materialIndex=void 0!==i?i:0;this.centroid=new THREE.Vector3};THREE.Face3.prototype={constructor:THREE.Face3,clone:function(){var e=new THREE.Face3(this.a,this.b,this.c);e.normal.copy(this.normal);e.color.copy(this.color);e.centroid.copy(this.centroid);e.materialIndex=this.materialIndex;var d,f;d=0;for(f=this.vertexNormals.length;d<f;d++){e.vertexNormals[d]=this.vertexNormals[d].clone()}d=0;for(f=this.vertexColors.length;d<f;d++){e.vertexColors[d]=this.vertexColors[d].clone()}d=0;for(f=this.vertexTangents.length;d<f;d++){e.vertexTangents[d]=this.vertexTangents[d].clone()}return e}};THREE.Face4=function(i,g,n,m,l,k,j){console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead.");return new THREE.Face3(i,g,n,l,k,j)};THREE.Geometry=function(){this.id=THREE.GeometryIdCount++;this.uuid=THREE.Math.generateUUID();this.name="";this.vertices=[];this.colors=[];this.faces=[];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphColors=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingSphere=this.boundingBox=null;this.hasTangents=!1;this.dynamic=!0;this.buffersNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.tangentsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.elementsNeedUpdate=this.verticesNeedUpdate=!1};THREE.Geometry.prototype={constructor:THREE.Geometry,applyMatrix:function(i){for(var g=(new THREE.Matrix3).getNormalMatrix(i),n=0,m=this.vertices.length;n<m;n++){this.vertices[n].applyMatrix4(i)}n=0;for(m=this.faces.length;n<m;n++){var l=this.faces[n];l.normal.applyMatrix3(g).normalize();for(var k=0,j=l.vertexNormals.length;k<j;k++){l.vertexNormals[k].applyMatrix3(g).normalize()}l.centroid.applyMatrix4(i)}this.boundingBox instanceof THREE.Box3&&this.computeBoundingBox();this.boundingSphere instanceof THREE.Sphere&&this.computeBoundingSphere()},computeCentroids:function(){var e,d,f;e=0;for(d=this.faces.length;e<d;e++){f=this.faces[e],f.centroid.set(0,0,0),f.centroid.add(this.vertices[f.a]),f.centroid.add(this.vertices[f.b]),f.centroid.add(this.vertices[f.c]),f.centroid.divideScalar(3)}},computeFaceNormals:function(){for(var i=new THREE.Vector3,g=new THREE.Vector3,n=0,m=this.faces.length;n<m;n++){var l=this.faces[n],k=this.vertices[l.a],j=this.vertices[l.b];i.subVectors(this.vertices[l.c],j);g.subVectors(k,j);i.cross(g);i.normalize();l.normal.copy(i)}},computeVertexNormals:function(r){var q,p,o,n;if(void 0===this.__tmpVertices){n=this.__tmpVertices=Array(this.vertices.length);q=0;for(p=this.vertices.length;q<p;q++){n[q]=new THREE.Vector3}q=0;for(p=this.faces.length;q<p;q++){o=this.faces[q],o.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3]}}else{n=this.__tmpVertices;q=0;for(p=this.vertices.length;q<p;q++){n[q].set(0,0,0)}}if(r){var m,k,l=new THREE.Vector3,j=new THREE.Vector3;new THREE.Vector3;new THREE.Vector3;new THREE.Vector3;q=0;for(p=this.faces.length;q<p;q++){o=this.faces[q],r=this.vertices[o.a],m=this.vertices[o.b],k=this.vertices[o.c],l.subVectors(k,m),j.subVectors(r,m),l.cross(j),n[o.a].add(l),n[o.b].add(l),n[o.c].add(l)}}else{q=0;for(p=this.faces.length;q<p;q++){o=this.faces[q],n[o.a].add(o.normal),n[o.b].add(o.normal),n[o.c].add(o.normal)}}q=0;for(p=this.vertices.length;q<p;q++){n[q].normalize()}q=0;for(p=this.faces.length;q<p;q++){o=this.faces[q],o.vertexNormals[0].copy(n[o.a]),o.vertexNormals[1].copy(n[o.b]),o.vertexNormals[2].copy(n[o.c])}},computeMorphNormals:function(){var r,q,p,o,n;p=0;for(o=this.faces.length;p<o;p++){n=this.faces[p];n.__originalFaceNormal?n.__originalFaceNormal.copy(n.normal):n.__originalFaceNormal=n.normal.clone();n.__originalVertexNormals||(n.__originalVertexNormals=[]);r=0;for(q=n.vertexNormals.length;r<q;r++){n.__originalVertexNormals[r]?n.__originalVertexNormals[r].copy(n.vertexNormals[r]):n.__originalVertexNormals[r]=n.vertexNormals[r].clone()}}var m=new THREE.Geometry;m.faces=this.faces;r=0;for(q=this.morphTargets.length;r<q;r++){if(!this.morphNormals[r]){this.morphNormals[r]={};this.morphNormals[r].faceNormals=[];this.morphNormals[r].vertexNormals=[];n=this.morphNormals[r].faceNormals;var k=this.morphNormals[r].vertexNormals,l,j;p=0;for(o=this.faces.length;p<o;p++){l=new THREE.Vector3,j={a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3},n.push(l),k.push(j)}}k=this.morphNormals[r];m.vertices=this.morphTargets[r].vertices;m.computeFaceNormals();m.computeVertexNormals();p=0;for(o=this.faces.length;p<o;p++){n=this.faces[p],l=k.faceNormals[p],j=k.vertexNormals[p],l.copy(n.normal),j.a.copy(n.vertexNormals[0]),j.b.copy(n.vertexNormals[1]),j.c.copy(n.vertexNormals[2])}}p=0;for(o=this.faces.length;p<o;p++){n=this.faces[p],n.normal=n.__originalFaceNormal,n.vertexNormals=n.__originalVertexNormals}},computeTangents:function(){var V,U,T,S,R,Q,O,P,N,M,K,L,I,E,A,J,F,H=[],v=[];T=new THREE.Vector3;var o=new THREE.Vector3,j=new THREE.Vector3,G=new THREE.Vector3,C=new THREE.Vector3;V=0;for(U=this.vertices.length;V<U;V++){H[V]=new THREE.Vector3,v[V]=new THREE.Vector3}V=0;for(U=this.faces.length;V<U;V++){R=this.faces[V],Q=this.faceVertexUvs[0][V],S=R.a,F=R.b,R=R.c,O=this.vertices[S],P=this.vertices[F],N=this.vertices[R],M=Q[0],K=Q[1],L=Q[2],Q=P.x-O.x,I=N.x-O.x,E=P.y-O.y,A=N.y-O.y,P=P.z-O.z,O=N.z-O.z,N=K.x-M.x,J=L.x-M.x,K=K.y-M.y,M=L.y-M.y,L=1/(N*M-J*K),T.set((M*Q-K*I)*L,(M*E-K*A)*L,(M*P-K*O)*L),o.set((N*I-J*Q)*L,(N*A-J*E)*L,(N*O-J*P)*L),H[S].add(T),H[F].add(T),H[R].add(T),v[S].add(o),v[F].add(o),v[R].add(o)}o=["a","b","c","d"];V=0;for(U=this.faces.length;V<U;V++){R=this.faces[V];for(T=0;T<Math.min(R.vertexNormals.length,3);T++){C.copy(R.vertexNormals[T]),S=R[o[T]],F=H[S],j.copy(F),j.sub(C.multiplyScalar(C.dot(F))).normalize(),G.crossVectors(R.vertexNormals[T],F),S=G.dot(v[S]),S=0>S?-1:1,R.vertexTangents[T]=new THREE.Vector4(j.x,j.y,j.z,S)}}this.hasTangents=!0},computeLineDistances:function(){for(var f=0,e=this.vertices,h=0,g=e.length;h<g;h++){0<h&&(f+=e[h].distanceTo(e[h-1])),this.lineDistances[h]=f}},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);this.boundingSphere.setFromPoints(this.vertices)},mergeVertices:function(){var i={},g=[],n=[],m,l=Math.pow(10,4),k,j;this.__tmpVertices=void 0;k=0;for(j=this.vertices.length;k<j;k++){m=this.vertices[k],m=Math.round(m.x*l)+"_"+Math.round(m.y*l)+"_"+Math.round(m.z*l),void 0===i[m]?(i[m]=k,g.push(this.vertices[k]),n[k]=g.length-1):n[k]=n[i[m]]}i=[];k=0;for(j=this.faces.length;k<j;k++){l=this.faces[k];l.a=n[l.a];l.b=n[l.b];l.c=n[l.c];l=[l.a,l.b,l.c];for(m=0;3>m;m++){if(l[m]==l[(m+1)%3]){i.push(k);break}}}for(k=i.length-1;0<=k;k--){l=i[k];this.faces.splice(l,1);n=0;for(j=this.faceVertexUvs.length;n<j;n++){this.faceVertexUvs[n].splice(l,1)}}k=this.vertices.length-g.length;this.vertices=g;return k},clone:function(){for(var j=new THREE.Geometry,i=this.vertices,p=0,o=i.length;p<o;p++){j.vertices.push(i[p].clone())}i=this.faces;p=0;for(o=i.length;p<o;p++){j.faces.push(i[p].clone())}i=this.faceVertexUvs[0];p=0;for(o=i.length;p<o;p++){for(var n=i[p],m=[],k=0,l=n.length;k<l;k++){m.push(new THREE.Vector2(n[k].x,n[k].y))}j.faceVertexUvs[0].push(m)}return j},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.Geometry.prototype);THREE.GeometryIdCount=0;THREE.BufferGeometry=function(){this.id=THREE.GeometryIdCount++;this.uuid=THREE.Math.generateUUID();this.name="";this.attributes={};this.dynamic=!0;this.offsets=[];this.boundingSphere=this.boundingBox=null;this.hasTangents=!1;this.morphTargets=[]};THREE.BufferGeometry.prototype={constructor:THREE.BufferGeometry,addAttribute:function(f,e,h,g){this.attributes[f]={itemSize:g,array:new e(h*g)}},applyMatrix:function(e){var d,f;this.attributes.position&&(d=this.attributes.position.array);this.attributes.normal&&(f=this.attributes.normal.array);void 0!==d&&(e.multiplyVector3Array(d),this.verticesNeedUpdate=!0);void 0!==f&&((new THREE.Matrix3).getNormalMatrix(e).multiplyVector3Array(f),this.normalizeNormals(),this.normalsNeedUpdate=!0)},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);var i=this.attributes.position.array;if(i){var g=this.boundingBox,n,m,l;3<=i.length&&(g.min.x=g.max.x=i[0],g.min.y=g.max.y=i[1],g.min.z=g.max.z=i[2]);for(var k=3,j=i.length;k<j;k+=3){n=i[k],m=i[k+1],l=i[k+2],n<g.min.x?g.min.x=n:n>g.max.x&&(g.max.x=n),m<g.min.y?g.min.y=m:m>g.max.y&&(g.max.y=m),l<g.min.z?g.min.z=l:l>g.max.z&&(g.max.z=l)}}if(void 0===i||0===i.length){this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0)}},computeBoundingSphere:function(){var d=new THREE.Box3,c=new THREE.Vector3;return function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);var j=this.attributes.position.array;if(j){for(var i=this.boundingSphere.center,g=0,b=j.length;g<b;g+=3){c.set(j[g],j[g+1],j[g+2]),d.addPoint(c)}d.center(i);for(var a=0,g=0,b=j.length;g<b;g+=3){c.set(j[g],j[g+1],j[g+2]),a=Math.max(a,i.distanceToSquared(c))}this.boundingSphere.radius=Math.sqrt(a)}}}(),computeVertexNormals:function(){if(this.attributes.position){var Q,P,O,N;Q=this.attributes.position.array.length;if(void 0===this.attributes.normal){this.attributes.normal={itemSize:3,array:new Float32Array(Q)}}else{Q=0;for(P=this.attributes.normal.array.length;Q<P;Q++){this.attributes.normal.array[Q]=0}}var M=this.attributes.position.array,L=this.attributes.normal.array,J,K,I,H,F,G,D=new THREE.Vector3,A=new THREE.Vector3,v=new THREE.Vector3,E=new THREE.Vector3,B=new THREE.Vector3;if(this.attributes.index){var C=this.attributes.index.array,o=this.offsets;O=0;for(N=o.length;O<N;++O){P=o[O].start;J=o[O].count;var j=o[O].index;Q=P;for(P+=J;Q<P;Q+=3){J=j+C[Q],K=j+C[Q+1],I=j+C[Q+2],H=M[3*J],F=M[3*J+1],G=M[3*J+2],D.set(H,F,G),H=M[3*K],F=M[3*K+1],G=M[3*K+2],A.set(H,F,G),H=M[3*I],F=M[3*I+1],G=M[3*I+2],v.set(H,F,G),E.subVectors(v,A),B.subVectors(D,A),E.cross(B),L[3*J]+=E.x,L[3*J+1]+=E.y,L[3*J+2]+=E.z,L[3*K]+=E.x,L[3*K+1]+=E.y,L[3*K+2]+=E.z,L[3*I]+=E.x,L[3*I+1]+=E.y,L[3*I+2]+=E.z}}}else{Q=0;for(P=M.length;Q<P;Q+=9){H=M[Q],F=M[Q+1],G=M[Q+2],D.set(H,F,G),H=M[Q+3],F=M[Q+4],G=M[Q+5],A.set(H,F,G),H=M[Q+6],F=M[Q+7],G=M[Q+8],v.set(H,F,G),E.subVectors(v,A),B.subVectors(D,A),E.cross(B),L[Q]=E.x,L[Q+1]=E.y,L[Q+2]=E.z,L[Q+3]=E.x,L[Q+4]=E.y,L[Q+5]=E.z,L[Q+6]=E.x,L[Q+7]=E.y,L[Q+8]=E.z}}this.normalizeNormals();this.normalsNeedUpdate=!0}},normalizeNormals:function(){for(var h=this.attributes.normal.array,g,l,k,j=0,i=h.length;j<i;j+=3){g=h[j],l=h[j+1],k=h[j+2],g=1/Math.sqrt(g*g+l*l+k*k),h[j]*=g,h[j+1]*=g,h[j+2]*=g}},computeTangents:function(){function aA(b){af.x=ax[3*b];af.y=ax[3*b+1];af.z=ax[3*b+2];aa.copy(af);L=au[b];P.copy(L);P.sub(af.multiplyScalar(af.dot(L))).normalize();aB.crossVectors(aa,L);o=aB.dot(ar[b]);K=0>o?-1:1;at[4*b]=P.x;at[4*b+1]=P.y;at[4*b+2]=P.z;at[4*b+3]=K}if(void 0===this.attributes.index||void 0===this.attributes.position||void 0===this.attributes.normal||void 0===this.attributes.uv){console.warn("Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()")}else{var az=this.attributes.index.array,ay=this.attributes.position.array,ax=this.attributes.normal.array,aw=this.attributes.uv.array,av=ay.length/3;void 0===this.attributes.tangent&&(this.attributes.tangent={itemSize:4,array:new Float32Array(4*av)});for(var at=this.attributes.tangent.array,au=[],ar=[],aq=0;aq<av;aq++){au[aq]=new THREE.Vector3,ar[aq]=new THREE.Vector3}var ao,ap,am,aj,ai,an,ak,al,ah,ae,ab,Y,W,ad,U,av=new THREE.Vector3,aq=new THREE.Vector3,Z,H,X,V,S,ac,ag,T=this.offsets;X=0;for(V=T.length;X<V;++X){H=T[X].start;S=T[X].count;var j=T[X].index;Z=H;for(H+=S;Z<H;Z+=3){S=j+az[Z],ac=j+az[Z+1],ag=j+az[Z+2],ao=ay[3*S],ap=ay[3*S+1],am=ay[3*S+2],aj=ay[3*ac],ai=ay[3*ac+1],an=ay[3*ac+2],ak=ay[3*ag],al=ay[3*ag+1],ah=ay[3*ag+2],ae=aw[2*S],ab=aw[2*S+1],Y=aw[2*ac],W=aw[2*ac+1],ad=aw[2*ag],U=aw[2*ag+1],aj-=ao,ao=ak-ao,ai-=ap,ap=al-ap,an-=am,am=ah-am,Y-=ae,ae=ad-ae,W-=ab,ab=U-ab,U=1/(Y*ab-ae*W),av.set((ab*aj-W*ao)*U,(ab*ai-W*ap)*U,(ab*an-W*am)*U),aq.set((Y*ao-ae*aj)*U,(Y*ap-ae*ai)*U,(Y*am-ae*an)*U),au[S].add(av),au[ac].add(av),au[ag].add(av),ar[S].add(aq),ar[ac].add(aq),ar[ag].add(aq)}}var P=new THREE.Vector3,aB=new THREE.Vector3,af=new THREE.Vector3,aa=new THREE.Vector3,K,L,o;X=0;for(V=T.length;X<V;++X){H=T[X].start;S=T[X].count;j=T[X].index;Z=H;for(H+=S;Z<H;Z+=3){S=j+az[Z],ac=j+az[Z+1],ag=j+az[Z+2],aA(S),aA(ac),aA(ag)}}this.tangentsNeedUpdate=this.hasTangents=!0}},clone:function(){var j=new THREE.BufferGeometry,i=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],p;for(p in this.attributes){for(var o=this.attributes[p],n=o.array,m={itemSize:o.itemSize,numItems:o.numItems,array:null},o=0,k=i.length;o<k;o++){var l=i[o];if(n instanceof l){m.array=new l(n);break}}j.attributes[p]=m}o=0;for(k=this.offsets.length;o<k;o++){i=this.offsets[o],j.offsets.push({start:i.start,index:i.index,count:i.count})}return j},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.BufferGeometry.prototype);THREE.Camera=function(){THREE.Object3D.call(this);this.matrixWorldInverse=new THREE.Matrix4;this.projectionMatrix=new THREE.Matrix4;this.projectionMatrixInverse=new THREE.Matrix4};THREE.Camera.prototype=Object.create(THREE.Object3D.prototype);THREE.Camera.prototype.lookAt=function(){var b=new THREE.Matrix4;return function(a){b.lookAt(this.position,a,this.up);this.quaternion.setFromRotationMatrix(b)}}();THREE.Camera.prototype.clone=function(b){void 0===b&&(b=new THREE.Camera);THREE.Object3D.prototype.clone.call(this,b);b.matrixWorldInverse.copy(this.matrixWorldInverse);b.projectionMatrix.copy(this.projectionMatrix);b.projectionMatrixInverse.copy(this.projectionMatrixInverse);return b};THREE.OrthographicCamera=function(h,g,l,k,j,i){THREE.Camera.call(this);this.left=h;this.right=g;this.top=l;this.bottom=k;this.near=void 0!==j?j:0.1;this.far=void 0!==i?i:2000;this.updateProjectionMatrix()};THREE.OrthographicCamera.prototype=Object.create(THREE.Camera.prototype);THREE.OrthographicCamera.prototype.updateProjectionMatrix=function(){this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far)};THREE.OrthographicCamera.prototype.clone=function(){var b=new THREE.OrthographicCamera;THREE.Camera.prototype.clone.call(this,b);b.left=this.left;b.right=this.right;b.top=this.top;b.bottom=this.bottom;b.near=this.near;b.far=this.far;return b};THREE.PerspectiveCamera=function(f,e,h,g){THREE.Camera.call(this);this.fov=void 0!==f?f:50;this.aspect=void 0!==e?e:1;this.near=void 0!==h?h:0.1;this.far=void 0!==g?g:2000;this.updateProjectionMatrix()};THREE.PerspectiveCamera.prototype=Object.create(THREE.Camera.prototype);THREE.PerspectiveCamera.prototype.setLens=function(d,c){void 0===c&&(c=24);this.fov=2*THREE.Math.radToDeg(Math.atan(c/(2*d)));this.updateProjectionMatrix()};THREE.PerspectiveCamera.prototype.setViewOffset=function(h,g,l,k,j,i){this.fullWidth=h;this.fullHeight=g;this.x=l;this.y=k;this.width=j;this.height=i;this.updateProjectionMatrix()};THREE.PerspectiveCamera.prototype.updateProjectionMatrix=function(){if(this.fullWidth){var f=this.fullWidth/this.fullHeight,e=Math.tan(THREE.Math.degToRad(0.5*this.fov))*this.near,h=-e,g=f*h,f=Math.abs(f*e-g),h=Math.abs(e-h);this.projectionMatrix.makeFrustum(g+this.x*f/this.fullWidth,g+(this.x+this.width)*f/this.fullWidth,e-(this.y+this.height)*h/this.fullHeight,e-this.y*h/this.fullHeight,this.near,this.far)}else{this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far)}};THREE.PerspectiveCamera.prototype.clone=function(){var b=new THREE.PerspectiveCamera;THREE.Camera.prototype.clone.call(this,b);b.fov=this.fov;b.aspect=this.aspect;b.near=this.near;b.far=this.far;return b};THREE.Light=function(b){THREE.Object3D.call(this);this.color=new THREE.Color(b)};THREE.Light.prototype=Object.create(THREE.Object3D.prototype);THREE.Light.prototype.clone=function(b){void 0===b&&(b=new THREE.Light);THREE.Object3D.prototype.clone.call(this,b);b.color.copy(this.color);return b};THREE.AmbientLight=function(b){THREE.Light.call(this,b)};THREE.AmbientLight.prototype=Object.create(THREE.Light.prototype);THREE.AmbientLight.prototype.clone=function(){var b=new THREE.AmbientLight;THREE.Light.prototype.clone.call(this,b);return b};THREE.AreaLight=function(d,c){THREE.Light.call(this,d);this.normal=new THREE.Vector3(0,-1,0);this.right=new THREE.Vector3(1,0,0);this.intensity=void 0!==c?c:1;this.height=this.width=1;this.constantAttenuation=1.5;this.linearAttenuation=0.5;this.quadraticAttenuation=0.1};THREE.AreaLight.prototype=Object.create(THREE.Light.prototype);THREE.DirectionalLight=function(d,c){THREE.Light.call(this,d);this.position.set(0,1,0);this.target=new THREE.Object3D;this.intensity=void 0!==c?c:1;this.onlyShadow=this.castShadow=!1;this.shadowCameraNear=50;this.shadowCameraFar=5000;this.shadowCameraLeft=-500;this.shadowCameraTop=this.shadowCameraRight=500;this.shadowCameraBottom=-500;this.shadowCameraVisible=!1;this.shadowBias=0;this.shadowDarkness=0.5;this.shadowMapHeight=this.shadowMapWidth=512;this.shadowCascade=!1;this.shadowCascadeOffset=new THREE.Vector3(0,0,-1000);this.shadowCascadeCount=2;this.shadowCascadeBias=[0,0,0];this.shadowCascadeWidth=[512,512,512];this.shadowCascadeHeight=[512,512,512];this.shadowCascadeNearZ=[-1,0.99,0.998];this.shadowCascadeFarZ=[0.99,0.998,1];this.shadowCascadeArray=[];this.shadowMatrix=this.shadowCamera=this.shadowMapSize=this.shadowMap=null};THREE.DirectionalLight.prototype=Object.create(THREE.Light.prototype);THREE.DirectionalLight.prototype.clone=function(){var b=new THREE.DirectionalLight;THREE.Light.prototype.clone.call(this,b);b.target=this.target.clone();b.intensity=this.intensity;b.castShadow=this.castShadow;b.onlyShadow=this.onlyShadow;return b};THREE.HemisphereLight=function(e,d,f){THREE.Light.call(this,e);this.position.set(0,100,0);this.groundColor=new THREE.Color(d);this.intensity=void 0!==f?f:1};THREE.HemisphereLight.prototype=Object.create(THREE.Light.prototype);THREE.HemisphereLight.prototype.clone=function(){var b=new THREE.HemisphereLight;THREE.Light.prototype.clone.call(this,b);b.groundColor.copy(this.groundColor);b.intensity=this.intensity;return b};THREE.PointLight=function(e,d,f){THREE.Light.call(this,e);this.intensity=void 0!==d?d:1;this.distance=void 0!==f?f:0};THREE.PointLight.prototype=Object.create(THREE.Light.prototype);THREE.PointLight.prototype.clone=function(){var b=new THREE.PointLight;THREE.Light.prototype.clone.call(this,b);b.intensity=this.intensity;b.distance=this.distance;return b};THREE.SpotLight=function(g,f,j,i,h){THREE.Light.call(this,g);this.position.set(0,1,0);this.target=new THREE.Object3D;this.intensity=void 0!==f?f:1;this.distance=void 0!==j?j:0;this.angle=void 0!==i?i:Math.PI/3;this.exponent=void 0!==h?h:10;this.onlyShadow=this.castShadow=!1;this.shadowCameraNear=50;this.shadowCameraFar=5000;this.shadowCameraFov=50;this.shadowCameraVisible=!1;this.shadowBias=0;this.shadowDarkness=0.5;this.shadowMapHeight=this.shadowMapWidth=512;this.shadowMatrix=this.shadowCamera=this.shadowMapSize=this.shadowMap=null};THREE.SpotLight.prototype=Object.create(THREE.Light.prototype);THREE.SpotLight.prototype.clone=function(){var b=new THREE.SpotLight;THREE.Light.prototype.clone.call(this,b);b.target=this.target.clone();b.intensity=this.intensity;b.distance=this.distance;b.angle=this.angle;b.exponent=this.exponent;b.castShadow=this.castShadow;b.onlyShadow=this.onlyShadow;return b};THREE.Loader=function(b){this.statusDomElement=(this.showStatus=b)?THREE.Loader.prototype.addStatusElement():null;this.onLoadStart=function(){};this.onLoadProgress=function(){};this.onLoadComplete=function(){}};THREE.Loader.prototype={constructor:THREE.Loader,crossOrigin:"anonymous",addStatusElement:function(){var b=document.createElement("div");b.style.position="absolute";b.style.right="0px";b.style.top="0px";b.style.fontSize="0.8em";b.style.textAlign="left";b.style.background="rgba(0,0,0,0.25)";b.style.color="#fff";b.style.width="120px";b.style.padding="0.5em 0.5em 0.5em 0.5em";b.style.zIndex=1000;b.innerHTML="Loading ...";return b},updateProgress:function(d){var c="Loaded ",c=d.total?c+((100*d.loaded/d.total).toFixed(0)+"%"):c+((d.loaded/1000).toFixed(2)+" KB");this.statusDomElement.innerHTML=c},extractUrlBase:function(b){b=b.split("/");b.pop();return(1>b.length?".":b.join("/"))+"/"},initMaterials:function(f,e){for(var h=[],g=0;g<f.length;++g){h[g]=THREE.Loader.prototype.createMaterial(f[g],e)}return h},needsTangents:function(e){for(var d=0,f=e.length;d<f;d++){if(e[d] instanceof THREE.ShaderMaterial){return !0}}return !1},createMaterial:function(t,s){function r(b){b=Math.log(b)/Math.LN2;return Math.floor(b)==b}function q(b){b=Math.log(b)/Math.LN2;return Math.pow(2,Math.round(b))}function p(D,B,A,v,h,d,b){var c=/\.dds$/i.test(A),F=s+"/"+A;if(c){var E=THREE.ImageUtils.loadCompressedTexture(F);D[B]=E}else{E=document.createElement("canvas"),D[B]=new THREE.Texture(E)}D[B].sourceFile=A;v&&(D[B].repeat.set(v[0],v[1]),1!==v[0]&&(D[B].wrapS=THREE.RepeatWrapping),1!==v[1]&&(D[B].wrapT=THREE.RepeatWrapping));h&&D[B].offset.set(h[0],h[1]);d&&(A={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping},void 0!==A[d[0]]&&(D[B].wrapS=A[d[0]]),void 0!==A[d[1]]&&(D[B].wrapT=A[d[1]]));b&&(D[B].anisotropy=b);if(!c){var C=D[B],D=new Image;D.onload=function(){if(!r(this.width)||!r(this.height)){var f=q(this.width),e=q(this.height);C.image.width=f;C.image.height=e;C.image.getContext("2d").drawImage(this,0,0,f,e)}else{C.image=this}C.needsUpdate=!0};D.crossOrigin=m.crossOrigin;D.src=F}}function o(b){return(255*b[0]<<16)+(255*b[1]<<8)+255*b[2]}var m=this,n="MeshLambertMaterial",l={color:15658734,opacity:1,map:null,lightMap:null,normalMap:null,bumpMap:null,wireframe:!1};if(t.shading){var j=t.shading.toLowerCase();"phong"===j?n="MeshPhongMaterial":"basic"===j&&(n="MeshBasicMaterial")}void 0!==t.blending&&void 0!==THREE[t.blending]&&(l.blending=THREE[t.blending]);if(void 0!==t.transparent||1>t.opacity){l.transparent=t.transparent}void 0!==t.depthTest&&(l.depthTest=t.depthTest);void 0!==t.depthWrite&&(l.depthWrite=t.depthWrite);void 0!==t.visible&&(l.visible=t.visible);void 0!==t.flipSided&&(l.side=THREE.BackSide);void 0!==t.doubleSided&&(l.side=THREE.DoubleSide);void 0!==t.wireframe&&(l.wireframe=t.wireframe);void 0!==t.vertexColors&&("face"===t.vertexColors?l.vertexColors=THREE.FaceColors:t.vertexColors&&(l.vertexColors=THREE.VertexColors));t.colorDiffuse?l.color=o(t.colorDiffuse):t.DbgColor&&(l.color=t.DbgColor);t.colorSpecular&&(l.specular=o(t.colorSpecular));t.colorAmbient&&(l.ambient=o(t.colorAmbient));t.transparency&&(l.opacity=t.transparency);t.specularCoef&&(l.shininess=t.specularCoef);t.mapDiffuse&&s&&p(l,"map",t.mapDiffuse,t.mapDiffuseRepeat,t.mapDiffuseOffset,t.mapDiffuseWrap,t.mapDiffuseAnisotropy);t.mapLight&&s&&p(l,"lightMap",t.mapLight,t.mapLightRepeat,t.mapLightOffset,t.mapLightWrap,t.mapLightAnisotropy);t.mapBump&&s&&p(l,"bumpMap",t.mapBump,t.mapBumpRepeat,t.mapBumpOffset,t.mapBumpWrap,t.mapBumpAnisotropy);t.mapNormal&&s&&p(l,"normalMap",t.mapNormal,t.mapNormalRepeat,t.mapNormalOffset,t.mapNormalWrap,t.mapNormalAnisotropy);t.mapSpecular&&s&&p(l,"specularMap",t.mapSpecular,t.mapSpecularRepeat,t.mapSpecularOffset,t.mapSpecularWrap,t.mapSpecularAnisotropy);t.mapBumpScale&&(l.bumpScale=t.mapBumpScale);t.mapNormal?(n=THREE.ShaderLib.normalmap,j=THREE.UniformsUtils.clone(n.uniforms),j.tNormal.value=l.normalMap,t.mapNormalFactor&&j.uNormalScale.value.set(t.mapNormalFactor,t.mapNormalFactor),l.map&&(j.tDiffuse.value=l.map,j.enableDiffuse.value=!0),l.specularMap&&(j.tSpecular.value=l.specularMap,j.enableSpecular.value=!0),l.lightMap&&(j.tAO.value=l.lightMap,j.enableAO.value=!0),j.uDiffuseColor.value.setHex(l.color),j.uSpecularColor.value.setHex(l.specular),j.uAmbientColor.value.setHex(l.ambient),j.uShininess.value=l.shininess,void 0!==l.opacity&&(j.uOpacity.value=l.opacity),n=new THREE.ShaderMaterial({fragmentShader:n.fragmentShader,vertexShader:n.vertexShader,uniforms:j,lights:!0,fog:!0}),l.transparent&&(n.transparent=!0)):n=new THREE[n](l);void 0!==t.DbgName&&(n.name=t.DbgName);return n}};THREE.XHRLoader=function(b){this.manager=void 0!==b?b:THREE.DefaultLoadingManager};THREE.XHRLoader.prototype={constructor:THREE.XHRLoader,load:function(h,g,l,k){var j=this,i=new XMLHttpRequest;void 0!==g&&i.addEventListener("load",function(a){g(a.target.responseText);j.manager.itemEnd(h)},!1);void 0!==l&&i.addEventListener("progress",function(b){l(b)},!1);void 0!==k&&i.addEventListener("error",function(b){k(b)},!1);void 0!==this.crossOrigin&&(i.crossOrigin=this.crossOrigin);i.open("GET",h,!0);i.send(null);j.manager.itemStart(h)},setCrossOrigin:function(b){this.crossOrigin=b}};THREE.ImageLoader=function(b){this.manager=void 0!==b?b:THREE.DefaultLoadingManager};THREE.ImageLoader.prototype={constructor:THREE.ImageLoader,load:function(h,g,l,k){var j=this,i=document.createElement("img");void 0!==g&&i.addEventListener("load",function(){j.manager.itemEnd(h);g(this)},!1);void 0!==l&&i.addEventListener("progress",function(b){l(b)},!1);void 0!==k&&i.addEventListener("error",function(b){k(b)},!1);void 0!==this.crossOrigin&&(i.crossOrigin=this.crossOrigin);i.src=h;j.manager.itemStart(h);return i},setCrossOrigin:function(b){this.crossOrigin=b}};THREE.JSONLoader=function(b){THREE.Loader.call(this,b);this.withCredentials=!1};THREE.JSONLoader.prototype=Object.create(THREE.Loader.prototype);THREE.JSONLoader.prototype.load=function(e,d,f){f=f&&"string"===typeof f?f:this.extractUrlBase(e);this.onLoadStart();this.loadAjaxJSON(this,e,d,f)};THREE.JSONLoader.prototype.loadAjaxJSON=function(i,g,n,m,l){var k=new XMLHttpRequest,j=0;k.onreadystatechange=function(){if(k.readyState===k.DONE){if(200===k.status||0===k.status){if(k.responseText){var a=JSON.parse(k.responseText),a=i.parse(a,m);n(a.geometry,a.materials)}else{console.warn("THREE.JSONLoader: ["+g+"] seems to be unreachable or file there is empty")}i.onLoadComplete()}else{console.error("THREE.JSONLoader: Couldn't load ["+g+"] ["+k.status+"]")}}else{k.readyState===k.LOADING?l&&(0===j&&(j=k.getResponseHeader("Content-Length")),l({total:j,loaded:k.responseText.length})):k.readyState===k.HEADERS_RECEIVED&&void 0!==l&&(j=k.getResponseHeader("Content-Length"))}};k.open("GET",g,!0);k.withCredentials=this.withCredentials;k.send(null)};THREE.JSONLoader.prototype.parse=function(T,S){var R=new THREE.Geometry,Q=void 0!==T.scale?1/T.scale:1,P,O,M,N,L,K,I,J,G,C,A,H,D,F,v=T.faces;G=T.vertices;var o=T.normals,j=T.colors,E=0;if(void 0!==T.uvs){for(P=0;P<T.uvs.length;P++){T.uvs[P].length&&E++}for(P=0;P<E;P++){R.faceVertexUvs[P]=[]}}N=0;for(L=G.length;N<L;){K=new THREE.Vector3,K.x=G[N++]*Q,K.y=G[N++]*Q,K.z=G[N++]*Q,R.vertices.push(K)}N=0;for(L=v.length;N<L;){if(G=v[N++],C=G&1,M=G&2,P=G&8,I=G&16,A=G&32,K=G&64,G&=128,C){C=new THREE.Face3;C.a=v[N];C.b=v[N+1];C.c=v[N+3];H=new THREE.Face3;H.a=v[N+1];H.b=v[N+2];H.c=v[N+3];N+=4;M&&(M=v[N++],C.materialIndex=M,H.materialIndex=M);M=R.faces.length;if(P){for(P=0;P<E;P++){D=T.uvs[P];R.faceVertexUvs[P][M]=[];R.faceVertexUvs[P][M+1]=[];for(O=0;4>O;O++){J=v[N++],F=D[2*J],J=D[2*J+1],F=new THREE.Vector2(F,J),2!==O&&R.faceVertexUvs[P][M].push(F),0!==O&&R.faceVertexUvs[P][M+1].push(F)}}}I&&(I=3*v[N++],C.normal.set(o[I++],o[I++],o[I]),H.normal.copy(C.normal));if(A){for(P=0;4>P;P++){I=3*v[N++],A=new THREE.Vector3(o[I++],o[I++],o[I]),2!==P&&C.vertexNormals.push(A),0!==P&&H.vertexNormals.push(A)}}K&&(K=v[N++],K=j[K],C.color.setHex(K),H.color.setHex(K));if(G){for(P=0;4>P;P++){K=v[N++],K=j[K],2!==P&&C.vertexColors.push(new THREE.Color(K)),0!==P&&H.vertexColors.push(new THREE.Color(K))}}R.faces.push(C);R.faces.push(H)}else{C=new THREE.Face3;C.a=v[N++];C.b=v[N++];C.c=v[N++];M&&(M=v[N++],C.materialIndex=M);M=R.faces.length;if(P){for(P=0;P<E;P++){D=T.uvs[P];R.faceVertexUvs[P][M]=[];for(O=0;3>O;O++){J=v[N++],F=D[2*J],J=D[2*J+1],F=new THREE.Vector2(F,J),R.faceVertexUvs[P][M].push(F)}}}I&&(I=3*v[N++],C.normal.set(o[I++],o[I++],o[I]));if(A){for(P=0;3>P;P++){I=3*v[N++],A=new THREE.Vector3(o[I++],o[I++],o[I]),C.vertexNormals.push(A)}}K&&(K=v[N++],C.color.setHex(j[K]));if(G){for(P=0;3>P;P++){K=v[N++],C.vertexColors.push(new THREE.Color(j[K]))}}R.faces.push(C)}}if(T.skinWeights){N=0;for(L=T.skinWeights.length;N<L;N+=2){v=T.skinWeights[N],o=T.skinWeights[N+1],R.skinWeights.push(new THREE.Vector4(v,o,0,0))}}if(T.skinIndices){N=0;for(L=T.skinIndices.length;N<L;N+=2){v=T.skinIndices[N],o=T.skinIndices[N+1],R.skinIndices.push(new THREE.Vector4(v,o,0,0))}}R.bones=T.bones;R.animation=T.animation;R.animations=T.animations;if(void 0!==T.morphTargets){N=0;for(L=T.morphTargets.length;N<L;N++){R.morphTargets[N]={};R.morphTargets[N].name=T.morphTargets[N].name;R.morphTargets[N].vertices=[];j=R.morphTargets[N].vertices;E=T.morphTargets[N].vertices;v=0;for(o=E.length;v<o;v+=3){G=new THREE.Vector3,G.x=E[v]*Q,G.y=E[v+1]*Q,G.z=E[v+2]*Q,j.push(G)}}}if(void 0!==T.morphColors){N=0;for(L=T.morphColors.length;N<L;N++){R.morphColors[N]={};R.morphColors[N].name=T.morphColors[N].name;R.morphColors[N].colors=[];o=R.morphColors[N].colors;j=T.morphColors[N].colors;Q=0;for(v=j.length;Q<v;Q+=3){E=new THREE.Color(16755200),E.setRGB(j[Q],j[Q+1],j[Q+2]),o.push(E)}}}R.computeCentroids();R.computeFaceNormals();R.computeBoundingSphere();if(void 0===T.materials){return{geometry:R}}Q=this.initMaterials(T.materials,S);this.needsTangents(Q)&&R.computeTangents();return{geometry:R,materials:Q}};THREE.LoadingManager=function(h,g,l){var k=this,j=0,i=0;this.onLoad=h;this.onProgress=g;this.onError=l;this.itemStart=function(){i++};this.itemEnd=function(b){j++;if(void 0!==k.onProgress){k.onProgress(b,j,i)}if(j===i&&void 0!==k.onLoad){k.onLoad()}}};THREE.DefaultLoadingManager=new THREE.LoadingManager;THREE.BufferGeometryLoader=function(b){this.manager=void 0!==b?b:THREE.DefaultLoadingManager};THREE.BufferGeometryLoader.prototype={constructor:THREE.BufferGeometryLoader,load:function(f,e){var h=this,g=new THREE.XHRLoader;g.setCrossOrigin(this.crossOrigin);g.load(f,function(b){e(h.parse(JSON.parse(b)))})},setCrossOrigin:function(b){this.crossOrigin=b},parse:function(h){var g=new THREE.BufferGeometry,l=h.attributes,k=h.offsets,h=h.boundingSphere,j;for(j in l){var i=l[j];g.attributes[j]={itemSize:i.itemSize,array:new self[i.type](i.array)}}void 0!==k&&(g.offsets=JSON.parse(JSON.stringify(k)));void 0!==h&&(g.boundingSphere=new THREE.Sphere((new THREE.Vector3).fromArray(void 0!==h.center?h.center:[0,0,0]),h.radius));return g}};THREE.GeometryLoader=function(b){this.manager=void 0!==b?b:THREE.DefaultLoadingManager};THREE.GeometryLoader.prototype={constructor:THREE.GeometryLoader,load:function(f,e){var h=this,g=new THREE.XHRLoader;g.setCrossOrigin(this.crossOrigin);g.load(f,function(b){e(h.parse(JSON.parse(b)))})},setCrossOrigin:function(b){this.crossOrigin=b},parse:function(){}};THREE.MaterialLoader=function(b){this.manager=void 0!==b?b:THREE.DefaultLoadingManager};THREE.MaterialLoader.prototype={constructor:THREE.MaterialLoader,load:function(f,e){var h=this,g=new THREE.XHRLoader;g.setCrossOrigin(this.crossOrigin);g.load(f,function(b){e(h.parse(JSON.parse(b)))})},setCrossOrigin:function(b){this.crossOrigin=b},parse:function(f){var e=new THREE[f.type];void 0!==f.color&&e.color.setHex(f.color);void 0!==f.ambient&&e.ambient.setHex(f.ambient);void 0!==f.emissive&&e.emissive.setHex(f.emissive);void 0!==f.specular&&e.specular.setHex(f.specular);void 0!==f.shininess&&(e.shininess=f.shininess);void 0!==f.vertexColors&&(e.vertexColors=f.vertexColors);void 0!==f.blending&&(e.blending=f.blending);void 0!==f.opacity&&(e.opacity=f.opacity);void 0!==f.transparent&&(e.transparent=f.transparent);void 0!==f.wireframe&&(e.wireframe=f.wireframe);if(void 0!==f.materials){for(var h=0,g=f.materials.length;h<g;h++){e.materials.push(this.parse(f.materials[h]))}}return e}};THREE.ObjectLoader=function(b){this.manager=void 0!==b?b:THREE.DefaultLoadingManager};THREE.ObjectLoader.prototype={constructor:THREE.ObjectLoader,load:function(f,e){var h=this,g=new THREE.XHRLoader(h.manager);g.setCrossOrigin(this.crossOrigin);g.load(f,function(b){e(h.parse(JSON.parse(b)))})},setCrossOrigin:function(b){this.crossOrigin=b},parse:function(e){var d=this.parseGeometries(e.geometries),f=this.parseMaterials(e.materials);return this.parseObject(e.object,d,f)},parseGeometries:function(j){var i={};if(void 0!==j){for(var p=new THREE.JSONLoader,o=new THREE.BufferGeometryLoader,n=0,m=j.length;n<m;n++){var k,l=j[n];switch(l.type){case"PlaneGeometry":k=new THREE.PlaneGeometry(l.width,l.height,l.widthSegments,l.heightSegments);break;case"CircleGeometry":k=new THREE.CircleGeometry(l.radius,l.segments);break;case"CubeGeometry":k=new THREE.CubeGeometry(l.width,l.height,l.depth,l.widthSegments,l.heightSegments,l.depthSegments);break;case"CylinderGeometry":k=new THREE.CylinderGeometry(l.radiusTop,l.radiusBottom,l.height,l.radiusSegments,l.heightSegments,l.openEnded);break;case"SphereGeometry":k=new THREE.SphereGeometry(l.radius,l.widthSegments,l.heightSegments,l.phiStart,l.phiLength,l.thetaStart,l.thetaLength);break;case"IcosahedronGeometry":k=new THREE.IcosahedronGeometry(l.radius,l.detail);break;case"TorusGeometry":k=new THREE.TorusGeometry(l.radius,l.tube,l.radialSegments,l.tubularSegments,l.arc);break;case"TorusKnotGeometry":k=new THREE.TorusKnotGeometry(l.radius,l.tube,l.radialSegments,l.tubularSegments,l.p,l.q,l.heightScale);break;case"BufferGeometry":k=o.parse(l.data);break;case"Geometry":k=p.parse(l.data).geometry}k.uuid=l.uuid;void 0!==l.name&&(k.name=l.name);i[l.uuid]=k}}return i},parseMaterials:function(i){var g={};if(void 0!==i){for(var n=new THREE.MaterialLoader,m=0,l=i.length;m<l;m++){var k=i[m],j=n.parse(k);j.uuid=k.uuid;void 0!==k.name&&(j.name=k.name);g[k.uuid]=j}}return g},parseObject:function(){var b=new THREE.Matrix4;return function(a,l,k){var j;switch(a.type){case"Scene":j=new THREE.Scene;break;case"PerspectiveCamera":j=new THREE.PerspectiveCamera(a.fov,a.aspect,a.near,a.far);break;case"OrthographicCamera":j=new THREE.OrthographicCamera(a.left,a.right,a.top,a.bottom,a.near,a.far);break;case"AmbientLight":j=new THREE.AmbientLight(a.color);break;case"DirectionalLight":j=new THREE.DirectionalLight(a.color,a.intensity);break;case"PointLight":j=new THREE.PointLight(a.color,a.intensity,a.distance);break;case"SpotLight":j=new THREE.SpotLight(a.color,a.intensity,a.distance,a.angle,a.exponent);break;case"HemisphereLight":j=new THREE.HemisphereLight(a.color,a.groundColor,a.intensity);break;case"Mesh":j=l[a.geometry];var i=k[a.material];void 0===j&&console.error("THREE.ObjectLoader: Undefined geometry "+a.geometry);void 0===i&&console.error("THREE.ObjectLoader: Undefined material "+a.material);j=new THREE.Mesh(j,i);break;default:j=new THREE.Object3D}j.uuid=a.uuid;void 0!==a.name&&(j.name=a.name);void 0!==a.matrix?(b.fromArray(a.matrix),b.decompose(j.position,j.quaternion,j.scale)):(void 0!==a.position&&j.position.fromArray(a.position),void 0!==a.rotation&&j.rotation.fromArray(a.rotation),void 0!==a.scale&&j.scale.fromArray(a.scale));void 0!==a.visible&&(j.visible=a.visible);void 0!==a.userData&&(j.userData=a.userData);if(void 0!==a.children){for(var g in a.children){j.add(this.parseObject(a.children[g],l,k))}}return j}}()};THREE.SceneLoader=function(){this.onLoadStart=function(){};this.onLoadProgress=function(){};this.onLoadComplete=function(){};this.callbackSync=function(){};this.callbackProgress=function(){};this.geometryHandlers={};this.hierarchyHandlers={};this.addGeometryHandler("ascii",THREE.JSONLoader)};THREE.SceneLoader.prototype={constructor:THREE.SceneLoader,load:function(f,e){var h=this,g=new THREE.XHRLoader(h.manager);g.setCrossOrigin(this.crossOrigin);g.load(f,function(a){h.parse(JSON.parse(a),e,f)})},setCrossOrigin:function(b){this.crossOrigin=b},addGeometryHandler:function(d,c){this.geometryHandlers[d]={loaderClass:c}},addHierarchyHandler:function(d,c){this.hierarchyHandlers[d]={loaderClass:c}},parse:function(ar,aq,ap){function ao(d,c){return"relativeToHTML"==c?d:ae+"/"+d}function an(){am(ad.scene,Z.objects)}function am(F,E){var C,A,v,u,t,s,n;for(n in E){var f=ad.objects[n],g=E[n];if(void 0===f){if(g.type&&g.type in ah.hierarchyHandlers){if(void 0===g.loading){A={type:1,url:1,material:1,position:1,rotation:1,scale:1,visible:1,children:1,userData:1,skin:1,morph:1,mirroredLoop:1,duration:1};v={};for(var l in g){l in A||(v[l]=g[l])}W=ad.materials[g.material];g.loading=!0;A=ah.hierarchyHandlers[g.type].loaderObject;A.options?A.load(ao(g.url,Z.urlBaseType),al(n,F,W,g)):A.load(ao(g.url,Z.urlBaseType),al(n,F,W,g),v)}}else{if(void 0!==g.geometry){if(Y=ad.geometries[g.geometry]){f=!1;W=ad.materials[g.material];f=W instanceof THREE.ShaderMaterial;v=g.position;u=g.rotation;t=g.scale;C=g.matrix;s=g.quaternion;g.material||(W=new THREE.MeshFaceMaterial(ad.face_materials[g.geometry]));W instanceof THREE.MeshFaceMaterial&&0===W.materials.length&&(W=new THREE.MeshFaceMaterial(ad.face_materials[g.geometry]));if(W instanceof THREE.MeshFaceMaterial){for(A=0;A<W.materials.length;A++){f=f||W.materials[A] instanceof THREE.ShaderMaterial}}f&&Y.computeTangents();g.skin?f=new THREE.SkinnedMesh(Y,W):g.morph?(f=new THREE.MorphAnimMesh(Y,W),void 0!==g.duration&&(f.duration=g.duration),void 0!==g.time&&(f.time=g.time),void 0!==g.mirroredLoop&&(f.mirroredLoop=g.mirroredLoop),W.morphNormals&&Y.computeMorphNormals()):f=new THREE.Mesh(Y,W);f.name=n;C?(f.matrixAutoUpdate=!1,f.matrix.set(C[0],C[1],C[2],C[3],C[4],C[5],C[6],C[7],C[8],C[9],C[10],C[11],C[12],C[13],C[14],C[15])):(f.position.fromArray(v),s?f.quaternion.fromArray(s):f.rotation.fromArray(u),f.scale.fromArray(t));f.visible=g.visible;f.castShadow=g.castShadow;f.receiveShadow=g.receiveShadow;F.add(f);ad.objects[n]=f}}else{"DirectionalLight"===g.type||"PointLight"===g.type||"AmbientLight"===g.type?(P=void 0!==g.color?g.color:16777215,H=void 0!==g.intensity?g.intensity:1,"DirectionalLight"===g.type?(v=g.direction,U=new THREE.DirectionalLight(P,H),U.position.fromArray(v),g.target&&(o.push({object:U,targetName:g.target}),U.target=null)):"PointLight"===g.type?(v=g.position,A=g.distance,U=new THREE.PointLight(P,H,A),U.position.fromArray(v)):"AmbientLight"===g.type&&(U=new THREE.AmbientLight(P)),F.add(U),U.name=n,ad.lights[n]=U,ad.objects[n]=U):"PerspectiveCamera"===g.type||"OrthographicCamera"===g.type?(v=g.position,u=g.rotation,s=g.quaternion,"PerspectiveCamera"===g.type?af=new THREE.PerspectiveCamera(g.fov,g.aspect,g.near,g.far):"OrthographicCamera"===g.type&&(af=new THREE.OrthographicCamera(g.left,g.right,g.top,g.bottom,g.near,g.far)),af.name=n,af.position.fromArray(v),void 0!==s?af.quaternion.fromArray(s):void 0!==u&&af.rotation.fromArray(u),F.add(af),ad.cameras[n]=af,ad.objects[n]=af):(v=g.position,u=g.rotation,t=g.scale,s=g.quaternion,f=new THREE.Object3D,f.name=n,f.position.fromArray(v),s?f.quaternion.fromArray(s):f.rotation.fromArray(u),f.scale.fromArray(t),f.visible=void 0!==g.visible?g.visible:!1,F.add(f),ad.objects[n]=f,ad.empties[n]=f)}}if(f){if(void 0!==g.userData){for(var d in g.userData){f.userData[d]=g.userData[d]}}if(void 0!==g.groups){for(A=0;A<g.groups.length;A++){v=g.groups[A],void 0===ad.groups[v]&&(ad.groups[v]=[]),ad.groups[v].push(n)}}}}void 0!==f&&void 0!==g.children&&am(f,g.children)}}function ak(b){return function(a,d){a.name=b;ad.geometries[b]=a;ad.face_materials[b]=d;an();ab-=1;ah.onLoadComplete();ai()}}function al(f,e,h,g){return function(k){var k=k.content?k.content:k.dae?k.scene:k,c=g.rotation,d=g.quaternion,b=g.scale;k.position.fromArray(g.position);d?k.quaternion.fromArray(d):k.rotation.fromArray(c);k.scale.fromArray(b);h&&k.traverse(function(i){i.material=h});var a=void 0!==g.visible?g.visible:!0;k.traverse(function(i){i.visible=a});e.add(k);k.name=f;ad.objects[f]=k;an();ab-=1;ah.onLoadComplete();ai()}}function aj(b){return function(a,d){a.name=b;ad.geometries[b]=a;ad.face_materials[b]=d}}function ai(){ah.callbackProgress({totalModels:N,totalTextures:T,loadedModels:N-ab,loadedTextures:T-X},ad);ah.onLoadProgress();if(0===ab&&0===X){for(var b=0;b<o.length;b++){var f=o[b],e=ad.objects[f.targetName];e?f.object.target=e:(f.object.target=new THREE.Object3D,ad.scene.add(f.object.target));f.object.target.userData.targetInverse=f.object}aq(ad)}}function ag(e,d){d(e);if(void 0!==e.children){for(var f in e.children){ag(e.children[f],d)}}}var ah=this,ae=THREE.Loader.prototype.extractUrlBase(ap),Y,W,af,aa,ac,U,P,H,ab,X,N,T,ad,o=[],Z=ar,V;for(V in this.geometryHandlers){ar=this.geometryHandlers[V].loaderClass,this.geometryHandlers[V].loaderObject=new ar}for(V in this.hierarchyHandlers){ar=this.hierarchyHandlers[V].loaderClass,this.hierarchyHandlers[V].loaderObject=new ar}X=ab=0;ad={scene:new THREE.Scene,geometries:{},face_materials:{},materials:{},textures:{},objects:{},cameras:{},lights:{},fogs:{},empties:{},groups:{}};if(Z.transform&&(V=Z.transform.position,ar=Z.transform.rotation,ap=Z.transform.scale,V&&ad.scene.position.fromArray(V),ar&&ad.scene.rotation.fromArray(ar),ap&&ad.scene.scale.fromArray(ap),V||ar||ap)){ad.scene.updateMatrix(),ad.scene.updateMatrixWorld()}V=function(b){return function(){X-=b;ai();ah.onLoadComplete()}};for(var M in Z.fogs){ar=Z.fogs[M],"linear"===ar.type?aa=new THREE.Fog(0,ar.near,ar.far):"exp2"===ar.type&&(aa=new THREE.FogExp2(0,ar.density)),ar=ar.color,aa.color.setRGB(ar[0],ar[1],ar[2]),ad.fogs[M]=aa}for(var L in Z.geometries){aa=Z.geometries[L],aa.type in this.geometryHandlers&&(ab+=1,ah.onLoadStart())}for(var S in Z.objects){ag(Z.objects[S],function(b){b.type&&b.type in ah.hierarchyHandlers&&(ab+=1,ah.onLoadStart())})}N=ab;for(L in Z.geometries){if(aa=Z.geometries[L],"cube"===aa.type){Y=new THREE.CubeGeometry(aa.width,aa.height,aa.depth,aa.widthSegments,aa.heightSegments,aa.depthSegments),Y.name=L,ad.geometries[L]=Y}else{if("plane"===aa.type){Y=new THREE.PlaneGeometry(aa.width,aa.height,aa.widthSegments,aa.heightSegments),Y.name=L,ad.geometries[L]=Y}else{if("sphere"===aa.type){Y=new THREE.SphereGeometry(aa.radius,aa.widthSegments,aa.heightSegments),Y.name=L,ad.geometries[L]=Y}else{if("cylinder"===aa.type){Y=new THREE.CylinderGeometry(aa.topRad,aa.botRad,aa.height,aa.radSegs,aa.heightSegs),Y.name=L,ad.geometries[L]=Y}else{if("torus"===aa.type){Y=new THREE.TorusGeometry(aa.radius,aa.tube,aa.segmentsR,aa.segmentsT),Y.name=L,ad.geometries[L]=Y}else{if("icosahedron"===aa.type){Y=new THREE.IcosahedronGeometry(aa.radius,aa.subdivisions),Y.name=L,ad.geometries[L]=Y}else{if(aa.type in this.geometryHandlers){S={};for(ac in aa){"type"!==ac&&"url"!==ac&&(S[ac]=aa[ac])}this.geometryHandlers[aa.type].loaderObject.load(ao(aa.url,Z.urlBaseType),ak(L),S)}else{"embedded"===aa.type&&(S=Z.embeds[aa.id],S.metadata=Z.metadata,S&&(S=this.geometryHandlers.ascii.loaderObject.parse(S,""),aj(L)(S.geometry,S.materials)))}}}}}}}}for(var Q in Z.textures){if(L=Z.textures[Q],L.url instanceof Array){X+=L.url.length;for(ac=0;ac<L.url.length;ac++){ah.onLoadStart()}}else{X+=1,ah.onLoadStart()}}T=X;for(Q in Z.textures){L=Z.textures[Q];void 0!==L.mapping&&void 0!==THREE[L.mapping]&&(L.mapping=new THREE[L.mapping]);if(L.url instanceof Array){S=L.url.length;aa=[];for(ac=0;ac<S;ac++){aa[ac]=ao(L.url[ac],Z.urlBaseType)}ac=(ac=/\.dds$/i.test(aa[0]))?THREE.ImageUtils.loadCompressedTextureCube(aa,L.mapping,V(S)):THREE.ImageUtils.loadTextureCube(aa,L.mapping,V(S))}else{ac=/\.dds$/i.test(L.url),S=ao(L.url,Z.urlBaseType),aa=V(1),ac=ac?THREE.ImageUtils.loadCompressedTexture(S,L.mapping,aa):THREE.ImageUtils.loadTexture(S,L.mapping,aa),void 0!==THREE[L.minFilter]&&(ac.minFilter=THREE[L.minFilter]),void 0!==THREE[L.magFilter]&&(ac.magFilter=THREE[L.magFilter]),L.anisotropy&&(ac.anisotropy=L.anisotropy),L.repeat&&(ac.repeat.set(L.repeat[0],L.repeat[1]),1!==L.repeat[0]&&(ac.wrapS=THREE.RepeatWrapping),1!==L.repeat[1]&&(ac.wrapT=THREE.RepeatWrapping)),L.offset&&ac.offset.set(L.offset[0],L.offset[1]),L.wrap&&(S={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping},void 0!==S[L.wrap[0]]&&(ac.wrapS=S[L.wrap[0]]),void 0!==S[L.wrap[1]]&&(ac.wrapT=S[L.wrap[1]]))}ad.textures[Q]=ac}var j,K;for(j in Z.materials){Q=Z.materials[j];for(K in Q.parameters){"envMap"===K||"map"===K||"lightMap"===K||"bumpMap"===K?Q.parameters[K]=ad.textures[Q.parameters[K]]:"shading"===K?Q.parameters[K]="flat"===Q.parameters[K]?THREE.FlatShading:THREE.SmoothShading:"side"===K?Q.parameters[K]="double"==Q.parameters[K]?THREE.DoubleSide:"back"==Q.parameters[K]?THREE.BackSide:THREE.FrontSide:"blending"===K?Q.parameters[K]=Q.parameters[K] in THREE?THREE[Q.parameters[K]]:THREE.NormalBlending:"combine"===K?Q.parameters[K]=Q.parameters[K] in THREE?THREE[Q.parameters[K]]:THREE.MultiplyOperation:"vertexColors"===K?"face"==Q.parameters[K]?Q.parameters[K]=THREE.FaceColors:Q.parameters[K]&&(Q.parameters[K]=THREE.VertexColors):"wrapRGB"===K&&(V=Q.parameters[K],Q.parameters[K]=new THREE.Vector3(V[0],V[1],V[2]))}void 0!==Q.parameters.opacity&&1>Q.parameters.opacity&&(Q.parameters.transparent=!0);Q.parameters.normalMap?(V=THREE.ShaderLib.normalmap,L=THREE.UniformsUtils.clone(V.uniforms),ac=Q.parameters.color,S=Q.parameters.specular,aa=Q.parameters.ambient,M=Q.parameters.shininess,L.tNormal.value=ad.textures[Q.parameters.normalMap],Q.parameters.normalScale&&L.uNormalScale.value.set(Q.parameters.normalScale[0],Q.parameters.normalScale[1]),Q.parameters.map&&(L.tDiffuse.value=Q.parameters.map,L.enableDiffuse.value=!0),Q.parameters.envMap&&(L.tCube.value=Q.parameters.envMap,L.enableReflection.value=!0,L.uReflectivity.value=Q.parameters.reflectivity),Q.parameters.lightMap&&(L.tAO.value=Q.parameters.lightMap,L.enableAO.value=!0),Q.parameters.specularMap&&(L.tSpecular.value=ad.textures[Q.parameters.specularMap],L.enableSpecular.value=!0),Q.parameters.displacementMap&&(L.tDisplacement.value=ad.textures[Q.parameters.displacementMap],L.enableDisplacement.value=!0,L.uDisplacementBias.value=Q.parameters.displacementBias,L.uDisplacementScale.value=Q.parameters.displacementScale),L.uDiffuseColor.value.setHex(ac),L.uSpecularColor.value.setHex(S),L.uAmbientColor.value.setHex(aa),L.uShininess.value=M,Q.parameters.opacity&&(L.uOpacity.value=Q.parameters.opacity),W=new THREE.ShaderMaterial({fragmentShader:V.fragmentShader,vertexShader:V.vertexShader,uniforms:L,lights:!0,fog:!0})):W=new THREE[Q.type](Q.parameters);W.name=j;ad.materials[j]=W}for(j in Z.materials){if(Q=Z.materials[j],Q.parameters.materials){K=[];for(ac=0;ac<Q.parameters.materials.length;ac++){K.push(ad.materials[Q.parameters.materials[ac]])}ad.materials[j].materials=K}}an();ad.cameras&&Z.defaults.camera&&(ad.currentCamera=ad.cameras[Z.defaults.camera]);ad.fogs&&Z.defaults.fog&&(ad.scene.fog=ad.fogs[Z.defaults.fog]);ah.callbackSync(ad);ai()}};THREE.TextureLoader=function(b){this.manager=void 0!==b?b:THREE.DefaultLoadingManager};THREE.TextureLoader.prototype={constructor:THREE.TextureLoader,load:function(e,d){var f=new THREE.ImageLoader(this.manager);f.setCrossOrigin(this.crossOrigin);f.load(e,function(b){b=new THREE.Texture(b);b.needsUpdate=!0;void 0!==d&&d(b)})},setCrossOrigin:function(b){this.crossOrigin=b}};THREE.Material=function(){this.id=THREE.MaterialIdCount++;this.uuid=THREE.Math.generateUUID();this.name="";this.side=THREE.FrontSide;this.opacity=1;this.transparent=!1;this.blending=THREE.NormalBlending;this.blendSrc=THREE.SrcAlphaFactor;this.blendDst=THREE.OneMinusSrcAlphaFactor;this.blendEquation=THREE.AddEquation;this.depthWrite=this.depthTest=!0;this.polygonOffset=!1;this.overdraw=this.alphaTest=this.polygonOffsetUnits=this.polygonOffsetFactor=0;this.needsUpdate=this.visible=!0};THREE.Material.prototype={constructor:THREE.Material,setValues:function(f){if(void 0!==f){for(var e in f){var h=f[e];if(void 0===h){console.warn("THREE.Material: '"+e+"' parameter is undefined.")}else{if(e in this){var g=this[e];g instanceof THREE.Color?g.set(h):g instanceof THREE.Vector3&&h instanceof THREE.Vector3?g.copy(h):this[e]="overdraw"==e?Number(h):h}}}}},clone:function(b){void 0===b&&(b=new THREE.Material);b.name=this.name;b.side=this.side;b.opacity=this.opacity;b.transparent=this.transparent;b.blending=this.blending;b.blendSrc=this.blendSrc;b.blendDst=this.blendDst;b.blendEquation=this.blendEquation;b.depthTest=this.depthTest;b.depthWrite=this.depthWrite;b.polygonOffset=this.polygonOffset;b.polygonOffsetFactor=this.polygonOffsetFactor;b.polygonOffsetUnits=this.polygonOffsetUnits;b.alphaTest=this.alphaTest;b.overdraw=this.overdraw;b.visible=this.visible;return b},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.Material.prototype);THREE.MaterialIdCount=0;THREE.LineBasicMaterial=function(b){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.linewidth=1;this.linejoin=this.linecap="round";this.vertexColors=!1;this.fog=!0;this.setValues(b)};THREE.LineBasicMaterial.prototype=Object.create(THREE.Material.prototype);THREE.LineBasicMaterial.prototype.clone=function(){var b=new THREE.LineBasicMaterial;THREE.Material.prototype.clone.call(this,b);b.color.copy(this.color);b.linewidth=this.linewidth;b.linecap=this.linecap;b.linejoin=this.linejoin;b.vertexColors=this.vertexColors;b.fog=this.fog;return b};THREE.LineDashedMaterial=function(b){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.scale=this.linewidth=1;this.dashSize=3;this.gapSize=1;this.vertexColors=!1;this.fog=!0;this.setValues(b)};THREE.LineDashedMaterial.prototype=Object.create(THREE.Material.prototype);THREE.LineDashedMaterial.prototype.clone=function(){var b=new THREE.LineDashedMaterial;THREE.Material.prototype.clone.call(this,b);b.color.copy(this.color);b.linewidth=this.linewidth;b.scale=this.scale;b.dashSize=this.dashSize;b.gapSize=this.gapSize;b.vertexColors=this.vertexColors;b.fog=this.fog;return b};THREE.MeshBasicMaterial=function(b){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.envMap=this.specularMap=this.lightMap=this.map=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=0.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=THREE.NoColors;this.morphTargets=this.skinning=!1;this.setValues(b)};THREE.MeshBasicMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshBasicMaterial.prototype.clone=function(){var b=new THREE.MeshBasicMaterial;THREE.Material.prototype.clone.call(this,b);b.color.copy(this.color);b.map=this.map;b.lightMap=this.lightMap;b.specularMap=this.specularMap;b.envMap=this.envMap;b.combine=this.combine;b.reflectivity=this.reflectivity;b.refractionRatio=this.refractionRatio;b.fog=this.fog;b.shading=this.shading;b.wireframe=this.wireframe;b.wireframeLinewidth=this.wireframeLinewidth;b.wireframeLinecap=this.wireframeLinecap;b.wireframeLinejoin=this.wireframeLinejoin;b.vertexColors=this.vertexColors;b.skinning=this.skinning;b.morphTargets=this.morphTargets;return b};THREE.MeshLambertMaterial=function(b){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.ambient=new THREE.Color(16777215);this.emissive=new THREE.Color(0);this.wrapAround=!1;this.wrapRGB=new THREE.Vector3(1,1,1);this.envMap=this.specularMap=this.lightMap=this.map=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=0.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=THREE.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(b)};THREE.MeshLambertMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshLambertMaterial.prototype.clone=function(){var b=new THREE.MeshLambertMaterial;THREE.Material.prototype.clone.call(this,b);b.color.copy(this.color);b.ambient.copy(this.ambient);b.emissive.copy(this.emissive);b.wrapAround=this.wrapAround;b.wrapRGB.copy(this.wrapRGB);b.map=this.map;b.lightMap=this.lightMap;b.specularMap=this.specularMap;b.envMap=this.envMap;b.combine=this.combine;b.reflectivity=this.reflectivity;b.refractionRatio=this.refractionRatio;b.fog=this.fog;b.shading=this.shading;b.wireframe=this.wireframe;b.wireframeLinewidth=this.wireframeLinewidth;b.wireframeLinecap=this.wireframeLinecap;b.wireframeLinejoin=this.wireframeLinejoin;b.vertexColors=this.vertexColors;b.skinning=this.skinning;b.morphTargets=this.morphTargets;b.morphNormals=this.morphNormals;return b};THREE.MeshPhongMaterial=function(b){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.ambient=new THREE.Color(16777215);this.emissive=new THREE.Color(0);this.specular=new THREE.Color(1118481);this.shininess=30;this.metal=!1;this.perPixel=!0;this.wrapAround=!1;this.wrapRGB=new THREE.Vector3(1,1,1);this.bumpMap=this.lightMap=this.map=null;this.bumpScale=1;this.normalMap=null;this.normalScale=new THREE.Vector2(1,1);this.envMap=this.specularMap=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=0.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=THREE.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(b)};THREE.MeshPhongMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshPhongMaterial.prototype.clone=function(){var b=new THREE.MeshPhongMaterial;THREE.Material.prototype.clone.call(this,b);b.color.copy(this.color);b.ambient.copy(this.ambient);b.emissive.copy(this.emissive);b.specular.copy(this.specular);b.shininess=this.shininess;b.metal=this.metal;b.perPixel=this.perPixel;b.wrapAround=this.wrapAround;b.wrapRGB.copy(this.wrapRGB);b.map=this.map;b.lightMap=this.lightMap;b.bumpMap=this.bumpMap;b.bumpScale=this.bumpScale;b.normalMap=this.normalMap;b.normalScale.copy(this.normalScale);b.specularMap=this.specularMap;b.envMap=this.envMap;b.combine=this.combine;b.reflectivity=this.reflectivity;b.refractionRatio=this.refractionRatio;b.fog=this.fog;b.shading=this.shading;b.wireframe=this.wireframe;b.wireframeLinewidth=this.wireframeLinewidth;b.wireframeLinecap=this.wireframeLinecap;b.wireframeLinejoin=this.wireframeLinejoin;b.vertexColors=this.vertexColors;b.skinning=this.skinning;b.morphTargets=this.morphTargets;b.morphNormals=this.morphNormals;return b};THREE.MeshDepthMaterial=function(b){THREE.Material.call(this);this.wireframe=!1;this.wireframeLinewidth=1;this.setValues(b)};THREE.MeshDepthMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshDepthMaterial.prototype.clone=function(){var b=new THREE.MeshDepthMaterial;THREE.Material.prototype.clone.call(this,b);b.wireframe=this.wireframe;b.wireframeLinewidth=this.wireframeLinewidth;return b};THREE.MeshNormalMaterial=function(b){THREE.Material.call(this,b);this.shading=THREE.FlatShading;this.wireframe=!1;this.wireframeLinewidth=1;this.morphTargets=!1;this.setValues(b)};THREE.MeshNormalMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshNormalMaterial.prototype.clone=function(){var b=new THREE.MeshNormalMaterial;THREE.Material.prototype.clone.call(this,b);b.shading=this.shading;b.wireframe=this.wireframe;b.wireframeLinewidth=this.wireframeLinewidth;return b};THREE.MeshFaceMaterial=function(b){this.materials=b instanceof Array?b:[]};THREE.MeshFaceMaterial.prototype.clone=function(){for(var d=new THREE.MeshFaceMaterial,c=0;c<this.materials.length;c++){d.materials.push(this.materials[c].clone())}return d};THREE.ParticleSystemMaterial=function(b){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.map=null;this.size=1;this.sizeAttenuation=!0;this.vertexColors=!1;this.fog=!0;this.setValues(b)};THREE.ParticleSystemMaterial.prototype=Object.create(THREE.Material.prototype);THREE.ParticleSystemMaterial.prototype.clone=function(){var b=new THREE.ParticleSystemMaterial;THREE.Material.prototype.clone.call(this,b);b.color.copy(this.color);b.map=this.map;b.size=this.size;b.sizeAttenuation=this.sizeAttenuation;b.vertexColors=this.vertexColors;b.fog=this.fog;return b};THREE.ParticleBasicMaterial=THREE.ParticleSystemMaterial;THREE.ShaderMaterial=function(b){THREE.Material.call(this);this.vertexShader=this.fragmentShader="void main() {}";this.uniforms={};this.defines={};this.attributes=null;this.shading=THREE.SmoothShading;this.linewidth=1;this.wireframe=!1;this.wireframeLinewidth=1;this.lights=this.fog=!1;this.vertexColors=THREE.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]};this.index0AttributeName="position";this.setValues(b)};THREE.ShaderMaterial.prototype=Object.create(THREE.Material.prototype);THREE.ShaderMaterial.prototype.clone=function(){var b=new THREE.ShaderMaterial;THREE.Material.prototype.clone.call(this,b);b.fragmentShader=this.fragmentShader;b.vertexShader=this.vertexShader;b.uniforms=THREE.UniformsUtils.clone(this.uniforms);b.attributes=this.attributes;b.defines=this.defines;b.shading=this.shading;b.wireframe=this.wireframe;b.wireframeLinewidth=this.wireframeLinewidth;b.fog=this.fog;b.lights=this.lights;b.vertexColors=this.vertexColors;b.skinning=this.skinning;b.morphTargets=this.morphTargets;b.morphNormals=this.morphNormals;return b};THREE.SpriteMaterial=function(b){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.map=new THREE.Texture;this.useScreenCoordinates=!0;this.depthTest=!this.useScreenCoordinates;this.sizeAttenuation=!this.useScreenCoordinates;this.alignment=THREE.SpriteAlignment.center.clone();this.fog=!1;this.uvOffset=new THREE.Vector2(0,0);this.uvScale=new THREE.Vector2(1,1);this.setValues(b);b=b||{};void 0===b.depthTest&&(this.depthTest=!this.useScreenCoordinates);void 0===b.sizeAttenuation&&(this.sizeAttenuation=!this.useScreenCoordinates)};THREE.SpriteMaterial.prototype=Object.create(THREE.Material.prototype);THREE.SpriteMaterial.prototype.clone=function(){var b=new THREE.SpriteMaterial;THREE.Material.prototype.clone.call(this,b);b.color.copy(this.color);b.map=this.map;b.useScreenCoordinates=this.useScreenCoordinates;b.sizeAttenuation=this.sizeAttenuation;b.alignment.copy(this.alignment);b.uvOffset.copy(this.uvOffset);b.uvScale.copy(this.uvScale);b.fog=this.fog;return b};THREE.SpriteAlignment={};THREE.SpriteAlignment.topLeft=new THREE.Vector2(0.5,-0.5);THREE.SpriteAlignment.topCenter=new THREE.Vector2(0,-0.5);THREE.SpriteAlignment.topRight=new THREE.Vector2(-0.5,-0.5);THREE.SpriteAlignment.centerLeft=new THREE.Vector2(0.5,0);THREE.SpriteAlignment.center=new THREE.Vector2(0,0);THREE.SpriteAlignment.centerRight=new THREE.Vector2(-0.5,0);THREE.SpriteAlignment.bottomLeft=new THREE.Vector2(0.5,0.5);THREE.SpriteAlignment.bottomCenter=new THREE.Vector2(0,0.5);THREE.SpriteAlignment.bottomRight=new THREE.Vector2(-0.5,0.5);THREE.SpriteCanvasMaterial=function(b){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.program=function(){};this.setValues(b)};THREE.SpriteCanvasMaterial.prototype=Object.create(THREE.Material.prototype);THREE.SpriteCanvasMaterial.prototype.clone=function(){var b=new THREE.SpriteCanvasMaterial;THREE.Material.prototype.clone.call(this,b);b.color.copy(this.color);b.program=this.program;return b};THREE.ParticleCanvasMaterial=THREE.SpriteCanvasMaterial;THREE.Texture=function(r,q,p,o,n,m,k,l,j){this.id=THREE.TextureIdCount++;this.uuid=THREE.Math.generateUUID();this.name="";this.image=r;this.mipmaps=[];this.mapping=void 0!==q?q:new THREE.UVMapping;this.wrapS=void 0!==p?p:THREE.ClampToEdgeWrapping;this.wrapT=void 0!==o?o:THREE.ClampToEdgeWrapping;this.magFilter=void 0!==n?n:THREE.LinearFilter;this.minFilter=void 0!==m?m:THREE.LinearMipMapLinearFilter;this.anisotropy=void 0!==j?j:1;this.format=void 0!==k?k:THREE.RGBAFormat;this.type=void 0!==l?l:THREE.UnsignedByteType;this.offset=new THREE.Vector2(0,0);this.repeat=new THREE.Vector2(1,1);this.generateMipmaps=!0;this.premultiplyAlpha=!1;this.flipY=!0;this.unpackAlignment=4;this.needsUpdate=!1;this.onUpdate=null};THREE.Texture.prototype={constructor:THREE.Texture,clone:function(b){void 0===b&&(b=new THREE.Texture);b.image=this.image;b.mipmaps=this.mipmaps.slice(0);b.mapping=this.mapping;b.wrapS=this.wrapS;b.wrapT=this.wrapT;b.magFilter=this.magFilter;b.minFilter=this.minFilter;b.anisotropy=this.anisotropy;b.format=this.format;b.type=this.type;b.offset.copy(this.offset);b.repeat.copy(this.repeat);b.generateMipmaps=this.generateMipmaps;b.premultiplyAlpha=this.premultiplyAlpha;b.flipY=this.flipY;b.unpackAlignment=this.unpackAlignment;return b},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.Texture.prototype);THREE.TextureIdCount=0;THREE.CompressedTexture=function(v,u,t,s,r,q,o,p,n,l,j){THREE.Texture.call(this,null,q,o,p,n,l,s,r,j);this.image={width:u,height:t};this.mipmaps=v;this.generateMipmaps=!1};THREE.CompressedTexture.prototype=Object.create(THREE.Texture.prototype);THREE.CompressedTexture.prototype.clone=function(){var b=new THREE.CompressedTexture;THREE.Texture.prototype.clone.call(this,b);return b};THREE.DataTexture=function(v,u,t,s,r,q,o,p,n,l,j){THREE.Texture.call(this,null,q,o,p,n,l,s,r,j);this.image={data:v,width:u,height:t}};THREE.DataTexture.prototype=Object.create(THREE.Texture.prototype);THREE.DataTexture.prototype.clone=function(){var b=new THREE.DataTexture;THREE.Texture.prototype.clone.call(this,b);return b};THREE.ParticleSystem=function(d,c){THREE.Object3D.call(this);this.geometry=void 0!==d?d:new THREE.Geometry;this.material=void 0!==c?c:new THREE.ParticleSystemMaterial({color:16777215*Math.random()});this.frustumCulled=this.sortParticles=!1};THREE.ParticleSystem.prototype=Object.create(THREE.Object3D.prototype);THREE.ParticleSystem.prototype.clone=function(b){void 0===b&&(b=new THREE.ParticleSystem(this.geometry,this.material));b.sortParticles=this.sortParticles;THREE.Object3D.prototype.clone.call(this,b);return b};THREE.Line=function(e,d,f){THREE.Object3D.call(this);this.geometry=void 0!==e?e:new THREE.Geometry;this.material=void 0!==d?d:new THREE.LineBasicMaterial({color:16777215*Math.random()});this.type=void 0!==f?f:THREE.LineStrip};THREE.LineStrip=0;THREE.LinePieces=1;THREE.Line.prototype=Object.create(THREE.Object3D.prototype);THREE.Line.prototype.clone=function(b){void 0===b&&(b=new THREE.Line(this.geometry,this.material,this.type));THREE.Object3D.prototype.clone.call(this,b);return b};THREE.Mesh=function(d,c){THREE.Object3D.call(this);this.geometry=void 0!==d?d:new THREE.Geometry;this.material=void 0!==c?c:new THREE.MeshBasicMaterial({color:16777215*Math.random()});this.updateMorphTargets()};THREE.Mesh.prototype=Object.create(THREE.Object3D.prototype);THREE.Mesh.prototype.updateMorphTargets=function(){if(0<this.geometry.morphTargets.length){this.morphTargetBase=-1;this.morphTargetForcedOrder=[];this.morphTargetInfluences=[];this.morphTargetDictionary={};for(var d=0,c=this.geometry.morphTargets.length;d<c;d++){this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[d].name]=d}}};THREE.Mesh.prototype.getMorphTargetIndexByName=function(b){if(void 0!==this.morphTargetDictionary[b]){return this.morphTargetDictionary[b]}console.log("THREE.Mesh.getMorphTargetIndexByName: morph target "+b+" does not exist. Returning 0.");return 0};THREE.Mesh.prototype.clone=function(b){void 0===b&&(b=new THREE.Mesh(this.geometry,this.material));THREE.Object3D.prototype.clone.call(this,b);return b};THREE.Bone=function(b){THREE.Object3D.call(this);this.skin=b;this.skinMatrix=new THREE.Matrix4};THREE.Bone.prototype=Object.create(THREE.Object3D.prototype);THREE.Bone.prototype.update=function(f,e){this.matrixAutoUpdate&&(e|=this.updateMatrix());if(e||this.matrixWorldNeedsUpdate){f?this.skinMatrix.multiplyMatrices(f,this.matrix):this.skinMatrix.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0}var h,g=this.children.length;for(h=0;h<g;h++){this.children[h].update(this.skinMatrix,e)}};THREE.SkinnedMesh=function(h,g,l){THREE.Mesh.call(this,h,g);this.useVertexTexture=void 0!==l?l:!0;this.identityMatrix=new THREE.Matrix4;this.bones=[];this.boneMatrices=[];var k,j,i;if(this.geometry&&void 0!==this.geometry.bones){for(h=0;h<this.geometry.bones.length;h++){l=this.geometry.bones[h],k=l.pos,j=l.rotq,i=l.scl,g=this.addBone(),g.name=l.name,g.position.set(k[0],k[1],k[2]),g.quaternion.set(j[0],j[1],j[2],j[3]),void 0!==i?g.scale.set(i[0],i[1],i[2]):g.scale.set(1,1,1)}for(h=0;h<this.bones.length;h++){l=this.geometry.bones[h],g=this.bones[h],-1===l.parent?this.add(g):this.bones[l.parent].add(g)}h=this.bones.length;this.useVertexTexture?(this.boneTextureHeight=this.boneTextureWidth=h=256<h?64:64<h?32:16<h?16:8,this.boneMatrices=new Float32Array(4*this.boneTextureWidth*this.boneTextureHeight),this.boneTexture=new THREE.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,THREE.RGBAFormat,THREE.FloatType),this.boneTexture.minFilter=THREE.NearestFilter,this.boneTexture.magFilter=THREE.NearestFilter,this.boneTexture.generateMipmaps=!1,this.boneTexture.flipY=!1):this.boneMatrices=new Float32Array(16*h);this.pose()}};THREE.SkinnedMesh.prototype=Object.create(THREE.Mesh.prototype);THREE.SkinnedMesh.prototype.addBone=function(b){void 0===b&&(b=new THREE.Bone(this));this.bones.push(b);return b};THREE.SkinnedMesh.prototype.updateMatrixWorld=function(){var b=new THREE.Matrix4;return function(a){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||a){this.parent?this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1}for(var a=0,f=this.children.length;a<f;a++){var e=this.children[a];e instanceof THREE.Bone?e.update(this.identityMatrix,!1):e.updateMatrixWorld(!0)}if(void 0==this.boneInverses){this.boneInverses=[];a=0;for(f=this.bones.length;a<f;a++){e=new THREE.Matrix4,e.getInverse(this.bones[a].skinMatrix),this.boneInverses.push(e)}}a=0;for(f=this.bones.length;a<f;a++){b.multiplyMatrices(this.bones[a].skinMatrix,this.boneInverses[a]),b.flattenToArrayOffset(this.boneMatrices,16*a)}this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)}}();THREE.SkinnedMesh.prototype.pose=function(){this.updateMatrixWorld(!0);this.normalizeSkinWeights()};THREE.SkinnedMesh.prototype.normalizeSkinWeights=function(){if(this.geometry instanceof THREE.Geometry){for(var e=0;e<this.geometry.skinIndices.length;e++){var d=this.geometry.skinWeights[e],f=1/d.lengthManhattan();Infinity!==f?d.multiplyScalar(f):d.set(1)}}};THREE.SkinnedMesh.prototype.clone=function(b){void 0===b&&(b=new THREE.SkinnedMesh(this.geometry,this.material,this.useVertexTexture));THREE.Mesh.prototype.clone.call(this,b);return b};THREE.MorphAnimMesh=function(d,c){THREE.Mesh.call(this,d,c);this.duration=1000;this.mirroredLoop=!1;this.currentKeyframe=this.lastKeyframe=this.time=0;this.direction=1;this.directionBackwards=!1;this.setFrameRange(0,this.geometry.morphTargets.length-1)};THREE.MorphAnimMesh.prototype=Object.create(THREE.Mesh.prototype);THREE.MorphAnimMesh.prototype.setFrameRange=function(d,c){this.startKeyframe=d;this.endKeyframe=c;this.length=this.endKeyframe-this.startKeyframe+1};THREE.MorphAnimMesh.prototype.setDirectionForward=function(){this.direction=1;this.directionBackwards=!1};THREE.MorphAnimMesh.prototype.setDirectionBackward=function(){this.direction=-1;this.directionBackwards=!0};THREE.MorphAnimMesh.prototype.parseAnimations=function(){var j=this.geometry;j.animations||(j.animations={});for(var i,p=j.animations,o=/([a-z]+)(\d+)/,n=0,m=j.morphTargets.length;n<m;n++){var k=j.morphTargets[n].name.match(o);if(k&&1<k.length){k=k[1];p[k]||(p[k]={start:Infinity,end:-Infinity});var l=p[k];n<l.start&&(l.start=n);n>l.end&&(l.end=n);i||(i=k)}}j.firstAnimation=i};THREE.MorphAnimMesh.prototype.setAnimationLabel=function(e,d,f){this.geometry.animations||(this.geometry.animations={});this.geometry.animations[e]={start:d,end:f}};THREE.MorphAnimMesh.prototype.playAnimation=function(e,d){var f=this.geometry.animations[e];f?(this.setFrameRange(f.start,f.end),this.duration=1000*((f.end-f.start)/d),this.time=0):console.warn("animation["+e+"] undefined")};THREE.MorphAnimMesh.prototype.updateAnimation=function(d){var c=this.duration/this.length;this.time+=this.direction*d;if(this.mirroredLoop){if(this.time>this.duration||0>this.time){this.direction*=-1,this.time>this.duration&&(this.time=this.duration,this.directionBackwards=!0),0>this.time&&(this.time=0,this.directionBackwards=!1)}}else{this.time%=this.duration,0>this.time&&(this.time+=this.duration)}d=this.startKeyframe+THREE.Math.clamp(Math.floor(this.time/c),0,this.length-1);d!==this.currentKeyframe&&(this.morphTargetInfluences[this.lastKeyframe]=0,this.morphTargetInfluences[this.currentKeyframe]=1,this.morphTargetInfluences[d]=0,this.lastKeyframe=this.currentKeyframe,this.currentKeyframe=d);c=this.time%c/c;this.directionBackwards&&(c=1-c);this.morphTargetInfluences[this.currentKeyframe]=c;this.morphTargetInfluences[this.lastKeyframe]=1-c};THREE.MorphAnimMesh.prototype.clone=function(b){void 0===b&&(b=new THREE.MorphAnimMesh(this.geometry,this.material));b.duration=this.duration;b.mirroredLoop=this.mirroredLoop;b.time=this.time;b.lastKeyframe=this.lastKeyframe;b.currentKeyframe=this.currentKeyframe;b.direction=this.direction;b.directionBackwards=this.directionBackwards;THREE.Mesh.prototype.clone.call(this,b);return b};THREE.LOD=function(){THREE.Object3D.call(this);this.objects=[]};THREE.LOD.prototype=Object.create(THREE.Object3D.prototype);THREE.LOD.prototype.addLevel=function(e,d){void 0===d&&(d=0);for(var d=Math.abs(d),f=0;f<this.objects.length&&!(d<this.objects[f].distance);f++){}this.objects.splice(f,0,{distance:d,object:e});this.add(e)};THREE.LOD.prototype.getObjectForDistance=function(e){for(var d=1,f=this.objects.length;d<f&&!(e<this.objects[d].distance);d++){}return this.objects[d-1].object};THREE.LOD.prototype.update=function(){var d=new THREE.Vector3,c=new THREE.Vector3;return function(f){if(1<this.objects.length){d.getPositionFromMatrix(f.matrixWorld);c.getPositionFromMatrix(this.matrixWorld);f=d.distanceTo(c);this.objects[0].object.visible=!0;for(var b=1,a=this.objects.length;b<a;b++){if(f>=this.objects[b].distance){this.objects[b-1].object.visible=!1,this.objects[b].object.visible=!0}else{break}}for(;b<a;b++){this.objects[b].object.visible=!1}}}}();THREE.LOD.prototype.clone=function(){};THREE.Sprite=function(b){THREE.Object3D.call(this);this.material=void 0!==b?b:new THREE.SpriteMaterial;this.rotation=0};THREE.Sprite.prototype=Object.create(THREE.Object3D.prototype);THREE.Sprite.prototype.updateMatrix=function(){this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0};THREE.Sprite.prototype.clone=function(b){void 0===b&&(b=new THREE.Sprite(this.material));THREE.Object3D.prototype.clone.call(this,b);return b};THREE.Particle=THREE.Sprite;THREE.Scene=function(){THREE.Object3D.call(this);this.overrideMaterial=this.fog=null;this.autoUpdate=!0;this.matrixAutoUpdate=!1;this.__lights=[];this.__objectsAdded=[];this.__objectsRemoved=[]};THREE.Scene.prototype=Object.create(THREE.Object3D.prototype);THREE.Scene.prototype.__addObject=function(d){if(d instanceof THREE.Light){-1===this.__lights.indexOf(d)&&this.__lights.push(d),d.target&&void 0===d.target.parent&&this.add(d.target)}else{if(!(d instanceof THREE.Camera||d instanceof THREE.Bone)){this.__objectsAdded.push(d);var c=this.__objectsRemoved.indexOf(d);-1!==c&&this.__objectsRemoved.splice(c,1)}}for(c=0;c<d.children.length;c++){this.__addObject(d.children[c])}};THREE.Scene.prototype.__removeObject=function(d){if(d instanceof THREE.Light){var c=this.__lights.indexOf(d);-1!==c&&this.__lights.splice(c,1);if(d.shadowCascadeArray){for(c=0;c<d.shadowCascadeArray.length;c++){this.__removeObject(d.shadowCascadeArray[c])}}}else{d instanceof THREE.Camera||(this.__objectsRemoved.push(d),c=this.__objectsAdded.indexOf(d),-1!==c&&this.__objectsAdded.splice(c,1))}for(c=0;c<d.children.length;c++){this.__removeObject(d.children[c])}};THREE.Scene.prototype.clone=function(b){void 0===b&&(b=new THREE.Scene);THREE.Object3D.prototype.clone.call(this,b);null!==this.fog&&(b.fog=this.fog.clone());null!==this.overrideMaterial&&(b.overrideMaterial=this.overrideMaterial.clone());b.autoUpdate=this.autoUpdate;b.matrixAutoUpdate=this.matrixAutoUpdate;return b};THREE.Fog=function(e,d,f){this.name="";this.color=new THREE.Color(e);this.near=void 0!==d?d:1;this.far=void 0!==f?f:1000};THREE.Fog.prototype.clone=function(){return new THREE.Fog(this.color.getHex(),this.near,this.far)};THREE.FogExp2=function(d,c){this.name="";this.color=new THREE.Color(d);this.density=void 0!==c?c:0.00025};THREE.FogExp2.prototype.clone=function(){return new THREE.FogExp2(this.color.getHex(),this.density)};THREE.CanvasRenderer=function(aJ){function aI(j,i,q){for(var p=0,n=af.length;p<n;p++){var m=af[p];T.copy(m.color);if(m instanceof THREE.DirectionalLight){var k=aK.getPositionFromMatrix(m.matrixWorld).normalize(),l=i.dot(k);0>=l||(l*=m.intensity,q.add(T.multiplyScalar(l)))}else{m instanceof THREE.PointLight&&(k=aK.getPositionFromMatrix(m.matrixWorld),l=i.dot(aK.subVectors(k,j).normalize()),0>=l||(l*=0==m.distance?1:1-Math.min(j.distanceTo(k)/m.distance,1),0!=l&&(l*=m.intensity,q.add(T.multiplyScalar(l)))))}}}function aH(f,e,h,g){au(e);av(h);ap(g);am(f.getStyle());a4.stroke();bo.expandByScalar(2*e)}function aF(b){al(b.getStyle());a4.fill()}function aE(N,M,K,J,I,F,G,D,E,C,A,B,u){if(!(u instanceof THREE.DataTexture||void 0===u.image||0==u.image.width)){if(!0===u.needsUpdate){var v=u.wrapS==THREE.RepeatWrapping,d=u.wrapT==THREE.RepeatWrapping;bn[u.id]=a4.createPattern(u.image,!0===v&&!0===d?"repeat":!0===v&&!1===d?"repeat-x":!1===v&&!0===d?"repeat-y":"no-repeat");u.needsUpdate=!1}void 0===bn[u.id]?al("rgba(0,0,0,1)"):al(bn[u.id]);var v=u.offset.x/u.repeat.x,d=u.offset.y/u.repeat.y,O=u.image.width*u.repeat.x,t=u.image.height*u.repeat.y,G=(G+v)*O,D=(1-D+d)*t,K=K-N,J=J-M,I=I-N,F=F-M,E=(E+v)*O-G,C=(1-C+d)*t-D,A=(A+v)*O-G,B=(1-B+d)*t-D,v=E*B-A*C;0===v?(void 0===bk[u.id]&&(M=document.createElement("canvas"),M.width=u.image.width,M.height=u.image.height,M=M.getContext("2d"),M.drawImage(u.image,0,0),bk[u.id]=M.getImageData(0,0,u.image.width,u.image.height).data),M=bk[u.id],G=4*(Math.floor(G)+Math.floor(D)*u.image.width),aN.setRGB(M[G]/255,M[G+1]/255,M[G+2]/255),aF(aN)):(v=1/v,u=(B*K-C*I)*v,C=(B*J-C*F)*v,K=(E*I-A*K)*v,J=(E*F-A*J)*v,N=N-u*G-K*D,G=M-C*G-J*D,a4.save(),a4.transform(u,C,K,J,N,G),a4.fill(),a4.restore())}}function aD(J,I,G,F,E,D,B,C,v,A,u,s,t){var q,r;q=t.width-1;r=t.height-1;B*=q;C*=r;G-=J;F-=I;E-=J;D-=I;v=v*q-B;A=A*r-C;u=u*q-B;s=s*r-C;r=1/(v*s-u*A);q=(s*G-A*E)*r;A=(s*F-A*D)*r;G=(v*E-u*G)*r;F=(v*D-u*F)*r;J=J-q*B-G*C;I=I-A*B-F*C;a4.save();a4.transform(q,A,G,F,J,I);a4.clip();a4.drawImage(t,0,0);a4.restore()}function aA(f,e,h,g){ad[0]=255*f.r|0;ad[1]=255*f.g|0;ad[2]=255*f.b|0;ad[4]=255*e.r|0;ad[5]=255*e.g|0;ad[6]=255*e.b|0;ad[8]=255*h.r|0;ad[9]=255*h.g|0;ad[10]=255*h.b|0;ad[12]=255*g.r|0;ad[13]=255*g.g|0;ad[14]=255*g.b|0;ax.putImageData(a8,0,0);aa.drawImage(aL,0,0);return W}function aC(h,g,l){var k=g.x-h.x,j=g.y-h.y,i=k*k+j*j;0!==i&&(l/=Math.sqrt(i),k*=l,j*=l,g.x+=k,g.y+=j,h.x-=k,h.y-=j)}function ay(b){ag!==b&&(ag=a4.globalAlpha=b)}function aw(b){aj!==b&&(b===THREE.NormalBlending?a4.globalCompositeOperation="source-over":b===THREE.AdditiveBlending?a4.globalCompositeOperation="lighter":b===THREE.SubtractiveBlending&&(a4.globalCompositeOperation="darker"),aj=b)}function au(b){aY!==b&&(aY=a4.lineWidth=b)}function av(b){aT!==b&&(aT=a4.lineCap=b)}function ap(b){aG!==b&&(aG=a4.lineJoin=b)}function am(b){a0!==b&&(a0=a4.strokeStyle=b)}function al(b){aP!==b&&(aP=a4.fillStyle=b)}function ar(d,c){if(ac!==d||aV!==c){a4.setLineDash([d,c]),ac=d,aV=c}}console.log("THREE.CanvasRenderer",THREE.REVISION);var an=THREE.Math.smoothstep,aJ=aJ||{},ao=this,ak,ai,af,a5=new THREE.Projector,a3=void 0!==aJ.canvas?aJ.canvas:document.createElement("canvas"),ah=a3.width,a1=a3.height,a6=Math.floor(ah/2),aU=Math.floor(a1/2),a4=a3.getContext("2d"),a2=new THREE.Color(0),aZ=0,ag=1,aj=0,a0=null,aP=null,aY=null,aT=null,aG=null,ac=null,aV=0,aW,aQ,aX,at;new THREE.RenderableVertex;new THREE.RenderableVertex;var S,be,Y,bl,bg,H,aN=new THREE.Color,aS=new THREE.Color,aM=new THREE.Color,aO=new THREE.Color,L=new THREE.Color,a7=new THREE.Color,az=new THREE.Color,T=new THREE.Color,bn={},bk={},aB,a9,ae,o,aR,aq,bp,bj,bh,ab,bf=new THREE.Box2,bm=new THREE.Box2,bo=new THREE.Box2,bc=new THREE.Color,bi=new THREE.Color,bd=new THREE.Color,aK=new THREE.Vector3,aL,ax,a8,ad,W,aa,X=16;aL=document.createElement("canvas");aL.width=aL.height=2;ax=aL.getContext("2d");ax.fillStyle="rgba(0,0,0,1)";ax.fillRect(0,0,2,2);a8=ax.getImageData(0,0,2,2);ad=a8.data;W=document.createElement("canvas");W.width=W.height=X;aa=W.getContext("2d");aa.translate(-X/2,-X/2);aa.scale(X,X);X--;void 0===a4.setLineDash&&(a4.setLineDash=void 0!==a4.mozDash?function(b){a4.mozDash=null!==b[0]?b:null}:function(){});this.domElement=a3;this.devicePixelRatio=void 0!==aJ.devicePixelRatio?aJ.devicePixelRatio:void 0!==self.devicePixelRatio?self.devicePixelRatio:1;this.sortElements=this.sortObjects=this.autoClear=!0;this.info={render:{vertices:0,faces:0}};this.supportsVertexTextures=function(){};this.setFaceCulling=function(){};this.setSize=function(e,d,f){ah=e*this.devicePixelRatio;a1=d*this.devicePixelRatio;a6=Math.floor(ah/2);aU=Math.floor(a1/2);a3.width=ah;a3.height=a1;1!==this.devicePixelRatio&&!1!==f&&(a3.style.width=e+"px",a3.style.height=d+"px");bf.set(new THREE.Vector2(-a6,-aU),new THREE.Vector2(a6,aU));bm.set(new THREE.Vector2(-a6,-aU),new THREE.Vector2(a6,aU));ag=1;aj=0;aG=aT=aY=aP=a0=null};this.setClearColor=function(d,c){a2.set(d);aZ=void 0!==c?c:1;bm.set(new THREE.Vector2(-a6,-aU),new THREE.Vector2(a6,aU))};this.setClearColorHex=function(d,c){console.warn("DEPRECATED: .setClearColorHex() is being removed. Use .setClearColor() instead.");this.setClearColor(d,c)};this.getMaxAnisotropy=function(){return 0};this.clear=function(){a4.setTransform(1,0,0,-1,a6,aU);!1===bm.empty()&&(bm.intersect(bf),bm.expandByScalar(2),1>aZ&&a4.clearRect(bm.min.x|0,bm.min.y|0,bm.max.x-bm.min.x|0,bm.max.y-bm.min.y|0),0<aZ&&(aw(THREE.NormalBlending),ay(1),al("rgba("+Math.floor(255*a2.r)+","+Math.floor(255*a2.g)+","+Math.floor(255*a2.b)+","+aZ+")"),a4.fillRect(bm.min.x|0,bm.min.y|0,bm.max.x-bm.min.x|0,bm.max.y-bm.min.y|0)),bm.makeEmpty())};this.render=function(l,e){if(!1===e instanceof THREE.Camera){console.error("THREE.CanvasRenderer.render: camera is not an instance of THREE.Camera.")}else{!0===this.autoClear&&this.clear();a4.setTransform(1,0,0,-1,a6,aU);ao.info.render.vertices=0;ao.info.render.faces=0;ak=a5.projectScene(l,e,this.sortObjects,this.sortElements);ai=ak.elements;af=ak.lights;aW=e;bc.setRGB(0,0,0);bi.setRGB(0,0,0);bd.setRGB(0,0,0);for(var b=0,r=af.length;b<r;b++){var i=af[b],s=i.color;i instanceof THREE.AmbientLight?bc.add(s):i instanceof THREE.DirectionalLight?bi.add(s):i instanceof THREE.PointLight&&bd.add(s)}b=0;for(r=ai.length;b<r;b++){var m=ai[b],q=m.material;if(!(void 0===q||!1===q.visible)){bo.makeEmpty();if(m instanceof THREE.RenderableSprite){aQ=m;aQ.x*=a6;aQ.y*=aU;var i=aQ,s=m,k=q;ay(k.opacity);aw(k.blending);var g=q=m=void 0,t=void 0,p=void 0,f=void 0,h=void 0;k instanceof THREE.SpriteMaterial||k instanceof THREE.ParticleSystemMaterial?void 0!==k.map.image?(p=k.map.image,f=p.width>>1,h=p.height>>1,g=s.scale.x*a6,t=s.scale.y*aU,m=g*f,q=t*h,bo.min.set(i.x-m,i.y-q),bo.max.set(i.x+m,i.y+q),!1===bf.isIntersectionBox(bo)?bo.makeEmpty():(a4.save(),a4.translate(i.x,i.y),a4.rotate(-s.rotation),a4.scale(g,-t),a4.translate(-f,-h),a4.drawImage(p,0,0),a4.restore())):(g=s.object.scale.x,t=s.object.scale.y,g*=s.scale.x*a6,t*=s.scale.y*aU,bo.min.set(i.x-g,i.y-t),bo.max.set(i.x+g,i.y+t),!1===bf.isIntersectionBox(bo)?bo.makeEmpty():(al(k.color.getStyle()),a4.save(),a4.translate(i.x,i.y),a4.rotate(-s.rotation),a4.scale(g,t),a4.fillRect(-1,-1,2,2),a4.restore())):k instanceof THREE.SpriteCanvasMaterial&&(m=s.scale.x*a6,q=s.scale.y*aU,bo.min.set(i.x-m,i.y-q),bo.max.set(i.x+m,i.y+q),!1===bf.isIntersectionBox(bo)?bo.makeEmpty():(am(k.color.getStyle()),al(k.color.getStyle()),a4.save(),a4.translate(i.x,i.y),a4.rotate(-s.rotation),a4.scale(m,q),k.program(a4),a4.restore()))}else{if(m instanceof THREE.RenderableLine){if(aQ=m.v1,aX=m.v2,aQ.positionScreen.x*=a6,aQ.positionScreen.y*=aU,aX.positionScreen.x*=a6,aX.positionScreen.y*=aU,bo.setFromPoints([aQ.positionScreen,aX.positionScreen]),!0===bf.isIntersectionBox(bo)){if(i=aQ,s=aX,k=m,m=q,ay(m.opacity),aw(m.blending),a4.beginPath(),a4.moveTo(i.positionScreen.x,i.positionScreen.y),a4.lineTo(s.positionScreen.x,s.positionScreen.y),m instanceof THREE.LineBasicMaterial){au(m.linewidth);av(m.linecap);ap(m.linejoin);if(m.vertexColors!==THREE.VertexColors){am(m.color.getStyle())}else{if(q=k.vertexColors[0].getStyle(),k=k.vertexColors[1].getStyle(),q===k){am(q)}else{try{var d=a4.createLinearGradient(i.positionScreen.x,i.positionScreen.y,s.positionScreen.x,s.positionScreen.y);d.addColorStop(0,q);d.addColorStop(1,k)}catch(c){d=q}am(d)}}a4.stroke();bo.expandByScalar(2*m.linewidth)}else{m instanceof THREE.LineDashedMaterial&&(au(m.linewidth),av(m.linecap),ap(m.linejoin),am(m.color.getStyle()),ar(m.dashSize,m.gapSize),a4.stroke(),bo.expandByScalar(2*m.linewidth),ar(null,null))}}}else{if(m instanceof THREE.RenderableFace3){aQ=m.v1;aX=m.v2;at=m.v3;if(-1>aQ.positionScreen.z||1<aQ.positionScreen.z){continue}if(-1>aX.positionScreen.z||1<aX.positionScreen.z){continue}if(-1>at.positionScreen.z||1<at.positionScreen.z){continue}aQ.positionScreen.x*=a6;aQ.positionScreen.y*=aU;aX.positionScreen.x*=a6;aX.positionScreen.y*=aU;at.positionScreen.x*=a6;at.positionScreen.y*=aU;0<q.overdraw&&(aC(aQ.positionScreen,aX.positionScreen,q.overdraw),aC(aX.positionScreen,at.positionScreen,q.overdraw),aC(at.positionScreen,aQ.positionScreen,q.overdraw));bo.setFromPoints([aQ.positionScreen,aX.positionScreen,at.positionScreen]);if(!0===bf.isIntersectionBox(bo)){i=aQ;s=aX;k=at;ao.info.render.vertices+=3;ao.info.render.faces++;ay(q.opacity);aw(q.blending);S=i.positionScreen.x;be=i.positionScreen.y;Y=s.positionScreen.x;bl=s.positionScreen.y;bg=k.positionScreen.x;H=k.positionScreen.y;var g=S,t=be,p=Y,f=bl,h=bg,n=H;a4.beginPath();a4.moveTo(g,t);a4.lineTo(p,f);a4.lineTo(h,n);a4.closePath();(q instanceof THREE.MeshLambertMaterial||q instanceof THREE.MeshPhongMaterial)&&null===q.map?(a7.copy(q.color),az.copy(q.emissive),q.vertexColors===THREE.FaceColors&&a7.multiply(m.color),!1===q.wireframe&&q.shading==THREE.SmoothShading&&3==m.vertexNormalsLength?(aS.copy(bc),aM.copy(bc),aO.copy(bc),aI(m.v1.positionWorld,m.vertexNormalsModel[0],aS),aI(m.v2.positionWorld,m.vertexNormalsModel[1],aM),aI(m.v3.positionWorld,m.vertexNormalsModel[2],aO),aS.multiply(a7).add(az),aM.multiply(a7).add(az),aO.multiply(a7).add(az),L.addColors(aM,aO).multiplyScalar(0.5),ae=aA(aS,aM,aO,L),aD(S,be,Y,bl,bg,H,0,0,1,0,0,1,ae)):(aN.copy(bc),aI(m.centroidModel,m.normalModel,aN),aN.multiply(a7).add(az),!0===q.wireframe?aH(aN,q.wireframeLinewidth,q.wireframeLinecap,q.wireframeLinejoin):aF(aN))):q instanceof THREE.MeshBasicMaterial||q instanceof THREE.MeshLambertMaterial||q instanceof THREE.MeshPhongMaterial?null!==q.map?q.map.mapping instanceof THREE.UVMapping&&(o=m.uvs[0],aE(S,be,Y,bl,bg,H,o[0].x,o[0].y,o[1].x,o[1].y,o[2].x,o[2].y,q.map)):null!==q.envMap?q.envMap.mapping instanceof THREE.SphericalReflectionMapping&&(aK.copy(m.vertexNormalsModelView[0]),aR=0.5*aK.x+0.5,aq=0.5*aK.y+0.5,aK.copy(m.vertexNormalsModelView[1]),bp=0.5*aK.x+0.5,bj=0.5*aK.y+0.5,aK.copy(m.vertexNormalsModelView[2]),bh=0.5*aK.x+0.5,ab=0.5*aK.y+0.5,aE(S,be,Y,bl,bg,H,aR,aq,bp,bj,bh,ab,q.envMap)):(aN.copy(q.color),q.vertexColors===THREE.FaceColors&&aN.multiply(m.color),!0===q.wireframe?aH(aN,q.wireframeLinewidth,q.wireframeLinecap,q.wireframeLinejoin):aF(aN)):q instanceof THREE.MeshDepthMaterial?(aB=aW.near,a9=aW.far,aS.r=aS.g=aS.b=1-an(i.positionScreen.z*i.positionScreen.w,aB,a9),aM.r=aM.g=aM.b=1-an(s.positionScreen.z*s.positionScreen.w,aB,a9),aO.r=aO.g=aO.b=1-an(k.positionScreen.z*k.positionScreen.w,aB,a9),L.addColors(aM,aO).multiplyScalar(0.5),ae=aA(aS,aM,aO,L),aD(S,be,Y,bl,bg,H,0,0,1,0,0,1,ae)):q instanceof THREE.MeshNormalMaterial&&(i=void 0,q.shading==THREE.FlatShading?(i=m.normalModelView,aN.setRGB(i.x,i.y,i.z).multiplyScalar(0.5).addScalar(0.5),!0===q.wireframe?aH(aN,q.wireframeLinewidth,q.wireframeLinecap,q.wireframeLinejoin):aF(aN)):q.shading==THREE.SmoothShading&&(i=m.vertexNormalsModelView[0],aS.setRGB(i.x,i.y,i.z).multiplyScalar(0.5).addScalar(0.5),i=m.vertexNormalsModelView[1],aM.setRGB(i.x,i.y,i.z).multiplyScalar(0.5).addScalar(0.5),i=m.vertexNormalsModelView[2],aO.setRGB(i.x,i.y,i.z).multiplyScalar(0.5).addScalar(0.5),L.addColors(aM,aO).multiplyScalar(0.5),ae=aA(aS,aM,aO,L),aD(S,be,Y,bl,bg,H,0,0,1,0,0,1,ae)))}}}}bm.union(bo)}}a4.setTransform(1,0,0,1,0,0)}}};THREE.ShaderChunk={fog_pars_fragment:"#ifdef USE_FOG\nuniform vec3 fogColor;\n#ifdef FOG_EXP2\nuniform float fogDensity;\n#else\nuniform float fogNear;\nuniform float fogFar;\n#endif\n#endif",fog_fragment:"#ifdef USE_FOG\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n#ifdef FOG_EXP2\nconst float LOG2 = 1.442695;\nfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n#else\nfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n#endif\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\nuniform float reflectivity;\nuniform samplerCube envMap;\nuniform float flipEnvMap;\nuniform int combine;\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nuniform bool useRefract;\nuniform float refractionRatio;\n#else\nvarying vec3 vReflect;\n#endif\n#endif",envmap_fragment:"#ifdef USE_ENVMAP\nvec3 reflectVec;\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\nif ( useRefract ) {\nreflectVec = refract( cameraToVertex, normal, refractionRatio );\n} else { \nreflectVec = reflect( cameraToVertex, normal );\n}\n#else\nreflectVec = vReflect;\n#endif\n#ifdef DOUBLE_SIDED\nfloat flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );\nvec4 cubeColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n#else\nvec4 cubeColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n#endif\n#ifdef GAMMA_INPUT\ncubeColor.xyz *= cubeColor.xyz;\n#endif\nif ( combine == 1 ) {\ngl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularStrength * reflectivity );\n} else if ( combine == 2 ) {\ngl_FragColor.xyz += cubeColor.xyz * specularStrength * reflectivity;\n} else {\ngl_FragColor.xyz = mix( gl_FragColor.xyz, gl_FragColor.xyz * cubeColor.xyz, specularStrength * reflectivity );\n}\n#endif",envmap_pars_vertex:"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\nvarying vec3 vReflect;\nuniform float refractionRatio;\nuniform bool useRefract;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n#ifdef USE_SKINNING\nvec4 worldPosition = modelMatrix * skinned;\n#endif\n#if defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\nvec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );\n#endif\n#if ! defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\nvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n#endif\n#endif",envmap_vertex:"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\nvec3 worldNormal = mat3( modelMatrix[ 0 ].xyz, modelMatrix[ 1 ].xyz, modelMatrix[ 2 ].xyz ) * objectNormal;\nworldNormal = normalize( worldNormal );\nvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\nif ( useRefract ) {\nvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n} else {\nvReflect = reflect( cameraToVertex, worldNormal );\n}\n#endif",map_particle_pars_fragment:"#ifdef USE_MAP\nuniform sampler2D map;\n#endif",map_particle_fragment:"#ifdef USE_MAP\ngl_FragColor = gl_FragColor * texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) );\n#endif",map_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;\nuniform vec4 offsetRepeat;\n#endif",map_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\nuniform sampler2D map;\n#endif",map_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",map_fragment:"#ifdef USE_MAP\nvec4 texelColor = texture2D( map, vUv );\n#ifdef GAMMA_INPUT\ntexelColor.xyz *= texelColor.xyz;\n#endif\ngl_FragColor = gl_FragColor * texelColor;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\nuniform sampler2D lightMap;\n#endif",lightmap_pars_vertex:"#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\n#endif",lightmap_fragment:"#ifdef USE_LIGHTMAP\ngl_FragColor = gl_FragColor * texture2D( lightMap, vUv2 );\n#endif",lightmap_vertex:"#ifdef USE_LIGHTMAP\nvUv2 = uv2;\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\nuniform sampler2D bumpMap;\nuniform float bumpScale;\nvec2 dHdxy_fwd() {\nvec2 dSTdx = dFdx( vUv );\nvec2 dSTdy = dFdy( vUv );\nfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\nfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\nfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\nreturn vec2( dBx, dBy );\n}\nvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\nvec3 vSigmaX = dFdx( surf_pos );\nvec3 vSigmaY = dFdy( surf_pos );\nvec3 vN = surf_norm;\nvec3 R1 = cross( vSigmaY, vN );\nvec3 R2 = cross( vN, vSigmaX );\nfloat fDet = dot( vSigmaX, R1 );\nvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\nreturn normalize( abs( fDet ) * surf_norm - vGrad );\n}\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\nuniform sampler2D normalMap;\nuniform vec2 normalScale;\nvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\nvec3 q0 = dFdx( eye_pos.xyz );\nvec3 q1 = dFdy( eye_pos.xyz );\nvec2 st0 = dFdx( vUv.st );\nvec2 st1 = dFdy( vUv.st );\nvec3 S = normalize(  q0 * st1.t - q1 * st0.t );\nvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\nvec3 N = normalize( surf_norm );\nvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\nmapN.xy = normalScale * mapN.xy;\nmat3 tsn = mat3( S, T, N );\nreturn normalize( tsn * mapN );\n}\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\nuniform sampler2D specularMap;\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\nvec4 texelSpecular = texture2D( specularMap, vUv );\nspecularStrength = texelSpecular.r;\n#else\nspecularStrength = 1.0;\n#endif",lights_lambert_pars_vertex:"uniform vec3 ambient;\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_HEMI_LIGHTS > 0\nuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif",lights_lambert_vertex:"vLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\nvLightBack = vec3( 0.0 );\n#endif\ntransformedNormal = normalize( transformedNormal );\n#if MAX_DIR_LIGHTS > 0\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( transformedNormal, dirVector );\nvec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\ndirectionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\ndirectionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += directionalLightColor[ i ] * directionalLightWeighting;\n#ifdef DOUBLE_SIDED\nvLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;\n#endif\n}\n#endif\n#if MAX_POINT_LIGHTS > 0\nfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nfloat dotProduct = dot( transformedNormal, lVector );\nvec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\npointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\npointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += pointLightColor[ i ] * pointLightWeighting * lDistance;\n#ifdef DOUBLE_SIDED\nvLightBack += pointLightColor[ i ] * pointLightWeightingBack * lDistance;\n#endif\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nfloat dotProduct = dot( transformedNormal, lVector );\nvec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\nspotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\nspotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += spotLightColor[ i ] * spotLightWeighting * lDistance * spotEffect;\n#ifdef DOUBLE_SIDED\nvLightBack += spotLightColor[ i ] * spotLightWeightingBack * lDistance * spotEffect;\n#endif\n}\n}\n#endif\n#if MAX_HEMI_LIGHTS > 0\nfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\nvec3 lVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( transformedNormal, lVector );\nfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\nfloat hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;\nvLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n#ifdef DOUBLE_SIDED\nvLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\n#endif\n}\n#endif\nvLightFront = vLightFront * diffuse + ambient * ambientLightColor + emissive;\n#ifdef DOUBLE_SIDED\nvLightBack = vLightBack * diffuse + ambient * ambientLightColor + emissive;\n#endif",lights_phong_pars_vertex:"#ifndef PHONG_PER_PIXEL\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\nvarying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\nvarying vec3 vWorldPosition;\n#endif",lights_phong_vertex:"#ifndef PHONG_PER_PIXEL\n#if MAX_POINT_LIGHTS > 0\nfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nvPointLight[ i ] = vec4( lVector, lDistance );\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nvSpotLight[ i ] = vec4( lVector, lDistance );\n}\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\nvWorldPosition = worldPosition.xyz;\n#endif",lights_phong_pars_fragment:"uniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_HEMI_LIGHTS > 0\nuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n#ifdef PHONG_PER_PIXEL\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#else\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n#ifdef PHONG_PER_PIXEL\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n#else\nvarying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\nvarying vec3 vWorldPosition;\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;",lights_phong_fragment:"vec3 normal = normalize( vNormal );\nvec3 viewPosition = normalize( vViewPosition );\n#ifdef DOUBLE_SIDED\nnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n#endif\n#ifdef USE_NORMALMAP\nnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\nnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n#if MAX_POINT_LIGHTS > 0\nvec3 pointDiffuse  = vec3( 0.0 );\nvec3 pointSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n#ifdef PHONG_PER_PIXEL\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\n#else\nvec3 lVector = normalize( vPointLight[ i ].xyz );\nfloat lDistance = vPointLight[ i ].w;\n#endif\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat pointDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n#else\nfloat pointDiffuseWeight = max( dotProduct, 0.0 );\n#endif\npointDiffuse  += diffuse * pointLightColor[ i ] * pointDiffuseWeight * lDistance;\nvec3 pointHalfVector = normalize( lVector + viewPosition );\nfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\nfloat pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, pointHalfVector ), 5.0 );\npointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization;\n#else\npointSpecular += specular * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance;\n#endif\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nvec3 spotDiffuse  = vec3( 0.0 );\nvec3 spotSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n#ifdef PHONG_PER_PIXEL\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\n#else\nvec3 lVector = normalize( vSpotLight[ i ].xyz );\nfloat lDistance = vSpotLight[ i ].w;\n#endif\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat spotDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n#else\nfloat spotDiffuseWeight = max( dotProduct, 0.0 );\n#endif\nspotDiffuse += diffuse * spotLightColor[ i ] * spotDiffuseWeight * lDistance * spotEffect;\nvec3 spotHalfVector = normalize( lVector + viewPosition );\nfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\nfloat spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, spotHalfVector ), 5.0 );\nspotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;\n#else\nspotSpecular += specular * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * spotEffect;\n#endif\n}\n}\n#endif\n#if MAX_DIR_LIGHTS > 0\nvec3 dirDiffuse  = vec3( 0.0 );\nvec3 dirSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, dirVector );\n#ifdef WRAP_AROUND\nfloat dirDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\n#else\nfloat dirDiffuseWeight = max( dotProduct, 0.0 );\n#endif\ndirDiffuse  += diffuse * directionalLightColor[ i ] * dirDiffuseWeight;\nvec3 dirHalfVector = normalize( dirVector + viewPosition );\nfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\nfloat dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );\ndirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n#else\ndirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight;\n#endif\n}\n#endif\n#if MAX_HEMI_LIGHTS > 0\nvec3 hemiDiffuse  = vec3( 0.0 );\nvec3 hemiSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\nvec3 lVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, lVector );\nfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\nvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\nhemiDiffuse += diffuse * hemiColor;\nvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\nfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\nfloat hemiSpecularWeightSky = specularStrength * max( pow( hemiDotNormalHalfSky, shininess ), 0.0 );\nvec3 lVectorGround = -lVector;\nvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\nfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\nfloat hemiSpecularWeightGround = specularStrength * max( pow( hemiDotNormalHalfGround, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat dotProductGround = dot( normal, lVectorGround );\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );\nvec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );\nhemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n#else\nhemiSpecular += specular * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;\n#endif\n}\n#endif\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n#if MAX_DIR_LIGHTS > 0\ntotalDiffuse += dirDiffuse;\ntotalSpecular += dirSpecular;\n#endif\n#if MAX_HEMI_LIGHTS > 0\ntotalDiffuse += hemiDiffuse;\ntotalSpecular += hemiSpecular;\n#endif\n#if MAX_POINT_LIGHTS > 0\ntotalDiffuse += pointDiffuse;\ntotalSpecular += pointSpecular;\n#endif\n#if MAX_SPOT_LIGHTS > 0\ntotalDiffuse += spotDiffuse;\ntotalSpecular += spotSpecular;\n#endif\n#ifdef METAL\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient + totalSpecular );\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient ) + totalSpecular;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif",color_fragment:"#ifdef USE_COLOR\ngl_FragColor = gl_FragColor * vec4( vColor, 1.0 );\n#endif",color_pars_vertex:"#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n#ifdef GAMMA_INPUT\nvColor = color * color;\n#else\nvColor = color;\n#endif\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n#ifdef BONE_TEXTURE\nuniform sampler2D boneTexture;\nuniform int boneTextureWidth;\nuniform int boneTextureHeight;\nmat4 getBoneMatrix( const in float i ) {\nfloat j = i * 4.0;\nfloat x = mod( j, float( boneTextureWidth ) );\nfloat y = floor( j / float( boneTextureWidth ) );\nfloat dx = 1.0 / float( boneTextureWidth );\nfloat dy = 1.0 / float( boneTextureHeight );\ny = dy * ( y + 0.5 );\nvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\nvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\nvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\nvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\nmat4 bone = mat4( v1, v2, v3, v4 );\nreturn bone;\n}\n#else\nuniform mat4 boneGlobalMatrices[ MAX_BONES ];\nmat4 getBoneMatrix( const in float i ) {\nmat4 bone = boneGlobalMatrices[ int(i) ];\nreturn bone;\n}\n#endif\n#endif",skinbase_vertex:"#ifdef USE_SKINNING\nmat4 boneMatX = getBoneMatrix( skinIndex.x );\nmat4 boneMatY = getBoneMatrix( skinIndex.y );\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n#ifdef USE_MORPHTARGETS\nvec4 skinVertex = vec4( morphed, 1.0 );\n#else\nvec4 skinVertex = vec4( position, 1.0 );\n#endif\nvec4 skinned  = boneMatX * skinVertex * skinWeight.x;\nskinned \t  += boneMatY * skinVertex * skinWeight.y;\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n#ifndef USE_MORPHNORMALS\nuniform float morphTargetInfluences[ 8 ];\n#else\nuniform float morphTargetInfluences[ 4 ];\n#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\nvec3 morphed = vec3( 0.0 );\nmorphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\nmorphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\nmorphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\nmorphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n#ifndef USE_MORPHNORMALS\nmorphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\nmorphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\nmorphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\nmorphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n#endif\nmorphed += position;\n#endif",default_vertex:"vec4 mvPosition;\n#ifdef USE_SKINNING\nmvPosition = modelViewMatrix * skinned;\n#endif\n#if !defined( USE_SKINNING ) && defined( USE_MORPHTARGETS )\nmvPosition = modelViewMatrix * vec4( morphed, 1.0 );\n#endif\n#if !defined( USE_SKINNING ) && ! defined( USE_MORPHTARGETS )\nmvPosition = modelViewMatrix * vec4( position, 1.0 );\n#endif\ngl_Position = projectionMatrix * mvPosition;",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\nvec3 morphedNormal = vec3( 0.0 );\nmorphedNormal +=  ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\nmorphedNormal +=  ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\nmorphedNormal +=  ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\nmorphedNormal +=  ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\nmorphedNormal += normal;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\nmat4 skinMatrix = skinWeight.x * boneMatX;\nskinMatrix \t+= skinWeight.y * boneMatY;\n#ifdef USE_MORPHNORMALS\nvec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );\n#else\nvec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );\n#endif\n#endif",defaultnormal_vertex:"vec3 objectNormal;\n#ifdef USE_SKINNING\nobjectNormal = skinnedNormal.xyz;\n#endif\n#if !defined( USE_SKINNING ) && defined( USE_MORPHNORMALS )\nobjectNormal = morphedNormal;\n#endif\n#if !defined( USE_SKINNING ) && ! defined( USE_MORPHNORMALS )\nobjectNormal = normal;\n#endif\n#ifdef FLIP_SIDED\nobjectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\nuniform sampler2D shadowMap[ MAX_SHADOWS ];\nuniform vec2 shadowMapSize[ MAX_SHADOWS ];\nuniform float shadowDarkness[ MAX_SHADOWS ];\nuniform float shadowBias[ MAX_SHADOWS ];\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nfloat unpackDepth( const in vec4 rgba_depth ) {\nconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\nfloat depth = dot( rgba_depth, bit_shift );\nreturn depth;\n}\n#endif",shadowmap_fragment:"#ifdef USE_SHADOWMAP\n#ifdef SHADOWMAP_DEBUG\nvec3 frustumColors[3];\nfrustumColors[0] = vec3( 1.0, 0.5, 0.0 );\nfrustumColors[1] = vec3( 0.0, 1.0, 0.8 );\nfrustumColors[2] = vec3( 0.0, 0.5, 1.0 );\n#endif\n#ifdef SHADOWMAP_CASCADE\nint inFrustumCount = 0;\n#endif\nfloat fDepth;\nvec3 shadowColor = vec3( 1.0 );\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\nbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\nbool inFrustum = all( inFrustumVec );\n#ifdef SHADOWMAP_CASCADE\ninFrustumCount += int( inFrustum );\nbvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );\n#else\nbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n#endif\nbool frustumTest = all( frustumTestVec );\nif ( frustumTest ) {\nshadowCoord.z += shadowBias[ i ];\n#if defined( SHADOWMAP_TYPE_PCF )\nfloat shadow = 0.0;\nconst float shadowDelta = 1.0 / 9.0;\nfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\nfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\nfloat dx0 = -1.25 * xPixelOffset;\nfloat dy0 = -1.25 * yPixelOffset;\nfloat dx1 = 1.25 * xPixelOffset;\nfloat dy1 = 1.25 * yPixelOffset;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\nfloat shadow = 0.0;\nfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\nfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\nfloat dx0 = -1.0 * xPixelOffset;\nfloat dy0 = -1.0 * yPixelOffset;\nfloat dx1 = 1.0 * xPixelOffset;\nfloat dy1 = 1.0 * yPixelOffset;\nmat3 shadowKernel;\nmat3 depthKernel;\ndepthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\ndepthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\ndepthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\ndepthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\ndepthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\ndepthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\ndepthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\ndepthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\ndepthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\nvec3 shadowZ = vec3( shadowCoord.z );\nshadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));\nshadowKernel[0] *= vec3(0.25);\nshadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));\nshadowKernel[1] *= vec3(0.25);\nshadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));\nshadowKernel[2] *= vec3(0.25);\nvec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\nshadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\nshadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\nvec4 shadowValues;\nshadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\nshadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\nshadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\nshadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\nshadow = dot( shadowValues, vec4( 1.0 ) );\nshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n#else\nvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\nfloat fDepth = unpackDepth( rgbaDepth );\nif ( fDepth < shadowCoord.z )\nshadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\n#endif\n}\n#ifdef SHADOWMAP_DEBUG\n#ifdef SHADOWMAP_CASCADE\nif ( inFrustum && inFrustumCount == 1 ) gl_FragColor.xyz *= frustumColors[ i ];\n#else\nif ( inFrustum ) gl_FragColor.xyz *= frustumColors[ i ];\n#endif\n#endif\n}\n#ifdef GAMMA_OUTPUT\nshadowColor *= shadowColor;\n#endif\ngl_FragColor.xyz = gl_FragColor.xyz * shadowColor;\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nuniform mat4 shadowMatrix[ MAX_SHADOWS ];\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n}\n#endif",alphatest_fragment:"#ifdef ALPHATEST\nif ( gl_FragColor.a < ALPHATEST ) discard;\n#endif",linear_to_gamma_fragment:"#ifdef GAMMA_OUTPUT\ngl_FragColor.xyz = sqrt( gl_FragColor.xyz );\n#endif"};THREE.UniformsUtils={merge:function(g){var f,j,i,h={};for(f=0;f<g.length;f++){for(j in i=this.clone(g[f]),i){h[j]=i[j]}}return h},clone:function(g){var f,j,i,h={};for(f in g){for(j in h[f]={},g[f]){i=g[f][j],h[f][j]=i instanceof THREE.Color||i instanceof THREE.Vector2||i instanceof THREE.Vector3||i instanceof THREE.Vector4||i instanceof THREE.Matrix4||i instanceof THREE.Texture?i.clone():i instanceof Array?i.slice():i}}return h}};THREE.UniformsLib={common:{diffuse:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)},lightMap:{type:"t",value:null},specularMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},useRefract:{type:"i",value:0},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:0.98},combine:{type:"i",value:0},morphTargetInfluences:{type:"f",value:0}},bump:{bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new THREE.Vector2(1,1)}},fog:{fogDensity:{type:"f",value:0.00025},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2000},fogColor:{type:"c",value:new THREE.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},hemisphereLightDirection:{type:"fv",value:[]},hemisphereLightSkyColor:{type:"fv",value:[]},hemisphereLightGroundColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},spotLightAngleCos:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]}},particle:{psColor:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:null},fogDensity:{type:"f",value:0.00025},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2000},fogColor:{type:"c",value:new THREE.Color(16777215)}},shadowmap:{shadowMap:{type:"tv",value:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}};THREE.ShaderLib={basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.shadowmap]),vertexShader:[THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.skinbase_vertex,"#ifdef USE_ENVMAP",THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"#endif",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {\ngl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},lambert:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\nvarying vec3 vLightBack;\n#endif",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_lambert_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_lambert_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\nvarying vec3 vLightBack;\n#endif",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3 ( 1.0 ), opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,"#ifdef DOUBLE_SIDED\nif ( gl_FrontFacing )\ngl_FragColor.xyz *= vLightFront;\nelse\ngl_FragColor.xyz *= vLightBack;\n#else\ngl_FragColor.xyz *= vLightFront;\n#endif",THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},phong:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.bump,THREE.UniformsLib.normalmap,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},specular:{type:"c",value:new THREE.Color(1118481)},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define PHONG\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_phong_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"vNormal = normalize( transformedNormal );",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,"vViewPosition = -mvPosition.xyz;",THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_phong_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;\nuniform vec3 ambient;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.lights_phong_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.bumpmap_pars_fragment,THREE.ShaderChunk.normalmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3 ( 1.0 ), opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.lights_phong_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},particle_basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.particle,THREE.UniformsLib.shadowmap]),vertexShader:["uniform float size;\nuniform float scale;",THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n#ifdef USE_SIZEATTENUATION\ngl_PointSize = size * ( scale / length( mvPosition.xyz ) );\n#else\ngl_PointSize = size;\n#endif\ngl_Position = projectionMatrix * mvPosition;",THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 psColor;\nuniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_particle_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,"void main() {\ngl_FragColor = vec4( psColor, opacity );",THREE.ShaderChunk.map_particle_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},dashed:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:["uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;",THREE.ShaderChunk.color_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"vLineDistance = scale * lineDistance;\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,"void main() {\nif ( mod( vLineDistance, totalSize ) > dashSize ) {\ndiscard;\n}\ngl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2000},opacity:{type:"f",value:1}},vertexShader:"void main() {\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float mNear;\nuniform float mFar;\nuniform float opacity;\nvoid main() {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat color = 1.0 - smoothstep( mNear, mFar, depth );\ngl_FragColor = vec4( vec3( color ), opacity );\n}"},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:["varying vec3 vNormal;",THREE.ShaderChunk.morphtarget_pars_vertex,"void main() {\nvNormal = normalize( normalMatrix * normal );",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,"}"].join("\n"),fragmentShader:"uniform float opacity;\nvarying vec3 vNormal;\nvoid main() {\ngl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );\n}"},normalmap:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{enableAO:{type:"i",value:0},enableDiffuse:{type:"i",value:0},enableSpecular:{type:"i",value:0},enableReflection:{type:"i",value:0},enableDisplacement:{type:"i",value:0},tDisplacement:{type:"t",value:null},tDiffuse:{type:"t",value:null},tCube:{type:"t",value:null},tNormal:{type:"t",value:null},tSpecular:{type:"t",value:null},tAO:{type:"t",value:null},uNormalScale:{type:"v2",value:new THREE.Vector2(1,1)},uDisplacementBias:{type:"f",value:0},uDisplacementScale:{type:"f",value:1},uDiffuseColor:{type:"c",value:new THREE.Color(16777215)},uSpecularColor:{type:"c",value:new THREE.Color(1118481)},uAmbientColor:{type:"c",value:new THREE.Color(16777215)},uShininess:{type:"f",value:30},uOpacity:{type:"f",value:1},useRefract:{type:"i",value:0},uRefractionRatio:{type:"f",value:0.98},uReflectivity:{type:"f",value:0.5},uOffset:{type:"v2",value:new THREE.Vector2(0,0)},uRepeat:{type:"v2",value:new THREE.Vector2(1,1)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),fragmentShader:["uniform vec3 uAmbientColor;\nuniform vec3 uDiffuseColor;\nuniform vec3 uSpecularColor;\nuniform float uShininess;\nuniform float uOpacity;\nuniform bool enableDiffuse;\nuniform bool enableSpecular;\nuniform bool enableAO;\nuniform bool enableReflection;\nuniform sampler2D tDiffuse;\nuniform sampler2D tNormal;\nuniform sampler2D tSpecular;\nuniform sampler2D tAO;\nuniform samplerCube tCube;\nuniform vec2 uNormalScale;\nuniform bool useRefract;\nuniform float uRefractionRatio;\nuniform float uReflectivity;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_HEMI_LIGHTS > 0\nuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif\nvarying vec3 vWorldPosition;\nvarying vec3 vViewPosition;",THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3( 1.0 ), uOpacity );\nvec3 specularTex = vec3( 1.0 );\nvec3 normalTex = texture2D( tNormal, vUv ).xyz * 2.0 - 1.0;\nnormalTex.xy *= uNormalScale;\nnormalTex = normalize( normalTex );\nif( enableDiffuse ) {\n#ifdef GAMMA_INPUT\nvec4 texelColor = texture2D( tDiffuse, vUv );\ntexelColor.xyz *= texelColor.xyz;\ngl_FragColor = gl_FragColor * texelColor;\n#else\ngl_FragColor = gl_FragColor * texture2D( tDiffuse, vUv );\n#endif\n}\nif( enableAO ) {\n#ifdef GAMMA_INPUT\nvec4 aoColor = texture2D( tAO, vUv );\naoColor.xyz *= aoColor.xyz;\ngl_FragColor.xyz = gl_FragColor.xyz * aoColor.xyz;\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * texture2D( tAO, vUv ).xyz;\n#endif\n}\nif( enableSpecular )\nspecularTex = texture2D( tSpecular, vUv ).xyz;\nmat3 tsb = mat3( normalize( vTangent ), normalize( vBinormal ), normalize( vNormal ) );\nvec3 finalNormal = tsb * normalTex;\n#ifdef FLIP_SIDED\nfinalNormal = -finalNormal;\n#endif\nvec3 normal = normalize( finalNormal );\nvec3 viewPosition = normalize( vViewPosition );\n#if MAX_POINT_LIGHTS > 0\nvec3 pointDiffuse = vec3( 0.0 );\nvec3 pointSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 pointVector = lPosition.xyz + vViewPosition.xyz;\nfloat pointDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\npointDistance = 1.0 - min( ( length( pointVector ) / pointLightDistance[ i ] ), 1.0 );\npointVector = normalize( pointVector );\n#ifdef WRAP_AROUND\nfloat pointDiffuseWeightFull = max( dot( normal, pointVector ), 0.0 );\nfloat pointDiffuseWeightHalf = max( 0.5 * dot( normal, pointVector ) + 0.5, 0.0 );\nvec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n#else\nfloat pointDiffuseWeight = max( dot( normal, pointVector ), 0.0 );\n#endif\npointDiffuse += pointDistance * pointLightColor[ i ] * uDiffuseColor * pointDiffuseWeight;\nvec3 pointHalfVector = normalize( pointVector + viewPosition );\nfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\nfloat pointSpecularWeight = specularTex.r * max( pow( pointDotNormalHalf, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( pointVector, pointHalfVector ), 5.0 );\npointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * pointDistance * specularNormalization;\n#else\npointSpecular += pointDistance * pointLightColor[ i ] * uSpecularColor * pointSpecularWeight * pointDiffuseWeight;\n#endif\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nvec3 spotDiffuse = vec3( 0.0 );\nvec3 spotSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 spotVector = lPosition.xyz + vViewPosition.xyz;\nfloat spotDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nspotDistance = 1.0 - min( ( length( spotVector ) / spotLightDistance[ i ] ), 1.0 );\nspotVector = normalize( spotVector );\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\n#ifdef WRAP_AROUND\nfloat spotDiffuseWeightFull = max( dot( normal, spotVector ), 0.0 );\nfloat spotDiffuseWeightHalf = max( 0.5 * dot( normal, spotVector ) + 0.5, 0.0 );\nvec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n#else\nfloat spotDiffuseWeight = max( dot( normal, spotVector ), 0.0 );\n#endif\nspotDiffuse += spotDistance * spotLightColor[ i ] * uDiffuseColor * spotDiffuseWeight * spotEffect;\nvec3 spotHalfVector = normalize( spotVector + viewPosition );\nfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\nfloat spotSpecularWeight = specularTex.r * max( pow( spotDotNormalHalf, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( spotVector, spotHalfVector ), 5.0 );\nspotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * spotDistance * specularNormalization * spotEffect;\n#else\nspotSpecular += spotDistance * spotLightColor[ i ] * uSpecularColor * spotSpecularWeight * spotDiffuseWeight * spotEffect;\n#endif\n}\n}\n#endif\n#if MAX_DIR_LIGHTS > 0\nvec3 dirDiffuse = vec3( 0.0 );\nvec3 dirSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_DIR_LIGHTS; i++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\n#ifdef WRAP_AROUND\nfloat directionalLightWeightingFull = max( dot( normal, dirVector ), 0.0 );\nfloat directionalLightWeightingHalf = max( 0.5 * dot( normal, dirVector ) + 0.5, 0.0 );\nvec3 dirDiffuseWeight = mix( vec3( directionalLightWeightingFull ), vec3( directionalLightWeightingHalf ), wrapRGB );\n#else\nfloat dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );\n#endif\ndirDiffuse += directionalLightColor[ i ] * uDiffuseColor * dirDiffuseWeight;\nvec3 dirHalfVector = normalize( dirVector + viewPosition );\nfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\nfloat dirSpecularWeight = specularTex.r * max( pow( dirDotNormalHalf, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );\ndirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n#else\ndirSpecular += directionalLightColor[ i ] * uSpecularColor * dirSpecularWeight * dirDiffuseWeight;\n#endif\n}\n#endif\n#if MAX_HEMI_LIGHTS > 0\nvec3 hemiDiffuse  = vec3( 0.0 );\nvec3 hemiSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\nvec3 lVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, lVector );\nfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\nvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\nhemiDiffuse += uDiffuseColor * hemiColor;\nvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\nfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\nfloat hemiSpecularWeightSky = specularTex.r * max( pow( hemiDotNormalHalfSky, uShininess ), 0.0 );\nvec3 lVectorGround = -lVector;\nvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\nfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\nfloat hemiSpecularWeightGround = specularTex.r * max( pow( hemiDotNormalHalfGround, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat dotProductGround = dot( normal, lVectorGround );\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlickSky = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );\nvec3 schlickGround = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );\nhemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n#else\nhemiSpecular += uSpecularColor * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;\n#endif\n}\n#endif\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n#if MAX_DIR_LIGHTS > 0\ntotalDiffuse += dirDiffuse;\ntotalSpecular += dirSpecular;\n#endif\n#if MAX_HEMI_LIGHTS > 0\ntotalDiffuse += hemiDiffuse;\ntotalSpecular += hemiSpecular;\n#endif\n#if MAX_POINT_LIGHTS > 0\ntotalDiffuse += pointDiffuse;\ntotalSpecular += pointSpecular;\n#endif\n#if MAX_SPOT_LIGHTS > 0\ntotalDiffuse += spotDiffuse;\ntotalSpecular += spotSpecular;\n#endif\n#ifdef METAL\ngl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor + totalSpecular );\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor ) + totalSpecular;\n#endif\nif ( enableReflection ) {\nvec3 vReflect;\nvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\nif ( useRefract ) {\nvReflect = refract( cameraToVertex, normal, uRefractionRatio );\n} else {\nvReflect = reflect( cameraToVertex, normal );\n}\nvec4 cubeColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );\n#ifdef GAMMA_INPUT\ncubeColor.xyz *= cubeColor.xyz;\n#endif\ngl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularTex.r * uReflectivity );\n}",THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n"),vertexShader:["attribute vec4 tangent;\nuniform vec2 uOffset;\nuniform vec2 uRepeat;\nuniform bool enableDisplacement;\n#ifdef VERTEX_TEXTURES\nuniform sampler2D tDisplacement;\nuniform float uDisplacementScale;\nuniform float uDisplacementBias;\n#endif\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nvarying vec3 vWorldPosition;\nvarying vec3 vViewPosition;",THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,"#ifdef USE_SKINNING\nvNormal = normalize( normalMatrix * skinnedNormal.xyz );\nvec4 skinnedTangent = skinMatrix * vec4( tangent.xyz, 0.0 );\nvTangent = normalize( normalMatrix * skinnedTangent.xyz );\n#else\nvNormal = normalize( normalMatrix * normal );\nvTangent = normalize( normalMatrix * tangent.xyz );\n#endif\nvBinormal = normalize( cross( vNormal, vTangent ) * tangent.w );\nvUv = uv * uRepeat + uOffset;\nvec3 displacedPosition;\n#ifdef VERTEX_TEXTURES\nif ( enableDisplacement ) {\nvec3 dv = texture2D( tDisplacement, uv ).xyz;\nfloat df = uDisplacementScale * dv.x + uDisplacementBias;\ndisplacedPosition = position + normalize( normal ) * df;\n} else {\n#ifdef USE_SKINNING\nvec4 skinVertex = vec4( position, 1.0 );\nvec4 skinned  = boneMatX * skinVertex * skinWeight.x;\nskinned \t  += boneMatY * skinVertex * skinWeight.y;\ndisplacedPosition  = skinned.xyz;\n#else\ndisplacedPosition = position;\n#endif\n}\n#else\n#ifdef USE_SKINNING\nvec4 skinVertex = vec4( position, 1.0 );\nvec4 skinned  = boneMatX * skinVertex * skinWeight.x;\nskinned \t  += boneMatY * skinVertex * skinWeight.y;\ndisplacedPosition  = skinned.xyz;\n#else\ndisplacedPosition = position;\n#endif\n#endif\nvec4 mvPosition = modelViewMatrix * vec4( displacedPosition, 1.0 );\nvec4 worldPosition = modelMatrix * vec4( displacedPosition, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\nvWorldPosition = worldPosition.xyz;\nvViewPosition = -mvPosition.xyz;\n#ifdef USE_SHADOWMAP\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n}\n#endif\n}"].join("\n")},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:"varying vec3 vWorldPosition;\nvoid main() {\nvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\nvWorldPosition = worldPosition.xyz;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform samplerCube tCube;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\nvoid main() {\ngl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n}"},depthRGBA:{uniforms:{},vertexShader:[THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,"}"].join("\n"),fragmentShader:"vec4 pack_depth( const in float depth ) {\nconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\nconst vec4 bit_mask  = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\nvec4 res = fract( depth * bit_shift );\nres -= res.xxyz * bit_mask;\nreturn res;\n}\nvoid main() {\ngl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\n}"}};THREE.WebGLRenderer=function(aP){function aO(i,g){var n=i.vertices.length,m=g.material;if(m.attributes){void 0===i.__webglCustomAttributesList&&(i.__webglCustomAttributesList=[]);for(var l in m.attributes){var k=m.attributes[l];if(!k.__webglInitialized||k.createUniqueBuffers){k.__webglInitialized=!0;var j=1;"v2"===k.type?j=2:"v3"===k.type?j=3:"v4"===k.type?j=4:"c"===k.type&&(j=3);k.size=j;k.array=new Float32Array(n*j);k.buffer=aC.createBuffer();k.buffer.belongsToAttribute=l;k.needsUpdate=!0}i.__webglCustomAttributesList.push(k)}}}function aN(C,B){var A=B.geometry,u=C.faces3,v=3*u.length,t=1*u.length,s=3*u.length,u=aL(B,C),j=aJ(u),q=aK(u),e=u.vertexColors?u.vertexColors:!1;C.__vertexArray=new Float32Array(3*v);q&&(C.__normalArray=new Float32Array(3*v));A.hasTangents&&(C.__tangentArray=new Float32Array(4*v));e&&(C.__colorArray=new Float32Array(3*v));j&&(0<A.faceVertexUvs.length&&(C.__uvArray=new Float32Array(2*v)),1<A.faceVertexUvs.length&&(C.__uv2Array=new Float32Array(2*v)));B.geometry.skinWeights.length&&B.geometry.skinIndices.length&&(C.__skinIndexArray=new Float32Array(4*v),C.__skinWeightArray=new Float32Array(4*v));C.__faceArray=new Uint16Array(3*t);C.__lineArray=new Uint16Array(2*s);if(C.numMorphTargets){C.__morphTargetsArrays=[];A=0;for(j=C.numMorphTargets;A<j;A++){C.__morphTargetsArrays.push(new Float32Array(3*v))}}if(C.numMorphNormals){C.__morphNormalsArrays=[];A=0;for(j=C.numMorphNormals;A<j;A++){C.__morphNormalsArrays.push(new Float32Array(3*v))}}C.__webglFaceCount=3*t;C.__webglLineCount=2*s;if(u.attributes){void 0===C.__webglCustomAttributesList&&(C.__webglCustomAttributesList=[]);for(var f in u.attributes){var t=u.attributes[f],s={},d;for(d in t){s[d]=t[d]}if(!s.__webglInitialized||s.createUniqueBuffers){s.__webglInitialized=!0,A=1,"v2"===s.type?A=2:"v3"===s.type?A=3:"v4"===s.type?A=4:"c"===s.type&&(A=3),s.size=A,s.array=new Float32Array(v*A),s.buffer=aC.createBuffer(),s.buffer.belongsToAttribute=f,t.needsUpdate=!0,s.__original=t}C.__webglCustomAttributesList.push(s)}}C.__inittedArrays=!0}function aL(d,c){return d.material instanceof THREE.MeshFaceMaterial?d.material.materials[c.materialIndex]:d.material}function aK(b){return b instanceof THREE.MeshBasicMaterial&&!b.envMap||b instanceof THREE.MeshDepthMaterial?!1:b&&void 0!==b.shading&&b.shading===THREE.SmoothShading?THREE.SmoothShading:THREE.FlatShading}function aJ(b){return b.map||b.lightMap||b.bumpMap||b.normalMap||b.specularMap||b instanceof THREE.ShaderMaterial?!0:!1}function aG(b){bt[b]||(aC.enableVertexAttribArray(b),bt[b]=!0)}function aI(){for(var b in bt){bt[b]&&(aC.disableVertexAttribArray(b),bt[b]=!1)}}function aE(d,c){return d.z!==c.z?c.z-d.z:d.id-c.id}function aB(d,c){return c[0]-d[0]}function az(g,f,j){if(g.length){for(var i=0,h=g.length;i<h;i++){H=br=null,bD=bu=aU=aS=bC=bG=S=-1,aQ=!0,g[i].render(f,j,bw,af),H=br=null,bD=bu=aU=aS=bC=bG=S=-1,aQ=!0}}}function aA(E,D,C,B,A,v,t,u){var r,s,q,n;D?(s=E.length-1,n=D=-1):(s=0,D=E.length,n=1);for(var p=s;p!==D;p+=n){if(r=E[p],r.render){s=r.object;q=r.buffer;if(u){r=u}else{r=r[C];if(!r){continue}t&&a4.setBlending(r.blending,r.blendEquation,r.blendSrc,r.blendDst);a4.setDepthTest(r.depthTest);a4.setDepthWrite(r.depthWrite);bi(r.polygonOffset,r.polygonOffsetFactor,r.polygonOffsetUnits)}a4.setMaterialFaces(r);q instanceof THREE.BufferGeometry?a4.renderBufferDirect(B,A,v,r,q,s):a4.renderBuffer(B,A,v,r,q,s)}}}function av(A,v,u,t,s,r,p){for(var q,m,n=0,l=A.length;n<l;n++){if(q=A[n],m=q.object,m.visible){if(p){q=p}else{q=q[v];if(!q){continue}r&&a4.setBlending(q.blending,q.blendEquation,q.blendSrc,q.blendDst);a4.setDepthTest(q.depthTest);a4.setDepthWrite(q.depthWrite);bi(q.polygonOffset,q.polygonOffsetFactor,q.polygonOffsetUnits)}a4.renderImmediateObject(u,t,s,q,m)}}}function aq(F,E){var D,C,A,B;if(void 0===F.__webglInit&&(F.__webglInit=!0,F._modelViewMatrix=new THREE.Matrix4,F._normalMatrix=new THREE.Matrix3,void 0!==F.geometry&&void 0===F.geometry.__webglInit&&(F.geometry.__webglInit=!0,F.geometry.addEventListener("dispose",a5)),C=F.geometry,void 0!==C)){if(C instanceof THREE.BufferGeometry){var v,u;for(v in C.attributes){u="index"===v?aC.ELEMENT_ARRAY_BUFFER:aC.ARRAY_BUFFER,B=C.attributes[v],void 0===B.numItems&&(B.numItems=B.array.length),B.buffer=aC.createBuffer(),aC.bindBuffer(u,B.buffer),aC.bufferData(u,B.array,aC.STATIC_DRAW)}}else{if(F instanceof THREE.Mesh){A=F.material;if(void 0===C.geometryGroups){v=C;var q,t,c;u={};var j=v.morphTargets.length,b=v.morphNormals.length,G=A instanceof THREE.MeshFaceMaterial;v.geometryGroups={};A=0;for(q=v.faces.length;A<q;A++){t=v.faces[A],t=G?t.materialIndex:0,void 0===u[t]&&(u[t]={hash:t,counter:0}),c=u[t].hash+"_"+u[t].counter,void 0===v.geometryGroups[c]&&(v.geometryGroups[c]={faces3:[],materialIndex:t,vertices:0,numMorphTargets:j,numMorphNormals:b}),65535<v.geometryGroups[c].vertices+3&&(u[t].counter+=1,c=u[t].hash+"_"+u[t].counter,void 0===v.geometryGroups[c]&&(v.geometryGroups[c]={faces3:[],materialIndex:t,vertices:0,numMorphTargets:j,numMorphNormals:b})),v.geometryGroups[c].faces3.push(A),v.geometryGroups[c].vertices+=3}v.geometryGroupsList=[];for(B in v.geometryGroups){v.geometryGroups[B].id=aT++,v.geometryGroupsList.push(v.geometryGroups[B])}}for(D in C.geometryGroups){if(B=C.geometryGroups[D],!B.__webglVertexBuffer){v=B;v.__webglVertexBuffer=aC.createBuffer();v.__webglNormalBuffer=aC.createBuffer();v.__webglTangentBuffer=aC.createBuffer();v.__webglColorBuffer=aC.createBuffer();v.__webglUVBuffer=aC.createBuffer();v.__webglUV2Buffer=aC.createBuffer();v.__webglSkinIndicesBuffer=aC.createBuffer();v.__webglSkinWeightsBuffer=aC.createBuffer();v.__webglFaceBuffer=aC.createBuffer();v.__webglLineBuffer=aC.createBuffer();j=u=void 0;if(v.numMorphTargets){v.__webglMorphTargetsBuffers=[];u=0;for(j=v.numMorphTargets;u<j;u++){v.__webglMorphTargetsBuffers.push(aC.createBuffer())}}if(v.numMorphNormals){v.__webglMorphNormalsBuffers=[];u=0;for(j=v.numMorphNormals;u<j;u++){v.__webglMorphNormalsBuffers.push(aC.createBuffer())}}a4.info.memory.geometries++;aN(B,F);C.verticesNeedUpdate=!0;C.morphTargetsNeedUpdate=!0;C.elementsNeedUpdate=!0;C.uvsNeedUpdate=!0;C.normalsNeedUpdate=!0;C.tangentsNeedUpdate=!0;C.colorsNeedUpdate=!0}}}else{F instanceof THREE.Line?C.__webglVertexBuffer||(B=C,B.__webglVertexBuffer=aC.createBuffer(),B.__webglColorBuffer=aC.createBuffer(),B.__webglLineDistanceBuffer=aC.createBuffer(),a4.info.memory.geometries++,B=C,v=B.vertices.length,B.__vertexArray=new Float32Array(3*v),B.__colorArray=new Float32Array(3*v),B.__lineDistanceArray=new Float32Array(1*v),B.__webglLineCount=v,aO(B,F),C.verticesNeedUpdate=!0,C.colorsNeedUpdate=!0,C.lineDistancesNeedUpdate=!0):F instanceof THREE.ParticleSystem&&!C.__webglVertexBuffer&&(B=C,B.__webglVertexBuffer=aC.createBuffer(),B.__webglColorBuffer=aC.createBuffer(),a4.info.memory.geometries++,B=C,v=B.vertices.length,B.__vertexArray=new Float32Array(3*v),B.__colorArray=new Float32Array(3*v),B.__sortArray=[],B.__webglParticleCount=v,aO(B,F),C.verticesNeedUpdate=!0,C.colorsNeedUpdate=!0)}}}if(void 0===F.__webglActive){if(F instanceof THREE.Mesh){if(C=F.geometry,C instanceof THREE.BufferGeometry){ap(E.__webglObjects,C,F)}else{if(C instanceof THREE.Geometry){for(D in C.geometryGroups){B=C.geometryGroups[D],ap(E.__webglObjects,B,F)}}}}else{F instanceof THREE.Line||F instanceof THREE.ParticleSystem?(C=F.geometry,ap(E.__webglObjects,C,F)):F instanceof THREE.ImmediateRenderObject||F.immediateRenderCallback?E.__webglObjectsImmediate.push({id:null,object:F,opaque:null,transparent:null,z:0}):F instanceof THREE.Sprite?E.__webglSprites.push(F):F instanceof THREE.LensFlare&&E.__webglFlares.push(F)}F.__webglActive=!0}}function ap(e,d,f){e.push({id:null,buffer:d,object:f,opaque:null,transparent:null,z:0})}function ax(d){for(var c in d.attributes){if(d.attributes[c].needsUpdate){return !0}}return !1}function ar(d){for(var c in d.attributes){d.attributes[c].needsUpdate=!1}}function at(d,c){d instanceof THREE.Mesh||d instanceof THREE.ParticleSystem||d instanceof THREE.Line?ao(c.__webglObjects,d):d instanceof THREE.Sprite?am(c.__webglSprites,d):d instanceof THREE.LensFlare?am(c.__webglFlares,d):(d instanceof THREE.ImmediateRenderObject||d.immediateRenderCallback)&&ao(c.__webglObjectsImmediate,d);delete d.__webglActive}function ao(e,d){for(var f=e.length-1;0<=f;f--){e[f].object===d&&e.splice(f,1)}}function am(e,d){for(var f=e.length-1;0<=f;f--){e[f]===d&&e.splice(f,1)}}function aj(cd,cc,cb,ca,b9){aZ=0;ca.needsUpdate&&(ca.program&&bE(ca),a4.initMaterial(ca,cc,cb,b9),ca.needsUpdate=!1);ca.morphTargets&&!b9.__webglMorphTargetInfluences&&(b9.__webglMorphTargetInfluences=new Float32Array(a4.maxMorphTargets));var b8=!1,b7=ca.program,b6=b7.uniforms,b5=ca.uniforms;b7!==br&&(aC.useProgram(b7),br=b7,b8=!0);ca.id!==bD&&(bD=ca.id,b8=!0);if(b8||cd!==H){aC.uniformMatrix4fv(b6.projectionMatrix,!1,cd.projectionMatrix.elements),cd!==H&&(H=cd)}if(ca.skinning){if(bz&&b9.useVertexTexture){if(null!==b6.boneTexture){var b4=bh();aC.uniform1i(b6.boneTexture,b4);a4.setTexture(b9.boneTexture,b4)}null!==b6.boneTextureWidth&&aC.uniform1i(b6.boneTextureWidth,b9.boneTextureWidth);null!==b6.boneTextureHeight&&aC.uniform1i(b6.boneTextureHeight,b9.boneTextureHeight)}else{null!==b6.boneGlobalMatrices&&aC.uniformMatrix4fv(b6.boneGlobalMatrices,!1,b9.boneMatrices)}}if(b8){cb&&ca.fog&&(b5.fogColor.value=cb.color,cb instanceof THREE.Fog?(b5.fogNear.value=cb.near,b5.fogFar.value=cb.far):cb instanceof THREE.FogExp2&&(b5.fogDensity.value=cb.density));if(ca instanceof THREE.MeshPhongMaterial||ca instanceof THREE.MeshLambertMaterial||ca.lights){if(aQ){for(var b2,b3=b4=0,b0=0,b1,bY,bX,bZ=aR,bW=bZ.directional.colors,bV=bZ.directional.positions,bU=bZ.point.colors,bS=bZ.point.positions,bT=bZ.point.distances,bO=bZ.spot.colors,bN=bZ.spot.positions,bM=bZ.spot.distances,bc=bZ.spot.directions,ba=bZ.spot.anglesCos,ac=bZ.spot.exponents,bL=bZ.hemi.skyColors,D=bZ.hemi.groundColors,K=bZ.hemi.positions,bb=0,E=0,bQ=0,j=0,G=0,bP=0,v=0,B=0,P=b2=0,cb=bX=P=0,b8=cc.length;cb<b8;cb++){b2=cc[cb],b2.onlyShadow||(b1=b2.color,bY=b2.intensity,bX=b2.distance,b2 instanceof THREE.AmbientLight?b2.visible&&(a4.gammaInput?(b4+=b1.r*b1.r,b3+=b1.g*b1.g,b0+=b1.b*b1.b):(b4+=b1.r,b3+=b1.g,b0+=b1.b)):b2 instanceof THREE.DirectionalLight?(G+=1,b2.visible&&(bq.getPositionFromMatrix(b2.matrixWorld),by.getPositionFromMatrix(b2.target.matrixWorld),bq.sub(by),bq.normalize(),0===bq.x&&0===bq.y&&0===bq.z||(b2=3*bb,bV[b2]=bq.x,bV[b2+1]=bq.y,bV[b2+2]=bq.z,a4.gammaInput?bf(bW,b2,b1,bY*bY):al(bW,b2,b1,bY),bb+=1))):b2 instanceof THREE.PointLight?(bP+=1,b2.visible&&(P=3*E,a4.gammaInput?bf(bU,P,b1,bY*bY):al(bU,P,b1,bY),by.getPositionFromMatrix(b2.matrixWorld),bS[P]=by.x,bS[P+1]=by.y,bS[P+2]=by.z,bT[E]=bX,E+=1)):b2 instanceof THREE.SpotLight?(v+=1,b2.visible&&(P=3*bQ,a4.gammaInput?bf(bO,P,b1,bY*bY):al(bO,P,b1,bY),by.getPositionFromMatrix(b2.matrixWorld),bN[P]=by.x,bN[P+1]=by.y,bN[P+2]=by.z,bM[bQ]=bX,bq.copy(by),by.getPositionFromMatrix(b2.target.matrixWorld),bq.sub(by),bq.normalize(),bc[P]=bq.x,bc[P+1]=bq.y,bc[P+2]=bq.z,ba[bQ]=Math.cos(b2.angle),ac[bQ]=b2.exponent,bQ+=1)):b2 instanceof THREE.HemisphereLight&&(B+=1,b2.visible&&(bq.getPositionFromMatrix(b2.matrixWorld),bq.normalize(),0===bq.x&&0===bq.y&&0===bq.z||(bX=3*j,K[bX]=bq.x,K[bX+1]=bq.y,K[bX+2]=bq.z,b1=b2.color,b2=b2.groundColor,a4.gammaInput?(bY*=bY,bf(bL,bX,b1,bY),bf(D,bX,b2,bY)):(al(bL,bX,b1,bY),al(D,bX,b2,bY)),j+=1))))}cb=3*bb;for(b8=Math.max(bW.length,3*G);cb<b8;cb++){bW[cb]=0}cb=3*E;for(b8=Math.max(bU.length,3*bP);cb<b8;cb++){bU[cb]=0}cb=3*bQ;for(b8=Math.max(bO.length,3*v);cb<b8;cb++){bO[cb]=0}cb=3*j;for(b8=Math.max(bL.length,3*B);cb<b8;cb++){bL[cb]=0}cb=3*j;for(b8=Math.max(D.length,3*B);cb<b8;cb++){D[cb]=0}bZ.directional.length=bb;bZ.point.length=E;bZ.spot.length=bQ;bZ.hemi.length=j;bZ.ambient[0]=b4;bZ.ambient[1]=b3;bZ.ambient[2]=b0;aQ=!1}cb=aR;b5.ambientLightColor.value=cb.ambient;b5.directionalLightColor.value=cb.directional.colors;b5.directionalLightDirection.value=cb.directional.positions;b5.pointLightColor.value=cb.point.colors;b5.pointLightPosition.value=cb.point.positions;b5.pointLightDistance.value=cb.point.distances;b5.spotLightColor.value=cb.spot.colors;b5.spotLightPosition.value=cb.spot.positions;b5.spotLightDistance.value=cb.spot.distances;b5.spotLightDirection.value=cb.spot.directions;b5.spotLightAngleCos.value=cb.spot.anglesCos;b5.spotLightExponent.value=cb.spot.exponents;b5.hemisphereLightSkyColor.value=cb.hemi.skyColors;b5.hemisphereLightGroundColor.value=cb.hemi.groundColors;b5.hemisphereLightDirection.value=cb.hemi.positions}if(ca instanceof THREE.MeshBasicMaterial||ca instanceof THREE.MeshLambertMaterial||ca instanceof THREE.MeshPhongMaterial){b5.opacity.value=ca.opacity;a4.gammaInput?b5.diffuse.value.copyGammaToLinear(ca.color):b5.diffuse.value=ca.color;b5.map.value=ca.map;b5.lightMap.value=ca.lightMap;b5.specularMap.value=ca.specularMap;ca.bumpMap&&(b5.bumpMap.value=ca.bumpMap,b5.bumpScale.value=ca.bumpScale);ca.normalMap&&(b5.normalMap.value=ca.normalMap,b5.normalScale.value.copy(ca.normalScale));var bR;ca.map?bR=ca.map:ca.specularMap?bR=ca.specularMap:ca.normalMap?bR=ca.normalMap:ca.bumpMap&&(bR=ca.bumpMap);void 0!==bR&&(cb=bR.offset,bR=bR.repeat,b5.offsetRepeat.value.set(cb.x,cb.y,bR.x,bR.y));b5.envMap.value=ca.envMap;b5.flipEnvMap.value=ca.envMap instanceof THREE.WebGLRenderTargetCube?1:-1;b5.reflectivity.value=ca.reflectivity;b5.refractionRatio.value=ca.refractionRatio;b5.combine.value=ca.combine;b5.useRefract.value=ca.envMap&&ca.envMap.mapping instanceof THREE.CubeRefractionMapping}ca instanceof THREE.LineBasicMaterial?(b5.diffuse.value=ca.color,b5.opacity.value=ca.opacity):ca instanceof THREE.LineDashedMaterial?(b5.diffuse.value=ca.color,b5.opacity.value=ca.opacity,b5.dashSize.value=ca.dashSize,b5.totalSize.value=ca.dashSize+ca.gapSize,b5.scale.value=ca.scale):ca instanceof THREE.ParticleSystemMaterial?(b5.psColor.value=ca.color,b5.opacity.value=ca.opacity,b5.size.value=ca.size,b5.scale.value=a8.height/2,b5.map.value=ca.map):ca instanceof THREE.MeshPhongMaterial?(b5.shininess.value=ca.shininess,a4.gammaInput?(b5.ambient.value.copyGammaToLinear(ca.ambient),b5.emissive.value.copyGammaToLinear(ca.emissive),b5.specular.value.copyGammaToLinear(ca.specular)):(b5.ambient.value=ca.ambient,b5.emissive.value=ca.emissive,b5.specular.value=ca.specular),ca.wrapAround&&b5.wrapRGB.value.copy(ca.wrapRGB)):ca instanceof THREE.MeshLambertMaterial?(a4.gammaInput?(b5.ambient.value.copyGammaToLinear(ca.ambient),b5.emissive.value.copyGammaToLinear(ca.emissive)):(b5.ambient.value=ca.ambient,b5.emissive.value=ca.emissive),ca.wrapAround&&b5.wrapRGB.value.copy(ca.wrapRGB)):ca instanceof THREE.MeshDepthMaterial?(b5.mNear.value=cd.near,b5.mFar.value=cd.far,b5.opacity.value=ca.opacity):ca instanceof THREE.MeshNormalMaterial&&(b5.opacity.value=ca.opacity);if(b9.receiveShadow&&!ca._shadowPass&&b5.shadowMatrix){cb=bR=0;for(b8=cc.length;cb<b8;cb++){if(b4=cc[cb],b4.castShadow&&(b4 instanceof THREE.SpotLight||b4 instanceof THREE.DirectionalLight&&!b4.shadowCascade)){b5.shadowMap.value[bR]=b4.shadowMap,b5.shadowMapSize.value[bR]=b4.shadowMapSize,b5.shadowMatrix.value[bR]=b4.shadowMatrix,b5.shadowDarkness.value[bR]=b4.shadowDarkness,b5.shadowBias.value[bR]=b4.shadowBias,bR++}}}cc=ca.uniformsList;b5=0;for(bR=cc.length;b5<bR;b5++){if(b8=b7.uniforms[cc[b5][1]]){if(cb=cc[b5][0],b3=cb.type,b4=cb.value,"i"===b3){aC.uniform1i(b8,b4)}else{if("f"===b3){aC.uniform1f(b8,b4)}else{if("v2"===b3){aC.uniform2f(b8,b4.x,b4.y)}else{if("v3"===b3){aC.uniform3f(b8,b4.x,b4.y,b4.z)}else{if("v4"===b3){aC.uniform4f(b8,b4.x,b4.y,b4.z,b4.w)}else{if("c"===b3){aC.uniform3f(b8,b4.r,b4.g,b4.b)}else{if("iv1"===b3){aC.uniform1iv(b8,b4)}else{if("iv"===b3){aC.uniform3iv(b8,b4)}else{if("fv1"===b3){aC.uniform1fv(b8,b4)}else{if("fv"===b3){aC.uniform3fv(b8,b4)}else{if("v2v"===b3){void 0===cb._array&&(cb._array=new Float32Array(2*b4.length));b3=0;for(b0=b4.length;b3<b0;b3++){bZ=2*b3,cb._array[bZ]=b4[b3].x,cb._array[bZ+1]=b4[b3].y}aC.uniform2fv(b8,cb._array)}else{if("v3v"===b3){void 0===cb._array&&(cb._array=new Float32Array(3*b4.length));b3=0;for(b0=b4.length;b3<b0;b3++){bZ=3*b3,cb._array[bZ]=b4[b3].x,cb._array[bZ+1]=b4[b3].y,cb._array[bZ+2]=b4[b3].z}aC.uniform3fv(b8,cb._array)}else{if("v4v"===b3){void 0===cb._array&&(cb._array=new Float32Array(4*b4.length));b3=0;for(b0=b4.length;b3<b0;b3++){bZ=4*b3,cb._array[bZ]=b4[b3].x,cb._array[bZ+1]=b4[b3].y,cb._array[bZ+2]=b4[b3].z,cb._array[bZ+3]=b4[b3].w}aC.uniform4fv(b8,cb._array)}else{if("m4"===b3){void 0===cb._array&&(cb._array=new Float32Array(16)),b4.flattenToArray(cb._array),aC.uniformMatrix4fv(b8,!1,cb._array)}else{if("m4v"===b3){void 0===cb._array&&(cb._array=new Float32Array(16*b4.length));b3=0;for(b0=b4.length;b3<b0;b3++){b4[b3].flattenToArrayOffset(cb._array,16*b3)}aC.uniformMatrix4fv(b8,!1,cb._array)}else{if("t"===b3){if(bZ=b4,b4=bh(),aC.uniform1i(b8,b4),bZ){if(bZ.image instanceof Array&&6===bZ.image.length){if(cb=bZ,b8=b4,6===cb.image.length){if(cb.needsUpdate){cb.image.__webglTextureCube||(cb.addEventListener("dispose",aD),cb.image.__webglTextureCube=aC.createTexture(),a4.info.memory.textures++);aC.activeTexture(aC.TEXTURE0+b8);aC.bindTexture(aC.TEXTURE_CUBE_MAP,cb.image.__webglTextureCube);aC.pixelStorei(aC.UNPACK_FLIP_Y_WEBGL,cb.flipY);b8=cb instanceof THREE.CompressedTexture;b4=[];for(b3=0;6>b3;b3++){a4.autoScaleCubemaps&&!b8?(b0=b4,bZ=b3,bW=cb.image[b3],bU=bn,bW.width<=bU&&bW.height<=bU||(bS=Math.max(bW.width,bW.height),bV=Math.floor(bW.width*bU/bS),bU=Math.floor(bW.height*bU/bS),bS=document.createElement("canvas"),bS.width=bV,bS.height=bU,bS.getContext("2d").drawImage(bW,0,0,bW.width,bW.height,0,0,bV,bU),bW=bS),b0[bZ]=bW):b4[b3]=cb.image[b3]}b3=b4[0];b0=0===(b3.width&b3.width-1)&&0===(b3.height&b3.height-1);bZ=an(cb.format);bW=an(cb.type);bd(aC.TEXTURE_CUBE_MAP,cb,b0);for(b3=0;6>b3;b3++){if(b8){bU=b4[b3].mipmaps;bS=0;for(bT=bU.length;bS<bT;bS++){bV=bU[bS],cb.format!==THREE.RGBAFormat?aC.compressedTexImage2D(aC.TEXTURE_CUBE_MAP_POSITIVE_X+b3,bS,bZ,bV.width,bV.height,0,bV.data):aC.texImage2D(aC.TEXTURE_CUBE_MAP_POSITIVE_X+b3,bS,bZ,bV.width,bV.height,0,bZ,bW,bV.data)}}else{aC.texImage2D(aC.TEXTURE_CUBE_MAP_POSITIVE_X+b3,0,bZ,bZ,bW,b4[b3])}}cb.generateMipmaps&&b0&&aC.generateMipmap(aC.TEXTURE_CUBE_MAP);cb.needsUpdate=!1;if(cb.onUpdate){cb.onUpdate()}}else{aC.activeTexture(aC.TEXTURE0+b8),aC.bindTexture(aC.TEXTURE_CUBE_MAP,cb.image.__webglTextureCube)}}}else{bZ instanceof THREE.WebGLRenderTargetCube?(cb=bZ,aC.activeTexture(aC.TEXTURE0+b4),aC.bindTexture(aC.TEXTURE_CUBE_MAP,cb.__webglTexture)):a4.setTexture(bZ,b4)}}}else{if("tv"===b3){void 0===cb._array&&(cb._array=[]);b3=0;for(b0=cb.value.length;b3<b0;b3++){cb._array[b3]=bh()}aC.uniform1iv(b8,cb._array);b3=0;for(b0=cb.value.length;b3<b0;b3++){bZ=cb.value[b3],b4=cb._array[b3],bZ&&a4.setTexture(bZ,b4)}}else{console.warn("THREE.WebGLRenderer: Unknown uniform type: "+b3)}}}}}}}}}}}}}}}}}}}if((ca instanceof THREE.ShaderMaterial||ca instanceof THREE.MeshPhongMaterial||ca.envMap)&&null!==b6.cameraPosition){by.getPositionFromMatrix(cd.matrixWorld),aC.uniform3f(b6.cameraPosition,by.x,by.y,by.z)}(ca instanceof THREE.MeshPhongMaterial||ca instanceof THREE.MeshLambertMaterial||ca instanceof THREE.ShaderMaterial||ca.skinning)&&null!==b6.viewMatrix&&aC.uniformMatrix4fv(b6.viewMatrix,!1,cd.matrixWorldInverse.elements)}aC.uniformMatrix4fv(b6.modelViewMatrix,!1,b9._modelViewMatrix.elements);b6.normalMatrix&&aC.uniformMatrix3fv(b6.normalMatrix,!1,b9._normalMatrix.elements);null!==b6.modelMatrix&&aC.uniformMatrix4fv(b6.modelMatrix,!1,b9.matrixWorld.elements);return b7}function bh(){var b=aZ;b>=bI&&console.warn("WebGLRenderer: trying to use "+b+" texture units while this GPU supports only "+bI);aZ+=1;return b}function bf(f,e,h,g){f[e]=h.r*h.r*g;f[e+1]=h.g*h.g*g;f[e+2]=h.b*h.b*g}function al(f,e,h,g){f[e]=h.r*g;f[e+1]=h.g*g;f[e+2]=h.b*g}function a9(b){b!==o&&(aC.lineWidth(b),o=b)}function bi(e,d,f){aH!==e&&(e?aC.enable(aC.POLYGON_OFFSET_FILL):aC.disable(aC.POLYGON_OFFSET_FILL),aH=e);if(e&&(bm!==d||ai!==f)){aC.polygonOffset(d,f),bm=d,ai=f}}function a1(e){for(var e=e.split("\n"),d=0,f=e.length;d<f;d++){e[d]=d+1+": "+e[d]}return e.join("\n")}function bg(e,d){var f;"fragment"===e?f=aC.createShader(aC.FRAGMENT_SHADER):"vertex"===e&&(f=aC.createShader(aC.VERTEX_SHADER));aC.shaderSource(f,d);aC.compileShader(f);return !aC.getShaderParameter(f,aC.COMPILE_STATUS)?(console.error(aC.getShaderInfoLog(f)),console.error(a1(d)),null):f}function bd(e,d,f){f?(aC.texParameteri(e,aC.TEXTURE_WRAP_S,an(d.wrapS)),aC.texParameteri(e,aC.TEXTURE_WRAP_T,an(d.wrapT)),aC.texParameteri(e,aC.TEXTURE_MAG_FILTER,an(d.magFilter)),aC.texParameteri(e,aC.TEXTURE_MIN_FILTER,an(d.minFilter))):(aC.texParameteri(e,aC.TEXTURE_WRAP_S,aC.CLAMP_TO_EDGE),aC.texParameteri(e,aC.TEXTURE_WRAP_T,aC.CLAMP_TO_EDGE),aC.texParameteri(e,aC.TEXTURE_MAG_FILTER,ak(d.magFilter)),aC.texParameteri(e,aC.TEXTURE_MIN_FILTER,ak(d.minFilter)));if(Y&&d.type!==THREE.FloatType&&(1<d.anisotropy||d.__oldAnisotropy)){aC.texParameterf(e,Y.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(d.anisotropy,bx)),d.__oldAnisotropy=d.anisotropy}}function a7(d,c){aC.bindRenderbuffer(aC.RENDERBUFFER,d);c.depthBuffer&&!c.stencilBuffer?(aC.renderbufferStorage(aC.RENDERBUFFER,aC.DEPTH_COMPONENT16,c.width,c.height),aC.framebufferRenderbuffer(aC.FRAMEBUFFER,aC.DEPTH_ATTACHMENT,aC.RENDERBUFFER,d)):c.depthBuffer&&c.stencilBuffer?(aC.renderbufferStorage(aC.RENDERBUFFER,aC.DEPTH_STENCIL,c.width,c.height),aC.framebufferRenderbuffer(aC.FRAMEBUFFER,aC.DEPTH_STENCIL_ATTACHMENT,aC.RENDERBUFFER,d)):aC.renderbufferStorage(aC.RENDERBUFFER,aC.RGBA4,c.width,c.height)}function ak(b){return b===THREE.NearestFilter||b===THREE.NearestMipMapNearestFilter||b===THREE.NearestMipMapLinearFilter?aC.NEAREST:aC.LINEAR}function an(b){if(b===THREE.RepeatWrapping){return aC.REPEAT}if(b===THREE.ClampToEdgeWrapping){return aC.CLAMP_TO_EDGE}if(b===THREE.MirroredRepeatWrapping){return aC.MIRRORED_REPEAT}if(b===THREE.NearestFilter){return aC.NEAREST}if(b===THREE.NearestMipMapNearestFilter){return aC.NEAREST_MIPMAP_NEAREST}if(b===THREE.NearestMipMapLinearFilter){return aC.NEAREST_MIPMAP_LINEAR}if(b===THREE.LinearFilter){return aC.LINEAR}if(b===THREE.LinearMipMapNearestFilter){return aC.LINEAR_MIPMAP_NEAREST}if(b===THREE.LinearMipMapLinearFilter){return aC.LINEAR_MIPMAP_LINEAR}if(b===THREE.UnsignedByteType){return aC.UNSIGNED_BYTE}if(b===THREE.UnsignedShort4444Type){return aC.UNSIGNED_SHORT_4_4_4_4}if(b===THREE.UnsignedShort5551Type){return aC.UNSIGNED_SHORT_5_5_5_1}if(b===THREE.UnsignedShort565Type){return aC.UNSIGNED_SHORT_5_6_5}if(b===THREE.ByteType){return aC.BYTE}if(b===THREE.ShortType){return aC.SHORT}if(b===THREE.UnsignedShortType){return aC.UNSIGNED_SHORT}if(b===THREE.IntType){return aC.INT}if(b===THREE.UnsignedIntType){return aC.UNSIGNED_INT}if(b===THREE.FloatType){return aC.FLOAT}if(b===THREE.AlphaFormat){return aC.ALPHA}if(b===THREE.RGBFormat){return aC.RGB}if(b===THREE.RGBAFormat){return aC.RGBA}if(b===THREE.LuminanceFormat){return aC.LUMINANCE}if(b===THREE.LuminanceAlphaFormat){return aC.LUMINANCE_ALPHA}if(b===THREE.AddEquation){return aC.FUNC_ADD}if(b===THREE.SubtractEquation){return aC.FUNC_SUBTRACT}if(b===THREE.ReverseSubtractEquation){return aC.FUNC_REVERSE_SUBTRACT}if(b===THREE.ZeroFactor){return aC.ZERO}if(b===THREE.OneFactor){return aC.ONE}if(b===THREE.SrcColorFactor){return aC.SRC_COLOR}if(b===THREE.OneMinusSrcColorFactor){return aC.ONE_MINUS_SRC_COLOR}if(b===THREE.SrcAlphaFactor){return aC.SRC_ALPHA}if(b===THREE.OneMinusSrcAlphaFactor){return aC.ONE_MINUS_SRC_ALPHA}if(b===THREE.DstAlphaFactor){return aC.DST_ALPHA}if(b===THREE.OneMinusDstAlphaFactor){return aC.ONE_MINUS_DST_ALPHA}if(b===THREE.DstColorFactor){return aC.DST_COLOR}if(b===THREE.OneMinusDstColorFactor){return aC.ONE_MINUS_DST_COLOR}if(b===THREE.SrcAlphaSaturateFactor){return aC.SRC_ALPHA_SATURATE}if(void 0!==ae){if(b===THREE.RGB_S3TC_DXT1_Format){return ae.COMPRESSED_RGB_S3TC_DXT1_EXT}if(b===THREE.RGBA_S3TC_DXT1_Format){return ae.COMPRESSED_RGBA_S3TC_DXT1_EXT}if(b===THREE.RGBA_S3TC_DXT3_Format){return ae.COMPRESSED_RGBA_S3TC_DXT3_EXT}if(b===THREE.RGBA_S3TC_DXT5_Format){return ae.COMPRESSED_RGBA_S3TC_DXT5_EXT}}return 0}console.log("THREE.WebGLRenderer",THREE.REVISION);var aP=aP||{},a8=void 0!==aP.canvas?aP.canvas:document.createElement("canvas"),aV=void 0!==aP.precision?aP.precision:"highp",a6=void 0!==aP.alpha?aP.alpha:!0,a0=void 0!==aP.premultipliedAlpha?aP.premultipliedAlpha:!0,aM=void 0!==aP.antialias?aP.antialias:!1,ag=void 0!==aP.stencil?aP.stencil:!0,a2=void 0!==aP.preserveDrawingBuffer?aP.preserveDrawingBuffer:!1,a3=new THREE.Color(0),aX=0;this.domElement=a8;this.context=null;this.devicePixelRatio=void 0!==aP.devicePixelRatio?aP.devicePixelRatio:void 0!==self.devicePixelRatio?self.devicePixelRatio:1;this.autoUpdateObjects=this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0;this.shadowMapEnabled=this.physicallyBasedShading=this.gammaOutput=this.gammaInput=!1;this.shadowMapAutoUpdate=!0;this.shadowMapType=THREE.PCFShadowMap;this.shadowMapCullFace=THREE.CullFaceFront;this.shadowMapCascade=this.shadowMapDebug=!1;this.maxMorphTargets=8;this.maxMorphNormals=4;this.autoScaleCubemaps=!0;this.renderPluginsPre=[];this.renderPluginsPost=[];this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};var a4=this,ay=[],T=0,br=null,ab=null,bD=-1,bu=null,H=null,aT=0,aZ=0,aS=-1,aU=-1,S=-1,bk=-1,aF=-1,X=-1,bG=-1,bC=-1,aH=null,bm=null,ai=null,o=null,aY=0,aw=0,bK=a8.width,bB=a8.height,bw=0,af=0,bt={},bF=new THREE.Frustum,bJ=new THREE.Matrix4,bo=new THREE.Matrix4,by=new THREE.Vector3,bq=new THREE.Vector3,aQ=!0,aR={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}},aC,bl,ah,Y,ae;try{var aa={alpha:a6,premultipliedAlpha:a0,antialias:aM,stencil:ag,preserveDrawingBuffer:a2};aC=a8.getContext("webgl",aa)||a8.getContext("experimental-webgl",aa);if(null===aC){throw"Error creating WebGL context."}}catch(bA){console.error(bA)}bl=aC.getExtension("OES_texture_float");aC.getExtension("OES_texture_float_linear");ah=aC.getExtension("OES_standard_derivatives");Y=aC.getExtension("EXT_texture_filter_anisotropic")||aC.getExtension("MOZ_EXT_texture_filter_anisotropic")||aC.getExtension("WEBKIT_EXT_texture_filter_anisotropic");ae=aC.getExtension("WEBGL_compressed_texture_s3tc")||aC.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||aC.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");bl||console.log("THREE.WebGLRenderer: Float textures not supported.");ah||console.log("THREE.WebGLRenderer: Standard derivatives not supported.");Y||console.log("THREE.WebGLRenderer: Anisotropic texture filtering not supported.");ae||console.log("THREE.WebGLRenderer: S3TC compressed textures not supported.");void 0===aC.getShaderPrecisionFormat&&(aC.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}});aC.clearColor(0,0,0,1);aC.clearDepth(1);aC.clearStencil(0);aC.enable(aC.DEPTH_TEST);aC.depthFunc(aC.LEQUAL);aC.frontFace(aC.CCW);aC.cullFace(aC.BACK);aC.enable(aC.CULL_FACE);aC.enable(aC.BLEND);aC.blendEquation(aC.FUNC_ADD);aC.blendFunc(aC.SRC_ALPHA,aC.ONE_MINUS_SRC_ALPHA);aC.viewport(aY,aw,bK,bB);aC.clearColor(a3.r,a3.g,a3.b,aX);this.context=aC;var bI=aC.getParameter(aC.MAX_TEXTURE_IMAGE_UNITS),be=aC.getParameter(aC.MAX_VERTEX_TEXTURE_IMAGE_UNITS);aC.getParameter(aC.MAX_TEXTURE_SIZE);var bn=aC.getParameter(aC.MAX_CUBE_MAP_TEXTURE_SIZE),bx=Y?aC.getParameter(Y.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,bp=0<be,bz=bp&&bl;ae&&aC.getParameter(aC.COMPRESSED_TEXTURE_FORMATS);var aW=aC.getShaderPrecisionFormat(aC.VERTEX_SHADER,aC.HIGH_FLOAT),au=aC.getShaderPrecisionFormat(aC.VERTEX_SHADER,aC.MEDIUM_FLOAT);aC.getShaderPrecisionFormat(aC.VERTEX_SHADER,aC.LOW_FLOAT);var W=aC.getShaderPrecisionFormat(aC.FRAGMENT_SHADER,aC.HIGH_FLOAT),bH=aC.getShaderPrecisionFormat(aC.FRAGMENT_SHADER,aC.MEDIUM_FLOAT);aC.getShaderPrecisionFormat(aC.FRAGMENT_SHADER,aC.LOW_FLOAT);aC.getShaderPrecisionFormat(aC.VERTEX_SHADER,aC.HIGH_INT);aC.getShaderPrecisionFormat(aC.VERTEX_SHADER,aC.MEDIUM_INT);aC.getShaderPrecisionFormat(aC.VERTEX_SHADER,aC.LOW_INT);aC.getShaderPrecisionFormat(aC.FRAGMENT_SHADER,aC.HIGH_INT);aC.getShaderPrecisionFormat(aC.FRAGMENT_SHADER,aC.MEDIUM_INT);aC.getShaderPrecisionFormat(aC.FRAGMENT_SHADER,aC.LOW_INT);var bv=0<aW.precision&&0<W.precision,bj=0<au.precision&&0<bH.precision;"highp"===aV&&!bv&&(bj?(aV="mediump",console.warn("WebGLRenderer: highp not supported, using mediump")):(aV="lowp",console.warn("WebGLRenderer: highp and mediump not supported, using lowp")));"mediump"===aV&&!bj&&(aV="lowp",console.warn("WebGLRenderer: mediump not supported, using lowp"));this.getContext=function(){return aC};this.supportsVertexTextures=function(){return bp};this.supportsFloatTextures=function(){return bl};this.supportsStandardDerivatives=function(){return ah};this.supportsCompressedTextureS3TC=function(){return ae};this.getMaxAnisotropy=function(){return bx};this.getPrecision=function(){return aV};this.setSize=function(e,d,f){a8.width=e*this.devicePixelRatio;a8.height=d*this.devicePixelRatio;1!==this.devicePixelRatio&&!1!==f&&(a8.style.width=e+"px",a8.style.height=d+"px");this.setViewport(0,0,a8.width,a8.height)};this.setViewport=function(f,e,h,g){aY=void 0!==f?f:0;aw=void 0!==e?e:0;bK=void 0!==h?h:a8.width;bB=void 0!==g?g:a8.height;aC.viewport(aY,aw,bK,bB)};this.setScissor=function(f,e,h,g){aC.scissor(f,e,h,g)};this.enableScissorTest=function(b){b?aC.enable(aC.SCISSOR_TEST):aC.disable(aC.SCISSOR_TEST)};this.setClearColor=function(d,c){a3.set(d);aX=void 0!==c?c:1;aC.clearColor(a3.r,a3.g,a3.b,aX)};this.setClearColorHex=function(d,c){console.warn("DEPRECATED: .setClearColorHex() is being removed. Use .setClearColor() instead.");this.setClearColor(d,c)};this.getClearColor=function(){return a3};this.getClearAlpha=function(){return aX};this.clear=function(f,e,h){var g=0;if(void 0===f||f){g|=aC.COLOR_BUFFER_BIT}if(void 0===e||e){g|=aC.DEPTH_BUFFER_BIT}if(void 0===h||h){g|=aC.STENCIL_BUFFER_BIT}aC.clear(g)};this.clearTarget=function(f,e,h,g){this.setRenderTarget(f);this.clear(e,h,g)};this.addPostPlugin=function(b){b.init(this);this.renderPluginsPost.push(b)};this.addPrePlugin=function(b){b.init(this);this.renderPluginsPre.push(b)};this.updateShadowMap=function(d,c){br=null;bD=bu=bC=bG=S=-1;aQ=!0;aU=aS=-1;this.shadowMapPlugin.update(d,c)};var a5=function(g){g=g.target;g.removeEventListener("dispose",a5);g.__webglInit=void 0;if(g instanceof THREE.BufferGeometry){var f=g.attributes,j;for(j in f){void 0!==f[j].buffer&&aC.deleteBuffer(f[j].buffer)}a4.info.memory.geometries--}else{if(void 0!==g.geometryGroups){for(f in g.geometryGroups){j=g.geometryGroups[f];if(void 0!==j.numMorphTargets){for(var i=0,h=j.numMorphTargets;i<h;i++){aC.deleteBuffer(j.__webglMorphTargetsBuffers[i])}}if(void 0!==j.numMorphNormals){i=0;for(h=j.numMorphNormals;i<h;i++){aC.deleteBuffer(j.__webglMorphNormalsBuffers[i])}}bs(j)}}else{bs(g)}}},aD=function(b){b=b.target;b.removeEventListener("dispose",aD);b.image&&b.image.__webglTextureCube?aC.deleteTexture(b.image.__webglTextureCube):b.__webglInit&&(b.__webglInit=!1,aC.deleteTexture(b.__webglTexture));a4.info.memory.textures--},ad=function(d){d=d.target;d.removeEventListener("dispose",ad);if(d&&d.__webglTexture){if(aC.deleteTexture(d.__webglTexture),d instanceof THREE.WebGLRenderTargetCube){for(var c=0;6>c;c++){aC.deleteFramebuffer(d.__webglFramebuffer[c]),aC.deleteRenderbuffer(d.__webglRenderbuffer[c])}}else{aC.deleteFramebuffer(d.__webglFramebuffer),aC.deleteRenderbuffer(d.__webglRenderbuffer)}}a4.info.memory.textures--},L=function(b){b=b.target;b.removeEventListener("dispose",L);bE(b)},bs=function(d){void 0!==d.__webglVertexBuffer&&aC.deleteBuffer(d.__webglVertexBuffer);void 0!==d.__webglNormalBuffer&&aC.deleteBuffer(d.__webglNormalBuffer);void 0!==d.__webglTangentBuffer&&aC.deleteBuffer(d.__webglTangentBuffer);void 0!==d.__webglColorBuffer&&aC.deleteBuffer(d.__webglColorBuffer);void 0!==d.__webglUVBuffer&&aC.deleteBuffer(d.__webglUVBuffer);void 0!==d.__webglUV2Buffer&&aC.deleteBuffer(d.__webglUV2Buffer);void 0!==d.__webglSkinIndicesBuffer&&aC.deleteBuffer(d.__webglSkinIndicesBuffer);void 0!==d.__webglSkinWeightsBuffer&&aC.deleteBuffer(d.__webglSkinWeightsBuffer);void 0!==d.__webglFaceBuffer&&aC.deleteBuffer(d.__webglFaceBuffer);void 0!==d.__webglLineBuffer&&aC.deleteBuffer(d.__webglLineBuffer);void 0!==d.__webglLineDistanceBuffer&&aC.deleteBuffer(d.__webglLineDistanceBuffer);if(void 0!==d.__webglCustomAttributesList){for(var c in d.__webglCustomAttributesList){aC.deleteBuffer(d.__webglCustomAttributesList[c].buffer)}}a4.info.memory.geometries--},bE=function(g){var f=g.program;if(void 0!==f){g.program=void 0;var j,i,h=!1,g=0;for(j=ay.length;g<j;g++){if(i=ay[g],i.program===f){i.usedTimes--;0===i.usedTimes&&(h=!0);break}}if(!0===h){h=[];g=0;for(j=ay.length;g<j;g++){i=ay[g],i.program!==f&&h.push(i)}ay=h;aC.deleteProgram(f);a4.info.memory.programs--}}};this.renderBufferImmediate=function(J,I,G){J.hasPositions&&!J.__webglVertexBuffer&&(J.__webglVertexBuffer=aC.createBuffer());J.hasNormals&&!J.__webglNormalBuffer&&(J.__webglNormalBuffer=aC.createBuffer());J.hasUvs&&!J.__webglUvBuffer&&(J.__webglUvBuffer=aC.createBuffer());J.hasColors&&!J.__webglColorBuffer&&(J.__webglColorBuffer=aC.createBuffer());J.hasPositions&&(aC.bindBuffer(aC.ARRAY_BUFFER,J.__webglVertexBuffer),aC.bufferData(aC.ARRAY_BUFFER,J.positionArray,aC.DYNAMIC_DRAW),aC.enableVertexAttribArray(I.attributes.position),aC.vertexAttribPointer(I.attributes.position,3,aC.FLOAT,!1,0,0));if(J.hasNormals){aC.bindBuffer(aC.ARRAY_BUFFER,J.__webglNormalBuffer);if(G.shading===THREE.FlatShading){var F,E,D,B,C,A,v,u,t,r,s,j=3*J.count;for(s=0;s<j;s+=9){r=J.normalArray,F=r[s],E=r[s+1],D=r[s+2],B=r[s+3],A=r[s+4],u=r[s+5],C=r[s+6],v=r[s+7],t=r[s+8],F=(F+B+C)/3,E=(E+A+v)/3,D=(D+u+t)/3,r[s]=F,r[s+1]=E,r[s+2]=D,r[s+3]=F,r[s+4]=E,r[s+5]=D,r[s+6]=F,r[s+7]=E,r[s+8]=D}}aC.bufferData(aC.ARRAY_BUFFER,J.normalArray,aC.DYNAMIC_DRAW);aC.enableVertexAttribArray(I.attributes.normal);aC.vertexAttribPointer(I.attributes.normal,3,aC.FLOAT,!1,0,0)}J.hasUvs&&G.map&&(aC.bindBuffer(aC.ARRAY_BUFFER,J.__webglUvBuffer),aC.bufferData(aC.ARRAY_BUFFER,J.uvArray,aC.DYNAMIC_DRAW),aC.enableVertexAttribArray(I.attributes.uv),aC.vertexAttribPointer(I.attributes.uv,2,aC.FLOAT,!1,0,0));J.hasColors&&G.vertexColors!==THREE.NoColors&&(aC.bindBuffer(aC.ARRAY_BUFFER,J.__webglColorBuffer),aC.bufferData(aC.ARRAY_BUFFER,J.colorArray,aC.DYNAMIC_DRAW),aC.enableVertexAttribArray(I.attributes.color),aC.vertexAttribPointer(I.attributes.color,3,aC.FLOAT,!1,0,0));aC.drawArrays(aC.TRIANGLES,0,J.count);J.count=0};this.renderBufferDirect=function(E,D,C,B,A,v){if(!1!==B.visible){var u,t,s,r;u=aj(E,D,C,B,v);D=u.attributes;E=A.attributes;C=!1;u=16777215*A.id+2*u.id+(B.wireframe?1:0);u!==bu&&(bu=u,C=!0);C&&aI();if(v instanceof THREE.Mesh){if(v=E.index){A=A.offsets;1<A.length&&(C=!0);for(var h=0,j=A.length;h<j;h++){var g=A[h].index;if(C){for(t in D){s=D[t],u=E[t],0<=s&&(u?(r=u.itemSize,aC.bindBuffer(aC.ARRAY_BUFFER,u.buffer),aG(s),aC.vertexAttribPointer(s,r,aC.FLOAT,!1,0,4*g*r)):B.defaultAttributeValues&&(2===B.defaultAttributeValues[t].length?aC.vertexAttrib2fv(s,B.defaultAttributeValues[t]):3===B.defaultAttributeValues[t].length&&aC.vertexAttrib3fv(s,B.defaultAttributeValues[t])))}aC.bindBuffer(aC.ELEMENT_ARRAY_BUFFER,v.buffer)}aC.drawElements(aC.TRIANGLES,A[h].count,aC.UNSIGNED_SHORT,2*A[h].start);a4.info.render.calls++;a4.info.render.vertices+=A[h].count;a4.info.render.faces+=A[h].count/3}}else{if(C){for(t in D){"index"!==t&&(s=D[t],u=E[t],0<=s&&(u?(r=u.itemSize,aC.bindBuffer(aC.ARRAY_BUFFER,u.buffer),aG(s),aC.vertexAttribPointer(s,r,aC.FLOAT,!1,0,0)):B.defaultAttributeValues&&B.defaultAttributeValues[t]&&(2===B.defaultAttributeValues[t].length?aC.vertexAttrib2fv(s,B.defaultAttributeValues[t]):3===B.defaultAttributeValues[t].length&&aC.vertexAttrib3fv(s,B.defaultAttributeValues[t]))))}}B=A.attributes.position;aC.drawArrays(aC.TRIANGLES,0,B.numItems/3);a4.info.render.calls++;a4.info.render.vertices+=B.numItems/3;a4.info.render.faces+=B.numItems/3/3}}else{if(v instanceof THREE.ParticleSystem){if(C){for(t in D){s=D[t],u=E[t],0<=s&&(u?(r=u.itemSize,aC.bindBuffer(aC.ARRAY_BUFFER,u.buffer),aG(s),aC.vertexAttribPointer(s,r,aC.FLOAT,!1,0,0)):B.defaultAttributeValues&&B.defaultAttributeValues[t]&&(2===B.defaultAttributeValues[t].length?aC.vertexAttrib2fv(s,B.defaultAttributeValues[t]):3===B.defaultAttributeValues[t].length&&aC.vertexAttrib3fv(s,B.defaultAttributeValues[t])))}B=E.position;aC.drawArrays(aC.POINTS,0,B.numItems/3);a4.info.render.calls++;a4.info.render.points+=B.numItems/3}}else{if(v instanceof THREE.Line&&C){for(t in D){s=D[t],u=E[t],0<=s&&(u?(r=u.itemSize,aC.bindBuffer(aC.ARRAY_BUFFER,u.buffer),aG(s),aC.vertexAttribPointer(s,r,aC.FLOAT,!1,0,0)):B.defaultAttributeValues&&B.defaultAttributeValues[t]&&(2===B.defaultAttributeValues[t].length?aC.vertexAttrib2fv(s,B.defaultAttributeValues[t]):3===B.defaultAttributeValues[t].length&&aC.vertexAttrib3fv(s,B.defaultAttributeValues[t])))}t=v.type===THREE.LineStrip?aC.LINE_STRIP:aC.LINES;a9(B.linewidth);B=E.position;aC.drawArrays(t,0,B.numItems/3);a4.info.render.calls++;a4.info.render.points+=B.numItems}}}}};this.renderBuffer=function(A,v,u,t,s,r){if(!1!==t.visible){var q,k,u=aj(A,v,u,t,r),A=u.attributes,v=!1,u=16777215*s.id+2*u.id+(t.wireframe?1:0);u!==bu&&(bu=u,v=!0);v&&aI();if(!t.morphTargets&&0<=A.position){v&&(aC.bindBuffer(aC.ARRAY_BUFFER,s.__webglVertexBuffer),aG(A.position),aC.vertexAttribPointer(A.position,3,aC.FLOAT,!1,0,0))}else{if(r.morphTargetBase){u=t.program.attributes;-1!==r.morphTargetBase&&0<=u.position?(aC.bindBuffer(aC.ARRAY_BUFFER,s.__webglMorphTargetsBuffers[r.morphTargetBase]),aG(u.position),aC.vertexAttribPointer(u.position,3,aC.FLOAT,!1,0,0)):0<=u.position&&(aC.bindBuffer(aC.ARRAY_BUFFER,s.__webglVertexBuffer),aG(u.position),aC.vertexAttribPointer(u.position,3,aC.FLOAT,!1,0,0));if(r.morphTargetForcedOrder.length){var j=0;k=r.morphTargetForcedOrder;for(q=r.morphTargetInfluences;j<t.numSupportedMorphTargets&&j<k.length;){0<=u["morphTarget"+j]&&(aC.bindBuffer(aC.ARRAY_BUFFER,s.__webglMorphTargetsBuffers[k[j]]),aG(u["morphTarget"+j]),aC.vertexAttribPointer(u["morphTarget"+j],3,aC.FLOAT,!1,0,0)),0<=u["morphNormal"+j]&&t.morphNormals&&(aC.bindBuffer(aC.ARRAY_BUFFER,s.__webglMorphNormalsBuffers[k[j]]),aG(u["morphNormal"+j]),aC.vertexAttribPointer(u["morphNormal"+j],3,aC.FLOAT,!1,0,0)),r.__webglMorphTargetInfluences[j]=q[k[j]],j++}}else{k=[];q=r.morphTargetInfluences;var g,h=q.length;for(g=0;g<h;g++){j=q[g],0<j&&k.push([j,g])}k.length>t.numSupportedMorphTargets?(k.sort(aB),k.length=t.numSupportedMorphTargets):k.length>t.numSupportedMorphNormals?k.sort(aB):0===k.length&&k.push([0,0]);for(j=0;j<t.numSupportedMorphTargets;){k[j]?(g=k[j][1],0<=u["morphTarget"+j]&&(aC.bindBuffer(aC.ARRAY_BUFFER,s.__webglMorphTargetsBuffers[g]),aG(u["morphTarget"+j]),aC.vertexAttribPointer(u["morphTarget"+j],3,aC.FLOAT,!1,0,0)),0<=u["morphNormal"+j]&&t.morphNormals&&(aC.bindBuffer(aC.ARRAY_BUFFER,s.__webglMorphNormalsBuffers[g]),aG(u["morphNormal"+j]),aC.vertexAttribPointer(u["morphNormal"+j],3,aC.FLOAT,!1,0,0)),r.__webglMorphTargetInfluences[j]=q[g]):r.__webglMorphTargetInfluences[j]=0,j++}}null!==t.program.uniforms.morphTargetInfluences&&aC.uniform1fv(t.program.uniforms.morphTargetInfluences,r.__webglMorphTargetInfluences)}}if(v){if(s.__webglCustomAttributesList){q=0;for(k=s.__webglCustomAttributesList.length;q<k;q++){u=s.__webglCustomAttributesList[q],0<=A[u.buffer.belongsToAttribute]&&(aC.bindBuffer(aC.ARRAY_BUFFER,u.buffer),aG(A[u.buffer.belongsToAttribute]),aC.vertexAttribPointer(A[u.buffer.belongsToAttribute],u.size,aC.FLOAT,!1,0,0))}}0<=A.color&&(0<r.geometry.colors.length||0<r.geometry.faces.length?(aC.bindBuffer(aC.ARRAY_BUFFER,s.__webglColorBuffer),aG(A.color),aC.vertexAttribPointer(A.color,3,aC.FLOAT,!1,0,0)):t.defaultAttributeValues&&aC.vertexAttrib3fv(A.color,t.defaultAttributeValues.color));0<=A.normal&&(aC.bindBuffer(aC.ARRAY_BUFFER,s.__webglNormalBuffer),aG(A.normal),aC.vertexAttribPointer(A.normal,3,aC.FLOAT,!1,0,0));0<=A.tangent&&(aC.bindBuffer(aC.ARRAY_BUFFER,s.__webglTangentBuffer),aG(A.tangent),aC.vertexAttribPointer(A.tangent,4,aC.FLOAT,!1,0,0));0<=A.uv&&(r.geometry.faceVertexUvs[0]?(aC.bindBuffer(aC.ARRAY_BUFFER,s.__webglUVBuffer),aG(A.uv),aC.vertexAttribPointer(A.uv,2,aC.FLOAT,!1,0,0)):t.defaultAttributeValues&&aC.vertexAttrib2fv(A.uv,t.defaultAttributeValues.uv));0<=A.uv2&&(r.geometry.faceVertexUvs[1]?(aC.bindBuffer(aC.ARRAY_BUFFER,s.__webglUV2Buffer),aG(A.uv2),aC.vertexAttribPointer(A.uv2,2,aC.FLOAT,!1,0,0)):t.defaultAttributeValues&&aC.vertexAttrib2fv(A.uv2,t.defaultAttributeValues.uv2));t.skinning&&(0<=A.skinIndex&&0<=A.skinWeight)&&(aC.bindBuffer(aC.ARRAY_BUFFER,s.__webglSkinIndicesBuffer),aG(A.skinIndex),aC.vertexAttribPointer(A.skinIndex,4,aC.FLOAT,!1,0,0),aC.bindBuffer(aC.ARRAY_BUFFER,s.__webglSkinWeightsBuffer),aG(A.skinWeight),aC.vertexAttribPointer(A.skinWeight,4,aC.FLOAT,!1,0,0));0<=A.lineDistance&&(aC.bindBuffer(aC.ARRAY_BUFFER,s.__webglLineDistanceBuffer),aG(A.lineDistance),aC.vertexAttribPointer(A.lineDistance,1,aC.FLOAT,!1,0,0))}r instanceof THREE.Mesh?(t.wireframe?(a9(t.wireframeLinewidth),v&&aC.bindBuffer(aC.ELEMENT_ARRAY_BUFFER,s.__webglLineBuffer),aC.drawElements(aC.LINES,s.__webglLineCount,aC.UNSIGNED_SHORT,0)):(v&&aC.bindBuffer(aC.ELEMENT_ARRAY_BUFFER,s.__webglFaceBuffer),aC.drawElements(aC.TRIANGLES,s.__webglFaceCount,aC.UNSIGNED_SHORT,0)),a4.info.render.calls++,a4.info.render.vertices+=s.__webglFaceCount,a4.info.render.faces+=s.__webglFaceCount/3):r instanceof THREE.Line?(r=r.type===THREE.LineStrip?aC.LINE_STRIP:aC.LINES,a9(t.linewidth),aC.drawArrays(r,0,s.__webglLineCount),a4.info.render.calls++):r instanceof THREE.ParticleSystem&&(aC.drawArrays(aC.POINTS,0,s.__webglParticleCount),a4.info.render.calls++,a4.info.render.points+=s.__webglParticleCount)}};this.render=function(E,D,C,B){if(!1===D instanceof THREE.Camera){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")}else{var A,v,p,u,m=E.__lights,l=E.fog;bD=-1;aQ=!0;!0===E.autoUpdate&&E.updateMatrixWorld();void 0===D.parent&&D.updateMatrixWorld();D.matrixWorldInverse.getInverse(D.matrixWorld);bJ.multiplyMatrices(D.projectionMatrix,D.matrixWorldInverse);bF.setFromMatrix(bJ);this.autoUpdateObjects&&this.initWebGLObjects(E);az(this.renderPluginsPre,E,D);a4.info.render.calls=0;a4.info.render.vertices=0;a4.info.render.faces=0;a4.info.render.points=0;this.setRenderTarget(C);(this.autoClear||B)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil);u=E.__webglObjects;B=0;for(A=u.length;B<A;B++){if(v=u[B],p=v.object,v.id=B,v.render=!1,p.visible&&(!(p instanceof THREE.Mesh||p instanceof THREE.ParticleSystem)||!p.frustumCulled||bF.intersectsObject(p))){var j=p;j._modelViewMatrix.multiplyMatrices(D.matrixWorldInverse,j.matrixWorld);j._normalMatrix.getNormalMatrix(j._modelViewMatrix);var j=v,i=j.buffer,G=void 0,F=G=void 0,F=j.object.material;if(F instanceof THREE.MeshFaceMaterial){G=i.materialIndex,G=F.materials[G],G.transparent?(j.transparent=G,j.opaque=null):(j.opaque=G,j.transparent=null)}else{if(G=F){G.transparent?(j.transparent=G,j.opaque=null):(j.opaque=G,j.transparent=null)}}v.render=!0;!0===this.sortObjects&&(null!==p.renderDepth?v.z=p.renderDepth:(by.getPositionFromMatrix(p.matrixWorld),by.applyProjection(bJ),v.z=by.z))}}this.sortObjects&&u.sort(aE);u=E.__webglObjectsImmediate;B=0;for(A=u.length;B<A;B++){v=u[B],p=v.object,p.visible&&(p._modelViewMatrix.multiplyMatrices(D.matrixWorldInverse,p.matrixWorld),p._normalMatrix.getNormalMatrix(p._modelViewMatrix),p=v.object.material,p.transparent?(v.transparent=p,v.opaque=null):(v.opaque=p,v.transparent=null))}E.overrideMaterial?(B=E.overrideMaterial,this.setBlending(B.blending,B.blendEquation,B.blendSrc,B.blendDst),this.setDepthTest(B.depthTest),this.setDepthWrite(B.depthWrite),bi(B.polygonOffset,B.polygonOffsetFactor,B.polygonOffsetUnits),aA(E.__webglObjects,!1,"",D,m,l,!0,B),av(E.__webglObjectsImmediate,"",D,m,l,!1,B)):(B=null,this.setBlending(THREE.NoBlending),aA(E.__webglObjects,!0,"opaque",D,m,l,!1,B),av(E.__webglObjectsImmediate,"opaque",D,m,l,!1,B),aA(E.__webglObjects,!1,"transparent",D,m,l,!0,B),av(E.__webglObjectsImmediate,"transparent",D,m,l,!0,B));az(this.renderPluginsPost,E,D);C&&(C.generateMipmaps&&C.minFilter!==THREE.NearestFilter&&C.minFilter!==THREE.LinearFilter)&&(C instanceof THREE.WebGLRenderTargetCube?(aC.bindTexture(aC.TEXTURE_CUBE_MAP,C.__webglTexture),aC.generateMipmap(aC.TEXTURE_CUBE_MAP),aC.bindTexture(aC.TEXTURE_CUBE_MAP,null)):(aC.bindTexture(aC.TEXTURE_2D,C.__webglTexture),aC.generateMipmap(aC.TEXTURE_2D),aC.bindTexture(aC.TEXTURE_2D,null)));this.setDepthTest(!0);this.setDepthWrite(!0)}};this.renderImmediateObject=function(h,g,l,k,j){var i=aj(h,g,l,k,j);bu=-1;a4.setMaterialFaces(k);j.immediateRenderCallback?j.immediateRenderCallback(i,aC,bF):j.render(function(b){a4.renderBufferImmediate(b,i,k)})};this.initWebGLObjects=function(de){de.__webglObjects||(de.__webglObjects=[],de.__webglObjectsImmediate=[],de.__webglSprites=[],de.__webglFlares=[]);for(;de.__objectsAdded.length;){aq(de.__objectsAdded[0],de),de.__objectsAdded.splice(0,1)}for(;de.__objectsRemoved.length;){at(de.__objectsRemoved[0],de),de.__objectsRemoved.splice(0,1)}for(var dd=0,c6=de.__webglObjects.length;dd<c6;dd++){var c8=de.__webglObjects[dd].object;void 0===c8.__webglInit&&(void 0!==c8.__webglActive&&at(c8,de),aq(c8,de));var c5=c8,c4=c5.geometry,c3=void 0,c2=void 0,cZ=void 0;if(c4 instanceof THREE.BufferGeometry){var cY=aC.DYNAMIC_DRAW,cW=!c4.dynamic,cS=c4.attributes,cU=void 0,cV=void 0;for(cU in cS){cV=cS[cU],cV.needsUpdate&&("index"===cU?(aC.bindBuffer(aC.ELEMENT_ARRAY_BUFFER,cV.buffer),aC.bufferData(aC.ELEMENT_ARRAY_BUFFER,cV.array,cY)):(aC.bindBuffer(aC.ARRAY_BUFFER,cV.buffer),aC.bufferData(aC.ARRAY_BUFFER,cV.array,cY)),cV.needsUpdate=!1),cW&&!cV.dynamic&&(cV.array=null)}}else{if(c5 instanceof THREE.Mesh){for(var dP=0,dO=c4.geometryGroupsList.length;dP<dO;dP++){if(c3=c4.geometryGroupsList[dP],cZ=aL(c5,c3),c4.buffersNeedUpdate&&aN(c3,c5),c2=cZ.attributes&&ax(cZ),c4.verticesNeedUpdate||c4.morphTargetsNeedUpdate||c4.elementsNeedUpdate||c4.uvsNeedUpdate||c4.normalsNeedUpdate||c4.colorsNeedUpdate||c4.tangentsNeedUpdate||c2){var cX=c3,dN=c5,dM=aC.DYNAMIC_DRAW,dK=!c4.dynamic,dI=cZ;if(cX.__inittedArrays){var dD=aK(dI),dC=dI.vertexColors?dI.vertexColors:!1,dz=aJ(dI),dy=dD===THREE.SmoothShading,dL=void 0,dE=void 0,dp=void 0,dA=void 0,du=void 0,dq=void 0,dw=void 0,cN=void 0,dk=void 0,d4=void 0,q=void 0,dx=void 0,dm=void 0,dn=void 0,cl=void 0,cF=void 0,cu=void 0,dJ=void 0,dc=void 0,b3=void 0,cx=void 0,cn=void 0,bL=void 0,d=void 0,dj=void 0,cT=void 0,cj=void 0,b7=void 0,bY=void 0,b9=void 0,b1=void 0,ei=void 0,bS=void 0,cH=void 0,f=void 0,d6=void 0,bP=void 0,k=void 0,bW=void 0,bN=void 0,cM=0,cE=0,ch=0,b5=0,dY=0,ce=0,ee=0,ci=0,cs=0,cJ=0,eg=0,dB=0,cp=void 0,b2=cX.__vertexArray,dH=cX.__uvArray,c9=cX.__uv2Array,cz=cX.__normalArray,dv=cX.__tangentArray,bT=cX.__colorArray,c1=cX.__skinIndexArray,cL=cX.__skinWeightArray,cw=cX.__morphTargetsArrays,cq=cX.__morphNormalsArrays,cR=cX.__webglCustomAttributesList,dG=void 0,b4=cX.__faceArray,bX=cX.__lineArray,dU=dN.geometry,ck=dU.elementsNeedUpdate,ef=dU.uvsNeedUpdate,bZ=dU.normalsNeedUpdate,cy=dU.tangentsNeedUpdate,co=dU.colorsNeedUpdate,cg=dU.morphTargetsNeedUpdate,cD=dU.vertices,d3=cX.faces3,s=dU.faces,b8=dU.faceVertexUvs[0],bQ=dU.faceVertexUvs[1],cv=dU.skinIndices,bV=dU.skinWeights,bM=dU.morphTargets,n=dU.morphNormals;if(dU.verticesNeedUpdate){dL=0;for(dE=d3.length;dL<dE;dL++){dA=s[d3[dL]],dx=cD[dA.a],dm=cD[dA.b],dn=cD[dA.c],b2[cE]=dx.x,b2[cE+1]=dx.y,b2[cE+2]=dx.z,b2[cE+3]=dm.x,b2[cE+4]=dm.y,b2[cE+5]=dm.z,b2[cE+6]=dn.x,b2[cE+7]=dn.y,b2[cE+8]=dn.z,cE+=9}aC.bindBuffer(aC.ARRAY_BUFFER,cX.__webglVertexBuffer);aC.bufferData(aC.ARRAY_BUFFER,b2,dM)}if(cg){f=0;for(d6=bM.length;f<d6;f++){dL=eg=0;for(dE=d3.length;dL<dE;dL++){bW=d3[dL],dA=s[bW],dx=bM[f].vertices[dA.a],dm=bM[f].vertices[dA.b],dn=bM[f].vertices[dA.c],bP=cw[f],bP[eg]=dx.x,bP[eg+1]=dx.y,bP[eg+2]=dx.z,bP[eg+3]=dm.x,bP[eg+4]=dm.y,bP[eg+5]=dm.z,bP[eg+6]=dn.x,bP[eg+7]=dn.y,bP[eg+8]=dn.z,dI.morphNormals&&(dy?(bN=n[f].vertexNormals[bW],dJ=bN.a,dc=bN.b,b3=bN.c):b3=dc=dJ=n[f].faceNormals[bW],k=cq[f],k[eg]=dJ.x,k[eg+1]=dJ.y,k[eg+2]=dJ.z,k[eg+3]=dc.x,k[eg+4]=dc.y,k[eg+5]=dc.z,k[eg+6]=b3.x,k[eg+7]=b3.y,k[eg+8]=b3.z),eg+=9}aC.bindBuffer(aC.ARRAY_BUFFER,cX.__webglMorphTargetsBuffers[f]);aC.bufferData(aC.ARRAY_BUFFER,cw[f],dM);dI.morphNormals&&(aC.bindBuffer(aC.ARRAY_BUFFER,cX.__webglMorphNormalsBuffers[f]),aC.bufferData(aC.ARRAY_BUFFER,cq[f],dM))}}if(bV.length){dL=0;for(dE=d3.length;dL<dE;dL++){dA=s[d3[dL]],d=bV[dA.a],dj=bV[dA.b],cT=bV[dA.c],cL[cJ]=d.x,cL[cJ+1]=d.y,cL[cJ+2]=d.z,cL[cJ+3]=d.w,cL[cJ+4]=dj.x,cL[cJ+5]=dj.y,cL[cJ+6]=dj.z,cL[cJ+7]=dj.w,cL[cJ+8]=cT.x,cL[cJ+9]=cT.y,cL[cJ+10]=cT.z,cL[cJ+11]=cT.w,cj=cv[dA.a],b7=cv[dA.b],bY=cv[dA.c],c1[cJ]=cj.x,c1[cJ+1]=cj.y,c1[cJ+2]=cj.z,c1[cJ+3]=cj.w,c1[cJ+4]=b7.x,c1[cJ+5]=b7.y,c1[cJ+6]=b7.z,c1[cJ+7]=b7.w,c1[cJ+8]=bY.x,c1[cJ+9]=bY.y,c1[cJ+10]=bY.z,c1[cJ+11]=bY.w,cJ+=12}0<cJ&&(aC.bindBuffer(aC.ARRAY_BUFFER,cX.__webglSkinIndicesBuffer),aC.bufferData(aC.ARRAY_BUFFER,c1,dM),aC.bindBuffer(aC.ARRAY_BUFFER,cX.__webglSkinWeightsBuffer),aC.bufferData(aC.ARRAY_BUFFER,cL,dM))}if(co&&dC){dL=0;for(dE=d3.length;dL<dE;dL++){dA=s[d3[dL]],dw=dA.vertexColors,cN=dA.color,3===dw.length&&dC===THREE.VertexColors?(cx=dw[0],cn=dw[1],bL=dw[2]):bL=cn=cx=cN,bT[cs]=cx.r,bT[cs+1]=cx.g,bT[cs+2]=cx.b,bT[cs+3]=cn.r,bT[cs+4]=cn.g,bT[cs+5]=cn.b,bT[cs+6]=bL.r,bT[cs+7]=bL.g,bT[cs+8]=bL.b,cs+=9}0<cs&&(aC.bindBuffer(aC.ARRAY_BUFFER,cX.__webglColorBuffer),aC.bufferData(aC.ARRAY_BUFFER,bT,dM))}if(cy&&dU.hasTangents){dL=0;for(dE=d3.length;dL<dE;dL++){dA=s[d3[dL]],dk=dA.vertexTangents,cl=dk[0],cF=dk[1],cu=dk[2],dv[ee]=cl.x,dv[ee+1]=cl.y,dv[ee+2]=cl.z,dv[ee+3]=cl.w,dv[ee+4]=cF.x,dv[ee+5]=cF.y,dv[ee+6]=cF.z,dv[ee+7]=cF.w,dv[ee+8]=cu.x,dv[ee+9]=cu.y,dv[ee+10]=cu.z,dv[ee+11]=cu.w,ee+=12}aC.bindBuffer(aC.ARRAY_BUFFER,cX.__webglTangentBuffer);aC.bufferData(aC.ARRAY_BUFFER,dv,dM)}if(bZ&&dD){dL=0;for(dE=d3.length;dL<dE;dL++){if(dA=s[d3[dL]],du=dA.vertexNormals,dq=dA.normal,3===du.length&&dy){for(b9=0;3>b9;b9++){ei=du[b9],cz[ce]=ei.x,cz[ce+1]=ei.y,cz[ce+2]=ei.z,ce+=3}}else{for(b9=0;3>b9;b9++){cz[ce]=dq.x,cz[ce+1]=dq.y,cz[ce+2]=dq.z,ce+=3}}}aC.bindBuffer(aC.ARRAY_BUFFER,cX.__webglNormalBuffer);aC.bufferData(aC.ARRAY_BUFFER,cz,dM)}if(ef&&b8&&dz){dL=0;for(dE=d3.length;dL<dE;dL++){if(dp=d3[dL],d4=b8[dp],void 0!==d4){for(b9=0;3>b9;b9++){bS=d4[b9],dH[ch]=bS.x,dH[ch+1]=bS.y,ch+=2}}}0<ch&&(aC.bindBuffer(aC.ARRAY_BUFFER,cX.__webglUVBuffer),aC.bufferData(aC.ARRAY_BUFFER,dH,dM))}if(ef&&bQ&&dz){dL=0;for(dE=d3.length;dL<dE;dL++){if(dp=d3[dL],q=bQ[dp],void 0!==q){for(b9=0;3>b9;b9++){cH=q[b9],c9[b5]=cH.x,c9[b5+1]=cH.y,b5+=2}}}0<b5&&(aC.bindBuffer(aC.ARRAY_BUFFER,cX.__webglUV2Buffer),aC.bufferData(aC.ARRAY_BUFFER,c9,dM))}if(ck){dL=0;for(dE=d3.length;dL<dE;dL++){b4[dY]=cM,b4[dY+1]=cM+1,b4[dY+2]=cM+2,dY+=3,bX[ci]=cM,bX[ci+1]=cM+1,bX[ci+2]=cM,bX[ci+3]=cM+2,bX[ci+4]=cM+1,bX[ci+5]=cM+2,ci+=6,cM+=3}aC.bindBuffer(aC.ELEMENT_ARRAY_BUFFER,cX.__webglFaceBuffer);aC.bufferData(aC.ELEMENT_ARRAY_BUFFER,b4,dM);aC.bindBuffer(aC.ELEMENT_ARRAY_BUFFER,cX.__webglLineBuffer);aC.bufferData(aC.ELEMENT_ARRAY_BUFFER,bX,dM)}if(cR){b9=0;for(b1=cR.length;b9<b1;b9++){if(dG=cR[b9],dG.__original.needsUpdate){dB=0;if(1===dG.size){if(void 0===dG.boundTo||"vertices"===dG.boundTo){dL=0;for(dE=d3.length;dL<dE;dL++){dA=s[d3[dL]],dG.array[dB]=dG.value[dA.a],dG.array[dB+1]=dG.value[dA.b],dG.array[dB+2]=dG.value[dA.c],dB+=3}}else{if("faces"===dG.boundTo){dL=0;for(dE=d3.length;dL<dE;dL++){cp=dG.value[d3[dL]],dG.array[dB]=cp,dG.array[dB+1]=cp,dG.array[dB+2]=cp,dB+=3}}}}else{if(2===dG.size){if(void 0===dG.boundTo||"vertices"===dG.boundTo){dL=0;for(dE=d3.length;dL<dE;dL++){dA=s[d3[dL]],dx=dG.value[dA.a],dm=dG.value[dA.b],dn=dG.value[dA.c],dG.array[dB]=dx.x,dG.array[dB+1]=dx.y,dG.array[dB+2]=dm.x,dG.array[dB+3]=dm.y,dG.array[dB+4]=dn.x,dG.array[dB+5]=dn.y,dB+=6}}else{if("faces"===dG.boundTo){dL=0;for(dE=d3.length;dL<dE;dL++){dn=dm=dx=cp=dG.value[d3[dL]],dG.array[dB]=dx.x,dG.array[dB+1]=dx.y,dG.array[dB+2]=dm.x,dG.array[dB+3]=dm.y,dG.array[dB+4]=dn.x,dG.array[dB+5]=dn.y,dB+=6}}}}else{if(3===dG.size){var dW;dW="c"===dG.type?["r","g","b"]:["x","y","z"];if(void 0===dG.boundTo||"vertices"===dG.boundTo){dL=0;for(dE=d3.length;dL<dE;dL++){dA=s[d3[dL]],dx=dG.value[dA.a],dm=dG.value[dA.b],dn=dG.value[dA.c],dG.array[dB]=dx[dW[0]],dG.array[dB+1]=dx[dW[1]],dG.array[dB+2]=dx[dW[2]],dG.array[dB+3]=dm[dW[0]],dG.array[dB+4]=dm[dW[1]],dG.array[dB+5]=dm[dW[2]],dG.array[dB+6]=dn[dW[0]],dG.array[dB+7]=dn[dW[1]],dG.array[dB+8]=dn[dW[2]],dB+=9}}else{if("faces"===dG.boundTo){dL=0;for(dE=d3.length;dL<dE;dL++){dn=dm=dx=cp=dG.value[d3[dL]],dG.array[dB]=dx[dW[0]],dG.array[dB+1]=dx[dW[1]],dG.array[dB+2]=dx[dW[2]],dG.array[dB+3]=dm[dW[0]],dG.array[dB+4]=dm[dW[1]],dG.array[dB+5]=dm[dW[2]],dG.array[dB+6]=dn[dW[0]],dG.array[dB+7]=dn[dW[1]],dG.array[dB+8]=dn[dW[2]],dB+=9}}else{if("faceVertices"===dG.boundTo){dL=0;for(dE=d3.length;dL<dE;dL++){cp=dG.value[d3[dL]],dx=cp[0],dm=cp[1],dn=cp[2],dG.array[dB]=dx[dW[0]],dG.array[dB+1]=dx[dW[1]],dG.array[dB+2]=dx[dW[2]],dG.array[dB+3]=dm[dW[0]],dG.array[dB+4]=dm[dW[1]],dG.array[dB+5]=dm[dW[2]],dG.array[dB+6]=dn[dW[0]],dG.array[dB+7]=dn[dW[1]],dG.array[dB+8]=dn[dW[2]],dB+=9}}}}}else{if(4===dG.size){if(void 0===dG.boundTo||"vertices"===dG.boundTo){dL=0;for(dE=d3.length;dL<dE;dL++){dA=s[d3[dL]],dx=dG.value[dA.a],dm=dG.value[dA.b],dn=dG.value[dA.c],dG.array[dB]=dx.x,dG.array[dB+1]=dx.y,dG.array[dB+2]=dx.z,dG.array[dB+3]=dx.w,dG.array[dB+4]=dm.x,dG.array[dB+5]=dm.y,dG.array[dB+6]=dm.z,dG.array[dB+7]=dm.w,dG.array[dB+8]=dn.x,dG.array[dB+9]=dn.y,dG.array[dB+10]=dn.z,dG.array[dB+11]=dn.w,dB+=12}}else{if("faces"===dG.boundTo){dL=0;for(dE=d3.length;dL<dE;dL++){dn=dm=dx=cp=dG.value[d3[dL]],dG.array[dB]=dx.x,dG.array[dB+1]=dx.y,dG.array[dB+2]=dx.z,dG.array[dB+3]=dx.w,dG.array[dB+4]=dm.x,dG.array[dB+5]=dm.y,dG.array[dB+6]=dm.z,dG.array[dB+7]=dm.w,dG.array[dB+8]=dn.x,dG.array[dB+9]=dn.y,dG.array[dB+10]=dn.z,dG.array[dB+11]=dn.w,dB+=12}}else{if("faceVertices"===dG.boundTo){dL=0;for(dE=d3.length;dL<dE;dL++){cp=dG.value[d3[dL]],dx=cp[0],dm=cp[1],dn=cp[2],dG.array[dB]=dx.x,dG.array[dB+1]=dx.y,dG.array[dB+2]=dx.z,dG.array[dB+3]=dx.w,dG.array[dB+4]=dm.x,dG.array[dB+5]=dm.y,dG.array[dB+6]=dm.z,dG.array[dB+7]=dm.w,dG.array[dB+8]=dn.x,dG.array[dB+9]=dn.y,dG.array[dB+10]=dn.z,dG.array[dB+11]=dn.w,dB+=12}}}}}}}}aC.bindBuffer(aC.ARRAY_BUFFER,dG.buffer);aC.bufferData(aC.ARRAY_BUFFER,dG.array,dM)}}}dK&&(delete cX.__inittedArrays,delete cX.__colorArray,delete cX.__normalArray,delete cX.__tangentArray,delete cX.__uvArray,delete cX.__uv2Array,delete cX.__faceArray,delete cX.__vertexArray,delete cX.__lineArray,delete cX.__skinIndexArray,delete cX.__skinWeightArray)}}}c4.verticesNeedUpdate=!1;c4.morphTargetsNeedUpdate=!1;c4.elementsNeedUpdate=!1;c4.uvsNeedUpdate=!1;c4.normalsNeedUpdate=!1;c4.colorsNeedUpdate=!1;c4.tangentsNeedUpdate=!1;c4.buffersNeedUpdate=!1;cZ.attributes&&ar(cZ)}else{if(c5 instanceof THREE.Line){cZ=aL(c5,c4);c2=cZ.attributes&&ax(cZ);if(c4.verticesNeedUpdate||c4.colorsNeedUpdate||c4.lineDistancesNeedUpdate||c2){var cC=c4,e=aC.DYNAMIC_DRAW,dS=void 0,df=void 0,cO=void 0,ed=void 0,d9=void 0,dX=void 0,eh=cC.vertices,d5=cC.colors,r=cC.lineDistances,cr=eh.length,dQ=d5.length,d1=r.length,dt=cC.__vertexArray,c0=cC.__colorArray,ej=cC.__lineDistanceArray,dF=cC.colorsNeedUpdate,c7=cC.lineDistancesNeedUpdate,cm=cC.__webglCustomAttributesList,cK=void 0,d7=void 0,d0=void 0,dZ=void 0,dh=void 0,bU=void 0;if(cC.verticesNeedUpdate){for(dS=0;dS<cr;dS++){ed=eh[dS],d9=3*dS,dt[d9]=ed.x,dt[d9+1]=ed.y,dt[d9+2]=ed.z}aC.bindBuffer(aC.ARRAY_BUFFER,cC.__webglVertexBuffer);aC.bufferData(aC.ARRAY_BUFFER,dt,e)}if(dF){for(df=0;df<dQ;df++){dX=d5[df],d9=3*df,c0[d9]=dX.r,c0[d9+1]=dX.g,c0[d9+2]=dX.b}aC.bindBuffer(aC.ARRAY_BUFFER,cC.__webglColorBuffer);aC.bufferData(aC.ARRAY_BUFFER,c0,e)}if(c7){for(cO=0;cO<d1;cO++){ej[cO]=r[cO]}aC.bindBuffer(aC.ARRAY_BUFFER,cC.__webglLineDistanceBuffer);aC.bufferData(aC.ARRAY_BUFFER,ej,e)}if(cm){cK=0;for(d7=cm.length;cK<d7;cK++){if(bU=cm[cK],bU.needsUpdate&&(void 0===bU.boundTo||"vertices"===bU.boundTo)){d9=0;dZ=bU.value.length;if(1===bU.size){for(d0=0;d0<dZ;d0++){bU.array[d0]=bU.value[d0]}}else{if(2===bU.size){for(d0=0;d0<dZ;d0++){dh=bU.value[d0],bU.array[d9]=dh.x,bU.array[d9+1]=dh.y,d9+=2}}else{if(3===bU.size){if("c"===bU.type){for(d0=0;d0<dZ;d0++){dh=bU.value[d0],bU.array[d9]=dh.r,bU.array[d9+1]=dh.g,bU.array[d9+2]=dh.b,d9+=3}}else{for(d0=0;d0<dZ;d0++){dh=bU.value[d0],bU.array[d9]=dh.x,bU.array[d9+1]=dh.y,bU.array[d9+2]=dh.z,d9+=3}}}else{if(4===bU.size){for(d0=0;d0<dZ;d0++){dh=bU.value[d0],bU.array[d9]=dh.x,bU.array[d9+1]=dh.y,bU.array[d9+2]=dh.z,bU.array[d9+3]=dh.w,d9+=4}}}}}aC.bindBuffer(aC.ARRAY_BUFFER,bU.buffer);aC.bufferData(aC.ARRAY_BUFFER,bU.array,e)}}}}c4.verticesNeedUpdate=!1;c4.colorsNeedUpdate=!1;c4.lineDistancesNeedUpdate=!1;cZ.attributes&&ar(cZ)}else{if(c5 instanceof THREE.ParticleSystem){cZ=aL(c5,c4);c2=cZ.attributes&&ax(cZ);if(c4.verticesNeedUpdate||c4.colorsNeedUpdate||c5.sortParticles||c2){var c=c4,cd=aC.DYNAMIC_DRAW,cG=c5,cQ=void 0,d8=void 0,dV=void 0,dr=void 0,di=void 0,b6=void 0,cB=c.vertices,b0=cB.length,bR=c.colors,dT=bR.length,bO=c.__vertexArray,j=c.__colorArray,cI=c.__sortArray,dg=c.verticesNeedUpdate,cP=c.colorsNeedUpdate,cA=c.__webglCustomAttributesList,dR=void 0,ct=void 0,dl=void 0,d2=void 0,cf=void 0,ds=void 0;if(cG.sortParticles){bo.copy(bJ);bo.multiply(cG.matrixWorld);for(cQ=0;cQ<b0;cQ++){dV=cB[cQ],by.copy(dV),by.applyProjection(bo),cI[cQ]=[by.z,cQ]}cI.sort(aB);for(cQ=0;cQ<b0;cQ++){dV=cB[cI[cQ][1]],dr=3*cQ,bO[dr]=dV.x,bO[dr+1]=dV.y,bO[dr+2]=dV.z}for(d8=0;d8<dT;d8++){dr=3*d8,b6=bR[cI[d8][1]],j[dr]=b6.r,j[dr+1]=b6.g,j[dr+2]=b6.b}if(cA){dR=0;for(ct=cA.length;dR<ct;dR++){if(ds=cA[dR],void 0===ds.boundTo||"vertices"===ds.boundTo){if(dr=0,d2=ds.value.length,1===ds.size){for(dl=0;dl<d2;dl++){di=cI[dl][1],ds.array[dl]=ds.value[di]}}else{if(2===ds.size){for(dl=0;dl<d2;dl++){di=cI[dl][1],cf=ds.value[di],ds.array[dr]=cf.x,ds.array[dr+1]=cf.y,dr+=2}}else{if(3===ds.size){if("c"===ds.type){for(dl=0;dl<d2;dl++){di=cI[dl][1],cf=ds.value[di],ds.array[dr]=cf.r,ds.array[dr+1]=cf.g,ds.array[dr+2]=cf.b,dr+=3}}else{for(dl=0;dl<d2;dl++){di=cI[dl][1],cf=ds.value[di],ds.array[dr]=cf.x,ds.array[dr+1]=cf.y,ds.array[dr+2]=cf.z,dr+=3}}}else{if(4===ds.size){for(dl=0;dl<d2;dl++){di=cI[dl][1],cf=ds.value[di],ds.array[dr]=cf.x,ds.array[dr+1]=cf.y,ds.array[dr+2]=cf.z,ds.array[dr+3]=cf.w,dr+=4}}}}}}}}}else{if(dg){for(cQ=0;cQ<b0;cQ++){dV=cB[cQ],dr=3*cQ,bO[dr]=dV.x,bO[dr+1]=dV.y,bO[dr+2]=dV.z}}if(cP){for(d8=0;d8<dT;d8++){b6=bR[d8],dr=3*d8,j[dr]=b6.r,j[dr+1]=b6.g,j[dr+2]=b6.b}}if(cA){dR=0;for(ct=cA.length;dR<ct;dR++){if(ds=cA[dR],ds.needsUpdate&&(void 0===ds.boundTo||"vertices"===ds.boundTo)){if(d2=ds.value.length,dr=0,1===ds.size){for(dl=0;dl<d2;dl++){ds.array[dl]=ds.value[dl]}}else{if(2===ds.size){for(dl=0;dl<d2;dl++){cf=ds.value[dl],ds.array[dr]=cf.x,ds.array[dr+1]=cf.y,dr+=2}}else{if(3===ds.size){if("c"===ds.type){for(dl=0;dl<d2;dl++){cf=ds.value[dl],ds.array[dr]=cf.r,ds.array[dr+1]=cf.g,ds.array[dr+2]=cf.b,dr+=3}}else{for(dl=0;dl<d2;dl++){cf=ds.value[dl],ds.array[dr]=cf.x,ds.array[dr+1]=cf.y,ds.array[dr+2]=cf.z,dr+=3}}}else{if(4===ds.size){for(dl=0;dl<d2;dl++){cf=ds.value[dl],ds.array[dr]=cf.x,ds.array[dr+1]=cf.y,ds.array[dr+2]=cf.z,ds.array[dr+3]=cf.w,dr+=4}}}}}}}}}if(dg||cG.sortParticles){aC.bindBuffer(aC.ARRAY_BUFFER,c.__webglVertexBuffer),aC.bufferData(aC.ARRAY_BUFFER,bO,cd)}if(cP||cG.sortParticles){aC.bindBuffer(aC.ARRAY_BUFFER,c.__webglColorBuffer),aC.bufferData(aC.ARRAY_BUFFER,j,cd)}if(cA){dR=0;for(ct=cA.length;dR<ct;dR++){if(ds=cA[dR],ds.needsUpdate||cG.sortParticles){aC.bindBuffer(aC.ARRAY_BUFFER,ds.buffer),aC.bufferData(aC.ARRAY_BUFFER,ds.array,cd)}}}}c4.verticesNeedUpdate=!1;c4.colorsNeedUpdate=!1;cZ.attributes&&ar(cZ)}}}}}};this.initMaterial=function(ac,Z,V,U){var R,Q,O,P;ac.addEventListener("dispose",L);var N,M,K,J,G;ac instanceof THREE.MeshDepthMaterial?G="depth":ac instanceof THREE.MeshNormalMaterial?G="normal":ac instanceof THREE.MeshBasicMaterial?G="basic":ac instanceof THREE.MeshLambertMaterial?G="lambert":ac instanceof THREE.MeshPhongMaterial?G="phong":ac instanceof THREE.LineBasicMaterial?G="basic":ac instanceof THREE.LineDashedMaterial?G="dashed":ac instanceof THREE.ParticleSystemMaterial&&(G="particle_basic");if(G){var I=THREE.ShaderLib[G];ac.uniforms=THREE.UniformsUtils.clone(I.uniforms);ac.vertexShader=I.vertexShader;ac.fragmentShader=I.fragmentShader}var F=R=0,E=0,C=I=0;for(Q=Z.length;C<Q;C++){O=Z[C],O.onlyShadow||(O instanceof THREE.DirectionalLight&&R++,O instanceof THREE.PointLight&&F++,O instanceof THREE.SpotLight&&E++,O instanceof THREE.HemisphereLight&&I++)}Q=F;O=E;P=I;E=I=0;for(F=Z.length;E<F;E++){C=Z[E],C.castShadow&&(C instanceof THREE.SpotLight&&I++,C instanceof THREE.DirectionalLight&&!C.shadowCascade&&I++)}J=I;bz&&U&&U.useVertexTexture?K=1024:(Z=aC.getParameter(aC.MAX_VERTEX_UNIFORM_VECTORS),Z=Math.floor((Z-20)/4),void 0!==U&&U instanceof THREE.SkinnedMesh&&(Z=Math.min(U.bones.length,Z),Z<U.bones.length&&console.warn("WebGLRenderer: too many bones - "+U.bones.length+", this GPU supports just "+Z+" (try OpenGL instead of ANGLE)")),K=Z);ac:{var E=ac.fragmentShader,F=ac.vertexShader,I=ac.uniforms,Z=ac.attributes,C=ac.defines,V={map:!!ac.map,envMap:!!ac.envMap,lightMap:!!ac.lightMap,bumpMap:!!ac.bumpMap,normalMap:!!ac.normalMap,specularMap:!!ac.specularMap,vertexColors:ac.vertexColors,fog:V,useFog:ac.fog,fogExp:V instanceof THREE.FogExp2,sizeAttenuation:ac.sizeAttenuation,skinning:ac.skinning,maxBones:K,useVertexTexture:bz&&U&&U.useVertexTexture,morphTargets:ac.morphTargets,morphNormals:ac.morphNormals,maxMorphTargets:this.maxMorphTargets,maxMorphNormals:this.maxMorphNormals,maxDirLights:R,maxPointLights:Q,maxSpotLights:O,maxHemiLights:P,maxShadows:J,shadowMapEnabled:this.shadowMapEnabled&&U.receiveShadow,shadowMapType:this.shadowMapType,shadowMapDebug:this.shadowMapDebug,shadowMapCascade:this.shadowMapCascade,alphaTest:ac.alphaTest,metal:ac.metal,perPixel:ac.perPixel,wrapAround:ac.wrapAround,doubleSided:ac.side===THREE.DoubleSide,flipSided:ac.side===THREE.BackSide},U=ac.index0AttributeName,D,B,j;R=[];G?R.push(G):(R.push(E),R.push(F));for(B in C){R.push(B),R.push(C[B])}for(D in V){R.push(D),R.push(V[D])}G=R.join();D=0;for(B=ay.length;D<B;D++){if(R=ay[D],R.code===G){R.usedTimes++;M=R.program;break ac}}D="SHADOWMAP_TYPE_BASIC";V.shadowMapType===THREE.PCFShadowMap?D="SHADOWMAP_TYPE_PCF":V.shadowMapType===THREE.PCFSoftShadowMap&&(D="SHADOWMAP_TYPE_PCF_SOFT");B=[];for(j in C){R=C[j],!1!==R&&(R="#define "+j+" "+R,B.push(R))}R=B.join("\n");j=aC.createProgram();B=["precision "+aV+" float;","precision "+aV+" int;",R,bp?"#define VERTEX_TEXTURES":"",a4.gammaInput?"#define GAMMA_INPUT":"",a4.gammaOutput?"#define GAMMA_OUTPUT":"",a4.physicallyBasedShading?"#define PHYSICALLY_BASED_SHADING":"","#define MAX_DIR_LIGHTS "+V.maxDirLights,"#define MAX_POINT_LIGHTS "+V.maxPointLights,"#define MAX_SPOT_LIGHTS "+V.maxSpotLights,"#define MAX_HEMI_LIGHTS "+V.maxHemiLights,"#define MAX_SHADOWS "+V.maxShadows,"#define MAX_BONES "+V.maxBones,V.map?"#define USE_MAP":"",V.envMap?"#define USE_ENVMAP":"",V.lightMap?"#define USE_LIGHTMAP":"",V.bumpMap?"#define USE_BUMPMAP":"",V.normalMap?"#define USE_NORMALMAP":"",V.specularMap?"#define USE_SPECULARMAP":"",V.vertexColors?"#define USE_COLOR":"",V.skinning?"#define USE_SKINNING":"",V.useVertexTexture?"#define BONE_TEXTURE":"",V.morphTargets?"#define USE_MORPHTARGETS":"",V.morphNormals?"#define USE_MORPHNORMALS":"",V.perPixel?"#define PHONG_PER_PIXEL":"",V.wrapAround?"#define WRAP_AROUND":"",V.doubleSided?"#define DOUBLE_SIDED":"",V.flipSided?"#define FLIP_SIDED":"",V.shadowMapEnabled?"#define USE_SHADOWMAP":"",V.shadowMapEnabled?"#define "+D:"",V.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",V.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",V.sizeAttenuation?"#define USE_SIZEATTENUATION":"","uniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\nattribute vec2 uv2;\n#ifdef USE_COLOR\nattribute vec3 color;\n#endif\n#ifdef USE_MORPHTARGETS\nattribute vec3 morphTarget0;\nattribute vec3 morphTarget1;\nattribute vec3 morphTarget2;\nattribute vec3 morphTarget3;\n#ifdef USE_MORPHNORMALS\nattribute vec3 morphNormal0;\nattribute vec3 morphNormal1;\nattribute vec3 morphNormal2;\nattribute vec3 morphNormal3;\n#else\nattribute vec3 morphTarget4;\nattribute vec3 morphTarget5;\nattribute vec3 morphTarget6;\nattribute vec3 morphTarget7;\n#endif\n#endif\n#ifdef USE_SKINNING\nattribute vec4 skinIndex;\nattribute vec4 skinWeight;\n#endif\n"].join("\n");D=["precision "+aV+" float;","precision "+aV+" int;",V.bumpMap||V.normalMap?"#extension GL_OES_standard_derivatives : enable":"",R,"#define MAX_DIR_LIGHTS "+V.maxDirLights,"#define MAX_POINT_LIGHTS "+V.maxPointLights,"#define MAX_SPOT_LIGHTS "+V.maxSpotLights,"#define MAX_HEMI_LIGHTS "+V.maxHemiLights,"#define MAX_SHADOWS "+V.maxShadows,V.alphaTest?"#define ALPHATEST "+V.alphaTest:"",a4.gammaInput?"#define GAMMA_INPUT":"",a4.gammaOutput?"#define GAMMA_OUTPUT":"",a4.physicallyBasedShading?"#define PHYSICALLY_BASED_SHADING":"",V.useFog&&V.fog?"#define USE_FOG":"",V.useFog&&V.fogExp?"#define FOG_EXP2":"",V.map?"#define USE_MAP":"",V.envMap?"#define USE_ENVMAP":"",V.lightMap?"#define USE_LIGHTMAP":"",V.bumpMap?"#define USE_BUMPMAP":"",V.normalMap?"#define USE_NORMALMAP":"",V.specularMap?"#define USE_SPECULARMAP":"",V.vertexColors?"#define USE_COLOR":"",V.metal?"#define METAL":"",V.perPixel?"#define PHONG_PER_PIXEL":"",V.wrapAround?"#define WRAP_AROUND":"",V.doubleSided?"#define DOUBLE_SIDED":"",V.flipSided?"#define FLIP_SIDED":"",V.shadowMapEnabled?"#define USE_SHADOWMAP":"",V.shadowMapEnabled?"#define "+D:"",V.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",V.shadowMapCascade?"#define SHADOWMAP_CASCADE":"","uniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\n"].join("\n");B=bg("vertex",B+F);D=bg("fragment",D+E);aC.attachShader(j,B);aC.attachShader(j,D);U&&aC.bindAttribLocation(j,0,U);aC.linkProgram(j);aC.getProgramParameter(j,aC.LINK_STATUS)||(console.error("Could not initialise shader\nVALIDATE_STATUS: "+aC.getProgramParameter(j,aC.VALIDATE_STATUS)+", gl error ["+aC.getError()+"]"),console.error("Program Info Log: "+aC.getProgramInfoLog(j)));aC.deleteShader(D);aC.deleteShader(B);j.uniforms={};j.attributes={};var A;D="viewMatrix modelViewMatrix projectionMatrix normalMatrix modelMatrix cameraPosition morphTargetInfluences".split(" ");V.useVertexTexture?(D.push("boneTexture"),D.push("boneTextureWidth"),D.push("boneTextureHeight")):D.push("boneGlobalMatrices");for(A in I){D.push(A)}A=D;D=0;for(B=A.length;D<B;D++){I=A[D],j.uniforms[I]=aC.getUniformLocation(j,I)}D="position normal uv uv2 tangent color skinIndex skinWeight lineDistance".split(" ");for(A=0;A<V.maxMorphTargets;A++){D.push("morphTarget"+A)}for(A=0;A<V.maxMorphNormals;A++){D.push("morphNormal"+A)}for(M in Z){D.push(M)}M=D;A=0;for(Z=M.length;A<Z;A++){D=M[A],j.attributes[D]=aC.getAttribLocation(j,D)}j.id=T++;ay.push({program:j,code:G,usedTimes:1});a4.info.memory.programs=ay.length;M=j}ac.program=M;A=ac.program.attributes;if(ac.morphTargets){ac.numSupportedMorphTargets=0;Z="morphTarget";for(M=0;M<this.maxMorphTargets;M++){j=Z+M,0<=A[j]&&ac.numSupportedMorphTargets++}}if(ac.morphNormals){ac.numSupportedMorphNormals=0;Z="morphNormal";for(M=0;M<this.maxMorphNormals;M++){j=Z+M,0<=A[j]&&ac.numSupportedMorphNormals++}}ac.uniformsList=[];for(N in ac.uniforms){ac.uniformsList.push([ac.uniforms[N],N])}};this.setFaceCulling=function(d,c){d===THREE.CullFaceNone?aC.disable(aC.CULL_FACE):(c===THREE.FrontFaceDirectionCW?aC.frontFace(aC.CW):aC.frontFace(aC.CCW),d===THREE.CullFaceBack?aC.cullFace(aC.BACK):d===THREE.CullFaceFront?aC.cullFace(aC.FRONT):aC.cullFace(aC.FRONT_AND_BACK),aC.enable(aC.CULL_FACE))};this.setMaterialFaces=function(d){var c=d.side===THREE.DoubleSide,d=d.side===THREE.BackSide;aS!==c&&(c?aC.disable(aC.CULL_FACE):aC.enable(aC.CULL_FACE),aS=c);aU!==d&&(d?aC.frontFace(aC.CW):aC.frontFace(aC.CCW),aU=d)};this.setDepthTest=function(b){bG!==b&&(b?aC.enable(aC.DEPTH_TEST):aC.disable(aC.DEPTH_TEST),bG=b)};this.setDepthWrite=function(b){bC!==b&&(aC.depthMask(b),bC=b)};this.setBlending=function(f,e,h,g){f!==S&&(f===THREE.NoBlending?aC.disable(aC.BLEND):f===THREE.AdditiveBlending?(aC.enable(aC.BLEND),aC.blendEquation(aC.FUNC_ADD),aC.blendFunc(aC.SRC_ALPHA,aC.ONE)):f===THREE.SubtractiveBlending?(aC.enable(aC.BLEND),aC.blendEquation(aC.FUNC_ADD),aC.blendFunc(aC.ZERO,aC.ONE_MINUS_SRC_COLOR)):f===THREE.MultiplyBlending?(aC.enable(aC.BLEND),aC.blendEquation(aC.FUNC_ADD),aC.blendFunc(aC.ZERO,aC.SRC_COLOR)):f===THREE.CustomBlending?aC.enable(aC.BLEND):(aC.enable(aC.BLEND),aC.blendEquationSeparate(aC.FUNC_ADD,aC.FUNC_ADD),aC.blendFuncSeparate(aC.SRC_ALPHA,aC.ONE_MINUS_SRC_ALPHA,aC.ONE,aC.ONE_MINUS_SRC_ALPHA)),S=f);if(f===THREE.CustomBlending){if(e!==bk&&(aC.blendEquation(an(e)),bk=e),h!==aF||g!==X){aC.blendFunc(an(h),an(g)),aF=h,X=g}}else{X=aF=bk=null}};this.setTexture=function(s,r){if(s.needsUpdate){s.__webglInit||(s.__webglInit=!0,s.addEventListener("dispose",aD),s.__webglTexture=aC.createTexture(),a4.info.memory.textures++);aC.activeTexture(aC.TEXTURE0+r);aC.bindTexture(aC.TEXTURE_2D,s.__webglTexture);aC.pixelStorei(aC.UNPACK_FLIP_Y_WEBGL,s.flipY);aC.pixelStorei(aC.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.premultiplyAlpha);aC.pixelStorei(aC.UNPACK_ALIGNMENT,s.unpackAlignment);var q=s.image,p=0===(q.width&q.width-1)&&0===(q.height&q.height-1),n=an(s.format),m=an(s.type);bd(aC.TEXTURE_2D,s,p);var k=s.mipmaps;if(s instanceof THREE.DataTexture){if(0<k.length&&p){for(var l=0,j=k.length;l<j;l++){q=k[l],aC.texImage2D(aC.TEXTURE_2D,l,n,q.width,q.height,0,n,m,q.data)}s.generateMipmaps=!1}else{aC.texImage2D(aC.TEXTURE_2D,0,n,q.width,q.height,0,n,m,q.data)}}else{if(s instanceof THREE.CompressedTexture){l=0;for(j=k.length;l<j;l++){q=k[l],s.format!==THREE.RGBAFormat?aC.compressedTexImage2D(aC.TEXTURE_2D,l,n,q.width,q.height,0,q.data):aC.texImage2D(aC.TEXTURE_2D,l,n,q.width,q.height,0,n,m,q.data)}}else{if(0<k.length&&p){l=0;for(j=k.length;l<j;l++){q=k[l],aC.texImage2D(aC.TEXTURE_2D,l,n,n,m,q)}s.generateMipmaps=!1}else{aC.texImage2D(aC.TEXTURE_2D,0,n,n,m,s.image)}}}s.generateMipmaps&&p&&aC.generateMipmap(aC.TEXTURE_2D);s.needsUpdate=!1;if(s.onUpdate){s.onUpdate()}}else{aC.activeTexture(aC.TEXTURE0+r),aC.bindTexture(aC.TEXTURE_2D,s.__webglTexture)}};this.setRenderTarget=function(j){var i=j instanceof THREE.WebGLRenderTargetCube;if(j&&!j.__webglFramebuffer){void 0===j.depthBuffer&&(j.depthBuffer=!0);void 0===j.stencilBuffer&&(j.stencilBuffer=!0);j.addEventListener("dispose",ad);j.__webglTexture=aC.createTexture();a4.info.memory.textures++;var q=0===(j.width&j.width-1)&&0===(j.height&j.height-1),p=an(j.format),n=an(j.type);if(i){j.__webglFramebuffer=[];j.__webglRenderbuffer=[];aC.bindTexture(aC.TEXTURE_CUBE_MAP,j.__webglTexture);bd(aC.TEXTURE_CUBE_MAP,j,q);for(var m=0;6>m;m++){j.__webglFramebuffer[m]=aC.createFramebuffer();j.__webglRenderbuffer[m]=aC.createRenderbuffer();aC.texImage2D(aC.TEXTURE_CUBE_MAP_POSITIVE_X+m,0,p,j.width,j.height,0,p,n,null);var k=j,l=aC.TEXTURE_CUBE_MAP_POSITIVE_X+m;aC.bindFramebuffer(aC.FRAMEBUFFER,j.__webglFramebuffer[m]);aC.framebufferTexture2D(aC.FRAMEBUFFER,aC.COLOR_ATTACHMENT0,l,k.__webglTexture,0);a7(j.__webglRenderbuffer[m],j)}q&&aC.generateMipmap(aC.TEXTURE_CUBE_MAP)}else{j.__webglFramebuffer=aC.createFramebuffer(),j.__webglRenderbuffer=j.shareDepthFrom?j.shareDepthFrom.__webglRenderbuffer:aC.createRenderbuffer(),aC.bindTexture(aC.TEXTURE_2D,j.__webglTexture),bd(aC.TEXTURE_2D,j,q),aC.texImage2D(aC.TEXTURE_2D,0,p,j.width,j.height,0,p,n,null),p=aC.TEXTURE_2D,aC.bindFramebuffer(aC.FRAMEBUFFER,j.__webglFramebuffer),aC.framebufferTexture2D(aC.FRAMEBUFFER,aC.COLOR_ATTACHMENT0,p,j.__webglTexture,0),j.shareDepthFrom?j.depthBuffer&&!j.stencilBuffer?aC.framebufferRenderbuffer(aC.FRAMEBUFFER,aC.DEPTH_ATTACHMENT,aC.RENDERBUFFER,j.__webglRenderbuffer):j.depthBuffer&&j.stencilBuffer&&aC.framebufferRenderbuffer(aC.FRAMEBUFFER,aC.DEPTH_STENCIL_ATTACHMENT,aC.RENDERBUFFER,j.__webglRenderbuffer):a7(j.__webglRenderbuffer,j),q&&aC.generateMipmap(aC.TEXTURE_2D)}i?aC.bindTexture(aC.TEXTURE_CUBE_MAP,null):aC.bindTexture(aC.TEXTURE_2D,null);aC.bindRenderbuffer(aC.RENDERBUFFER,null);aC.bindFramebuffer(aC.FRAMEBUFFER,null)}j?(i=i?j.__webglFramebuffer[j.activeCubeFace]:j.__webglFramebuffer,q=j.width,j=j.height,n=p=0):(i=null,q=bK,j=bB,p=aY,n=aw);i!==ab&&(aC.bindFramebuffer(aC.FRAMEBUFFER,i),aC.viewport(p,n,q,j),ab=i);bw=q;af=j};this.shadowMapPlugin=new THREE.ShadowMapPlugin;this.addPrePlugin(this.shadowMapPlugin);this.addPostPlugin(new THREE.SpritePlugin);this.addPostPlugin(new THREE.LensFlarePlugin)};THREE.WebGLRenderTarget=function(e,d,f){this.width=e;this.height=d;f=f||{};this.wrapS=void 0!==f.wrapS?f.wrapS:THREE.ClampToEdgeWrapping;this.wrapT=void 0!==f.wrapT?f.wrapT:THREE.ClampToEdgeWrapping;this.magFilter=void 0!==f.magFilter?f.magFilter:THREE.LinearFilter;this.minFilter=void 0!==f.minFilter?f.minFilter:THREE.LinearMipMapLinearFilter;this.anisotropy=void 0!==f.anisotropy?f.anisotropy:1;this.offset=new THREE.Vector2(0,0);this.repeat=new THREE.Vector2(1,1);this.format=void 0!==f.format?f.format:THREE.RGBAFormat;this.type=void 0!==f.type?f.type:THREE.UnsignedByteType;this.depthBuffer=void 0!==f.depthBuffer?f.depthBuffer:!0;this.stencilBuffer=void 0!==f.stencilBuffer?f.stencilBuffer:!0;this.generateMipmaps=!0;this.shareDepthFrom=null};THREE.WebGLRenderTarget.prototype={constructor:THREE.WebGLRenderTarget,clone:function(){var b=new THREE.WebGLRenderTarget(this.width,this.height);b.wrapS=this.wrapS;b.wrapT=this.wrapT;b.magFilter=this.magFilter;b.minFilter=this.minFilter;b.anisotropy=this.anisotropy;b.offset.copy(this.offset);b.repeat.copy(this.repeat);b.format=this.format;b.type=this.type;b.depthBuffer=this.depthBuffer;b.stencilBuffer=this.stencilBuffer;b.generateMipmaps=this.generateMipmaps;b.shareDepthFrom=this.shareDepthFrom;return b},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.WebGLRenderTarget.prototype);THREE.WebGLRenderTargetCube=function(e,d,f){THREE.WebGLRenderTarget.call(this,e,d,f);this.activeCubeFace=0};THREE.WebGLRenderTargetCube.prototype=Object.create(THREE.WebGLRenderTarget.prototype);THREE.RenderableVertex=function(){this.positionWorld=new THREE.Vector3;this.positionScreen=new THREE.Vector4;this.visible=!0};THREE.RenderableVertex.prototype.copy=function(b){this.positionWorld.copy(b.positionWorld);this.positionScreen.copy(b.positionScreen)};THREE.RenderableFace3=function(){this.id=0;this.v1=new THREE.RenderableVertex;this.v2=new THREE.RenderableVertex;this.v3=new THREE.RenderableVertex;this.centroidModel=new THREE.Vector3;this.normalModel=new THREE.Vector3;this.normalModelView=new THREE.Vector3;this.vertexNormalsLength=0;this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];this.vertexNormalsModelView=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];this.material=this.color=null;this.uvs=[[]];this.z=0};THREE.RenderableObject=function(){this.id=0;this.object=null;this.z=0};THREE.RenderableSprite=function(){this.id=0;this.object=null;this.rotation=this.z=this.y=this.x=0;this.scale=new THREE.Vector2;this.material=null};THREE.RenderableLine=function(){this.id=0;this.v1=new THREE.RenderableVertex;this.v2=new THREE.RenderableVertex;this.vertexColors=[new THREE.Color,new THREE.Color];this.material=null;this.z=0};THREE.GeometryUtils={merge:function(J,I,H){var G,F,E=J.vertices.length,C=I instanceof THREE.Mesh?I.geometry:I,D=J.vertices,B=C.vertices,A=J.faces,u=C.faces,J=J.faceVertexUvs[0],C=C.faceVertexUvs[0];void 0===H&&(H=0);I instanceof THREE.Mesh&&(I.matrixAutoUpdate&&I.updateMatrix(),G=I.matrix,F=(new THREE.Matrix3).getNormalMatrix(G));for(var I=0,v=B.length;I<v;I++){var o=B[I].clone();G&&o.applyMatrix4(G);D.push(o)}I=0;for(v=u.length;I<v;I++){var o=u[I],L,K,q=o.vertexNormals,j=o.vertexColors;L=new THREE.Face3(o.a+E,o.b+E,o.c+E);L.normal.copy(o.normal);F&&L.normal.applyMatrix3(F).normalize();D=0;for(B=q.length;D<B;D++){K=q[D].clone(),F&&K.applyMatrix3(F).normalize(),L.vertexNormals.push(K)}L.color.copy(o.color);D=0;for(B=j.length;D<B;D++){K=j[D],L.vertexColors.push(K.clone())}L.materialIndex=o.materialIndex+H;L.centroid.copy(o.centroid);G&&L.centroid.applyMatrix4(G);A.push(L)}I=0;for(v=C.length;I<v;I++){H=C[I];G=[];D=0;for(B=H.length;D<B;D++){G.push(new THREE.Vector2(H[D].x,H[D].y))}J.push(G)}},randomPointInTriangle:function(){var b=new THREE.Vector3;return function(a,n,m){var l=new THREE.Vector3,k=THREE.Math.random16(),i=THREE.Math.random16();1<k+i&&(k=1-k,i=1-i);var j=1-k-i;l.copy(a);l.multiplyScalar(k);b.copy(n);b.multiplyScalar(i);l.add(b);b.copy(m);b.multiplyScalar(j);l.add(b);return l}}(),randomPointInFace:function(d,c){return THREE.GeometryUtils.randomPointInTriangle(c.vertices[d.a],c.vertices[d.b],c.vertices[d.c])},randomPointsInGeometry:function(D,C){function B(d){function c(f,b){if(b<f){return f}var a=f+Math.floor((b-f)/2);return q[a]>d?c(f,a-1):q[a]<d?c(a+1,b):a}return c(0,q.length-1)}var A,v,u=D.faces,s=D.vertices,t=u.length,r=0,q=[],n,o,j;for(v=0;v<t;v++){A=u[v],n=s[A.a],o=s[A.b],j=s[A.c],A._area=THREE.GeometryUtils.triangleArea(n,o,j),r+=A._area,q[v]=r}A=[];for(v=0;v<C;v++){s=THREE.Math.random16()*r,s=B(s),A[v]=THREE.GeometryUtils.randomPointInFace(u[s],D,!0)}return A},triangleArea:function(){var d=new THREE.Vector3,c=new THREE.Vector3;return function(f,b,a){d.subVectors(b,f);c.subVectors(a,f);d.cross(c);return 0.5*d.length()}}(),center:function(e){e.computeBoundingBox();var d=e.boundingBox,f=new THREE.Vector3;f.addVectors(d.min,d.max);f.multiplyScalar(-0.5);e.applyMatrix((new THREE.Matrix4).makeTranslation(f.x,f.y,f.z));e.computeBoundingBox();return f},triangulateQuads:function(i){var g,n,m,l,k=[],j=[];g=0;for(n=i.faceVertexUvs.length;g<n;g++){j[g]=[]}g=0;for(n=i.faces.length;g<n;g++){k.push(i.faces[g]);m=0;for(l=i.faceVertexUvs.length;m<l;m++){j[m].push(i.faceVertexUvs[m][g])}}i.faces=k;i.faceVertexUvs=j;i.computeCentroids();i.computeFaceNormals();i.computeVertexNormals();i.hasTangents&&i.computeTangents()}};THREE.ImageUtils={crossOrigin:"anonymous",loadTexture:function(g,f,j){var i=new THREE.ImageLoader;i.crossOrigin=this.crossOrigin;var h=new THREE.Texture(void 0,f),f=i.load(g,function(){h.needsUpdate=!0;j&&j(h)});h.image=f;h.sourceFile=g;return h},loadCompressedTexture:function(h,g,l,k){var j=new THREE.CompressedTexture;j.mapping=g;var i=new XMLHttpRequest;i.onload=function(){var b=THREE.ImageUtils.parseDDS(i.response,!0);j.format=b.format;j.mipmaps=b.mipmaps;j.image.width=b.width;j.image.height=b.height;j.generateMipmaps=!1;j.needsUpdate=!0;l&&l(j)};i.onerror=k;i.open("GET",h,!0);i.responseType="arraybuffer";i.send(null);return j},loadTextureCube:function(j,i,p,o){var n=[];n.loadCount=0;var m=new THREE.Texture;m.image=n;void 0!==i&&(m.mapping=i);m.flipY=!1;for(var i=0,k=j.length;i<k;++i){var l=new Image;n[i]=l;l.onload=function(){n.loadCount+=1;6===n.loadCount&&(m.needsUpdate=!0,p&&p(m))};l.onerror=o;l.crossOrigin=this.crossOrigin;l.src=j[i]}return m},loadCompressedTextureCube:function(t,s,r,q){var p=[];p.loadCount=0;var o=new THREE.CompressedTexture;o.image=p;void 0!==s&&(o.mapping=s);o.flipY=!1;o.generateMipmaps=!1;s=function(d,c){return function(){var a=THREE.ImageUtils.parseDDS(d.response,!0);c.format=a.format;c.mipmaps=a.mipmaps;c.width=a.width;c.height=a.height;p.loadCount+=1;6===p.loadCount&&(o.format=a.format,o.needsUpdate=!0,r&&r(o))}};if(t instanceof Array){for(var m=0,n=t.length;m<n;++m){var l={};p[m]=l;var j=new XMLHttpRequest;j.onload=s(j,l);j.onerror=q;l=t[m];j.open("GET",l,!0);j.responseType="arraybuffer";j.send(null)}}else{j=new XMLHttpRequest,j.onload=function(){var e=THREE.ImageUtils.parseDDS(j.response,!0);if(e.isCubemap){for(var c=e.mipmaps.length/e.mipmapCount,g=0;g<c;g++){p[g]={mipmaps:[]};for(var f=0;f<e.mipmapCount;f++){p[g].mipmaps.push(e.mipmaps[g*e.mipmapCount+f]),p[g].format=e.format,p[g].width=e.width,p[g].height=e.height}}o.format=e.format;o.needsUpdate=!0;r&&r(o)}},j.onerror=q,j.open("GET",t,!0),j.responseType="arraybuffer",j.send(null)}return o},loadDDSTexture:function(i,g,n,m){var l=[];l.loadCount=0;var k=new THREE.CompressedTexture;k.image=l;void 0!==g&&(k.mapping=g);k.flipY=!1;k.generateMipmaps=!1;var j=new XMLHttpRequest;j.onload=function(){var f=THREE.ImageUtils.parseDDS(j.response,!0);if(f.isCubemap){for(var e=f.mipmaps.length/f.mipmapCount,h=0;h<e;h++){l[h]={mipmaps:[]};for(var c=0;c<f.mipmapCount;c++){l[h].mipmaps.push(f.mipmaps[h*f.mipmapCount+c]),l[h].format=f.format,l[h].width=f.width,l[h].height=f.height}}}else{k.image.width=f.width,k.image.height=f.height,k.mipmaps=f.mipmaps}k.format=f.format;k.needsUpdate=!0;n&&n(k)};j.onerror=m;j.open("GET",i,!0);j.responseType="arraybuffer";j.send(null);return k},parseDDS:function(W,V){function U(b){return b.charCodeAt(0)+(b.charCodeAt(1)<<8)+(b.charCodeAt(2)<<16)+(b.charCodeAt(3)<<24)}var T={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},S=U("DXT1"),R=U("DXT3"),P=U("DXT5"),Q=new Int32Array(W,0,31);if(542327876!==Q[0]){return console.error("ImageUtils.parseDDS(): Invalid magic number in DDS header"),T}if(!Q[20]&4){return console.error("ImageUtils.parseDDS(): Unsupported format, must contain a FourCC code"),T}var O=Q[21],N=!1;switch(O){case S:S=8;T.format=THREE.RGB_S3TC_DXT1_Format;break;case R:S=16;T.format=THREE.RGBA_S3TC_DXT3_Format;break;case P:S=16;T.format=THREE.RGBA_S3TC_DXT5_Format;break;default:if(32==Q[22]&&Q[23]&16711680&&Q[24]&65280&&Q[25]&255&&Q[26]&4278190080){N=!0,S=64,T.format=THREE.RGBAFormat}else{return console.error("ImageUtils.parseDDS(): Unsupported FourCC code: ",String.fromCharCode(O&255,O>>8&255,O>>16&255,O>>24&255)),T}}T.mipmapCount=1;Q[2]&131072&&!1!==V&&(T.mipmapCount=Math.max(1,Q[7]));T.isCubemap=Q[28]&512?!0:!1;T.width=Q[4];T.height=Q[3];for(var Q=Q[1]+4,R=T.width,P=T.height,O=T.isCubemap?6:1,L=0;L<O;L++){for(var M=0;M<T.mipmapCount;M++){if(N){var J;J=R;for(var F=P,C=4*J*F,K=new Uint8Array(W,Q,C),C=new Uint8Array(C),G=0,I=0,A=0;A<F;A++){for(var v=0;v<J;v++){var j=K[I];I++;var H=K[I];I++;var E=K[I];I++;var o=K[I];I++;C[G]=E;G++;C[G]=H;G++;C[G]=j;G++;C[G]=o;G++}}J=C;F=J.length}else{F=Math.max(4,R)/4*Math.max(4,P)/4*S,J=new Uint8Array(W,Q,F)}T.mipmaps.push({data:J,width:R,height:P});Q+=F;R=Math.max(0.5*R,1);P=Math.max(0.5*P,1)}R=T.width;P=T.height}return T},getNormalMap:function(P,O){var N=function(d){var c=Math.sqrt(d[0]*d[0]+d[1]*d[1]+d[2]*d[2]);return[d[0]/c,d[1]/c,d[2]/c]},O=O|1,M=P.width,L=P.height,K=document.createElement("canvas");K.width=M;K.height=L;var I=K.getContext("2d");I.drawImage(P,0,0);for(var J=I.getImageData(0,0,M,L).data,H=I.createImageData(M,L),G=H.data,E=0;E<M;E++){for(var F=0;F<L;F++){var C=0>F-1?0:F-1,v=F+1>L-1?L-1:F+1,o=0>E-1?0:E-1,D=E+1>M-1?M-1:E+1,A=[],B=[0,0,J[4*(F*M+E)]/255*O];A.push([-1,0,J[4*(F*M+o)]/255*O]);A.push([-1,-1,J[4*(C*M+o)]/255*O]);A.push([0,-1,J[4*(C*M+E)]/255*O]);A.push([1,-1,J[4*(C*M+D)]/255*O]);A.push([1,0,J[4*(F*M+D)]/255*O]);A.push([1,1,J[4*(v*M+D)]/255*O]);A.push([0,1,J[4*(v*M+E)]/255*O]);A.push([-1,1,J[4*(v*M+o)]/255*O]);C=[];o=A.length;for(v=0;v<o;v++){var D=A[v],j=A[(v+1)%o],D=[D[0]-B[0],D[1]-B[1],D[2]-B[2]],j=[j[0]-B[0],j[1]-B[1],j[2]-B[2]];C.push(N([D[1]*j[2]-D[2]*j[1],D[2]*j[0]-D[0]*j[2],D[0]*j[1]-D[1]*j[0]]))}A=[0,0,0];for(v=0;v<C.length;v++){A[0]+=C[v][0],A[1]+=C[v][1],A[2]+=C[v][2]}A[0]/=C.length;A[1]/=C.length;A[2]/=C.length;B=4*(F*M+E);G[B]=255*((A[0]+1)/2)|0;G[B+1]=255*((A[1]+1)/2)|0;G[B+2]=255*A[2]|0;G[B+3]=255}}I.putImageData(H,0,0);return K},generateDataTexture:function(j,i,p){for(var o=j*i,n=new Uint8Array(3*o),m=Math.floor(255*p.r),k=Math.floor(255*p.g),p=Math.floor(255*p.b),l=0;l<o;l++){n[3*l]=m,n[3*l+1]=k,n[3*l+2]=p}j=new THREE.DataTexture(n,j,i,THREE.RGBFormat);j.needsUpdate=!0;return j}};THREE.SceneUtils={createMultiMaterialObject:function(g,f){for(var j=new THREE.Object3D,i=0,h=f.length;i<h;i++){j.add(new THREE.Mesh(g,f[i]))}return j},detach:function(e,d,f){e.applyMatrix(d.matrixWorld);d.remove(e);f.add(e)},attach:function(f,e,h){var g=new THREE.Matrix4;g.getInverse(h.matrixWorld);f.applyMatrix(g);e.remove(f);h.add(f)}};THREE.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){return this.faces[this.face][this.weight][this.style]},loadFace:function(d){var c=d.familyName.toLowerCase();this.faces[c]=this.faces[c]||{};this.faces[c][d.cssFontWeight]=this.faces[c][d.cssFontWeight]||{};this.faces[c][d.cssFontWeight][d.cssFontStyle]=d;return this.faces[c][d.cssFontWeight][d.cssFontStyle]=d},drawText:function(j){for(var i=this.getFace(),p=this.size/i.resolution,o=0,n=String(j).split(""),m=n.length,k=[],j=0;j<m;j++){var l=new THREE.Path,l=this.extractGlyphPoints(n[j],i,p,o,l),o=o+l.offset;k.push(l.path)}return{paths:k,offset:o/2}},extractGlyphPoints:function(P,O,N,M,L){var K=[],I,J,H,G,E,F,C,v,o,D,A,B=O.glyphs[P]||O.glyphs["?"];if(B){if(B.o){O=B._cachedOutline||(B._cachedOutline=B.o.split(" "));G=O.length;for(P=0;P<G;){switch(H=O[P++],H){case"m":H=O[P++]*N+M;E=O[P++]*N;L.moveTo(H,E);break;case"l":H=O[P++]*N+M;E=O[P++]*N;L.lineTo(H,E);break;case"q":H=O[P++]*N+M;E=O[P++]*N;v=O[P++]*N+M;o=O[P++]*N;L.quadraticCurveTo(v,o,H,E);if(I=K[K.length-1]){F=I.x;C=I.y;I=1;for(J=this.divisions;I<=J;I++){var j=I/J;THREE.Shape.Utils.b2(j,F,v,H);THREE.Shape.Utils.b2(j,C,o,E)}}break;case"b":if(H=O[P++]*N+M,E=O[P++]*N,v=O[P++]*N+M,o=O[P++]*-N,D=O[P++]*N+M,A=O[P++]*-N,L.bezierCurveTo(H,E,v,o,D,A),I=K[K.length-1]){F=I.x;C=I.y;I=1;for(J=this.divisions;I<=J;I++){j=I/J,THREE.Shape.Utils.b3(j,F,v,D,H),THREE.Shape.Utils.b3(j,C,o,A,E)}}}}}return{offset:B.ha*N,path:L}}}};THREE.FontUtils.generateShapes=function(h,g){var g=g||{},l=void 0!==g.curveSegments?g.curveSegments:4,k=void 0!==g.font?g.font:"helvetiker",j=void 0!==g.weight?g.weight:"normal",i=void 0!==g.style?g.style:"normal";THREE.FontUtils.size=void 0!==g.size?g.size:100;THREE.FontUtils.divisions=l;THREE.FontUtils.face=k;THREE.FontUtils.weight=j;THREE.FontUtils.style=i;l=THREE.FontUtils.drawText(h).paths;k=[];j=0;for(i=l.length;j<i;j++){Array.prototype.push.apply(k,l[j].toShapes())}return k};(function(d){var c=function(i){for(var g=i.length,l=0,k=g-1,j=0;j<g;k=j++){l+=i[k].x*i[j].y-i[j].x*i[k].y}return 0.5*l};d.Triangulate=function(ag,af){var ae=ag.length;if(3>ae){return null}var ad=[],ab=[],ac=[],aa,Z,X;if(0<c(ag)){for(Z=0;Z<ae;Z++){ab[Z]=Z}}else{for(Z=0;Z<ae;Z++){ab[Z]=ae-1-Z}}var Y=2*ae;for(Z=ae-1;2<ae;){if(0>=Y--){console.log("Warning, unable to triangulate polygon!");break}aa=Z;ae<=aa&&(aa=0);Z=aa+1;ae<=Z&&(Z=0);X=Z+1;ae<=X&&(X=0);var V;ag:{var P=V=void 0,M=void 0,W=void 0,R=void 0,T=void 0,K=void 0,H=void 0,j=void 0,P=ag[ab[aa]].x,M=ag[ab[aa]].y,W=ag[ab[Z]].x,R=ag[ab[Z]].y,T=ag[ab[X]].x,K=ag[ab[X]].y;if(1e-10>(W-P)*(K-M)-(R-M)*(T-P)){V=!1}else{var S=void 0,N=void 0,G=void 0,J=void 0,U=void 0,b=void 0,Q=void 0,L=void 0,v=void 0,o=void 0,v=L=Q=j=H=void 0,S=T-W,N=K-R,G=P-T,J=M-K,U=W-P,b=R-M;for(V=0;V<ae;V++){if(!(V===aa||V===Z||V===X)){if(H=ag[ab[V]].x,j=ag[ab[V]].y,Q=H-P,L=j-M,v=H-W,o=j-R,H-=T,j-=K,v=S*o-N*v,Q=U*L-b*Q,L=G*j-J*H,-1e-10<=v&&-1e-10<=L&&-1e-10<=Q){V=!1;break ag}}}V=!0}}if(V){ad.push([ag[ab[aa]],ag[ab[Z]],ag[ab[X]]]);ac.push([ab[aa],ab[Z],ab[X]]);aa=Z;for(X=Z+1;X<ae;aa++,X++){ab[aa]=ab[X]}ae--;Y=2*ae}}return af?ac:ad};d.Triangulate.area=c;return d})(THREE.FontUtils);self._typeface_js={faces:THREE.FontUtils.faces,loadFace:THREE.FontUtils.loadFace};THREE.typeface_js=self._typeface_js;THREE.Curve=function(){};THREE.Curve.prototype.getPoint=function(){console.log("Warning, getPoint() not implemented!");return null};THREE.Curve.prototype.getPointAt=function(b){b=this.getUtoTmapping(b);return this.getPoint(b)};THREE.Curve.prototype.getPoints=function(e){e||(e=5);var d,f=[];for(d=0;d<=e;d++){f.push(this.getPoint(d/e))}return f};THREE.Curve.prototype.getSpacedPoints=function(e){e||(e=5);var d,f=[];for(d=0;d<=e;d++){f.push(this.getPointAt(d/e))}return f};THREE.Curve.prototype.getLength=function(){var b=this.getLengths();return b[b.length-1]};THREE.Curve.prototype.getLengths=function(h){h||(h=this.__arcLengthDivisions?this.__arcLengthDivisions:200);if(this.cacheArcLengths&&this.cacheArcLengths.length==h+1&&!this.needsUpdate){return this.cacheArcLengths}this.needsUpdate=!1;var g=[],l,k=this.getPoint(0),j,i=0;g.push(0);for(j=1;j<=h;j++){l=this.getPoint(j/h),i+=l.distanceTo(k),g.push(i),k=l}return this.cacheArcLengths=g};THREE.Curve.prototype.updateArcLengths=function(){this.needsUpdate=!0;this.getLengths()};THREE.Curve.prototype.getUtoTmapping=function(r,q){var p=this.getLengths(),o=0,n=p.length,m;m=q?q:r*p[n-1];for(var k=0,l=n-1,j;k<=l;){if(o=Math.floor(k+(l-k)/2),j=p[o]-m,0>j){k=o+1}else{if(0<j){l=o-1}else{l=o;break}}}o=l;if(p[o]==m){return o/(n-1)}k=p[o];return p=(o+(m-k)/(p[o+1]-k))/(n-1)};THREE.Curve.prototype.getTangent=function(d){var c=d-0.0001,d=d+0.0001;0>c&&(c=0);1<d&&(d=1);c=this.getPoint(c);return this.getPoint(d).clone().sub(c).normalize()};THREE.Curve.prototype.getTangentAt=function(b){b=this.getUtoTmapping(b);return this.getTangent(b)};THREE.Curve.Utils={tangentQuadraticBezier:function(f,e,h,g){return 2*(1-f)*(h-e)+2*f*(g-h)},tangentCubicBezier:function(g,f,j,i,h){return -3*f*(1-g)*(1-g)+3*j*(1-g)*(1-g)-6*g*j*(1-g)+6*g*i*(1-g)-3*g*g*i+3*g*g*h},tangentSpline:function(b){return 6*b*b-6*b+(3*b*b-4*b+1)+(-6*b*b+6*b)+(3*b*b-2*b)},interpolate:function(h,g,l,k,j){var h=0.5*(l-h),k=0.5*(k-g),i=j*j;return(2*g-2*l+h+k)*j*i+(-3*g+3*l-2*h-k)*i+h*j+g}};THREE.Curve.create=function(d,c){d.prototype=Object.create(THREE.Curve.prototype);d.prototype.getPoint=c;return d};THREE.CurvePath=function(){this.curves=[];this.bends=[];this.autoClose=!1};THREE.CurvePath.prototype=Object.create(THREE.Curve.prototype);THREE.CurvePath.prototype.add=function(b){this.curves.push(b)};THREE.CurvePath.prototype.checkConnection=function(){};THREE.CurvePath.prototype.closePath=function(){var d=this.curves[0].getPoint(0),c=this.curves[this.curves.length-1].getPoint(1);d.equals(c)||this.curves.push(new THREE.LineCurve(c,d))};THREE.CurvePath.prototype.getPoint=function(e){for(var d=e*this.getLength(),f=this.getCurveLengths(),e=0;e<f.length;){if(f[e]>=d){return d=f[e]-d,e=this.curves[e],d=1-d/e.getLength(),e.getPointAt(d)}e++}return null};THREE.CurvePath.prototype.getLength=function(){var b=this.getCurveLengths();return b[b.length-1]};THREE.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length){return this.cacheLengths}var f=[],e=0,h,g=this.curves.length;for(h=0;h<g;h++){e+=this.curves[h].getLength(),f.push(e)}return this.cacheLengths=f};THREE.CurvePath.prototype.getBoundingBox=function(){var B=this.getPoints(),A,v,u,t,s,q;A=v=Number.NEGATIVE_INFINITY;t=s=Number.POSITIVE_INFINITY;var r,p,o,j,n=B[0] instanceof THREE.Vector3;j=n?new THREE.Vector3:new THREE.Vector2;p=0;for(o=B.length;p<o;p++){r=B[p],r.x>A?A=r.x:r.x<t&&(t=r.x),r.y>v?v=r.y:r.y<s&&(s=r.y),n&&(r.z>u?u=r.z:r.z<q&&(q=r.z)),j.add(r)}B={minX:t,minY:s,maxX:A,maxY:v,centroid:j.divideScalar(o)};n&&(B.maxZ=u,B.minZ=q);return B};THREE.CurvePath.prototype.createPointsGeometry=function(b){b=this.getPoints(b,!0);return this.createGeometry(b)};THREE.CurvePath.prototype.createSpacedPointsGeometry=function(b){b=this.getSpacedPoints(b,!0);return this.createGeometry(b)};THREE.CurvePath.prototype.createGeometry=function(e){for(var d=new THREE.Geometry,f=0;f<e.length;f++){d.vertices.push(new THREE.Vector3(e[f].x,e[f].y,e[f].z||0))}return d};THREE.CurvePath.prototype.addWrapPath=function(b){this.bends.push(b)};THREE.CurvePath.prototype.getTransformedPoints=function(g,f){var j=this.getPoints(g),i,h;f||(f=this.bends);i=0;for(h=f.length;i<h;i++){j=this.getWrapPoints(j,f[i])}return j};THREE.CurvePath.prototype.getTransformedSpacedPoints=function(g,f){var j=this.getSpacedPoints(g),i,h;f||(f=this.bends);i=0;for(h=f.length;i<h;i++){j=this.getWrapPoints(j,f[i])}return j};THREE.CurvePath.prototype.getWrapPoints=function(r,q){var p=this.getBoundingBox(),o,n,m,k,l,j;o=0;for(n=r.length;o<n;o++){m=r[o],k=m.x,l=m.y,j=k/p.maxX,j=q.getUtoTmapping(j,k),k=q.getPoint(j),l=q.getNormalVector(j).multiplyScalar(l),m.x=k.x+l.x,m.y=k.y+l.y}return r};THREE.Gyroscope=function(){THREE.Object3D.call(this)};THREE.Gyroscope.prototype=Object.create(THREE.Object3D.prototype);THREE.Gyroscope.prototype.updateMatrixWorld=function(e){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||e){this.parent?(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorld.decompose(this.translationWorld,this.quaternionWorld,this.scaleWorld),this.matrix.decompose(this.translationObject,this.quaternionObject,this.scaleObject),this.matrixWorld.compose(this.translationWorld,this.quaternionObject,this.scaleWorld)):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0}for(var d=0,f=this.children.length;d<f;d++){this.children[d].updateMatrixWorld(e)}};THREE.Gyroscope.prototype.translationWorld=new THREE.Vector3;THREE.Gyroscope.prototype.translationObject=new THREE.Vector3;THREE.Gyroscope.prototype.quaternionWorld=new THREE.Quaternion;THREE.Gyroscope.prototype.quaternionObject=new THREE.Quaternion;THREE.Gyroscope.prototype.scaleWorld=new THREE.Vector3;THREE.Gyroscope.prototype.scaleObject=new THREE.Vector3;THREE.Path=function(b){THREE.CurvePath.call(this);this.actions=[];b&&this.fromPoints(b)};THREE.Path.prototype=Object.create(THREE.CurvePath.prototype);THREE.PathActions={MOVE_TO:"moveTo",LINE_TO:"lineTo",QUADRATIC_CURVE_TO:"quadraticCurveTo",BEZIER_CURVE_TO:"bezierCurveTo",CSPLINE_THRU:"splineThru",ARC:"arc",ELLIPSE:"ellipse"};THREE.Path.prototype.fromPoints=function(e){this.moveTo(e[0].x,e[0].y);for(var d=1,f=e.length;d<f;d++){this.lineTo(e[d].x,e[d].y)}};THREE.Path.prototype.moveTo=function(e,d){var f=Array.prototype.slice.call(arguments);this.actions.push({action:THREE.PathActions.MOVE_TO,args:f})};THREE.Path.prototype.lineTo=function(f,e){var h=Array.prototype.slice.call(arguments),g=this.actions[this.actions.length-1].args,g=new THREE.LineCurve(new THREE.Vector2(g[g.length-2],g[g.length-1]),new THREE.Vector2(f,e));this.curves.push(g);this.actions.push({action:THREE.PathActions.LINE_TO,args:h})};THREE.Path.prototype.quadraticCurveTo=function(h,g,l,k){var j=Array.prototype.slice.call(arguments),i=this.actions[this.actions.length-1].args,i=new THREE.QuadraticBezierCurve(new THREE.Vector2(i[i.length-2],i[i.length-1]),new THREE.Vector2(h,g),new THREE.Vector2(l,k));this.curves.push(i);this.actions.push({action:THREE.PathActions.QUADRATIC_CURVE_TO,args:j})};THREE.Path.prototype.bezierCurveTo=function(j,i,p,o,n,m){var k=Array.prototype.slice.call(arguments),l=this.actions[this.actions.length-1].args,l=new THREE.CubicBezierCurve(new THREE.Vector2(l[l.length-2],l[l.length-1]),new THREE.Vector2(j,i),new THREE.Vector2(p,o),new THREE.Vector2(n,m));this.curves.push(l);this.actions.push({action:THREE.PathActions.BEZIER_CURVE_TO,args:k})};THREE.Path.prototype.splineThru=function(e){var d=Array.prototype.slice.call(arguments),f=this.actions[this.actions.length-1].args,f=[new THREE.Vector2(f[f.length-2],f[f.length-1])];Array.prototype.push.apply(f,e);f=new THREE.SplineCurve(f);this.curves.push(f);this.actions.push({action:THREE.PathActions.CSPLINE_THRU,args:d})};THREE.Path.prototype.arc=function(i,g,n,m,l,k){var j=this.actions[this.actions.length-1].args;this.absarc(i+j[j.length-2],g+j[j.length-1],n,m,l,k)};THREE.Path.prototype.absarc=function(h,g,l,k,j,i){this.absellipse(h,g,l,l,k,j,i)};THREE.Path.prototype.ellipse=function(j,i,p,o,n,m,k){var l=this.actions[this.actions.length-1].args;this.absellipse(j+l[l.length-2],i+l[l.length-1],p,o,n,m,k)};THREE.Path.prototype.absellipse=function(r,q,p,o,n,m,k){var l=Array.prototype.slice.call(arguments),j=new THREE.EllipseCurve(r,q,p,o,n,m,k);this.curves.push(j);j=j.getPoint(1);l.push(j.x);l.push(j.y);this.actions.push({action:THREE.PathActions.ELLIPSE,args:l})};THREE.Path.prototype.getSpacedPoints=function(e){e||(e=40);for(var d=[],f=0;f<e;f++){d.push(this.getPoint(f/e))}return d};THREE.Path.prototype.getPoints=function(H,G){if(this.useSpacedPoints){return console.log("tata"),this.getSpacedPoints(H,G)}var H=H||12,F=[],E,D,C,A,B,v,u,q,r,j,J,I,o;E=0;for(D=this.actions.length;E<D;E++){switch(C=this.actions[E],A=C.action,C=C.args,A){case THREE.PathActions.MOVE_TO:F.push(new THREE.Vector2(C[0],C[1]));break;case THREE.PathActions.LINE_TO:F.push(new THREE.Vector2(C[0],C[1]));break;case THREE.PathActions.QUADRATIC_CURVE_TO:B=C[2];v=C[3];r=C[0];j=C[1];0<F.length?(A=F[F.length-1],J=A.x,I=A.y):(A=this.actions[E-1].args,J=A[A.length-2],I=A[A.length-1]);for(C=1;C<=H;C++){o=C/H,A=THREE.Shape.Utils.b2(o,J,r,B),o=THREE.Shape.Utils.b2(o,I,j,v),F.push(new THREE.Vector2(A,o))}break;case THREE.PathActions.BEZIER_CURVE_TO:B=C[4];v=C[5];r=C[0];j=C[1];u=C[2];q=C[3];0<F.length?(A=F[F.length-1],J=A.x,I=A.y):(A=this.actions[E-1].args,J=A[A.length-2],I=A[A.length-1]);for(C=1;C<=H;C++){o=C/H,A=THREE.Shape.Utils.b3(o,J,r,u,B),o=THREE.Shape.Utils.b3(o,I,j,q,v),F.push(new THREE.Vector2(A,o))}break;case THREE.PathActions.CSPLINE_THRU:A=this.actions[E-1].args;o=[new THREE.Vector2(A[A.length-2],A[A.length-1])];A=H*C[0].length;o=o.concat(C[0]);o=new THREE.SplineCurve(o);for(C=1;C<=A;C++){F.push(o.getPointAt(C/A))}break;case THREE.PathActions.ARC:B=C[0];v=C[1];j=C[2];u=C[3];A=C[4];r=!!C[5];J=A-u;I=2*H;for(C=1;C<=I;C++){o=C/I,r||(o=1-o),o=u+o*J,A=B+j*Math.cos(o),o=v+j*Math.sin(o),F.push(new THREE.Vector2(A,o))}break;case THREE.PathActions.ELLIPSE:B=C[0];v=C[1];j=C[2];q=C[3];u=C[4];A=C[5];r=!!C[6];J=A-u;I=2*H;for(C=1;C<=I;C++){o=C/I,r||(o=1-o),o=u+o*J,A=B+j*Math.cos(o),o=v+q*Math.sin(o),F.push(new THREE.Vector2(A,o))}}}E=F[F.length-1];1e-10>Math.abs(E.x-F[0].x)&&1e-10>Math.abs(E.y-F[0].y)&&F.splice(F.length-1,1);G&&F.push(F[0]);return F};THREE.Path.prototype.toShapes=function(j){var i,p,o,n,m=[],k=new THREE.Path;i=0;for(p=this.actions.length;i<p;i++){o=this.actions[i],n=o.args,o=o.action,o==THREE.PathActions.MOVE_TO&&0!=k.actions.length&&(m.push(k),k=new THREE.Path),k[o].apply(k,n)}0!=k.actions.length&&m.push(k);if(0==m.length){return[]}var l;n=[];if(1==m.length){return o=m[0],l=new THREE.Shape,l.actions=o.actions,l.curves=o.curves,n.push(l),n}i=!THREE.Shape.Utils.isClockWise(m[0].getPoints());if(j?!i:i){l=new THREE.Shape;i=0;for(p=m.length;i<p;i++){o=m[i],k=THREE.Shape.Utils.isClockWise(o.getPoints()),(k=j?!k:k)?(l.actions=o.actions,l.curves=o.curves,n.push(l),l=new THREE.Shape):l.holes.push(o)}}else{l=void 0;i=0;for(p=m.length;i<p;i++){o=m[i],k=THREE.Shape.Utils.isClockWise(o.getPoints()),(k=j?!k:k)?(l&&n.push(l),l=new THREE.Shape,l.actions=o.actions,l.curves=o.curves):l.holes.push(o)}n.push(l)}return n};THREE.Shape=function(){THREE.Path.apply(this,arguments);this.holes=[]};THREE.Shape.prototype=Object.create(THREE.Path.prototype);THREE.Shape.prototype.extrude=function(b){return new THREE.ExtrudeGeometry(this,b)};THREE.Shape.prototype.makeGeometry=function(b){return new THREE.ShapeGeometry(this,b)};THREE.Shape.prototype.getPointsHoles=function(f){var e,h=this.holes.length,g=[];for(e=0;e<h;e++){g[e]=this.holes[e].getTransformedPoints(f,this.bends)}return g};THREE.Shape.prototype.getSpacedPointsHoles=function(f){var e,h=this.holes.length,g=[];for(e=0;e<h;e++){g[e]=this.holes[e].getTransformedSpacedPoints(f,this.bends)}return g};THREE.Shape.prototype.extractAllPoints=function(b){return{shape:this.getTransformedPoints(b),holes:this.getPointsHoles(b)}};THREE.Shape.prototype.extractPoints=function(b){return this.useSpacedPoints?this.extractAllSpacedPoints(b):this.extractAllPoints(b)};THREE.Shape.prototype.extractAllSpacedPoints=function(b){return{shape:this.getTransformedSpacedPoints(b),holes:this.getSpacedPointsHoles(b)}};THREE.Shape.Utils={removeHoles:function(J,I){var H=J.concat(),G=H.concat(),F,E,C,D,B,A,u,v,o,L,K=[];for(B=0;B<I.length;B++){A=I[B];Array.prototype.push.apply(G,A);E=Number.POSITIVE_INFINITY;for(F=0;F<A.length;F++){o=A[F];L=[];for(v=0;v<H.length;v++){u=H[v],u=o.distanceToSquared(u),L.push(u),u<E&&(E=u,C=F,D=v)}}F=0<=D-1?D-1:H.length-1;E=0<=C-1?C-1:A.length-1;var q=[A[C],H[D],H[F]];v=THREE.FontUtils.Triangulate.area(q);var j=[A[C],A[E],H[D]];o=THREE.FontUtils.Triangulate.area(j);L=D;u=C;D+=1;C+=-1;0>D&&(D+=H.length);D%=H.length;0>C&&(C+=A.length);C%=A.length;F=0<=D-1?D-1:H.length-1;E=0<=C-1?C-1:A.length-1;q=[A[C],H[D],H[F]];q=THREE.FontUtils.Triangulate.area(q);j=[A[C],A[E],H[D]];j=THREE.FontUtils.Triangulate.area(j);v+o>q+j&&(D=L,C=u,0>D&&(D+=H.length),D%=H.length,0>C&&(C+=A.length),C%=A.length,F=0<=D-1?D-1:H.length-1,E=0<=C-1?C-1:A.length-1);v=H.slice(0,D);o=H.slice(D);L=A.slice(C);u=A.slice(0,C);E=[A[C],A[E],H[D]];K.push([A[C],H[D],H[F]]);K.push(E);H=v.concat(L).concat(u).concat(o)}return{shape:H,isolatedPts:K,allpoints:G}},triangulateShape:function(t,s){var r=THREE.Shape.Utils.removeHoles(t,s),q=r.allpoints,p=r.isolatedPts,r=THREE.FontUtils.Triangulate(r.shape,!1),o,m,n,l,j={};o=0;for(m=q.length;o<m;o++){l=q[o].x+":"+q[o].y,void 0!==j[l]&&console.log("Duplicate point",l),j[l]=o}o=0;for(m=r.length;o<m;o++){n=r[o];for(q=0;3>q;q++){l=n[q].x+":"+n[q].y,l=j[l],void 0!==l&&(n[q]=l)}}o=0;for(m=p.length;o<m;o++){n=p[o];for(q=0;3>q;q++){l=n[q].x+":"+n[q].y,l=j[l],void 0!==l&&(n[q]=l)}}return r.concat(p)},isClockWise:function(b){return 0>THREE.FontUtils.Triangulate.area(b)},b2p0:function(e,d){var f=1-e;return f*f*d},b2p1:function(d,c){return 2*(1-d)*d*c},b2p2:function(d,c){return d*d*c},b2:function(f,e,h,g){return this.b2p0(f,e)+this.b2p1(f,h)+this.b2p2(f,g)},b3p0:function(e,d){var f=1-e;return f*f*f*d},b3p1:function(e,d){var f=1-e;return 3*f*f*e*d},b3p2:function(d,c){return 3*(1-d)*d*d*c},b3p3:function(d,c){return d*d*d*c},b3:function(g,f,j,i,h){return this.b3p0(g,f)+this.b3p1(g,j)+this.b3p2(g,i)+this.b3p3(g,h)}};THREE.LineCurve=function(d,c){this.v1=d;this.v2=c};THREE.LineCurve.prototype=Object.create(THREE.Curve.prototype);THREE.LineCurve.prototype.getPoint=function(d){var c=this.v2.clone().sub(this.v1);c.multiplyScalar(d).add(this.v1);return c};THREE.LineCurve.prototype.getPointAt=function(b){return this.getPoint(b)};THREE.LineCurve.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()};THREE.QuadraticBezierCurve=function(e,d,f){this.v0=e;this.v1=d;this.v2=f};THREE.QuadraticBezierCurve.prototype=Object.create(THREE.Curve.prototype);THREE.QuadraticBezierCurve.prototype.getPoint=function(d){var c;c=THREE.Shape.Utils.b2(d,this.v0.x,this.v1.x,this.v2.x);d=THREE.Shape.Utils.b2(d,this.v0.y,this.v1.y,this.v2.y);return new THREE.Vector2(c,d)};THREE.QuadraticBezierCurve.prototype.getTangent=function(d){var c;c=THREE.Curve.Utils.tangentQuadraticBezier(d,this.v0.x,this.v1.x,this.v2.x);d=THREE.Curve.Utils.tangentQuadraticBezier(d,this.v0.y,this.v1.y,this.v2.y);c=new THREE.Vector2(c,d);c.normalize();return c};THREE.CubicBezierCurve=function(f,e,h,g){this.v0=f;this.v1=e;this.v2=h;this.v3=g};THREE.CubicBezierCurve.prototype=Object.create(THREE.Curve.prototype);THREE.CubicBezierCurve.prototype.getPoint=function(d){var c;c=THREE.Shape.Utils.b3(d,this.v0.x,this.v1.x,this.v2.x,this.v3.x);d=THREE.Shape.Utils.b3(d,this.v0.y,this.v1.y,this.v2.y,this.v3.y);return new THREE.Vector2(c,d)};THREE.CubicBezierCurve.prototype.getTangent=function(d){var c;c=THREE.Curve.Utils.tangentCubicBezier(d,this.v0.x,this.v1.x,this.v2.x,this.v3.x);d=THREE.Curve.Utils.tangentCubicBezier(d,this.v0.y,this.v1.y,this.v2.y,this.v3.y);c=new THREE.Vector2(c,d);c.normalize();return c};THREE.SplineCurve=function(b){this.points=void 0==b?[]:b};THREE.SplineCurve.prototype=Object.create(THREE.Curve.prototype);THREE.SplineCurve.prototype.getPoint=function(g){var f=new THREE.Vector2,j=[],i=this.points,h;h=(i.length-1)*g;g=Math.floor(h);h-=g;j[0]=0==g?g:g-1;j[1]=g;j[2]=g>i.length-2?i.length-1:g+1;j[3]=g>i.length-3?i.length-1:g+2;f.x=THREE.Curve.Utils.interpolate(i[j[0]].x,i[j[1]].x,i[j[2]].x,i[j[3]].x,h);f.y=THREE.Curve.Utils.interpolate(i[j[0]].y,i[j[1]].y,i[j[2]].y,i[j[3]].y,h);return f};THREE.EllipseCurve=function(i,g,n,m,l,k,j){this.aX=i;this.aY=g;this.xRadius=n;this.yRadius=m;this.aStartAngle=l;this.aEndAngle=k;this.aClockwise=j};THREE.EllipseCurve.prototype=Object.create(THREE.Curve.prototype);THREE.EllipseCurve.prototype.getPoint=function(d){var c;c=this.aEndAngle-this.aStartAngle;0>c&&(c+=2*Math.PI);c>2*Math.PI&&(c-=2*Math.PI);c=!0===this.aClockwise?this.aEndAngle+(1-d)*(2*Math.PI-c):this.aStartAngle+d*c;d=this.aX+this.xRadius*Math.cos(c);c=this.aY+this.yRadius*Math.sin(c);return new THREE.Vector2(d,c)};THREE.ArcCurve=function(h,g,l,k,j,i){THREE.EllipseCurve.call(this,h,g,l,l,k,j,i)};THREE.ArcCurve.prototype=Object.create(THREE.EllipseCurve.prototype);THREE.LineCurve3=THREE.Curve.create(function(d,c){this.v1=d;this.v2=c},function(d){var c=new THREE.Vector3;c.subVectors(this.v2,this.v1);c.multiplyScalar(d);c.add(this.v1);return c});THREE.QuadraticBezierCurve3=THREE.Curve.create(function(e,d,f){this.v0=e;this.v1=d;this.v2=f},function(e){var d,f;d=THREE.Shape.Utils.b2(e,this.v0.x,this.v1.x,this.v2.x);f=THREE.Shape.Utils.b2(e,this.v0.y,this.v1.y,this.v2.y);e=THREE.Shape.Utils.b2(e,this.v0.z,this.v1.z,this.v2.z);return new THREE.Vector3(d,f,e)});THREE.CubicBezierCurve3=THREE.Curve.create(function(f,e,h,g){this.v0=f;this.v1=e;this.v2=h;this.v3=g},function(e){var d,f;d=THREE.Shape.Utils.b3(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x);f=THREE.Shape.Utils.b3(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y);e=THREE.Shape.Utils.b3(e,this.v0.z,this.v1.z,this.v2.z,this.v3.z);return new THREE.Vector3(d,f,e)});THREE.SplineCurve3=THREE.Curve.create(function(b){this.points=void 0==b?[]:b},function(i){var g=new THREE.Vector3,n=[],m=this.points,l,i=(m.length-1)*i;l=Math.floor(i);i-=l;n[0]=0==l?l:l-1;n[1]=l;n[2]=l>m.length-2?m.length-1:l+1;n[3]=l>m.length-3?m.length-1:l+2;l=m[n[0]];var k=m[n[1]],j=m[n[2]],n=m[n[3]];g.x=THREE.Curve.Utils.interpolate(l.x,k.x,j.x,n.x,i);g.y=THREE.Curve.Utils.interpolate(l.y,k.y,j.y,n.y,i);g.z=THREE.Curve.Utils.interpolate(l.z,k.z,j.z,n.z,i);return g});THREE.ClosedSplineCurve3=THREE.Curve.create(function(b){this.points=void 0==b?[]:b},function(g){var f=new THREE.Vector3,j=[],i=this.points,h;h=(i.length-0)*g;g=Math.floor(h);h-=g;g+=0<g?0:(Math.floor(Math.abs(g)/i.length)+1)*i.length;j[0]=(g-1)%i.length;j[1]=g%i.length;j[2]=(g+1)%i.length;j[3]=(g+2)%i.length;f.x=THREE.Curve.Utils.interpolate(i[j[0]].x,i[j[1]].x,i[j[2]].x,i[j[3]].x,h);f.y=THREE.Curve.Utils.interpolate(i[j[0]].y,i[j[1]].y,i[j[2]].y,i[j[3]].y,h);f.z=THREE.Curve.Utils.interpolate(i[j[0]].z,i[j[1]].z,i[j[2]].z,i[j[3]].z,h);return f});THREE.AnimationHandler=function(){var f=[],e={},h={update:function(a){for(var d=0;d<f.length;d++){f[d].update(a)}},addToUpdate:function(a){-1===f.indexOf(a)&&f.push(a)},removeFromUpdate:function(a){a=f.indexOf(a);-1!==a&&f.splice(a,1)},add:function(j){void 0!==e[j.name]&&console.log("THREE.AnimationHandler.add: Warning! "+j.name+" already exists in library. Overwriting.");e[j.name]=j;if(!0!==j.initialized){for(var q=0;q<j.hierarchy.length;q++){for(var p=0;p<j.hierarchy[q].keys.length;p++){if(0>j.hierarchy[q].keys[p].time&&(j.hierarchy[q].keys[p].time=0),void 0!==j.hierarchy[q].keys[p].rot&&!(j.hierarchy[q].keys[p].rot instanceof THREE.Quaternion)){var o=j.hierarchy[q].keys[p].rot;j.hierarchy[q].keys[p].rot=new THREE.Quaternion(o[0],o[1],o[2],o[3])}}if(j.hierarchy[q].keys.length&&void 0!==j.hierarchy[q].keys[0].morphTargets){o={};for(p=0;p<j.hierarchy[q].keys.length;p++){for(var n=0;n<j.hierarchy[q].keys[p].morphTargets.length;n++){var l=j.hierarchy[q].keys[p].morphTargets[n];o[l]=-1}}j.hierarchy[q].usedMorphTargets=o;for(p=0;p<j.hierarchy[q].keys.length;p++){var b={};for(l in o){for(n=0;n<j.hierarchy[q].keys[p].morphTargets.length;n++){if(j.hierarchy[q].keys[p].morphTargets[n]===l){b[l]=j.hierarchy[q].keys[p].morphTargetsInfluences[n];break}}n===j.hierarchy[q].keys[p].morphTargets.length&&(b[l]=0)}j.hierarchy[q].keys[p].morphTargetsInfluences=b}}for(p=1;p<j.hierarchy[q].keys.length;p++){j.hierarchy[q].keys[p].time===j.hierarchy[q].keys[p-1].time&&(j.hierarchy[q].keys.splice(p,1),p--)}for(p=0;p<j.hierarchy[q].keys.length;p++){j.hierarchy[q].keys[p].index=p}}p=parseInt(j.length*j.fps,10);j.JIT={};j.JIT.hierarchy=[];for(q=0;q<j.hierarchy.length;q++){j.JIT.hierarchy.push(Array(p))}j.initialized=!0}},get:function(b){if("string"===typeof b){if(e[b]){return e[b]}console.log("THREE.AnimationHandler.get: Couldn't find animation "+b);return null}},parse:function(i){var d=[];if(i instanceof THREE.SkinnedMesh){for(var j=0;j<i.bones.length;j++){d.push(i.bones[j])}}else{g(i,d)}return d}},g=function(i,d){d.push(i);for(var j=0;j<i.children.length;j++){g(i.children[j],d)}};h.LINEAR=0;h.CATMULLROM=1;h.CATMULLROM_FORWARD=2;return h}();THREE.Animation=function(e,d,f){this.root=e;this.data=THREE.AnimationHandler.get(d);this.hierarchy=THREE.AnimationHandler.parse(e);this.currentTime=0;this.timeScale=1;this.isPlaying=!1;this.loop=this.isPaused=!0;this.interpolationType=void 0!==f?f:THREE.AnimationHandler.LINEAR;this.points=[];this.target=new THREE.Vector3};THREE.Animation.prototype.play=function(h,g){if(!1===this.isPlaying){this.isPlaying=!0;this.loop=void 0!==h?h:!0;this.currentTime=void 0!==g?g:0;var l,k=this.hierarchy.length,j;for(l=0;l<k;l++){j=this.hierarchy[l];j.matrixAutoUpdate=!0;void 0===j.animationCache&&(j.animationCache={},j.animationCache.prevKey={pos:0,rot:0,scl:0},j.animationCache.nextKey={pos:0,rot:0,scl:0},j.animationCache.originalMatrix=j instanceof THREE.Bone?j.skinMatrix:j.matrix);var i=j.animationCache.prevKey;j=j.animationCache.nextKey;i.pos=this.data.hierarchy[l].keys[0];i.rot=this.data.hierarchy[l].keys[0];i.scl=this.data.hierarchy[l].keys[0];j.pos=this.getNextKeyWith("pos",l,1);j.rot=this.getNextKeyWith("rot",l,1);j.scl=this.getNextKeyWith("scl",l,1)}this.update(0)}this.isPaused=!1;THREE.AnimationHandler.addToUpdate(this)};THREE.Animation.prototype.pause=function(){!0===this.isPaused?THREE.AnimationHandler.addToUpdate(this):THREE.AnimationHandler.removeFromUpdate(this);this.isPaused=!this.isPaused};THREE.Animation.prototype.stop=function(){this.isPaused=this.isPlaying=!1;THREE.AnimationHandler.removeFromUpdate(this)};THREE.Animation.prototype.update=function(E){if(!1!==this.isPlaying){var D=["pos","rot","scl"],C,B,A,v,t,u,r,q,n;n=this.currentTime+=E*this.timeScale;q=this.currentTime%=this.data.length;parseInt(Math.min(q*this.data.fps,this.data.length*this.data.fps),10);for(var o=0,j=this.hierarchy.length;o<j;o++){E=this.hierarchy[o];r=E.animationCache;for(var F=0;3>F;F++){C=D[F];t=r.prevKey[C];u=r.nextKey[C];if(u.time<=n){if(q<n){if(this.loop){t=this.data.hierarchy[o].keys[0];for(u=this.getNextKeyWith(C,o,1);u.time<q;){t=u,u=this.getNextKeyWith(C,o,u.index+1)}}else{this.stop();return}}else{do{t=u,u=this.getNextKeyWith(C,o,u.index+1)}while(u.time<q)}r.prevKey[C]=t;r.nextKey[C]=u}E.matrixAutoUpdate=!0;E.matrixWorldNeedsUpdate=!0;B=(q-t.time)/(u.time-t.time);A=t[C];v=u[C];if(0>B||1<B){console.log("THREE.Animation.update: Warning! Scale out of bounds:"+B+" on bone "+o),B=0>B?0:1}if("pos"===C){if(C=E.position,this.interpolationType===THREE.AnimationHandler.LINEAR){C.x=A[0]+(v[0]-A[0])*B,C.y=A[1]+(v[1]-A[1])*B,C.z=A[2]+(v[2]-A[2])*B}else{if(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD){this.points[0]=this.getPrevKeyWith("pos",o,t.index-1).pos,this.points[1]=A,this.points[2]=v,this.points[3]=this.getNextKeyWith("pos",o,u.index+1).pos,B=0.33*B+0.33,A=this.interpolateCatmullRom(this.points,B),C.x=A[0],C.y=A[1],C.z=A[2],this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD&&(B=this.interpolateCatmullRom(this.points,1.01*B),this.target.set(B[0],B[1],B[2]),this.target.sub(C),this.target.y=0,this.target.normalize(),B=Math.atan2(this.target.x,this.target.z),E.rotation.set(0,B,0))}}}else{"rot"===C?THREE.Quaternion.slerp(A,v,E.quaternion,B):"scl"===C&&(C=E.scale,C.x=A[0]+(v[0]-A[0])*B,C.y=A[1]+(v[1]-A[1])*B,C.z=A[2]+(v[2]-A[2])*B)}}}}};THREE.Animation.prototype.interpolateCatmullRom=function(t,s){var r=[],q=[],p,o,m,n,l,j;p=(t.length-1)*s;o=Math.floor(p);p-=o;r[0]=0===o?o:o-1;r[1]=o;r[2]=o>t.length-2?o:o+1;r[3]=o>t.length-3?o:o+2;o=t[r[0]];n=t[r[1]];l=t[r[2]];j=t[r[3]];r=p*p;m=p*r;q[0]=this.interpolate(o[0],n[0],l[0],j[0],p,r,m);q[1]=this.interpolate(o[1],n[1],l[1],j[1],p,r,m);q[2]=this.interpolate(o[2],n[2],l[2],j[2],p,r,m);return q};THREE.Animation.prototype.interpolate=function(i,g,n,m,l,k,j){i=0.5*(n-i);m=0.5*(m-g);return(2*(g-n)+i+m)*j+(-3*(g-n)-2*i-m)*k+i*l+g};THREE.Animation.prototype.getNextKeyWith=function(f,e,h){for(var g=this.data.hierarchy[e].keys,h=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?h<g.length-1?h:g.length-1:h%g.length;h<g.length;h++){if(void 0!==g[h][f]){return g[h]}}return this.data.hierarchy[e].keys[0]};THREE.Animation.prototype.getPrevKeyWith=function(f,e,h){for(var g=this.data.hierarchy[e].keys,h=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?0<h?h:0:0<=h?h:h+g.length;0<=h;h--){if(void 0!==g[h][f]){return g[h]}}return this.data.hierarchy[e].keys[g.length-1]};THREE.KeyFrameAnimation=function(i,g,n){this.root=i;this.data=THREE.AnimationHandler.get(g);this.hierarchy=THREE.AnimationHandler.parse(i);this.currentTime=0;this.timeScale=0.001;this.isPlaying=!1;this.loop=this.isPaused=!0;this.JITCompile=void 0!==n?n:!0;i=0;for(g=this.hierarchy.length;i<g;i++){var n=this.data.hierarchy[i].sids,m=this.hierarchy[i];if(this.data.hierarchy[i].keys.length&&n){for(var l=0;l<n.length;l++){var k=n[l],j=this.getNextKeyWith(k,i,0);j&&j.apply(k)}m.matrixAutoUpdate=!1;this.data.hierarchy[i].node.updateMatrix();m.matrixWorldNeedsUpdate=!0}}};THREE.KeyFrameAnimation.prototype.play=function(h,g){if(!this.isPlaying){this.isPlaying=!0;this.loop=void 0!==h?h:!0;this.currentTime=void 0!==g?g:0;this.startTimeMs=g;this.startTime=10000000;this.endTime=-this.startTime;var l,k=this.hierarchy.length,j,i;for(l=0;l<k;l++){j=this.hierarchy[l],i=this.data.hierarchy[l],void 0===i.animationCache&&(i.animationCache={},i.animationCache.prevKey=null,i.animationCache.nextKey=null,i.animationCache.originalMatrix=j instanceof THREE.Bone?j.skinMatrix:j.matrix),j=this.data.hierarchy[l].keys,j.length&&(i.animationCache.prevKey=j[0],i.animationCache.nextKey=j[1],this.startTime=Math.min(j[0].time,this.startTime),this.endTime=Math.max(j[j.length-1].time,this.endTime))}this.update(0)}this.isPaused=!1;THREE.AnimationHandler.addToUpdate(this)};THREE.KeyFrameAnimation.prototype.pause=function(){this.isPaused?THREE.AnimationHandler.addToUpdate(this):THREE.AnimationHandler.removeFromUpdate(this);this.isPaused=!this.isPaused};THREE.KeyFrameAnimation.prototype.stop=function(){this.isPaused=this.isPlaying=!1;THREE.AnimationHandler.removeFromUpdate(this);for(var f=0;f<this.data.hierarchy.length;f++){var e=this.hierarchy[f],h=this.data.hierarchy[f];if(void 0!==h.animationCache){var g=h.animationCache.originalMatrix;e instanceof THREE.Bone?(g.copy(e.skinMatrix),e.skinMatrix=g):(g.copy(e.matrix),e.matrix=g);delete h.animationCache}}};THREE.KeyFrameAnimation.prototype.update=function(D){if(this.isPlaying){var C,B,A,v,u=this.data.JIT.hierarchy,s,t,r;t=this.currentTime+=D*this.timeScale;s=this.currentTime%=this.data.length;s<this.startTimeMs&&(s=this.currentTime=this.startTimeMs+s);v=parseInt(Math.min(s*this.data.fps,this.data.length*this.data.fps),10);if((r=s<t)&&!this.loop){for(var D=0,q=this.hierarchy.length;D<q;D++){var n=this.data.hierarchy[D].keys,u=this.data.hierarchy[D].sids;A=n.length-1;v=this.hierarchy[D];if(n.length){for(n=0;n<u.length;n++){s=u[n],(t=this.getPrevKeyWith(s,D,A))&&t.apply(s)}this.data.hierarchy[D].node.updateMatrix();v.matrixWorldNeedsUpdate=!0}}this.stop()}else{if(!(s<this.startTime)){D=0;for(q=this.hierarchy.length;D<q;D++){A=this.hierarchy[D];C=this.data.hierarchy[D];var n=C.keys,o=C.animationCache;if(this.JITCompile&&void 0!==u[D][v]){A instanceof THREE.Bone?(A.skinMatrix=u[D][v],A.matrixWorldNeedsUpdate=!1):(A.matrix=u[D][v],A.matrixWorldNeedsUpdate=!0)}else{if(n.length){this.JITCompile&&o&&(A instanceof THREE.Bone?A.skinMatrix=o.originalMatrix:A.matrix=o.originalMatrix);C=o.prevKey;B=o.nextKey;if(C&&B){if(B.time<=t){if(r&&this.loop){C=n[0];for(B=n[1];B.time<s;){C=B,B=n[C.index+1]}}else{if(!r){for(var j=n.length-1;B.time<s&&B.index!==j;){C=B,B=n[C.index+1]}}}o.prevKey=C;o.nextKey=B}B.time>=s?C.interpolate(B,s):C.interpolate(B,B.time)}this.data.hierarchy[D].node.updateMatrix();A.matrixWorldNeedsUpdate=!0}}}if(this.JITCompile&&void 0===u[0][v]){this.hierarchy[0].updateMatrixWorld(!0);for(D=0;D<this.hierarchy.length;D++){u[D][v]=this.hierarchy[D] instanceof THREE.Bone?this.hierarchy[D].skinMatrix.clone():this.hierarchy[D].matrix.clone()}}}}}};THREE.KeyFrameAnimation.prototype.getNextKeyWith=function(e,d,f){d=this.data.hierarchy[d].keys;for(f%=d.length;f<d.length;f++){if(d[f].hasTarget(e)){return d[f]}}return d[0]};THREE.KeyFrameAnimation.prototype.getPrevKeyWith=function(e,d,f){d=this.data.hierarchy[d].keys;for(f=0<=f?f:f+d.length;0<=f;f--){if(d[f].hasTarget(e)){return d[f]}}return d[d.length-1]};THREE.CubeCamera=function(r,q,p){THREE.Object3D.call(this);var o=new THREE.PerspectiveCamera(90,1,r,q);o.up.set(0,-1,0);o.lookAt(new THREE.Vector3(1,0,0));this.add(o);var n=new THREE.PerspectiveCamera(90,1,r,q);n.up.set(0,-1,0);n.lookAt(new THREE.Vector3(-1,0,0));this.add(n);var m=new THREE.PerspectiveCamera(90,1,r,q);m.up.set(0,0,1);m.lookAt(new THREE.Vector3(0,1,0));this.add(m);var k=new THREE.PerspectiveCamera(90,1,r,q);k.up.set(0,0,-1);k.lookAt(new THREE.Vector3(0,-1,0));this.add(k);var l=new THREE.PerspectiveCamera(90,1,r,q);l.up.set(0,-1,0);l.lookAt(new THREE.Vector3(0,0,1));this.add(l);var j=new THREE.PerspectiveCamera(90,1,r,q);j.up.set(0,-1,0);j.lookAt(new THREE.Vector3(0,0,-1));this.add(j);this.renderTarget=new THREE.WebGLRenderTargetCube(p,p,{format:THREE.RGBFormat,magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter});this.updateCubeMap=function(e,d){var g=this.renderTarget,f=g.generateMipmaps;g.generateMipmaps=!1;g.activeCubeFace=0;e.render(d,o,g);g.activeCubeFace=1;e.render(d,n,g);g.activeCubeFace=2;e.render(d,m,g);g.activeCubeFace=3;e.render(d,k,g);g.activeCubeFace=4;e.render(d,l,g);g.generateMipmaps=f;g.activeCubeFace=5;e.render(d,j,g)}};THREE.CubeCamera.prototype=Object.create(THREE.Object3D.prototype);THREE.CombinedCamera=function(i,g,n,m,l,k,j){THREE.Camera.call(this);this.fov=n;this.left=-i/2;this.right=i/2;this.top=g/2;this.bottom=-g/2;this.cameraO=new THREE.OrthographicCamera(i/-2,i/2,g/2,g/-2,k,j);this.cameraP=new THREE.PerspectiveCamera(n,i/g,m,l);this.zoom=1;this.toPerspective()};THREE.CombinedCamera.prototype=Object.create(THREE.Camera.prototype);THREE.CombinedCamera.prototype.toPerspective=function(){this.near=this.cameraP.near;this.far=this.cameraP.far;this.cameraP.fov=this.fov/this.zoom;this.cameraP.updateProjectionMatrix();this.projectionMatrix=this.cameraP.projectionMatrix;this.inPerspectiveMode=!0;this.inOrthographicMode=!1};THREE.CombinedCamera.prototype.toOrthographic=function(){var d=this.cameraP.aspect,c=(this.cameraP.near+this.cameraP.far)/2,c=Math.tan(this.fov/2)*c,d=2*c*d/2,c=c/this.zoom,d=d/this.zoom;this.cameraO.left=-d;this.cameraO.right=d;this.cameraO.top=c;this.cameraO.bottom=-c;this.cameraO.updateProjectionMatrix();this.near=this.cameraO.near;this.far=this.cameraO.far;this.projectionMatrix=this.cameraO.projectionMatrix;this.inPerspectiveMode=!1;this.inOrthographicMode=!0};THREE.CombinedCamera.prototype.setSize=function(d,c){this.cameraP.aspect=d/c;this.left=-d/2;this.right=d/2;this.top=c/2;this.bottom=-c/2};THREE.CombinedCamera.prototype.setFov=function(b){this.fov=b;this.inPerspectiveMode?this.toPerspective():this.toOrthographic()};THREE.CombinedCamera.prototype.updateProjectionMatrix=function(){this.inPerspectiveMode?this.toPerspective():(this.toPerspective(),this.toOrthographic())};THREE.CombinedCamera.prototype.setLens=function(e,d){void 0===d&&(d=24);var f=2*THREE.Math.radToDeg(Math.atan(d/(2*e)));this.setFov(f);return f};THREE.CombinedCamera.prototype.setZoom=function(b){this.zoom=b;this.inPerspectiveMode?this.toPerspective():this.toOrthographic()};THREE.CombinedCamera.prototype.toFrontView=function(){this.rotation.x=0;this.rotation.y=0;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toBackView=function(){this.rotation.x=0;this.rotation.y=Math.PI;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toLeftView=function(){this.rotation.x=0;this.rotation.y=-Math.PI/2;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toRightView=function(){this.rotation.x=0;this.rotation.y=Math.PI/2;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toTopView=function(){this.rotation.x=-Math.PI/2;this.rotation.y=0;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toBottomView=function(){this.rotation.x=Math.PI/2;this.rotation.y=0;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CircleGeometry=function(r,q,p,o){THREE.Geometry.call(this);this.radius=r=r||50;this.segments=q=void 0!==q?Math.max(3,q):8;this.thetaStart=p=void 0!==p?p:0;this.thetaLength=o=void 0!==o?o:2*Math.PI;var n,m=[];n=new THREE.Vector3;var k=new THREE.Vector2(0.5,0.5);this.vertices.push(n);m.push(k);for(n=0;n<=q;n++){var l=new THREE.Vector3,j=p+n/q*o;l.x=r*Math.cos(j);l.y=r*Math.sin(j);this.vertices.push(l);m.push(new THREE.Vector2((l.x/r+1)/2,(l.y/r+1)/2))}p=new THREE.Vector3(0,0,1);for(n=1;n<=q;n++){this.faces.push(new THREE.Face3(n,n+1,0,[p,p,p])),this.faceVertexUvs[0].push([m[n],m[n+1],k])}this.computeCentroids();this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,r)};THREE.CircleGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.CubeGeometry=function(j,i,p,o,n,m){function k(V,U,T,S,R,Q,P,N){var J,L=l.widthSegments,G=l.heightSegments,v=R/2,s=Q/2,K=l.vertices.length;if("x"===V&&"y"===U||"y"===V&&"x"===U){J="z"}else{if("x"===V&&"z"===U||"z"===V&&"x"===U){J="y",G=l.depthSegments}else{if("z"===V&&"y"===U||"y"===V&&"z"===U){J="x",L=l.depthSegments}}}var H=L+1,t=G+1,E=R/L,M=Q/G,g=new THREE.Vector3;g[J]=0<P?1:-1;for(R=0;R<t;R++){for(Q=0;Q<H;Q++){var I=new THREE.Vector3;I[V]=(Q*E-v)*T;I[U]=(R*M-s)*S;I[J]=P;l.vertices.push(I)}}for(R=0;R<G;R++){for(Q=0;Q<L;Q++){s=Q+H*R,V=Q+H*(R+1),U=Q+1+H*(R+1),T=Q+1+H*R,S=new THREE.Vector2(Q/L,1-R/G),P=new THREE.Vector2(Q/L,1-(R+1)/G),J=new THREE.Vector2((Q+1)/L,1-(R+1)/G),v=new THREE.Vector2((Q+1)/L,1-R/G),s=new THREE.Face3(s+K,V+K,T+K),s.normal.copy(g),s.vertexNormals.push(g.clone(),g.clone(),g.clone()),s.materialIndex=N,l.faces.push(s),l.faceVertexUvs[0].push([S,P,v]),s=new THREE.Face3(V+K,U+K,T+K),s.normal.copy(g),s.vertexNormals.push(g.clone(),g.clone(),g.clone()),s.materialIndex=N,l.faces.push(s),l.faceVertexUvs[0].push([P.clone(),J,v.clone()])}}}THREE.Geometry.call(this);var l=this;this.width=j;this.height=i;this.depth=p;this.widthSegments=o||1;this.heightSegments=n||1;this.depthSegments=m||1;j=this.width/2;i=this.height/2;p=this.depth/2;k("z","y",-1,-1,this.depth,this.height,j,0);k("z","y",1,-1,this.depth,this.height,-j,1);k("x","z",1,1,this.width,this.depth,i,2);k("x","z",1,-1,this.width,this.depth,-i,3);k("x","y",1,-1,this.width,this.height,p,4);k("x","y",-1,-1,this.width,this.height,-p,5);this.computeCentroids();this.mergeVertices()};THREE.CubeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.CylinderGeometry=function(Y,X,W,V,U,T){THREE.Geometry.call(this);this.radiusTop=Y=void 0!==Y?Y:20;this.radiusBottom=X=void 0!==X?X:20;this.height=W=void 0!==W?W:100;this.radialSegments=V=V||8;this.heightSegments=U=U||1;this.openEnded=T=void 0!==T?T:!1;var R=W/2,S,Q,P=[],N=[];for(Q=0;Q<=U;Q++){var O=[],L=[],H=Q/U,E=H*(X-Y)+Y;for(S=0;S<=V;S++){var M=S/V,I=new THREE.Vector3;I.x=E*Math.sin(2*M*Math.PI);I.y=-H*W+R;I.z=E*Math.cos(2*M*Math.PI);this.vertices.push(I);O.push(this.vertices.length-1);L.push(new THREE.Vector2(M,1-H))}P.push(O);N.push(L)}W=(X-Y)/W;for(S=0;S<V;S++){0!==Y?(O=this.vertices[P[0][S]].clone(),L=this.vertices[P[0][S+1]].clone()):(O=this.vertices[P[1][S]].clone(),L=this.vertices[P[1][S+1]].clone());O.setY(Math.sqrt(O.x*O.x+O.z*O.z)*W).normalize();L.setY(Math.sqrt(L.x*L.x+L.z*L.z)*W).normalize();for(Q=0;Q<U;Q++){var H=P[Q][S],E=P[Q+1][S],M=P[Q+1][S+1],I=P[Q][S+1],K=O.clone(),C=O.clone(),v=L.clone(),j=L.clone(),J=N[Q][S].clone(),G=N[Q+1][S].clone(),o=N[Q+1][S+1].clone(),A=N[Q][S+1].clone();this.faces.push(new THREE.Face3(H,E,I,[K,C,j]));this.faceVertexUvs[0].push([J,G,A]);this.faces.push(new THREE.Face3(E,M,I,[C,v,j]));this.faceVertexUvs[0].push([G,o,A])}}if(!1===T&&0<Y){this.vertices.push(new THREE.Vector3(0,R,0));for(S=0;S<V;S++){H=P[0][S],E=P[0][S+1],M=this.vertices.length-1,K=new THREE.Vector3(0,1,0),C=new THREE.Vector3(0,1,0),v=new THREE.Vector3(0,1,0),J=N[0][S].clone(),G=N[0][S+1].clone(),o=new THREE.Vector2(G.u,0),this.faces.push(new THREE.Face3(H,E,M,[K,C,v])),this.faceVertexUvs[0].push([J,G,o])}}if(!1===T&&0<X){this.vertices.push(new THREE.Vector3(0,-R,0));for(S=0;S<V;S++){H=P[Q][S+1],E=P[Q][S],M=this.vertices.length-1,K=new THREE.Vector3(0,-1,0),C=new THREE.Vector3(0,-1,0),v=new THREE.Vector3(0,-1,0),J=N[Q][S+1].clone(),G=N[Q][S].clone(),o=new THREE.Vector2(G.u,1),this.faces.push(new THREE.Face3(H,E,M,[K,C,v])),this.faceVertexUvs[0].push([J,G,o])}}this.computeCentroids();this.computeFaceNormals()};THREE.CylinderGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ExtrudeGeometry=function(d,c){"undefined"!==typeof d&&(THREE.Geometry.call(this),d=d instanceof Array?d:[d],this.shapebb=d[d.length-1].getBoundingBox(),this.addShapeList(d,c),this.computeCentroids(),this.computeFaceNormals())};THREE.ExtrudeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ExtrudeGeometry.prototype.addShapeList=function(f,e){for(var h=f.length,g=0;g<h;g++){this.addShape(f[g],e)}};THREE.ExtrudeGeometry.prototype.addShape=function(aD,aC){function aB(e,d,f){d||console.log("die");return d.clone().multiplyScalar(f).add(e)}function aA(t,s,r){var q=THREE.ExtrudeGeometry.__v1,p=THREE.ExtrudeGeometry.__v2,n=THREE.ExtrudeGeometry.__v3,m=THREE.ExtrudeGeometry.__v4,l=THREE.ExtrudeGeometry.__v5,k=THREE.ExtrudeGeometry.__v6;q.set(t.x-s.x,t.y-s.y);p.set(t.x-r.x,t.y-r.y);q=q.normalize();p=p.normalize();n.set(-q.y,q.x);m.set(p.y,-p.x);l.copy(t).add(n);k.copy(t).add(m);if(l.equals(k)){return m.clone()}l.copy(s).add(n);k.copy(r).add(m);n=q.dot(m);m=k.sub(l).dot(m);0===n&&(console.log("Either infinite or no solutions!"),0===m?console.log("Its finite solutions."):console.log("Too bad, no solutions."));m/=n;return 0>m?(s=Math.atan2(s.y-t.y,s.x-t.x),t=Math.atan2(r.y-t.y,r.x-t.x),s>t&&(t+=2*Math.PI),r=(s+t)/2,t=-Math.cos(r),r=-Math.sin(r),new THREE.Vector2(t,r)):q.multiplyScalar(m).add(l).sub(t).clone()}function az(I,G){var F,E;for(L=I.length;0<=--L;){F=L;E=L-1;0>E&&(E=I.length-1);for(var D=0,C=am+2*ar,D=0;D<C;D++){var B=aE*D,A=aE*(D+1),u=G+F+B,B=G+E+B,m=G+E+A,A=G+F+A,s=I,b=D,a=C,K=F,J=E,u=u+X,B=B+X,m=m+X,A=A+X;Z.faces.push(new THREE.Face3(u,B,A,null,null,ak));Z.faces.push(new THREE.Face3(B,m,A,null,null,ak));u=ah.generateSideWallUV(Z,aD,s,aC,u,B,m,A,b,a,K,J);Z.faceVertexUvs[0].push([u[0],u[1],u[3]]);Z.faceVertexUvs[0].push([u[1],u[2],u[3]])}}}function ay(e,d,f){Z.vertices.push(new THREE.Vector3(e,d,f))}function aw(h,g,b,a){h+=X;g+=X;b+=X;Z.faces.push(new THREE.Face3(h,g,b,null,null,ao));h=a?ah.generateBottomUV(Z,aD,aC,h,g,b):ah.generateTopUV(Z,aD,aC,h,g,b);Z.faceVertexUvs[0].push(h)}var ax=void 0!==aC.amount?aC.amount:100,av=void 0!==aC.bevelThickness?aC.bevelThickness:6,au=void 0!==aC.bevelSize?aC.bevelSize:av-2,ar=void 0!==aC.bevelSegments?aC.bevelSegments:3,at=void 0!==aC.bevelEnabled?aC.bevelEnabled:!0,ap=void 0!==aC.curveSegments?aC.curveSegments:12,am=void 0!==aC.steps?aC.steps:1,al=aC.extrudePath,aq,an=!1,ao=aC.material,ak=aC.extrudeMaterial,ah=void 0!==aC.UVGenerator?aC.UVGenerator:THREE.ExtrudeGeometry.WorldUVGenerator,ae,aa,Y,ag;al&&(aq=al.getSpacedPoints(am),an=!0,at=!1,ae=void 0!==aC.frames?aC.frames:new THREE.TubeGeometry.FrenetFrames(al,am,!1),aa=new THREE.Vector3,Y=new THREE.Vector3,ag=new THREE.Vector3);at||(au=av=ar=0);var W,ab,H,Z=this,X=this.vertices.length,ap=aD.extractPoints(ap),U=ap.shape,ap=ap.holes;if(al=!THREE.Shape.Utils.isClockWise(U)){U=U.reverse();ab=0;for(H=ap.length;ab<H;ab++){W=ap[ab],THREE.Shape.Utils.isClockWise(W)&&(ap[ab]=W.reverse())}al=!1}var af=THREE.Shape.Utils.triangulateShape(U,ap),al=U;ab=0;for(H=ap.length;ab<H;ab++){W=ap[ab],U=U.concat(W)}var aj,V,j,T,aE=U.length,ai=af.length,ac=[],L=0,P=al.length;aj=P-1;for(V=L+1;L<P;L++,aj++,V++){aj===P&&(aj=0),V===P&&(V=0),ac[L]=aA(al[L],al[aj],al[V])}var o=[],S,ad=ac.concat();ab=0;for(H=ap.length;ab<H;ab++){W=ap[ab];S=[];L=0;P=W.length;aj=P-1;for(V=L+1;L<P;L++,aj++,V++){aj===P&&(aj=0),V===P&&(V=0),S[L]=aA(W[L],W[aj],W[V])}o.push(S);ad=ad.concat(S)}for(aj=0;aj<ar;aj++){W=aj/ar;j=av*(1-W);V=au*Math.sin(W*Math.PI/2);L=0;for(P=al.length;L<P;L++){T=aB(al[L],ac[L],V),ay(T.x,T.y,-j)}ab=0;for(H=ap.length;ab<H;ab++){W=ap[ab];S=o[ab];L=0;for(P=W.length;L<P;L++){T=aB(W[L],S[L],V),ay(T.x,T.y,-j)}}}V=au;for(L=0;L<aE;L++){T=at?aB(U[L],ad[L],V):U[L],an?(Y.copy(ae.normals[0]).multiplyScalar(T.x),aa.copy(ae.binormals[0]).multiplyScalar(T.y),ag.copy(aq[0]).add(Y).add(aa),ay(ag.x,ag.y,ag.z)):ay(T.x,T.y,0)}for(W=1;W<=am;W++){for(L=0;L<aE;L++){T=at?aB(U[L],ad[L],V):U[L],an?(Y.copy(ae.normals[W]).multiplyScalar(T.x),aa.copy(ae.binormals[W]).multiplyScalar(T.y),ag.copy(aq[W]).add(Y).add(aa),ay(ag.x,ag.y,ag.z)):ay(T.x,T.y,ax/am*W)}}for(aj=ar-1;0<=aj;aj--){W=aj/ar;j=av*(1-W);V=au*Math.sin(W*Math.PI/2);L=0;for(P=al.length;L<P;L++){T=aB(al[L],ac[L],V),ay(T.x,T.y,ax+j)}ab=0;for(H=ap.length;ab<H;ab++){W=ap[ab];S=o[ab];L=0;for(P=W.length;L<P;L++){T=aB(W[L],S[L],V),an?ay(T.x,T.y+aq[am-1].y,aq[am-1].x+j):ay(T.x,T.y,ax+j)}}}if(at){av=0*aE;for(L=0;L<ai;L++){ax=af[L],aw(ax[2]+av,ax[1]+av,ax[0]+av,!0)}av=aE*(am+2*ar);for(L=0;L<ai;L++){ax=af[L],aw(ax[0]+av,ax[1]+av,ax[2]+av,!1)}}else{for(L=0;L<ai;L++){ax=af[L],aw(ax[2],ax[1],ax[0],!0)}for(L=0;L<ai;L++){ax=af[L],aw(ax[0]+aE*am,ax[1]+aE*am,ax[2]+aE*am,!1)}}ax=0;az(al,ax);ax+=al.length;ab=0;for(H=ap.length;ab<H;ab++){W=ap[ab],az(W,ax),ax+=W.length}};THREE.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(h,g,l,k,j,i){g=h.vertices[j].x;j=h.vertices[j].y;l=h.vertices[i].x;i=h.vertices[i].y;return[new THREE.Vector2(h.vertices[k].x,h.vertices[k].y),new THREE.Vector2(g,j),new THREE.Vector2(l,i)]},generateBottomUV:function(h,g,l,k,j,i){return this.generateTopUV(h,g,l,k,j,i)},generateSideWallUV:function(D,C,B,A,v,u,s,t){var C=D.vertices[v].x,B=D.vertices[v].y,v=D.vertices[v].z,A=D.vertices[u].x,r=D.vertices[u].y,u=D.vertices[u].z,q=D.vertices[s].x,n=D.vertices[s].y,s=D.vertices[s].z,o=D.vertices[t].x,j=D.vertices[t].y,D=D.vertices[t].z;return 0.01>Math.abs(B-r)?[new THREE.Vector2(C,1-v),new THREE.Vector2(A,1-u),new THREE.Vector2(q,1-s),new THREE.Vector2(o,1-D)]:[new THREE.Vector2(B,1-v),new THREE.Vector2(r,1-u),new THREE.Vector2(n,1-s),new THREE.Vector2(j,1-D)]}};THREE.ExtrudeGeometry.__v1=new THREE.Vector2;THREE.ExtrudeGeometry.__v2=new THREE.Vector2;THREE.ExtrudeGeometry.__v3=new THREE.Vector2;THREE.ExtrudeGeometry.__v4=new THREE.Vector2;THREE.ExtrudeGeometry.__v5=new THREE.Vector2;THREE.ExtrudeGeometry.__v6=new THREE.Vector2;THREE.ShapeGeometry=function(d,c){THREE.Geometry.call(this);!1===d instanceof Array&&(d=[d]);this.shapebb=d[d.length-1].getBoundingBox();this.addShapeList(d,c);this.computeCentroids();this.computeFaceNormals()};THREE.ShapeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ShapeGeometry.prototype.addShapeList=function(f,e){for(var h=0,g=f.length;h<g;h++){this.addShape(f[h],e)}return this};THREE.ShapeGeometry.prototype.addShape=function(v,u){void 0===u&&(u={});var t=u.material,s=void 0===u.UVGenerator?THREE.ExtrudeGeometry.WorldUVGenerator:u.UVGenerator,r,q,o,p=this.vertices.length;r=v.extractPoints(void 0!==u.curveSegments?u.curveSegments:12);var n=r.shape,l=r.holes;if(!THREE.Shape.Utils.isClockWise(n)){n=n.reverse();r=0;for(q=l.length;r<q;r++){o=l[r],THREE.Shape.Utils.isClockWise(o)&&(l[r]=o.reverse())}}var j=THREE.Shape.Utils.triangulateShape(n,l);r=0;for(q=l.length;r<q;r++){o=l[r],n=n.concat(o)}l=n.length;q=j.length;for(r=0;r<l;r++){o=n[r],this.vertices.push(new THREE.Vector3(o.x,o.y,0))}for(r=0;r<q;r++){l=j[r],n=l[0]+p,o=l[1]+p,l=l[2]+p,this.faces.push(new THREE.Face3(n,o,l,null,null,t)),this.faceVertexUvs[0].push(s.generateBottomUV(this,v,u,n,o,l))}};THREE.LatheGeometry=function(H,G,F,E){THREE.Geometry.call(this);for(var G=G||12,F=F||0,E=E||2*Math.PI,D=1/(H.length-1),C=1/G,A=0,B=G;A<=B;A++){for(var v=F+A*C*E,u=Math.cos(v),q=Math.sin(v),v=0,r=H.length;v<r;v++){var j=H[v],J=new THREE.Vector3;J.x=u*j.x-q*j.y;J.y=q*j.x+u*j.y;J.z=j.z;this.vertices.push(J)}}F=H.length;A=0;for(B=G;A<B;A++){v=0;for(r=H.length-1;v<r;v++){var G=q=v+F*A,E=q+F,u=q+1+F,q=q+1,j=A*C,J=v*D,I=j+C,o=J+D;this.faces.push(new THREE.Face3(G,E,q));this.faceVertexUvs[0].push([new THREE.Vector2(j,J),new THREE.Vector2(I,J),new THREE.Vector2(j,o)]);this.faces.push(new THREE.Face3(E,u,q));this.faceVertexUvs[0].push([new THREE.Vector2(I,J),new THREE.Vector2(I,o),new THREE.Vector2(j,o)])}}this.mergeVertices();this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.LatheGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.PlaneGeometry=function(E,D,C,B){THREE.Geometry.call(this);this.width=E;this.height=D;this.widthSegments=C||1;this.heightSegments=B||1;for(var A=E/2,v=D/2,C=this.widthSegments,B=this.heightSegments,t=C+1,u=B+1,r=this.width/C,q=this.height/B,n=new THREE.Vector3(0,0,1),E=0;E<u;E++){for(D=0;D<t;D++){this.vertices.push(new THREE.Vector3(D*r-A,-(E*q-v),0))}}for(E=0;E<B;E++){for(D=0;D<C;D++){var o=D+t*E,A=D+t*(E+1),v=D+1+t*(E+1),u=D+1+t*E,r=new THREE.Vector2(D/C,1-E/B),q=new THREE.Vector2(D/C,1-(E+1)/B),j=new THREE.Vector2((D+1)/C,1-(E+1)/B),F=new THREE.Vector2((D+1)/C,1-E/B),o=new THREE.Face3(o,A,u);o.normal.copy(n);o.vertexNormals.push(n.clone(),n.clone(),n.clone());this.faces.push(o);this.faceVertexUvs[0].push([r,q,F]);o=new THREE.Face3(A,v,u);o.normal.copy(n);o.vertexNormals.push(n.clone(),n.clone(),n.clone());this.faces.push(o);this.faceVertexUvs[0].push([q.clone(),j,F.clone()])}}this.computeCentroids()};THREE.PlaneGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.RingGeometry=function(B,A,v,u,t,s){THREE.Geometry.call(this);for(var B=B||0,A=A||50,t=void 0!==t?t:0,s=void 0!==s?s:2*Math.PI,v=void 0!==v?Math.max(3,v):8,u=void 0!==u?Math.max(3,u):8,q=[],r=B,p=(A-B)/u,B=0;B<=u;B++){for(A=0;A<=v;A++){var o=new THREE.Vector3,j=t+A/v*s;o.x=r*Math.cos(j);o.y=r*Math.sin(j);this.vertices.push(o);q.push(new THREE.Vector2((o.x/r+1)/2,-(o.y/r+1)/2+1))}r+=p}t=new THREE.Vector3(0,0,1);for(B=0;B<u;B++){s=B*v;for(A=0;A<=v;A++){var j=A+s,p=j+B,o=j+v+B,n=j+v+1+B;this.faces.push(new THREE.Face3(p,o,n,[t,t,t]));this.faceVertexUvs[0].push([q[p],q[o],q[n]]);p=j+B;o=j+v+1+B;n=j+1+B;this.faces.push(new THREE.Face3(p,o,n,[t,t,t]));this.faceVertexUvs[0].push([q[p],q[o],q[n]])}}this.computeCentroids();this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,r)};THREE.RingGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.SphereGeometry=function(J,I,H,G,F,E,C){THREE.Geometry.call(this);this.radius=J=J||50;this.widthSegments=I=Math.max(3,Math.floor(I)||8);this.heightSegments=H=Math.max(2,Math.floor(H)||6);this.phiStart=G=void 0!==G?G:0;this.phiLength=F=void 0!==F?F:2*Math.PI;this.thetaStart=E=void 0!==E?E:0;this.thetaLength=C=void 0!==C?C:Math.PI;var D,B,A=[],u=[];for(B=0;B<=H;B++){var v=[],o=[];for(D=0;D<=I;D++){var L=D/I,K=B/H,q=new THREE.Vector3;q.x=-J*Math.cos(G+L*F)*Math.sin(E+K*C);q.y=J*Math.cos(E+K*C);q.z=J*Math.sin(G+L*F)*Math.sin(E+K*C);this.vertices.push(q);v.push(this.vertices.length-1);o.push(new THREE.Vector2(L,1-K))}A.push(v);u.push(o)}for(B=0;B<this.heightSegments;B++){for(D=0;D<this.widthSegments;D++){var I=A[B][D+1],H=A[B][D],G=A[B+1][D],F=A[B+1][D+1],E=this.vertices[I].clone().normalize(),C=this.vertices[H].clone().normalize(),v=this.vertices[G].clone().normalize(),o=this.vertices[F].clone().normalize(),L=u[B][D+1].clone(),K=u[B][D].clone(),q=u[B+1][D].clone(),j=u[B+1][D+1].clone();Math.abs(this.vertices[I].y)===this.radius?(this.faces.push(new THREE.Face3(I,G,F,[E,v,o])),this.faceVertexUvs[0].push([L,q,j])):Math.abs(this.vertices[G].y)===this.radius?(this.faces.push(new THREE.Face3(I,H,G,[E,C,v])),this.faceVertexUvs[0].push([L,K,q])):(this.faces.push(new THREE.Face3(I,H,F,[E,C,o])),this.faceVertexUvs[0].push([L,K,j]),this.faces.push(new THREE.Face3(H,G,F,[C,v,o])),this.faceVertexUvs[0].push([K.clone(),q,j.clone()]))}}this.computeCentroids();this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,J)};THREE.SphereGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TextGeometry=function(e,d){var d=d||{},f=THREE.FontUtils.generateShapes(e,d);d.amount=void 0!==d.height?d.height:50;void 0===d.bevelThickness&&(d.bevelThickness=10);void 0===d.bevelSize&&(d.bevelSize=8);void 0===d.bevelEnabled&&(d.bevelEnabled=!1);THREE.ExtrudeGeometry.call(this,f,d)};THREE.TextGeometry.prototype=Object.create(THREE.ExtrudeGeometry.prototype);THREE.TorusGeometry=function(r,q,p,o,n){THREE.Geometry.call(this);this.radius=r||100;this.tube=q||40;this.radialSegments=p||8;this.tubularSegments=o||6;this.arc=n||2*Math.PI;n=new THREE.Vector3;r=[];q=[];for(p=0;p<=this.radialSegments;p++){for(o=0;o<=this.tubularSegments;o++){var m=o/this.tubularSegments*this.arc,k=2*p/this.radialSegments*Math.PI;n.x=this.radius*Math.cos(m);n.y=this.radius*Math.sin(m);var l=new THREE.Vector3;l.x=(this.radius+this.tube*Math.cos(k))*Math.cos(m);l.y=(this.radius+this.tube*Math.cos(k))*Math.sin(m);l.z=this.tube*Math.sin(k);this.vertices.push(l);r.push(new THREE.Vector2(o/this.tubularSegments,p/this.radialSegments));q.push(l.clone().sub(n).normalize())}}for(p=1;p<=this.radialSegments;p++){for(o=1;o<=this.tubularSegments;o++){var n=(this.tubularSegments+1)*p+o-1,m=(this.tubularSegments+1)*(p-1)+o-1,k=(this.tubularSegments+1)*(p-1)+o,l=(this.tubularSegments+1)*p+o,j=new THREE.Face3(n,m,l,[q[n],q[m],q[l]]);j.normal.add(q[n]);j.normal.add(q[m]);j.normal.add(q[l]);j.normal.normalize();this.faces.push(j);this.faceVertexUvs[0].push([r[n].clone(),r[m].clone(),r[l].clone()]);j=new THREE.Face3(m,k,l,[q[m],q[k],q[l]]);j.normal.add(q[m]);j.normal.add(q[k]);j.normal.add(q[l]);j.normal.normalize();this.faces.push(j);this.faceVertexUvs[0].push([r[m].clone(),r[k].clone(),r[l].clone()])}}this.computeCentroids()};THREE.TorusGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TorusKnotGeometry=function(v,u,t,s,r,q,o){function p(i,h,C,B,A){var m=Math.cos(i),k=Math.sin(i),i=h/C*i,h=Math.cos(i),m=0.5*(B*(2+h))*m,k=0.5*B*(2+h)*k,B=0.5*A*B*Math.sin(i);return new THREE.Vector3(m,k,B)}THREE.Geometry.call(this);this.radius=v||100;this.tube=u||40;this.radialSegments=t||64;this.tubularSegments=s||8;this.p=r||2;this.q=q||3;this.heightScale=o||1;this.grid=Array(this.radialSegments);t=new THREE.Vector3;s=new THREE.Vector3;r=new THREE.Vector3;for(v=0;v<this.radialSegments;++v){this.grid[v]=Array(this.tubularSegments);u=2*(v/this.radialSegments)*this.p*Math.PI;q=p(u,this.q,this.p,this.radius,this.heightScale);u=p(u+0.01,this.q,this.p,this.radius,this.heightScale);t.subVectors(u,q);s.addVectors(u,q);r.crossVectors(t,s);s.crossVectors(r,t);r.normalize();s.normalize();for(u=0;u<this.tubularSegments;++u){var n=2*(u/this.tubularSegments)*Math.PI,o=-this.tube*Math.cos(n),n=this.tube*Math.sin(n),l=new THREE.Vector3;l.x=q.x+o*s.x+n*r.x;l.y=q.y+o*s.y+n*r.y;l.z=q.z+o*s.z+n*r.z;this.grid[v][u]=this.vertices.push(l)-1}}for(v=0;v<this.radialSegments;++v){for(u=0;u<this.tubularSegments;++u){var r=(v+1)%this.radialSegments,q=(u+1)%this.tubularSegments,t=this.grid[v][u],s=this.grid[r][u],r=this.grid[r][q],q=this.grid[v][q],o=new THREE.Vector2(v/this.radialSegments,u/this.tubularSegments),n=new THREE.Vector2((v+1)/this.radialSegments,u/this.tubularSegments),l=new THREE.Vector2((v+1)/this.radialSegments,(u+1)/this.tubularSegments),j=new THREE.Vector2(v/this.radialSegments,(u+1)/this.tubularSegments);this.faces.push(new THREE.Face3(t,s,q));this.faceVertexUvs[0].push([o,n,j]);this.faces.push(new THREE.Face3(s,r,q));this.faceVertexUvs[0].push([n.clone(),l,j.clone()])}}this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.TorusKnotGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TubeGeometry=function(B,A,v,u,t){THREE.Geometry.call(this);this.path=B;this.segments=A||64;this.radius=v||1;this.radialSegments=u||8;this.closed=t||!1;this.grid=[];var s,q,u=this.segments+1,r,p,o,t=new THREE.Vector3,j,n,A=new THREE.TubeGeometry.FrenetFrames(this.path,this.segments,this.closed);j=A.normals;n=A.binormals;this.tangents=A.tangents;this.normals=j;this.binormals=n;for(A=0;A<u;A++){this.grid[A]=[];v=A/(u-1);o=B.getPointAt(v);s=j[A];q=n[A];for(v=0;v<this.radialSegments;v++){r=2*(v/this.radialSegments)*Math.PI,p=-this.radius*Math.cos(r),r=this.radius*Math.sin(r),t.copy(o),t.x+=p*s.x+r*q.x,t.y+=p*s.y+r*q.y,t.z+=p*s.z+r*q.z,this.grid[A][v]=this.vertices.push(new THREE.Vector3(t.x,t.y,t.z))-1}}for(A=0;A<this.segments;A++){for(v=0;v<this.radialSegments;v++){t=this.closed?(A+1)%this.segments:A+1,j=(v+1)%this.radialSegments,B=this.grid[A][v],u=this.grid[t][v],t=this.grid[t][j],j=this.grid[A][j],n=new THREE.Vector2(A/this.segments,v/this.radialSegments),s=new THREE.Vector2((A+1)/this.segments,v/this.radialSegments),q=new THREE.Vector2((A+1)/this.segments,(v+1)/this.radialSegments),p=new THREE.Vector2(A/this.segments,(v+1)/this.radialSegments),this.faces.push(new THREE.Face3(B,u,j)),this.faceVertexUvs[0].push([n,s,p]),this.faces.push(new THREE.Face3(u,t,j)),this.faceVertexUvs[0].push([s.clone(),q,p.clone()])}}this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.TubeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TubeGeometry.FrenetFrames=function(B,A,v){new THREE.Vector3;var u=new THREE.Vector3;new THREE.Vector3;var t=[],s=[],q=[],r=new THREE.Vector3,p=new THREE.Matrix4,A=A+1,o,j,n;this.tangents=t;this.normals=s;this.binormals=q;for(o=0;o<A;o++){j=o/(A-1),t[o]=B.getTangentAt(j),t[o].normalize()}s[0]=new THREE.Vector3;q[0]=new THREE.Vector3;B=Number.MAX_VALUE;o=Math.abs(t[0].x);j=Math.abs(t[0].y);n=Math.abs(t[0].z);o<=B&&(B=o,u.set(1,0,0));j<=B&&(B=j,u.set(0,1,0));n<=B&&u.set(0,0,1);r.crossVectors(t[0],u).normalize();s[0].crossVectors(t[0],r);q[0].crossVectors(t[0],s[0]);for(o=1;o<A;o++){s[o]=s[o-1].clone(),q[o]=q[o-1].clone(),r.crossVectors(t[o-1],t[o]),0.0001<r.length()&&(r.normalize(),u=Math.acos(THREE.Math.clamp(t[o-1].dot(t[o]),-1,1)),s[o].applyMatrix4(p.makeRotationAxis(r,u))),q[o].crossVectors(t[o],s[o])}if(v){u=Math.acos(THREE.Math.clamp(s[0].dot(s[A-1]),-1,1));u/=A-1;0<t[0].dot(r.crossVectors(s[0],s[A-1]))&&(u=-u);for(o=1;o<A;o++){s[o].applyMatrix4(p.makeRotationAxis(t[o],u*o)),q[o].crossVectors(t[o],s[o])}}};THREE.PolyhedronGeometry=function(P,O,N,M){function L(e){var d=e.normalize().clone();d.index=J.vertices.push(d)-1;var f=Math.atan2(e.z,-e.x)/2/Math.PI+0.5,e=Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))/Math.PI+0.5;d.uv=new THREE.Vector2(f,1-e);return d}function K(f,e,h){var g=new THREE.Face3(f.index,e.index,h.index,[f.clone(),e.clone(),h.clone()]);g.centroid.add(f).add(e).add(h).divideScalar(3);J.faces.push(g);g=Math.atan2(g.centroid.z,-g.centroid.x);J.faceVertexUvs[0].push([I(f.uv,f,g),I(e.uv,e,g),I(h.uv,h,g)])}function I(e,d,f){0>f&&1===e.x&&(e=new THREE.Vector2(e.x-1,e.y));0===d.x&&0===d.z&&(e=new THREE.Vector2(f/2/Math.PI+0.5,e.y));return e.clone()}THREE.Geometry.call(this);for(var N=N||1,M=M||0,J=this,H=0,G=P.length;H<G;H++){L(new THREE.Vector3(P[H][0],P[H][1],P[H][2]))}for(var E=this.vertices,P=[],H=0,G=O.length;H<G;H++){var F=E[O[H][0]],C=E[O[H][1]],v=E[O[H][2]];P[H]=new THREE.Face3(F.index,C.index,v.index,[F.clone(),C.clone(),v.clone()])}H=0;for(G=P.length;H<G;H++){C=P[H];E=M;O=Math.pow(2,E);Math.pow(4,E);for(var E=L(J.vertices[C.a]),F=L(J.vertices[C.b]),o=L(J.vertices[C.c]),C=[],v=0;v<=O;v++){C[v]=[];for(var D=L(E.clone().lerp(o,v/O)),A=L(F.clone().lerp(o,v/O)),B=O-v,j=0;j<=B;j++){C[v][j]=0==j&&v==O?D:L(D.clone().lerp(A,j/B))}}for(v=0;v<O;v++){for(j=0;j<2*(O-v)-1;j++){E=Math.floor(j/2),0==j%2?K(C[v][E+1],C[v+1][E],C[v][E]):K(C[v][E+1],C[v+1][E+1],C[v+1][E])}}}H=0;for(G=this.faceVertexUvs[0].length;H<G;H++){M=this.faceVertexUvs[0][H],P=M[0].x,O=M[1].x,E=M[2].x,F=Math.max(P,Math.max(O,E)),C=Math.min(P,Math.min(O,E)),0.9<F&&0.1>C&&(0.2>P&&(M[0].x+=1),0.2>O&&(M[1].x+=1),0.2>E&&(M[2].x+=1))}H=0;for(G=this.vertices.length;H<G;H++){this.vertices[H].multiplyScalar(N)}this.mergeVertices();this.computeCentroids();this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,N)};THREE.PolyhedronGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.IcosahedronGeometry=function(e,d){this.radius=e;this.detail=d;var f=(1+Math.sqrt(5))/2;THREE.PolyhedronGeometry.call(this,[[-1,f,0],[1,f,0],[-1,-f,0],[1,-f,0],[0,-1,f],[0,1,f],[0,-1,-f],[0,1,-f],[f,0,-1],[f,0,1],[-f,0,-1],[-f,0,1]],[[0,11,5],[0,5,1],[0,1,7],[0,7,10],[0,10,11],[1,5,9],[5,11,4],[11,10,2],[10,7,6],[7,1,8],[3,9,4],[3,4,2],[3,2,6],[3,6,8],[3,8,9],[4,9,5],[2,4,11],[6,2,10],[8,6,7],[9,8,1]],e,d)};THREE.IcosahedronGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.OctahedronGeometry=function(d,c){THREE.PolyhedronGeometry.call(this,[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],[[0,2,4],[0,4,3],[0,3,5],[0,5,2],[1,2,5],[1,5,3],[1,3,4],[1,4,2]],d,c)};THREE.OctahedronGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TetrahedronGeometry=function(d,c){THREE.PolyhedronGeometry.call(this,[[1,1,1],[-1,-1,1],[-1,1,-1],[1,-1,-1]],[[2,1,0],[0,3,2],[1,3,0],[2,3,1]],d,c)};THREE.TetrahedronGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ParametricGeometry=function(F,E,D){THREE.Geometry.call(this);var C=this.vertices,B=this.faces,A=this.faceVertexUvs[0],u,v,r,q,n=E+1;for(u=0;u<=D;u++){q=u/D;for(v=0;v<=E;v++){r=v/E,r=F(r,q),C.push(r)}}var o,j,H,G;for(u=0;u<D;u++){for(v=0;v<E;v++){F=u*n+v,C=u*n+v+1,q=(u+1)*n+v+1,r=(u+1)*n+v,o=new THREE.Vector2(v/E,u/D),j=new THREE.Vector2((v+1)/E,u/D),H=new THREE.Vector2((v+1)/E,(u+1)/D),G=new THREE.Vector2(v/E,(u+1)/D),B.push(new THREE.Face3(F,C,r)),A.push([o,j,G]),B.push(new THREE.Face3(C,q,r)),A.push([j.clone(),H,G.clone()])}}this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.ParametricGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.AxisHelper=function(d){var d=d||1,c=new THREE.Geometry;c.vertices.push(new THREE.Vector3,new THREE.Vector3(d,0,0),new THREE.Vector3,new THREE.Vector3(0,d,0),new THREE.Vector3,new THREE.Vector3(0,0,d));c.colors.push(new THREE.Color(16711680),new THREE.Color(16755200),new THREE.Color(65280),new THREE.Color(11206400),new THREE.Color(255),new THREE.Color(43775));d=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});THREE.Line.call(this,c,d,THREE.LinePieces)};THREE.AxisHelper.prototype=Object.create(THREE.Line.prototype);THREE.ArrowHelper=function(f,e,h,g){THREE.Object3D.call(this);void 0===g&&(g=16776960);void 0===h&&(h=1);this.position=e;e=new THREE.Geometry;e.vertices.push(new THREE.Vector3(0,0,0));e.vertices.push(new THREE.Vector3(0,1,0));this.line=new THREE.Line(e,new THREE.LineBasicMaterial({color:g}));this.line.matrixAutoUpdate=!1;this.add(this.line);e=new THREE.CylinderGeometry(0,0.05,0.25,5,1);e.applyMatrix((new THREE.Matrix4).makeTranslation(0,0.875,0));this.cone=new THREE.Mesh(e,new THREE.MeshBasicMaterial({color:g}));this.cone.matrixAutoUpdate=!1;this.add(this.cone);this.setDirection(f);this.setLength(h)};THREE.ArrowHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.ArrowHelper.prototype.setDirection=function(){var d=new THREE.Vector3,c;return function(a){0.99999<a.y?this.quaternion.set(0,0,0,1):-0.99999>a.y?this.quaternion.set(1,0,0,0):(d.set(a.z,0,-a.x).normalize(),c=Math.acos(a.y),this.quaternion.setFromAxisAngle(d,c))}}();THREE.ArrowHelper.prototype.setLength=function(b){this.scale.set(b,b,b)};THREE.ArrowHelper.prototype.setColor=function(b){this.line.material.color.setHex(b);this.cone.material.color.setHex(b)};THREE.BoxHelper=function(e){var d=[new THREE.Vector3(1,1,1),new THREE.Vector3(-1,1,1),new THREE.Vector3(-1,-1,1),new THREE.Vector3(1,-1,1),new THREE.Vector3(1,1,-1),new THREE.Vector3(-1,1,-1),new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,-1,-1)];this.vertices=d;var f=new THREE.Geometry;f.vertices.push(d[0],d[1],d[1],d[2],d[2],d[3],d[3],d[0],d[4],d[5],d[5],d[6],d[6],d[7],d[7],d[4],d[0],d[4],d[1],d[5],d[2],d[6],d[3],d[7]);THREE.Line.call(this,f,new THREE.LineBasicMaterial({color:16776960}),THREE.LinePieces);void 0!==e&&this.update(e)};THREE.BoxHelper.prototype=Object.create(THREE.Line.prototype);THREE.BoxHelper.prototype.update=function(f){var e=f.geometry;null===e.boundingBox&&e.computeBoundingBox();var h=e.boundingBox.min,e=e.boundingBox.max,g=this.vertices;g[0].set(e.x,e.y,e.z);g[1].set(h.x,e.y,e.z);g[2].set(h.x,h.y,e.z);g[3].set(e.x,h.y,e.z);g[4].set(e.x,e.y,h.z);g[5].set(h.x,e.y,h.z);g[6].set(h.x,h.y,h.z);g[7].set(e.x,h.y,h.z);this.geometry.computeBoundingSphere();this.geometry.verticesNeedUpdate=!0;this.matrixAutoUpdate=!1;this.matrixWorld=f.matrixWorld};THREE.BoundingBoxHelper=function(e,d){var f=d||8947848;this.object=e;this.box=new THREE.Box3;THREE.Mesh.call(this,new THREE.CubeGeometry(1,1,1),new THREE.MeshBasicMaterial({color:f,wireframe:!0}))};THREE.BoundingBoxHelper.prototype=Object.create(THREE.Mesh.prototype);THREE.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object);this.box.size(this.scale);this.box.center(this.position)};THREE.CameraHelper=function(h){function g(e,c,f){l(e,f);l(c,f)}function l(d,c){k.vertices.push(new THREE.Vector3);k.colors.push(new THREE.Color(c));void 0===i[d]&&(i[d]=[]);i[d].push(k.vertices.length-1)}var k=new THREE.Geometry,j=new THREE.LineBasicMaterial({color:16777215,vertexColors:THREE.FaceColors}),i={};g("n1","n2",16755200);g("n2","n4",16755200);g("n4","n3",16755200);g("n3","n1",16755200);g("f1","f2",16755200);g("f2","f4",16755200);g("f4","f3",16755200);g("f3","f1",16755200);g("n1","f1",16755200);g("n2","f2",16755200);g("n3","f3",16755200);g("n4","f4",16755200);g("p","n1",16711680);g("p","n2",16711680);g("p","n3",16711680);g("p","n4",16711680);g("u1","u2",43775);g("u2","u3",43775);g("u3","u1",43775);g("c","t",16777215);g("p","c",3355443);g("cn1","cn2",3355443);g("cn3","cn4",3355443);g("cf1","cf2",3355443);g("cf3","cf4",3355443);THREE.Line.call(this,k,j,THREE.LinePieces);this.camera=h;this.matrixWorld=h.matrixWorld;this.matrixAutoUpdate=!1;this.pointMap=i;this.update()};THREE.CameraHelper.prototype=Object.create(THREE.Line.prototype);THREE.CameraHelper.prototype.update=function(){var e=new THREE.Vector3,d=new THREE.Camera,f=new THREE.Projector;return function(){function b(l,j,k,c){e.set(j,k,c);f.unprojectVector(e,d);l=a.pointMap[l];if(void 0!==l){j=0;for(k=l.length;j<k;j++){a.geometry.vertices[l[j]].copy(e)}}}var a=this;d.projectionMatrix.copy(this.camera.projectionMatrix);b("c",0,0,-1);b("t",0,0,1);b("n1",-1,-1,-1);b("n2",1,-1,-1);b("n3",-1,1,-1);b("n4",1,1,-1);b("f1",-1,-1,1);b("f2",1,-1,1);b("f3",-1,1,1);b("f4",1,1,1);b("u1",0.7,1.1,-1);b("u2",-0.7,1.1,-1);b("u3",0,2,-1);b("cf1",-1,0,1);b("cf2",1,0,1);b("cf3",0,-1,1);b("cf4",0,1,1);b("cn1",-1,0,-1);b("cn2",1,0,-1);b("cn3",0,-1,-1);b("cn4",0,1,-1);this.geometry.verticesNeedUpdate=!0}}();THREE.DirectionalLightHelper=function(f,e){THREE.Object3D.call(this);this.light=f;this.light.updateMatrixWorld();this.matrixWorld=f.matrixWorld;this.matrixAutoUpdate=!1;var h=new THREE.PlaneGeometry(e,e),g=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});g.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.lightPlane=new THREE.Mesh(h,g);this.add(this.lightPlane);h=new THREE.Geometry;h.vertices.push(new THREE.Vector3);h.vertices.push(new THREE.Vector3);h.computeLineDistances();g=new THREE.LineBasicMaterial({fog:!1});g.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.targetLine=new THREE.Line(h,g);this.add(this.targetLine);this.update()};THREE.DirectionalLightHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.DirectionalLightHelper.prototype.dispose=function(){this.lightPlane.geometry.dispose();this.lightPlane.material.dispose();this.targetLine.geometry.dispose();this.targetLine.material.dispose()};THREE.DirectionalLightHelper.prototype.update=function(){var b=new THREE.Vector3;return function(){b.getPositionFromMatrix(this.light.matrixWorld).negate();this.lightPlane.lookAt(b);this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.targetLine.geometry.vertices[1].copy(b);this.targetLine.geometry.verticesNeedUpdate=!0;this.targetLine.material.color.copy(this.lightPlane.material.color)}}();THREE.FaceNormalsHelper=function(g,f,j,i){this.object=g;this.size=f||1;for(var g=j||16776960,i=i||1,f=new THREE.Geometry,j=0,h=this.object.geometry.faces.length;j<h;j++){f.vertices.push(new THREE.Vector3),f.vertices.push(new THREE.Vector3)}THREE.Line.call(this,f,new THREE.LineBasicMaterial({color:g,linewidth:i}),THREE.LinePieces);this.matrixAutoUpdate=!1;this.normalMatrix=new THREE.Matrix3;this.update()};THREE.FaceNormalsHelper.prototype=Object.create(THREE.Line.prototype);THREE.FaceNormalsHelper.prototype.update=function(){var b=new THREE.Vector3;return function(){this.object.updateMatrixWorld(!0);this.normalMatrix.getNormalMatrix(this.object.matrixWorld);for(var a=this.geometry.vertices,n=this.object.geometry.faces,m=this.object.matrixWorld,l=0,k=n.length;l<k;l++){var i=n[l];b.copy(i.normal).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size);var j=2*l;a[j].copy(i.centroid).applyMatrix4(m);a[j+1].addVectors(a[j],b)}this.geometry.verticesNeedUpdate=!0;return this}}();THREE.GridHelper=function(h,g){var l=new THREE.Geometry,k=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});this.color1=new THREE.Color(4473924);this.color2=new THREE.Color(8947848);for(var j=-h;j<=h;j+=g){l.vertices.push(new THREE.Vector3(-h,0,j),new THREE.Vector3(h,0,j),new THREE.Vector3(j,0,-h),new THREE.Vector3(j,0,h));var i=0===j?this.color1:this.color2;l.colors.push(i,i,i,i)}THREE.Line.call(this,l,k,THREE.LinePieces)};THREE.GridHelper.prototype=Object.create(THREE.Line.prototype);THREE.GridHelper.prototype.setColors=function(d,c){this.color1.set(d);this.color2.set(c);this.geometry.colorsNeedUpdate=!0};THREE.HemisphereLightHelper=function(f,e){THREE.Object3D.call(this);this.light=f;this.light.updateMatrixWorld();this.matrixWorld=f.matrixWorld;this.matrixAutoUpdate=!1;this.colors=[new THREE.Color,new THREE.Color];var h=new THREE.SphereGeometry(e,4,2);h.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));for(var g=0;8>g;g++){h.faces[g].color=this.colors[4>g?0:1]}g=new THREE.MeshBasicMaterial({vertexColors:THREE.FaceColors,wireframe:!0});this.lightSphere=new THREE.Mesh(h,g);this.add(this.lightSphere);this.update()};THREE.HemisphereLightHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.HemisphereLightHelper.prototype.dispose=function(){this.lightSphere.geometry.dispose();this.lightSphere.material.dispose()};THREE.HemisphereLightHelper.prototype.update=function(){var b=new THREE.Vector3;return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity);this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity);this.lightSphere.lookAt(b.getPositionFromMatrix(this.light.matrixWorld).negate());this.lightSphere.geometry.colorsNeedUpdate=!0}}();THREE.PointLightHelper=function(f,e){this.light=f;this.light.updateMatrixWorld();var h=new THREE.SphereGeometry(e,4,2),g=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});g.color.copy(this.light.color).multiplyScalar(this.light.intensity);THREE.Mesh.call(this,h,g);this.matrixWorld=this.light.matrixWorld;this.matrixAutoUpdate=!1};THREE.PointLightHelper.prototype=Object.create(THREE.Mesh.prototype);THREE.PointLightHelper.prototype.dispose=function(){this.geometry.dispose();this.material.dispose()};THREE.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)};THREE.SpotLightHelper=function(d){THREE.Object3D.call(this);this.light=d;this.light.updateMatrixWorld();this.matrixWorld=d.matrixWorld;this.matrixAutoUpdate=!1;d=new THREE.CylinderGeometry(0,1,1,8,1,!0);d.applyMatrix((new THREE.Matrix4).makeTranslation(0,-0.5,0));d.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));var c=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});this.cone=new THREE.Mesh(d,c);this.add(this.cone);this.update()};THREE.SpotLightHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose();this.cone.material.dispose()};THREE.SpotLightHelper.prototype.update=function(){var d=new THREE.Vector3,c=new THREE.Vector3;return function(){var b=this.light.distance?this.light.distance:10000,a=b*Math.tan(this.light.angle);this.cone.scale.set(a,a,b);d.getPositionFromMatrix(this.light.matrixWorld);c.getPositionFromMatrix(this.light.target.matrixWorld);this.cone.lookAt(c.sub(d));this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}();THREE.VertexNormalsHelper=function(j,i,p,o){this.object=j;this.size=i||1;for(var i=p||16711680,o=o||1,p=new THREE.Geometry,j=j.geometry.faces,n=0,m=j.length;n<m;n++){for(var k=0,l=j[n].vertexNormals.length;k<l;k++){p.vertices.push(new THREE.Vector3),p.vertices.push(new THREE.Vector3)}}THREE.Line.call(this,p,new THREE.LineBasicMaterial({color:i,linewidth:o}),THREE.LinePieces);this.matrixAutoUpdate=!1;this.normalMatrix=new THREE.Matrix3;this.update()};THREE.VertexNormalsHelper.prototype=Object.create(THREE.Line.prototype);THREE.VertexNormalsHelper.prototype.update=function(){var b=new THREE.Vector3;return function(){var B=["a","b","c","d"];this.object.updateMatrixWorld(!0);this.normalMatrix.getNormalMatrix(this.object.matrixWorld);for(var A=this.geometry.vertices,v=this.object.geometry.vertices,u=this.object.geometry.faces,t=this.object.matrixWorld,r=0,s=0,q=u.length;s<q;s++){for(var o=u[s],j=0,n=o.vertexNormals.length;j<n;j++){var a=o.vertexNormals[j];A[r].copy(v[o[B[j]]]).applyMatrix4(t);b.copy(a).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size);b.add(A[r]);r+=1;A[r].copy(b);r+=1}}this.geometry.verticesNeedUpdate=!0;return this}}();THREE.VertexTangentsHelper=function(j,i,p,o){this.object=j;this.size=i||1;for(var i=p||255,o=o||1,p=new THREE.Geometry,j=j.geometry.faces,n=0,m=j.length;n<m;n++){for(var k=0,l=j[n].vertexTangents.length;k<l;k++){p.vertices.push(new THREE.Vector3),p.vertices.push(new THREE.Vector3)}}THREE.Line.call(this,p,new THREE.LineBasicMaterial({color:i,linewidth:o}),THREE.LinePieces);this.matrixAutoUpdate=!1;this.update()};THREE.VertexTangentsHelper.prototype=Object.create(THREE.Line.prototype);THREE.VertexTangentsHelper.prototype.update=function(){var b=new THREE.Vector3;return function(){var B=["a","b","c","d"];this.object.updateMatrixWorld(!0);for(var A=this.geometry.vertices,v=this.object.geometry.vertices,u=this.object.geometry.faces,t=this.object.matrixWorld,r=0,s=0,q=u.length;s<q;s++){for(var o=u[s],j=0,n=o.vertexTangents.length;j<n;j++){var a=o.vertexTangents[j];A[r].copy(v[o[B[j]]]).applyMatrix4(t);b.copy(a).transformDirection(t).multiplyScalar(this.size);b.add(A[r]);r+=1;A[r].copy(b);r+=1}}this.geometry.verticesNeedUpdate=!0;return this}}();THREE.WireframeHelper=function(D){for(var C=[0,0],B={},A=function(d,c){return d-c},v=["a","b","c","d"],u=new THREE.Geometry,s=D.geometry.vertices,t=D.geometry.faces,r=0,q=t.length;r<q;r++){for(var n=t[r],o=0;3>o;o++){C[0]=n[v[o]];C[1]=n[v[(o+1)%3]];C.sort(A);var j=C.toString();void 0===B[j]&&(u.vertices.push(s[C[0]]),u.vertices.push(s[C[1]]),B[j]=!0)}}THREE.Line.call(this,u,new THREE.LineBasicMaterial({color:16777215}),THREE.LinePieces);this.matrixAutoUpdate=!1;this.matrixWorld=D.matrixWorld};THREE.WireframeHelper.prototype=Object.create(THREE.Line.prototype);THREE.ImmediateRenderObject=function(){THREE.Object3D.call(this);this.render=function(){}};THREE.ImmediateRenderObject.prototype=Object.create(THREE.Object3D.prototype);THREE.LensFlare=function(g,f,j,i,h){THREE.Object3D.call(this);this.lensFlares=[];this.positionScreen=new THREE.Vector3;this.customUpdateCallback=void 0;void 0!==g&&this.add(g,f,j,i,h)};THREE.LensFlare.prototype=Object.create(THREE.Object3D.prototype);THREE.LensFlare.prototype.add=function(h,g,l,k,j,i){void 0===g&&(g=-1);void 0===l&&(l=0);void 0===i&&(i=1);void 0===j&&(j=new THREE.Color(16777215));void 0===k&&(k=THREE.NormalBlending);l=Math.min(l,Math.max(0,l));this.lensFlares.push({texture:h,size:g,distance:l,x:0,y:0,z:0,scale:1,rotation:1,opacity:i,color:j,blending:k})};THREE.LensFlare.prototype.updateLensFlares=function(){var g,f=this.lensFlares.length,j,i=2*-this.positionScreen.x,h=2*-this.positionScreen.y;for(g=0;g<f;g++){j=this.lensFlares[g],j.x=this.positionScreen.x+i*j.distance,j.y=this.positionScreen.y+h*j.distance,j.wantedRotation=0.25*j.x*Math.PI,j.rotation+=0.25*(j.wantedRotation-j.rotation)}};THREE.MorphBlendMesh=function(e,d){THREE.Mesh.call(this,e,d);this.animationsMap={};this.animationsList=[];var f=this.geometry.morphTargets.length;this.createAnimation("__default",0,f-1,f/1);this.setAnimationWeight("__default",1)};THREE.MorphBlendMesh.prototype=Object.create(THREE.Mesh.prototype);THREE.MorphBlendMesh.prototype.createAnimation=function(f,e,h,g){e={startFrame:e,endFrame:h,length:h-e+1,fps:g,duration:(h-e)/g,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[f]=e;this.animationsList.push(e)};THREE.MorphBlendMesh.prototype.autoCreateAnimations=function(r){for(var q=/([a-z]+)(\d+)/,p,o={},n=this.geometry,m=0,k=n.morphTargets.length;m<k;m++){var l=n.morphTargets[m].name.match(q);if(l&&1<l.length){var j=l[1];o[j]||(o[j]={start:Infinity,end:-Infinity});l=o[j];m<l.start&&(l.start=m);m>l.end&&(l.end=m);p||(p=j)}}for(j in o){l=o[j],this.createAnimation(j,l.start,l.end,r)}this.firstAnimation=p};THREE.MorphBlendMesh.prototype.setAnimationDirectionForward=function(b){if(b=this.animationsMap[b]){b.direction=1,b.directionBackwards=!1}};THREE.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(b){if(b=this.animationsMap[b]){b.direction=-1,b.directionBackwards=!0}};THREE.MorphBlendMesh.prototype.setAnimationFPS=function(e,d){var f=this.animationsMap[e];f&&(f.fps=d,f.duration=(f.end-f.start)/f.fps)};THREE.MorphBlendMesh.prototype.setAnimationDuration=function(e,d){var f=this.animationsMap[e];f&&(f.duration=d,f.fps=(f.end-f.start)/f.duration)};THREE.MorphBlendMesh.prototype.setAnimationWeight=function(e,d){var f=this.animationsMap[e];f&&(f.weight=d)};THREE.MorphBlendMesh.prototype.setAnimationTime=function(e,d){var f=this.animationsMap[e];f&&(f.time=d)};THREE.MorphBlendMesh.prototype.getAnimationTime=function(d){var c=0;if(d=this.animationsMap[d]){c=d.time}return c};THREE.MorphBlendMesh.prototype.getAnimationDuration=function(d){var c=-1;if(d=this.animationsMap[d]){c=d.duration}return c};THREE.MorphBlendMesh.prototype.playAnimation=function(d){var c=this.animationsMap[d];c?(c.time=0,c.active=!0):console.warn("animation["+d+"] undefined")};THREE.MorphBlendMesh.prototype.stopAnimation=function(b){if(b=this.animationsMap[b]){b.active=!1}};THREE.MorphBlendMesh.prototype.update=function(i){for(var g=0,n=this.animationsList.length;g<n;g++){var m=this.animationsList[g];if(m.active){var l=m.duration/m.length;m.time+=m.direction*i;if(m.mirroredLoop){if(m.time>m.duration||0>m.time){m.direction*=-1,m.time>m.duration&&(m.time=m.duration,m.directionBackwards=!0),0>m.time&&(m.time=0,m.directionBackwards=!1)}}else{m.time%=m.duration,0>m.time&&(m.time+=m.duration)}var k=m.startFrame+THREE.Math.clamp(Math.floor(m.time/l),0,m.length-1),j=m.weight;k!==m.currentFrame&&(this.morphTargetInfluences[m.lastFrame]=0,this.morphTargetInfluences[m.currentFrame]=1*j,this.morphTargetInfluences[k]=0,m.lastFrame=m.currentFrame,m.currentFrame=k);l=m.time%l/l;m.directionBackwards&&(l=1-l);this.morphTargetInfluences[m.currentFrame]=l*j;this.morphTargetInfluences[m.lastFrame]=(1-l)*j}}};THREE.LensFlarePlugin=function(){function E(b,m){var l=D.createProgram(),k=D.createShader(D.FRAGMENT_SHADER),i=D.createShader(D.VERTEX_SHADER),h="precision "+m+" float;\n";D.shaderSource(k,h+b.fragmentShader);D.shaderSource(i,h+b.vertexShader);D.compileShader(k);D.compileShader(i);D.attachShader(l,k);D.attachShader(l,i);D.linkProgram(l);return l}var D,C,B,A,v,t,u,r,q,n,o,j,F;this.init=function(a){D=a.context;C=a;B=a.getPrecision();A=new Float32Array(16);v=new Uint16Array(6);a=0;A[a++]=-1;A[a++]=-1;A[a++]=0;A[a++]=0;A[a++]=1;A[a++]=-1;A[a++]=1;A[a++]=0;A[a++]=1;A[a++]=1;A[a++]=1;A[a++]=1;A[a++]=-1;A[a++]=1;A[a++]=0;A[a++]=1;a=0;v[a++]=0;v[a++]=1;v[a++]=2;v[a++]=0;v[a++]=2;v[a++]=3;t=D.createBuffer();u=D.createBuffer();D.bindBuffer(D.ARRAY_BUFFER,t);D.bufferData(D.ARRAY_BUFFER,A,D.STATIC_DRAW);D.bindBuffer(D.ELEMENT_ARRAY_BUFFER,u);D.bufferData(D.ELEMENT_ARRAY_BUFFER,v,D.STATIC_DRAW);r=D.createTexture();q=D.createTexture();D.bindTexture(D.TEXTURE_2D,r);D.texImage2D(D.TEXTURE_2D,0,D.RGB,16,16,0,D.RGB,D.UNSIGNED_BYTE,null);D.texParameteri(D.TEXTURE_2D,D.TEXTURE_WRAP_S,D.CLAMP_TO_EDGE);D.texParameteri(D.TEXTURE_2D,D.TEXTURE_WRAP_T,D.CLAMP_TO_EDGE);D.texParameteri(D.TEXTURE_2D,D.TEXTURE_MAG_FILTER,D.NEAREST);D.texParameteri(D.TEXTURE_2D,D.TEXTURE_MIN_FILTER,D.NEAREST);D.bindTexture(D.TEXTURE_2D,q);D.texImage2D(D.TEXTURE_2D,0,D.RGBA,16,16,0,D.RGBA,D.UNSIGNED_BYTE,null);D.texParameteri(D.TEXTURE_2D,D.TEXTURE_WRAP_S,D.CLAMP_TO_EDGE);D.texParameteri(D.TEXTURE_2D,D.TEXTURE_WRAP_T,D.CLAMP_TO_EDGE);D.texParameteri(D.TEXTURE_2D,D.TEXTURE_MAG_FILTER,D.NEAREST);D.texParameteri(D.TEXTURE_2D,D.TEXTURE_MIN_FILTER,D.NEAREST);0>=D.getParameter(D.MAX_VERTEX_TEXTURE_IMAGE_UNITS)?(n=!1,o=E(THREE.ShaderFlares.lensFlare,B)):(n=!0,o=E(THREE.ShaderFlares.lensFlareVertexTexture,B));j={};F={};j.vertex=D.getAttribLocation(o,"position");j.uv=D.getAttribLocation(o,"uv");F.renderType=D.getUniformLocation(o,"renderType");F.map=D.getUniformLocation(o,"map");F.occlusionMap=D.getUniformLocation(o,"occlusionMap");F.opacity=D.getUniformLocation(o,"opacity");F.color=D.getUniformLocation(o,"color");F.scale=D.getUniformLocation(o,"scale");F.rotation=D.getUniformLocation(o,"rotation");F.screenPosition=D.getUniformLocation(o,"screenPosition")};this.render=function(R,Q,P,N){var R=R.__webglFlares,s=R.length;if(s){var k=new THREE.Vector3,c=N/P,L=0.5*P,J=0.5*N,i=16/N,p=new THREE.Vector2(i*c,i),M=new THREE.Vector3(1,1,0),b=new THREE.Vector2(1,1),K=F,i=j;D.useProgram(o);D.enableVertexAttribArray(j.vertex);D.enableVertexAttribArray(j.uv);D.uniform1i(K.occlusionMap,0);D.uniform1i(K.map,1);D.bindBuffer(D.ARRAY_BUFFER,t);D.vertexAttribPointer(i.vertex,2,D.FLOAT,!1,16,0);D.vertexAttribPointer(i.uv,2,D.FLOAT,!1,16,8);D.bindBuffer(D.ELEMENT_ARRAY_BUFFER,u);D.disable(D.CULL_FACE);D.depthMask(!1);var H,h,g,m,l;for(H=0;H<s;H++){if(i=16/N,p.set(i*c,i),m=R[H],k.set(m.matrixWorld.elements[12],m.matrixWorld.elements[13],m.matrixWorld.elements[14]),k.applyMatrix4(Q.matrixWorldInverse),k.applyProjection(Q.projectionMatrix),M.copy(k),b.x=M.x*L+L,b.y=M.y*J+J,n||0<b.x&&b.x<P&&0<b.y&&b.y<N){D.activeTexture(D.TEXTURE1);D.bindTexture(D.TEXTURE_2D,r);D.copyTexImage2D(D.TEXTURE_2D,0,D.RGB,b.x-8,b.y-8,16,16,0);D.uniform1i(K.renderType,0);D.uniform2f(K.scale,p.x,p.y);D.uniform3f(K.screenPosition,M.x,M.y,M.z);D.disable(D.BLEND);D.enable(D.DEPTH_TEST);D.drawElements(D.TRIANGLES,6,D.UNSIGNED_SHORT,0);D.activeTexture(D.TEXTURE0);D.bindTexture(D.TEXTURE_2D,q);D.copyTexImage2D(D.TEXTURE_2D,0,D.RGBA,b.x-8,b.y-8,16,16,0);D.uniform1i(K.renderType,1);D.disable(D.DEPTH_TEST);D.activeTexture(D.TEXTURE1);D.bindTexture(D.TEXTURE_2D,r);D.drawElements(D.TRIANGLES,6,D.UNSIGNED_SHORT,0);m.positionScreen.copy(M);m.customUpdateCallback?m.customUpdateCallback(m):m.updateLensFlares();D.uniform1i(K.renderType,2);D.enable(D.BLEND);h=0;for(g=m.lensFlares.length;h<g;h++){l=m.lensFlares[h],0.001<l.opacity&&0.001<l.scale&&(M.x=l.x,M.y=l.y,M.z=l.z,i=l.size*l.scale/N,p.x=i*c,p.y=i,D.uniform3f(K.screenPosition,M.x,M.y,M.z),D.uniform2f(K.scale,p.x,p.y),D.uniform1f(K.rotation,l.rotation),D.uniform1f(K.opacity,l.opacity),D.uniform3f(K.color,l.color.r,l.color.g,l.color.b),C.setBlending(l.blending,l.blendEquation,l.blendSrc,l.blendDst),C.setTexture(l.texture,1),D.drawElements(D.TRIANGLES,6,D.UNSIGNED_SHORT,0))}}}D.enable(D.CULL_FACE);D.enable(D.DEPTH_TEST);D.depthMask(!0)}}};THREE.ShadowMapPlugin=function(){var v,u,t,s,r,q,o=new THREE.Frustum,p=new THREE.Matrix4,n=new THREE.Vector3,l=new THREE.Vector3,j=new THREE.Vector3;this.init=function(b){v=b.context;u=b;var b=THREE.ShaderLib.depthRGBA,a=THREE.UniformsUtils.clone(b.uniforms);t=new THREE.ShaderMaterial({fragmentShader:b.fragmentShader,vertexShader:b.vertexShader,uniforms:a});s=new THREE.ShaderMaterial({fragmentShader:b.fragmentShader,vertexShader:b.vertexShader,uniforms:a,morphTargets:!0});r=new THREE.ShaderMaterial({fragmentShader:b.fragmentShader,vertexShader:b.vertexShader,uniforms:a,skinning:!0});q=new THREE.ShaderMaterial({fragmentShader:b.fragmentShader,vertexShader:b.vertexShader,uniforms:a,morphTargets:!0,skinning:!0});t._shadowPass=!0;s._shadowPass=!0;r._shadowPass=!0;q._shadowPass=!0};this.render=function(b,d){u.shadowMapEnabled&&u.shadowMapAutoUpdate&&this.update(b,d)};this.update=function(g,e){var E,C,f,b,c,m,k,h,d,a=[];b=0;v.clearColor(1,1,1,1);v.disable(v.BLEND);v.enable(v.CULL_FACE);v.frontFace(v.CCW);u.shadowMapCullFace===THREE.CullFaceFront?v.cullFace(v.FRONT):v.cullFace(v.BACK);u.setDepthTest(!0);E=0;for(C=g.__lights.length;E<C;E++){if(f=g.__lights[E],f.castShadow){if(f instanceof THREE.DirectionalLight&&f.shadowCascade){for(c=0;c<f.shadowCascadeCount;c++){var i;if(f.shadowCascadeArray[c]){i=f.shadowCascadeArray[c]}else{d=f;k=c;i=new THREE.DirectionalLight;i.isVirtual=!0;i.onlyShadow=!0;i.castShadow=!0;i.shadowCameraNear=d.shadowCameraNear;i.shadowCameraFar=d.shadowCameraFar;i.shadowCameraLeft=d.shadowCameraLeft;i.shadowCameraRight=d.shadowCameraRight;i.shadowCameraBottom=d.shadowCameraBottom;i.shadowCameraTop=d.shadowCameraTop;i.shadowCameraVisible=d.shadowCameraVisible;i.shadowDarkness=d.shadowDarkness;i.shadowBias=d.shadowCascadeBias[k];i.shadowMapWidth=d.shadowCascadeWidth[k];i.shadowMapHeight=d.shadowCascadeHeight[k];i.pointsWorld=[];i.pointsFrustum=[];h=i.pointsWorld;m=i.pointsFrustum;for(var A=0;8>A;A++){h[A]=new THREE.Vector3,m[A]=new THREE.Vector3}h=d.shadowCascadeNearZ[k];d=d.shadowCascadeFarZ[k];m[0].set(-1,-1,h);m[1].set(1,-1,h);m[2].set(-1,1,h);m[3].set(1,1,h);m[4].set(-1,-1,d);m[5].set(1,-1,d);m[6].set(-1,1,d);m[7].set(1,1,d);i.originalCamera=e;m=new THREE.Gyroscope;m.position=f.shadowCascadeOffset;m.add(i);m.add(i.target);e.add(m);f.shadowCascadeArray[c]=i;console.log("Created virtualLight",i)}k=f;h=c;d=k.shadowCascadeArray[h];d.position.copy(k.position);d.target.position.copy(k.target.position);d.lookAt(d.target);d.shadowCameraVisible=k.shadowCameraVisible;d.shadowDarkness=k.shadowDarkness;d.shadowBias=k.shadowCascadeBias[h];m=k.shadowCascadeNearZ[h];k=k.shadowCascadeFarZ[h];d=d.pointsFrustum;d[0].z=m;d[1].z=m;d[2].z=m;d[3].z=m;d[4].z=k;d[5].z=k;d[6].z=k;d[7].z=k;a[b]=i;b++}}else{a[b]=f,b++}}}E=0;for(C=a.length;E<C;E++){f=a[E];f.shadowMap||(c=THREE.LinearFilter,u.shadowMapType===THREE.PCFSoftShadowMap&&(c=THREE.NearestFilter),f.shadowMap=new THREE.WebGLRenderTarget(f.shadowMapWidth,f.shadowMapHeight,{minFilter:c,magFilter:c,format:THREE.RGBAFormat}),f.shadowMapSize=new THREE.Vector2(f.shadowMapWidth,f.shadowMapHeight),f.shadowMatrix=new THREE.Matrix4);if(!f.shadowCamera){if(f instanceof THREE.SpotLight){f.shadowCamera=new THREE.PerspectiveCamera(f.shadowCameraFov,f.shadowMapWidth/f.shadowMapHeight,f.shadowCameraNear,f.shadowCameraFar)}else{if(f instanceof THREE.DirectionalLight){f.shadowCamera=new THREE.OrthographicCamera(f.shadowCameraLeft,f.shadowCameraRight,f.shadowCameraTop,f.shadowCameraBottom,f.shadowCameraNear,f.shadowCameraFar)}else{console.error("Unsupported light type for shadow");continue}}g.add(f.shadowCamera);!0===g.autoUpdate&&g.updateMatrixWorld()}f.shadowCameraVisible&&!f.cameraHelper&&(f.cameraHelper=new THREE.CameraHelper(f.shadowCamera),f.shadowCamera.add(f.cameraHelper));if(f.isVirtual&&i.originalCamera==e){c=e;b=f.shadowCamera;m=f.pointsFrustum;d=f.pointsWorld;n.set(Infinity,Infinity,Infinity);l.set(-Infinity,-Infinity,-Infinity);for(k=0;8>k;k++){h=d[k],h.copy(m[k]),THREE.ShadowMapPlugin.__projector.unprojectVector(h,c),h.applyMatrix4(b.matrixWorldInverse),h.x<n.x&&(n.x=h.x),h.x>l.x&&(l.x=h.x),h.y<n.y&&(n.y=h.y),h.y>l.y&&(l.y=h.y),h.z<n.z&&(n.z=h.z),h.z>l.z&&(l.z=h.z)}b.left=n.x;b.right=l.x;b.top=l.y;b.bottom=n.y;b.updateProjectionMatrix()}b=f.shadowMap;m=f.shadowMatrix;c=f.shadowCamera;c.position.getPositionFromMatrix(f.matrixWorld);j.getPositionFromMatrix(f.target.matrixWorld);c.lookAt(j);c.updateMatrixWorld();c.matrixWorldInverse.getInverse(c.matrixWorld);f.cameraHelper&&(f.cameraHelper.visible=f.shadowCameraVisible);f.shadowCameraVisible&&f.cameraHelper.update();m.set(0.5,0,0,0.5,0,0.5,0,0.5,0,0,0.5,0.5,0,0,0,1);m.multiply(c.projectionMatrix);m.multiply(c.matrixWorldInverse);p.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse);o.setFromMatrix(p);u.setRenderTarget(b);u.clear();d=g.__webglObjects;f=0;for(b=d.length;f<b;f++){if(k=d[f],m=k.object,k.render=!1,m.visible&&m.castShadow&&(!(m instanceof THREE.Mesh||m instanceof THREE.ParticleSystem)||!m.frustumCulled||o.intersectsObject(m))){m._modelViewMatrix.multiplyMatrices(c.matrixWorldInverse,m.matrixWorld),k.render=!0}}f=0;for(b=d.length;f<b;f++){k=d[f],k.render&&(m=k.object,k=k.buffer,A=m.material instanceof THREE.MeshFaceMaterial?m.material.materials[0]:m.material,h=0<m.geometry.morphTargets.length&&A.morphTargets,A=m instanceof THREE.SkinnedMesh&&A.skinning,h=m.customDepthMaterial?m.customDepthMaterial:A?h?q:r:h?s:t,k instanceof THREE.BufferGeometry?u.renderBufferDirect(c,g.__lights,null,h,k,m):u.renderBuffer(c,g.__lights,null,h,k,m))}d=g.__webglObjectsImmediate;f=0;for(b=d.length;f<b;f++){k=d[f],m=k.object,m.visible&&m.castShadow&&(m._modelViewMatrix.multiplyMatrices(c.matrixWorldInverse,m.matrixWorld),u.renderImmediateObject(c,g.__lights,null,t,m))}}E=u.getClearColor();C=u.getClearAlpha();v.clearColor(E.r,E.g,E.b,C);v.enable(v.BLEND);u.shadowMapCullFace===THREE.CullFaceFront&&v.cullFace(v.BACK)}};THREE.ShadowMapPlugin.__projector=new THREE.Projector;THREE.SpritePlugin=function(){function v(d,c){return d.z!==c.z?c.z-d.z:c.id-d.id}var u,t,s,r,q,o,p,n,l,j;this.init=function(b){u=b.context;t=b;s=b.getPrecision();r=new Float32Array(16);q=new Uint16Array(6);b=0;r[b++]=-0.5;r[b++]=-0.5;r[b++]=0;r[b++]=0;r[b++]=0.5;r[b++]=-0.5;r[b++]=1;r[b++]=0;r[b++]=0.5;r[b++]=0.5;r[b++]=1;r[b++]=1;r[b++]=-0.5;r[b++]=0.5;r[b++]=0;r[b++]=1;b=0;q[b++]=0;q[b++]=1;q[b++]=2;q[b++]=0;q[b++]=2;q[b++]=3;o=u.createBuffer();p=u.createBuffer();u.bindBuffer(u.ARRAY_BUFFER,o);u.bufferData(u.ARRAY_BUFFER,r,u.STATIC_DRAW);u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,p);u.bufferData(u.ELEMENT_ARRAY_BUFFER,q,u.STATIC_DRAW);var b=THREE.ShaderSprite.sprite,e=u.createProgram(),d=u.createShader(u.FRAGMENT_SHADER),c=u.createShader(u.VERTEX_SHADER),f="precision "+s+" float;\n";u.shaderSource(d,f+b.fragmentShader);u.shaderSource(c,f+b.vertexShader);u.compileShader(d);u.compileShader(c);u.attachShader(e,d);u.attachShader(e,c);u.linkProgram(e);n=e;l={};j={};l.position=u.getAttribLocation(n,"position");l.uv=u.getAttribLocation(n,"uv");j.uvOffset=u.getUniformLocation(n,"uvOffset");j.uvScale=u.getUniformLocation(n,"uvScale");j.rotation=u.getUniformLocation(n,"rotation");j.scale=u.getUniformLocation(n,"scale");j.alignment=u.getUniformLocation(n,"alignment");j.halfViewport=u.getUniformLocation(n,"halfViewport");j.color=u.getUniformLocation(n,"color");j.map=u.getUniformLocation(n,"map");j.opacity=u.getUniformLocation(n,"opacity");j.useScreenCoordinates=u.getUniformLocation(n,"useScreenCoordinates");j.sizeAttenuation=u.getUniformLocation(n,"sizeAttenuation");j.screenPosition=u.getUniformLocation(n,"screenPosition");j.modelViewMatrix=u.getUniformLocation(n,"modelViewMatrix");j.projectionMatrix=u.getUniformLocation(n,"projectionMatrix");j.fogType=u.getUniformLocation(n,"fogType");j.fogDensity=u.getUniformLocation(n,"fogDensity");j.fogNear=u.getUniformLocation(n,"fogNear");j.fogFar=u.getUniformLocation(n,"fogFar");j.fogColor=u.getUniformLocation(n,"fogColor");j.alphaTest=u.getUniformLocation(n,"alphaTest")};this.render=function(m,k,i,G){var h=m.__webglSprites,b=h.length;if(b){var c=l,F=j,i=0.5*i,G=0.5*G;u.useProgram(n);u.enableVertexAttribArray(c.position);u.enableVertexAttribArray(c.uv);u.disable(u.CULL_FACE);u.enable(u.BLEND);u.bindBuffer(u.ARRAY_BUFFER,o);u.vertexAttribPointer(c.position,2,u.FLOAT,!1,16,0);u.vertexAttribPointer(c.uv,2,u.FLOAT,!1,16,8);u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,p);u.uniformMatrix4fv(F.projectionMatrix,!1,k.projectionMatrix.elements);u.activeTexture(u.TEXTURE0);u.uniform1i(F.map,0);var E=c=0,A=m.fog;A?(u.uniform3f(F.fogColor,A.color.r,A.color.g,A.color.b),A instanceof THREE.Fog?(u.uniform1f(F.fogNear,A.near),u.uniform1f(F.fogFar,A.far),u.uniform1i(F.fogType,1),E=c=1):A instanceof THREE.FogExp2&&(u.uniform1f(F.fogDensity,A.density),u.uniform1i(F.fogType,2),E=c=2)):(u.uniform1i(F.fogType,0),E=c=0);for(var g,a,C=[],A=0;A<b;A++){g=h[A],a=g.material,g.visible&&0!==a.opacity&&(a.useScreenCoordinates?g.z=-g.position.z:(g._modelViewMatrix.multiplyMatrices(k.matrixWorldInverse,g.matrixWorld),g.z=-g._modelViewMatrix.elements[14]))}h.sort(v);for(A=0;A<b;A++){g=h[A],a=g.material,g.visible&&0!==a.opacity&&(a.map&&a.map.image&&a.map.image.width)&&(u.uniform1f(F.alphaTest,a.alphaTest),!0===a.useScreenCoordinates?(u.uniform1i(F.useScreenCoordinates,1),u.uniform3f(F.screenPosition,(g.position.x*t.devicePixelRatio-i)/i,(G-g.position.y*t.devicePixelRatio)/G,Math.max(0,Math.min(1,g.position.z))),C[0]=t.devicePixelRatio*g.scale.x,C[1]=t.devicePixelRatio*g.scale.y):(u.uniform1i(F.useScreenCoordinates,0),u.uniform1i(F.sizeAttenuation,a.sizeAttenuation?1:0),u.uniformMatrix4fv(F.modelViewMatrix,!1,g._modelViewMatrix.elements),C[0]=g.scale.x,C[1]=g.scale.y),k=m.fog&&a.fog?E:0,c!==k&&(u.uniform1i(F.fogType,k),c=k),u.uniform2f(F.uvScale,a.uvScale.x,a.uvScale.y),u.uniform2f(F.uvOffset,a.uvOffset.x,a.uvOffset.y),u.uniform2f(F.alignment,a.alignment.x,a.alignment.y),u.uniform1f(F.opacity,a.opacity),u.uniform3f(F.color,a.color.r,a.color.g,a.color.b),u.uniform1f(F.rotation,g.rotation),u.uniform2fv(F.scale,C),u.uniform2f(F.halfViewport,i,G),t.setBlending(a.blending,a.blendEquation,a.blendSrc,a.blendDst),t.setDepthTest(a.depthTest),t.setDepthWrite(a.depthWrite),t.setTexture(a.map,0),u.drawElements(u.TRIANGLES,6,u.UNSIGNED_SHORT,0))}u.enable(u.CULL_FACE)}}};THREE.DepthPassPlugin=function(){this.enabled=!1;this.renderTarget=null;var j,i,p,o,n,m,k=new THREE.Frustum,l=new THREE.Matrix4;this.init=function(b){j=b.context;i=b;var b=THREE.ShaderLib.depthRGBA,a=THREE.UniformsUtils.clone(b.uniforms);p=new THREE.ShaderMaterial({fragmentShader:b.fragmentShader,vertexShader:b.vertexShader,uniforms:a});o=new THREE.ShaderMaterial({fragmentShader:b.fragmentShader,vertexShader:b.vertexShader,uniforms:a,morphTargets:!0});n=new THREE.ShaderMaterial({fragmentShader:b.fragmentShader,vertexShader:b.vertexShader,uniforms:a,skinning:!0});m=new THREE.ShaderMaterial({fragmentShader:b.fragmentShader,vertexShader:b.vertexShader,uniforms:a,morphTargets:!0,skinning:!0});p._shadowPass=!0;o._shadowPass=!0;n._shadowPass=!0;m._shadowPass=!0};this.render=function(d,c){this.enabled&&this.update(d,c)};this.update=function(g,f){var d,e,b,q,h,c;j.clearColor(1,1,1,1);j.disable(j.BLEND);i.setDepthTest(!0);!0===g.autoUpdate&&g.updateMatrixWorld();f.matrixWorldInverse.getInverse(f.matrixWorld);l.multiplyMatrices(f.projectionMatrix,f.matrixWorldInverse);k.setFromMatrix(l);i.setRenderTarget(this.renderTarget);i.clear();c=g.__webglObjects;d=0;for(e=c.length;d<e;d++){if(b=c[d],h=b.object,b.render=!1,h.visible&&(!(h instanceof THREE.Mesh||h instanceof THREE.ParticleSystem)||!h.frustumCulled||k.intersectsObject(h))){h._modelViewMatrix.multiplyMatrices(f.matrixWorldInverse,h.matrixWorld),b.render=!0}}var a;d=0;for(e=c.length;d<e;d++){if(b=c[d],b.render&&(h=b.object,b=b.buffer,!(h instanceof THREE.ParticleSystem)||h.customDepthMaterial)){(a=h.material instanceof THREE.MeshFaceMaterial?h.material.materials[0]:h.material)&&i.setMaterialFaces(h.material),q=0<h.geometry.morphTargets.length&&a.morphTargets,a=h instanceof THREE.SkinnedMesh&&a.skinning,q=h.customDepthMaterial?h.customDepthMaterial:a?q?m:n:q?o:p,b instanceof THREE.BufferGeometry?i.renderBufferDirect(f,g.__lights,null,q,b,h):i.renderBuffer(f,g.__lights,null,q,b,h)}}c=g.__webglObjectsImmediate;d=0;for(e=c.length;d<e;d++){b=c[d],h=b.object,h.visible&&(h._modelViewMatrix.multiplyMatrices(f.matrixWorldInverse,h.matrixWorld),i.renderImmediateObject(f,g.__lights,null,p,h))}d=i.getClearColor();e=i.getClearAlpha();j.clearColor(d.r,d.g,d.b,e);j.enable(j.BLEND)}};THREE.ShaderFlares={lensFlareVertexTexture:{vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nuniform sampler2D occlusionMap;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif( renderType == 2 ) {\nvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\nvVisibility =        visibility.r / 9.0;\nvVisibility *= 1.0 - visibility.g / 9.0;\nvVisibility *=       visibility.b / 9.0;\nvVisibility *= 1.0 - visibility.a / 9.0;\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",fragmentShader:"uniform lowp int renderType;\nuniform sampler2D map;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * vVisibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"},lensFlare:{vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif( renderType == 2 ) {\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",fragmentShader:"precision mediump float;\nuniform lowp int renderType;\nuniform sampler2D map;\nuniform sampler2D occlusionMap;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nfloat visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;\nvisibility = ( 1.0 - visibility / 4.0 );\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * visibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"}};THREE.ShaderSprite={sprite:{vertexShader:"uniform int useScreenCoordinates;\nuniform int sizeAttenuation;\nuniform vec3 screenPosition;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 scale;\nuniform vec2 alignment;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nuniform vec2 halfViewport;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uvOffset + uv * uvScale;\nvec2 alignedPosition = ( position + alignment ) * scale;\nvec2 rotatedPosition;\nrotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\nrotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\nvec4 finalPosition;\nif( useScreenCoordinates != 0 ) {\nfinalPosition = vec4( screenPosition.xy + ( rotatedPosition / halfViewport ), screenPosition.z, 1.0 );\n} else {\nfinalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\nfinalPosition.xy += rotatedPosition * ( sizeAttenuation == 1 ? 1.0 : finalPosition.z );\nfinalPosition = projectionMatrix * finalPosition;\n}\ngl_Position = finalPosition;\n}",fragmentShader:"uniform vec3 color;\nuniform sampler2D map;\nuniform float opacity;\nuniform int fogType;\nuniform vec3 fogColor;\nuniform float fogDensity;\nuniform float fogNear;\nuniform float fogFar;\nuniform float alphaTest;\nvarying vec2 vUV;\nvoid main() {\nvec4 texture = texture2D( map, vUV );\nif ( texture.a < alphaTest ) discard;\ngl_FragColor = vec4( color * texture.xyz, texture.a * opacity );\nif ( fogType > 0 ) {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat fogFactor = 0.0;\nif ( fogType == 1 ) {\nfogFactor = smoothstep( fogNear, fogFar, depth );\n} else {\nconst float LOG2 = 1.442695;\nfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n}\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n}\n}"}};window.leap=new Leap.Controller();window.leap.connect();function LeapExample(d,b,c){var a=this;this.exampleID=d;this.initCallback=b;this.frameCallback=c;this.leapConnected=false;this.initialized=false;this.controller=new Leap.Controller();this.init=function(){a.exampleElement=document.getElementById(a.exampleID);if(a.initCallback){a.initialized=a.initCallback()}a.leapConnected=true;a.exampleElement.style.display="block"};this.controller.on("deviceConnected",function(){if(!a.initialized){a.init()}a.leapConnected=true;a.exampleElement.style.display="block"});this.controller.on("deviceDisconnected",function(){a.leapConnected=false;a.exampleElement.style.display="none"});this.controller.on("frame",function(){if(!a.initialized){a.init()}if(a.frameCallback){a.frameCallback(a.controller.frame(0))}});this.controller.connect()};/*! KineticJS v5.0.1 2014-01-21 http://www.kineticjs.com by Eric Rowell @ericdrowell - MIT License https://github.com/ericdrowell/KineticJS/wiki/License*/
var Kinetic={};!function(){Kinetic={version:"5.0.1",stages:[],idCounter:0,ids:{},names:{},shapes:{},listenClickTap:!1,inDblClickWindow:!1,enableTrace:!1,traceArrMax:100,dblClickWindow:400,pixelRatio:void 0,UA:function(){var d=navigator.userAgent.toLowerCase(),c=/(chrome)[ \/]([\w.]+)/.exec(d)||/(webkit)[ \/]([\w.]+)/.exec(d)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(d)||/(msie) ([\w.]+)/.exec(d)||d.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(d)||[];return{browser:c[1]||"",version:c[2]||"0"}}(),Filters:{},Node:function(b){this._init(b)},Shape:function(b){this.__init(b)},Container:function(b){this.__init(b)},Stage:function(b){this.___init(b)},Layer:function(b){this.___init(b)},Group:function(b){this.___init(b)},isDragging:function(){var b=Kinetic.DD;return b?b.isDragging:!1},isDragReady:function(){var b=Kinetic.DD;return b?!!b.node:!1},_addId:function(d,c){void 0!==c&&(this.ids[c]=d)},_removeId:function(b){void 0!==b&&delete this.ids[b]},_addName:function(d,c){void 0!==c&&(void 0===this.names[c]&&(this.names[c]=[]),this.names[c].push(d))},_removeName:function(g,f){if(void 0!==g){var j=this.names[g];if(void 0!==j){for(var i=0;i<j.length;i++){var h=j[i];h._id===f&&j.splice(i,1)}0===j.length&&delete this.names[g]}}}}}(),function(d,c){"object"==typeof exports?module.exports=c():"function"==typeof define&&define.amd?define(c):d.returnExports=c()}(this,function(){return Kinetic}),function(){Kinetic.Collection=function(){var e=[].slice.call(arguments),d=e.length,f=0;for(this.length=d;d>f;f++){this[f]=e[f]}return this},Kinetic.Collection.prototype=[],Kinetic.Collection.prototype.each=function(d){for(var c=0;c<this.length;c++){d(this[c],c)}},Kinetic.Collection.prototype.toArray=function(){var e,d=[],f=this.length;for(e=0;f>e;e++){d.push(this[e])}return d},Kinetic.Collection.toCollection=function(f){var e,h=new Kinetic.Collection,g=f.length;for(e=0;g>e;e++){h.push(f[e])}return h},Kinetic.Collection.mapMethods=function(e){var d,f=e.prototype;for(d in f){!function(b){Kinetic.Collection.prototype[b]=function(){var a,g=this.length;for(args=[].slice.call(arguments),a=0;g>a;a++){this[a][b].apply(this[a],args)}return this}}(d)}},Kinetic.Transform=function(){this.m=[1,0,0,1,0,0]},Kinetic.Transform.prototype={translate:function(d,c){this.m[4]+=this.m[0]*d+this.m[2]*c,this.m[5]+=this.m[1]*d+this.m[3]*c},scale:function(d,c){this.m[0]*=d,this.m[1]*=d,this.m[2]*=c,this.m[3]*=c},rotate:function(i){var h=Math.cos(i),n=Math.sin(i),m=this.m[0]*h+this.m[2]*n,l=this.m[1]*h+this.m[3]*n,k=this.m[0]*-n+this.m[2]*h,j=this.m[1]*-n+this.m[3]*h;this.m[0]=m,this.m[1]=l,this.m[2]=k,this.m[3]=j},getTranslation:function(){return{x:this.m[4],y:this.m[5]}},skew:function(h,g){var l=this.m[0]+this.m[2]*g,k=this.m[1]+this.m[3]*g,j=this.m[2]+this.m[0]*h,i=this.m[3]+this.m[1]*h;this.m[0]=l,this.m[1]=k,this.m[2]=j,this.m[3]=i},multiply:function(i){var h=this.m[0]*i.m[0]+this.m[2]*i.m[1],n=this.m[1]*i.m[0]+this.m[3]*i.m[1],m=this.m[0]*i.m[2]+this.m[2]*i.m[3],l=this.m[1]*i.m[2]+this.m[3]*i.m[3],k=this.m[0]*i.m[4]+this.m[2]*i.m[5]+this.m[4],j=this.m[1]*i.m[4]+this.m[3]*i.m[5]+this.m[5];this.m[0]=h,this.m[1]=n,this.m[2]=m,this.m[3]=l,this.m[4]=k,this.m[5]=j},invert:function(){var i=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),h=this.m[3]*i,n=-this.m[1]*i,m=-this.m[2]*i,l=this.m[0]*i,k=i*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),j=i*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);this.m[0]=h,this.m[1]=n,this.m[2]=m,this.m[3]=l,this.m[4]=k,this.m[5]=j},getMatrix:function(){return this.m},setAbsolutePosition:function(J,I){var H=this.m[0],G=this.m[1],F=this.m[2],o=this.m[3],n=this.m[4],m=this.m[5],l=(H*(I-m)-G*(J-n))/(H*o-G*F),k=(J-n-F*l)/H;this.translate(k,l)}};var E="canvas",D="2d",C="[object Array]",B="[object Number]",A="[object String]",z=Math.PI/180,y=180/Math.PI,x="#",w="",v="0",u="Kinetic warning: ",s="Kinetic error: ",r="rgb(",q={aqua:[0,255,255],lime:[0,255,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,255],navy:[0,0,128],white:[255,255,255],fuchsia:[255,0,255],olive:[128,128,0],yellow:[255,255,0],orange:[255,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[255,0,0],pink:[255,192,203],cyan:[0,255,255],transparent:[255,255,255,0]},p=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;Kinetic.Util={_isElement:function(b){return !(!b||1!=b.nodeType)},_isFunction:function(b){return !!(b&&b.constructor&&b.call&&b.apply)},_isObject:function(b){return !!b&&b.constructor==Object},_isArray:function(b){return Object.prototype.toString.call(b)==C},_isNumber:function(b){return Object.prototype.toString.call(b)==B},_isString:function(b){return Object.prototype.toString.call(b)==A},_hasMethods:function(e){var d,f=[];for(d in e){this._isFunction(e[d])&&f.push(d)}return f.length>0},_isInDocument:function(b){for(;b=b.parentNode;){if(b==document){return !0}}return !1},_simplifyArray:function(h){var g,l,k=[],j=h.length,i=Kinetic.Util;for(g=0;j>g;g++){l=h[g],i._isNumber(l)?l=Math.round(1000*l)/1000:i._isString(l)||(l=l.toString()),k.push(l)}return k},_getImage:function(h,g){var b,a;h?this._isElement(h)?g(h):this._isString(h)?(b=new Image,b.onload=function(){g(b)},b.src=h):h.data?(a=document.createElement(E),a.width=h.width,a.height=h.height,_context=a.getContext(D),_context.putImageData(h,0,0),this._getImage(a.toDataURL(),g)):g(null):g(null)},_getRGBAString:function(g){var f=g.red||0,j=g.green||0,i=g.blue||0,h=g.alpha||1;return["rgba(",f,",",j,",",i,",",h,")"].join(w)},_rgbToHex:function(e,d,f){return((1<<24)+(e<<16)+(d<<8)+f).toString(16).slice(1)},_hexToRgb:function(d){d=d.replace(x,w);var c=parseInt(d,16);return{r:255&c>>16,g:255&c>>8,b:255&c}},getRandomColor:function(){for(var b=(16777215*Math.random()<<0).toString(16);b.length<6;){b=v+b}return x+b},get:function(d,c){return void 0===d?c:d},getRGB:function(d){var c;return d in q?(c=q[d],{r:c[0],g:c[1],b:c[2]}):d[0]===x?this._hexToRgb(d.substring(1)):d.substr(0,4)===r?(c=p.exec(d.replace(/ /g,"")),{r:parseInt(c[1],10),g:parseInt(c[2],10),b:parseInt(c[3],10)}):{r:0,g:0,b:0}},_merge:function(f,e){var h=this._clone(e);for(var g in f){h[g]=this._isObject(f[g])?this._merge(f[g],h[g]):f[g]}return h},cloneObject:function(e){var d={};for(var f in e){d[f]=this._isObject(e[f])?this._clone(e[f]):e[f]}return d},cloneArray:function(b){return b.slice(0)},_degToRad:function(b){return b*z},_radToDeg:function(b){return b*y},_capitalize:function(b){return b.charAt(0).toUpperCase()+b.slice(1)},error:function(b){throw new Error(s+b)},warn:function(b){window.console&&console.warn&&console.warn(u+b)},extend:function(e,d){for(var f in d.prototype){f in e.prototype||(e.prototype[f]=d.prototype[f])}},addMethods:function(e,d){var f;for(f in d){e.prototype[f]=d[f]}},_getControlPoints:function(T,S,R,Q,P,O,N){var M=Math.sqrt(Math.pow(R-T,2)+Math.pow(Q-S,2)),L=Math.sqrt(Math.pow(P-R,2)+Math.pow(O-Q,2)),K=N*M/(M+L),J=N*L/(M+L),I=R-K*(P-T),H=Q-K*(O-S),G=R+J*(P-T),F=Q+J*(O-S);return[I,H,G,F]},_expandPoints:function(h,g){var l,k,j=h.length,i=[];for(l=2;j-2>l;l+=2){k=Kinetic.Util._getControlPoints(h[l-2],h[l-1],h[l],h[l+1],h[l+2],h[l+3],g),i.push(k[0]),i.push(k[1]),i.push(h[l]),i.push(h[l+1]),i.push(k[2]),i.push(k[3])}return i},_removeLastLetter:function(b){return b.substring(0,b.length-1)}}}(),function(){var g=document.createElement("canvas"),f=g.getContext("2d"),j=window.devicePixelRatio||1,i=f.webkitBackingStorePixelRatio||f.mozBackingStorePixelRatio||f.msBackingStorePixelRatio||f.oBackingStorePixelRatio||f.backingStorePixelRatio||1,h=j/i;Kinetic.Canvas=function(b){this.init(b)},Kinetic.Canvas.prototype={init:function(d){d=d||{};var c=d.pixelRatio||Kinetic.pixelRatio||h;this.pixelRatio=c,this._canvas=document.createElement("canvas"),this._canvas.style.padding=0,this._canvas.style.margin=0,this._canvas.style.border=0,this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top=0,this._canvas.style.left=0},getContext:function(){return this.context},getPixelRatio:function(){return this.pixelRatio},setPixelRatio:function(b){this.pixelRatio=b,this.setSize(this.getWidth(),this.getHeight())},setWidth:function(b){this.width=this._canvas.width=b*this.pixelRatio,this._canvas.style.width=b+"px"},setHeight:function(b){this.height=this._canvas.height=b*this.pixelRatio,this._canvas.style.height=b+"px"},getWidth:function(){return this.width},getHeight:function(){return this.height},setSize:function(d,c){this.setWidth(d),this.setHeight(c)},toDataURL:function(k,e){try{return this._canvas.toDataURL(k,e)}catch(m){try{return this._canvas.toDataURL()}catch(l){return Kinetic.Util.warn("Unable to get data URL. "+l.message),""}}}},Kinetic.SceneCanvas=function(e){e=e||{};var d=e.width||0,k=e.height||0;Kinetic.Canvas.call(this,e),this.context=new Kinetic.SceneContext(this),this.setSize(d,k)},Kinetic.SceneCanvas.prototype={setWidth:function(e){var d=this.pixelRatio,k=this.getContext()._context;Kinetic.Canvas.prototype.setWidth.call(this,e),k.scale(d,d)},setHeight:function(e){var d=this.pixelRatio,k=this.getContext()._context;Kinetic.Canvas.prototype.setHeight.call(this,e),k.scale(d,d)}},Kinetic.Util.extend(Kinetic.SceneCanvas,Kinetic.Canvas),Kinetic.HitCanvas=function(e){e=e||{};var d=e.width||0,k=e.height||0;Kinetic.Canvas.call(this,e),this.context=new Kinetic.HitContext(this),this.setSize(d,k)},Kinetic.Util.extend(Kinetic.HitCanvas,Kinetic.Canvas)}(),function(){var r=",",q="(",p=")",o="([",n="])",m=";",l="()",k="=",j=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"];Kinetic.Context=function(b){this.init(b)},Kinetic.Context.prototype={init:function(b){this.canvas=b,this._context=b._canvas.getContext("2d"),Kinetic.enableTrace&&(this.traceArr=[],this._enableTrace())},fillShape:function(b){b.getFillEnabled()&&this._fill(b)},strokeShape:function(b){b.getStrokeEnabled()&&this._stroke(b)},fillStrokeShape:function(d){var c=d.getFillEnabled();c&&this._fill(d),d.getStrokeEnabled()&&this._stroke(d)},getTrace:function(e){var d,c,b,a,h=this.traceArr,g=h.length,f="";for(d=0;g>d;d++){c=h[d],b=c.method,b?(a=c.args,f+=b,f+=e?l:Kinetic.Util._isArray(a[0])?o+a.join(r)+n:q+a.join(r)+p):(f+=c.property,e||(f+=k+c.val)),f+=m}return f},clearTrace:function(){this.traceArr=[]},_trace:function(e){var d,f=this.traceArr;f.push(e),d=f.length,d>=Kinetic.traceArrMax&&f.shift()},reset:function(){var b=this.getCanvas().getPixelRatio();this.setTransform(1*b,0,0,1*b,0,0)},getCanvas:function(){return this.canvas},clear:function(d){var c=this.getCanvas();d?this.clearRect(d.x||0,d.y||0,d.width||0,d.height||0):this.clearRect(0,0,c.getWidth(),c.getHeight())},_applyLineCap:function(d){var c=d.getLineCap();c&&this.setAttr("lineCap",c)},_applyOpacity:function(d){var c=d.getAbsoluteOpacity();1!==c&&this.setAttr("globalAlpha",c)},_applyLineJoin:function(d){var c=d.getLineJoin();c&&this.setAttr("lineJoin",c)},_applyTransform:function(e){var d,f=e.getTransformsEnabled();"all"===f?(d=e.getAbsoluteTransform().getMatrix(),this.transform(d[0],d[1],d[2],d[3],d[4],d[5])):"position"===f&&this.translate(e.getX(),e.getY())},setAttr:function(d,c){this._context[d]=c},arc:function(){var b=arguments;this._context.arc(b[0],b[1],b[2],b[3],b[4],b[5])},beginPath:function(){this._context.beginPath()},bezierCurveTo:function(){var b=arguments;this._context.bezierCurveTo(b[0],b[1],b[2],b[3],b[4],b[5])},clearRect:function(){var b=arguments;this._context.clearRect(b[0],b[1],b[2],b[3])},clip:function(){this._context.clip()},closePath:function(){this._context.closePath()},createImageData:function(){var b=arguments;return 2===b.length?this._context.createImageData(b[0],b[1]):1===b.length?this._context.createImageData(b[0]):void 0},createLinearGradient:function(){var b=arguments;return this._context.createLinearGradient(b[0],b[1],b[2],b[3])},createPattern:function(){var b=arguments;return this._context.createPattern(b[0],b[1])},createRadialGradient:function(){var b=arguments;return this._context.createRadialGradient(b[0],b[1],b[2],b[3],b[4],b[5])},drawImage:function(){var d=arguments,c=this._context;3===d.length?c.drawImage(d[0],d[1],d[2]):5===d.length?c.drawImage(d[0],d[1],d[2],d[3],d[4]):9===d.length&&c.drawImage(d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8])},fill:function(){this._context.fill()},fillText:function(){var b=arguments;this._context.fillText(b[0],b[1],b[2])},getImageData:function(){var b=arguments;return this._context.getImageData(b[0],b[1],b[2],b[3])},lineTo:function(){var b=arguments;this._context.lineTo(b[0],b[1])},moveTo:function(){var b=arguments;this._context.moveTo(b[0],b[1])},rect:function(){var b=arguments;this._context.rect(b[0],b[1],b[2],b[3])},putImageData:function(){var b=arguments;this._context.putImageData(b[0],b[1],b[2])},quadraticCurveTo:function(){var b=arguments;this._context.quadraticCurveTo(b[0],b[1],b[2],b[3])},restore:function(){this._context.restore()},rotate:function(){var b=arguments;this._context.rotate(b[0])},save:function(){this._context.save()},scale:function(){var b=arguments;this._context.scale(b[0],b[1])},setLineDash:function(){var d=arguments,c=this._context;this._context.setLineDash?c.setLineDash(d[0]):"mozDash" in c?c.mozDash=d[0]:"webkitLineDash" in c&&(c.webkitLineDash=d[0])},setTransform:function(){var b=arguments;this._context.setTransform(b[0],b[1],b[2],b[3],b[4],b[5])},stroke:function(){this._context.stroke()},strokeText:function(){var b=arguments;this._context.strokeText(b[0],b[1],b[2])},transform:function(){var b=arguments;this._context.transform(b[0],b[1],b[2],b[3],b[4],b[5])},translate:function(){var b=arguments;this._context.translate(b[0],b[1])},_enableTrace:function(){var h,g,v=this,u=j.length,s=Kinetic.Util._simplifyArray,i=this.setAttr;for(h=0;u>h;h++){!function(b){var e,c=v[b];v[b]=function(){return g=s(Array.prototype.slice.call(arguments,0)),e=c.apply(v,arguments),v._trace({method:b,args:g}),e}}(j[h])}v.setAttr=function(){i.apply(v,arguments),v._trace({property:arguments[0],val:arguments[1]})}}},Kinetic.SceneContext=function(b){Kinetic.Context.call(this,b)},Kinetic.SceneContext.prototype={_fillColor:function(d){var c=d.fill()||Kinetic.Util._getRGBAString({red:d.fillRed(),green:d.fillGreen(),blue:d.fillBlue(),alpha:d.fillAlpha()});this.setAttr("fillStyle",c),d._fillFunc(this)},_fillPattern:function(s){var i=s.getFillPatternImage(),z=s.getFillPatternX(),y=s.getFillPatternY(),x=s.getFillPatternScale(),w=s.getFillPatternRotation(),v=s.getFillPatternOffset(),u=s.getFillPatternRepeat();(z||y)&&this.translate(z||0,y||0),w&&this.rotate(w),x&&this.scale(x.x,x.y),v&&this.translate(-1*v.x,-1*v.y),this.setAttr("fillStyle",this.createPattern(i,u||"repeat")),this.fill()},_fillLinearGradient:function(h){var g=h.getFillLinearGradientStartPoint(),v=h.getFillLinearGradientEndPoint(),u=h.getFillLinearGradientColorStops(),s=this.createLinearGradient(g.x,g.y,v.x,v.y);if(u){for(var i=0;i<u.length;i+=2){s.addColorStop(u[i],u[i+1])}this.setAttr("fillStyle",s),this.fill()}},_fillRadialGradient:function(s){for(var i=s.getFillRadialGradientStartPoint(),z=s.getFillRadialGradientEndPoint(),y=s.getFillRadialGradientStartRadius(),x=s.getFillRadialGradientEndRadius(),w=s.getFillRadialGradientColorStops(),v=this.createRadialGradient(i.x,i.y,y,z.x,z.y,x),u=0;u<w.length;u+=2){v.addColorStop(w[u],w[u+1])}this.setAttr("fillStyle",v),this.fill()},_fill:function(h){var g=h.fill()||h.fillRed()||h.fillGreen()||h.fillBlue(),v=h.getFillPatternImage(),u=h.getFillLinearGradientColorStops(),s=h.getFillRadialGradientColorStops(),i=h.getFillPriority();g&&"color"===i?this._fillColor(h):v&&"pattern"===i?this._fillPattern(h):u&&"linear-gradient"===i?this._fillLinearGradient(h):s&&"radial-gradient"===i?this._fillRadialGradient(h):g?this._fillColor(h):v?this._fillPattern(h):u?this._fillLinearGradient(h):s&&this._fillRadialGradient(h)},_stroke:function(e){var d=e.dash(),f=e.getStrokeScaleEnabled();e.hasStroke()&&(f||(this.save(),this.setTransform(1,0,0,1,0,0)),this._applyLineCap(e),d&&e.dashEnabled()&&this.setLineDash(d),this.setAttr("lineWidth",e.strokeWidth()),this.setAttr("strokeStyle",e.stroke()||Kinetic.Util._getRGBAString({red:e.strokeRed(),green:e.strokeGreen(),blue:e.strokeBlue(),alpha:e.strokeAlpha()})),e._strokeFunc(this),f||this.restore())},_applyShadow:function(i){var h=Kinetic.Util,x=i.getAbsoluteOpacity(),w=h.get(i.getShadowColor(),"black"),v=h.get(i.getShadowBlur(),5),u=h.get(i.getShadowOpacity(),0),s=h.get(i.getShadowOffset(),{x:0,y:0});u&&this.setAttr("globalAlpha",u*x),this.setAttr("shadowColor",w),this.setAttr("shadowBlur",v),this.setAttr("shadowOffsetX",s.x),this.setAttr("shadowOffsetY",s.y)}},Kinetic.Util.extend(Kinetic.SceneContext,Kinetic.Context),Kinetic.HitContext=function(b){Kinetic.Context.call(this,b)},Kinetic.HitContext.prototype={_fill:function(b){this.save(),this.setAttr("fillStyle",b.colorKey),b._fillFuncHit(this),this.restore()},_stroke:function(b){b.hasStroke()&&(this._applyLineCap(b),this.setAttr("lineWidth",b.strokeWidth()),this.setAttr("strokeStyle",b.colorKey),b._strokeFuncHit(this))}},Kinetic.Util.extend(Kinetic.HitContext,Kinetic.Context)}(),function(){var d="get",c="set";Kinetic.Factory={addGetterSetter:function(g,f,j,i,h){this.addGetter(g,f,j),this.addSetter(g,f,i,h),this.addOverloadedGetterSetter(g,f)},addGetter:function(a,h,g){var f=d+Kinetic.Util._capitalize(h);a.prototype[f]=function(){var b=this.attrs[h];return void 0===b?g:b}},addSetter:function(b,j,i,h){var g=c+Kinetic.Util._capitalize(j);b.prototype[g]=function(e){return i&&(e=i.call(this,e)),this._setAttr(j,e),h&&h.call(this),this}},addComponentsGetterSetter:function(w,v,u,s,r){var q,p,o=u.length,n=Kinetic.Util._capitalize,b=d+n(v),a=c+n(v);w.prototype[b]=function(){var e={};for(q=0;o>q;q++){p=u[q],e[p]=this.getAttr(v+n(p))}return e},w.prototype[a]=function(f){var e,g=this.attrs[v];s&&(f=s.call(this,f));for(e in f){this._setAttr(v+n(e),f[e])}return this._fireChangeEvent(v,g,f),r&&r.call(this),this},this.addOverloadedGetterSetter(w,v)},addOverloadedGetterSetter:function(j,i){var h=Kinetic.Util._capitalize(i),b=c+h,a=d+h;j.prototype[i]=function(){return arguments.length?(this[b](arguments[0]),this):this[a]()}},backCompat:function(f,e){var g;for(g in e){f.prototype[g]=f.prototype[e[g]]}},afterSetFilter:function(){this._filterUpToDate=!1}},Kinetic.Validators={RGBComponent:function(b){return b>255?255:0>b?0:Math.round(b)},alphaComponent:function(b){return b>1?1:0.0001>b?0.0001:b}}}(),function(){var R="absoluteOpacity",Q="absoluteTransform",P="before",O="Change",N="children",M=".",L="",K="get",J="id",I="kinetic",H="listening",G="mouseenter",F="mouseleave",E="name",D="set",C="Shape",B=" ",A="stage",z="transform",y="Stage",x="visible",w=["xChange.kinetic","yChange.kinetic","scaleXChange.kinetic","scaleYChange.kinetic","skewXChange.kinetic","skewYChange.kinetic","rotationChange.kinetic","offsetXChange.kinetic","offsetYChange.kinetic","transformsEnabledChange.kinetic"].join(B);Kinetic.Util.addMethods(Kinetic.Node,{_init:function(b){var a=this;this._id=Kinetic.idCounter++,this.eventListeners={},this.attrs={},this._cache={},this._filterUpToDate=!1,this.setAttrs(b),this.on(w,function(){this._clearCache(z),a._clearSelfAndDescendantCache(Q)}),this.on("visibleChange.kinetic",function(){a._clearSelfAndDescendantCache(x)}),this.on("listeningChange.kinetic",function(){a._clearSelfAndDescendantCache(H)}),this.on("opacityChange.kinetic",function(){a._clearSelfAndDescendantCache(R)})},_clearCache:function(b){b?delete this._cache[b]:this._cache={}},_getCache:function(e,d){var f=this._cache[e];return void 0===f&&(this._cache[e]=d.call(this)),this._cache[e]},_clearSelfAndDescendantCache:function(b){this._clearCache(b),this.children&&this.getChildren().each(function(a){a._clearSelfAndDescendantCache(b)})},clearCache:function(){return delete this._cache.canvas,this._filterUpToDate=!1,this},cache:function(Y){var X,W=Y||{},V=W.x||0,U=W.y||0,T=W.width||this.width(),S=W.height||this.height(),v=W.drawBorder||!1,u=new Kinetic.SceneCanvas({pixelRatio:1,width:T,height:S}),s=new Kinetic.SceneCanvas({pixelRatio:1,width:T,height:S}),r=new Kinetic.HitCanvas({width:T,height:S}),q=this.transformsEnabled(),p=this.x(),o=this.y();return this.clearCache(),this.transformsEnabled("position"),this.x(-1*V),this.y(-1*U),this.drawScene(u),this.drawHit(r),v&&(X=u.getContext(),X.save(),X.beginPath(),X.rect(0,0,T,S),X.closePath(),X.setAttr("strokeStyle","red"),X.setAttr("lineWidth",5),X.stroke(),X.restore()),this.x(p),this.y(o),this.transformsEnabled(q),this._cache.canvas={scene:u,filter:s,hit:r},this},_drawCachedSceneCanvas:function(b){b.save(),b._applyTransform(this),b.drawImage(this._getCachedSceneCanvas()._canvas,0,0),b.restore()},_getCachedSceneCanvas:function(){var u,s,r,q,p=this.filters(),o=this._cache.canvas,n=o.scene,m=o.filter,l=m.getContext();if(p){if(!this._filterUpToDate){try{for(u=p.length,l.clear(),l.drawImage(n._canvas,0,0),s=l.getImageData(0,0,m.getWidth(),m.getHeight()),r=0;u>r;r++){q=p[r],q.call(this,s),l.putImageData(s,0,0)}}catch(k){Kinetic.Util.warn("Unable to apply filter. "+k.message)}this._filterUpToDate=!0}return m}return n},_drawCachedHitCanvas:function(e){var d=this._cache.canvas,f=d.hit;e.save(),e._applyTransform(this),e.drawImage(f._canvas,0,0),e.restore()},on:function(r,q){var p,o,n,m,l,g=r.split(B),f=g.length;for(p=0;f>p;p++){o=g[p],n=o.split(M),m=n[0],l=n[1]||L,this.eventListeners[m]||(this.eventListeners[m]=[]),this.eventListeners[m].push({name:l,handler:q})}return this},off:function(r){var q,p,o,n,m,l,k=r.split(B),f=k.length;for(q=0;f>q;q++){if(o=k[q],n=o.split(M),m=n[0],l=n[1],m){this.eventListeners[m]&&this._off(m,l)}else{for(p in this.eventListeners){this._off(p,l)}}}return this},remove:function(){var a=this.getParent();return a&&a.children&&(a.children.splice(this.index,1),a._setChildrenIndices(),delete this.parent),this._clearSelfAndDescendantCache(A),this._clearSelfAndDescendantCache(Q),this._clearSelfAndDescendantCache(x),this._clearSelfAndDescendantCache(H),this._clearSelfAndDescendantCache(R),this},destroy:function(){Kinetic._removeId(this.getId()),Kinetic._removeName(this.getName(),this._id),this.remove()},getAttr:function(d){var c=K+Kinetic.Util._capitalize(d);return Kinetic.Util._isFunction(this[c])?this[c]():this.attrs[d]},getAncestors:function(){for(var d=this.getParent(),c=new Kinetic.Collection;d;){c.push(d),d=d.getParent()}return c},getAttrs:function(){return this.attrs||{}},setAttrs:function(e){var d,f;if(e){for(d in e){d===N||(f=D+Kinetic.Util._capitalize(d),Kinetic.Util._isFunction(this[f])?this[f](e[d]):this._setAttr(d,e[d]))}}return this},isListening:function(){return this._getCache(H,this._isListening)},_isListening:function(){var d=this.getListening(),c=this.getParent();return"inherit"===d?c?c.isListening():!0:d},isVisible:function(){return this._getCache(x,this._isVisible)},_isVisible:function(){var d=this.getVisible(),c=this.getParent();return"inherit"===d?c?c.isVisible():!0:d},shouldDrawHit:function(){var b=this.getLayer();return b&&b.hitGraphEnabled()&&this.isListening()&&this.isVisible()&&!Kinetic.isDragging()},show:function(){return this.setVisible(!0),this},hide:function(){return this.setVisible(!1),this},getZIndex:function(){return this.index||0},getAbsoluteZIndex:function(){function j(a){for(i=[],p=a.length,o=0;p>o;o++){n=a[o],k++,n.nodeType!==C&&(i=i.concat(n.getChildren().toArray())),n._id===l._id&&(o=p)}i.length>0&&i[0].getDepth()<=m&&j(i)}var i,p,o,n,m=this.getDepth(),l=this,k=0;return l.nodeType!==y&&j(l.getStage().getChildren()),k},getDepth:function(){for(var d=0,c=this.parent;c;){d++,c=c.parent}return d},setPosition:function(b){return this.setX(b.x),this.setY(b.y),this},getPosition:function(){return{x:this.getX(),y:this.getY()}},getAbsolutePosition:function(){var e=this.getAbsoluteTransform().getMatrix(),d=new Kinetic.Transform,f=this.offset();return d.m=e.slice(),d.translate(f.x,f.y),d.getTranslation()},setAbsolutePosition:function(e){var d,f=this._clearTransform();return this.attrs.x=f.x,this.attrs.y=f.y,delete f.x,delete f.y,d=this.getAbsoluteTransform(),d.invert(),d.translate(e.x,e.y),e={x:this.attrs.x+d.getTranslation().x,y:this.attrs.y+d.getTranslation().y},this.setPosition({x:e.x,y:e.y}),this._setTransform(f),this},_setTransform:function(b){var d;for(d in b){this.attrs[d]=b[d]}this._clearCache(z),this._clearSelfAndDescendantCache(Q)},_clearTransform:function(){var b={x:this.getX(),y:this.getY(),rotation:this.getRotation(),scaleX:this.getScaleX(),scaleY:this.getScaleY(),offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),skewX:this.getSkewX(),skewY:this.getSkewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,this._clearCache(z),this._clearSelfAndDescendantCache(Q),b},move:function(g){var f=g.x,j=g.y,i=this.getX(),h=this.getY();return void 0!==f&&(i+=f),void 0!==j&&(h+=j),this.setPosition({x:i,y:h}),this},_eachAncestorReverse:function(h,g){var l,k,j=[],i=this.getParent();for(g&&j.unshift(this);i;){j.unshift(i),i=i.parent}for(l=j.length,k=0;l>k;k++){h(j[k])}},rotate:function(b){return this.setRotation(this.getRotation()+b),this},moveToTop:function(){var b=this.index;return this.parent.children.splice(b,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0},moveUp:function(){var d=this.index,c=this.parent.getChildren().length;return c-1>d?(this.parent.children.splice(d,1),this.parent.children.splice(d+1,0,this),this.parent._setChildrenIndices(),!0):!1},moveDown:function(){var b=this.index;return b>0?(this.parent.children.splice(b,1),this.parent.children.splice(b-1,0,this),this.parent._setChildrenIndices(),!0):!1},moveToBottom:function(){var b=this.index;return b>0?(this.parent.children.splice(b,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1},setZIndex:function(d){var c=this.index;return this.parent.children.splice(c,1),this.parent.children.splice(d,0,this),this.parent._setChildrenIndices(),this},getAbsoluteOpacity:function(){return this._getCache(R,this._getAbsoluteOpacity)},_getAbsoluteOpacity:function(){var b=this.getOpacity();return this.getParent()&&(b*=this.getParent().getAbsoluteOpacity()),b},moveTo:function(b){return Kinetic.Node.prototype.remove.call(this),b.add(this),this},toObject:function(){var i,h,n,m,l=Kinetic.Util,k={},j=this.getAttrs();k.attrs={};for(i in j){h=j[i],l._isFunction(h)||l._isElement(h)||l._isObject(h)&&l._hasMethods(h)||(n=this[i],delete j[i],m=n?n.call(this):null,j[i]=h,m!==h&&(k.attrs[i]=h))}return k.className=this.getClassName(),k},toJSON:function(){return JSON.stringify(this.toObject())},getParent:function(){return this.parent},getLayer:function(){var b=this.getParent();return b?b.getLayer():null},getStage:function(){return this._getCache(A,this._getStage)},_getStage:function(){var b=this.getParent();return b?b.getStage():void 0},fire:function(e,d,f){return f?this._fireAndBubble(e,d||{}):this._fire(e,d||{}),this},getAbsoluteTransform:function(){return this._getCache(Q,this._getAbsoluteTransform)},_getAbsoluteTransform:function(){var e,d,f=new Kinetic.Transform;return this._eachAncestorReverse(function(a){e=a.transformsEnabled(),d=a.getTransform(),"all"===e?f.multiply(d):"position"===e&&f.translate(a.x(),a.y())},!0),f},getTransform:function(){return this._getCache(z,this._getTransform)},_getTransform:function(){var u=new Kinetic.Transform,s=this.getX(),r=this.getY(),q=this.getRotation()*Math.PI/180,p=this.getScaleX(),o=this.getScaleY(),n=this.getSkewX(),m=this.getSkewY(),l=this.getOffsetX(),k=this.getOffsetY();return(0!==s||0!==r)&&u.translate(s,r),0!==q&&u.rotate(q),(0!==n||0!==m)&&u.skew(n,m),(1!==p||1!==o)&&u.scale(p,o),(0!==l||0!==k)&&u.translate(-1*l,-1*k),u},clone:function(j){var i,p,o,n,m,l=this.getClassName(),k=new Kinetic[l](this.attrs);for(i in this.eventListeners){for(p=this.eventListeners[i],o=p.length,n=0;o>n;n++){m=p[n],m.name.indexOf(I)<0&&(k.eventListeners[i]||(k.eventListeners[i]=[]),k.eventListeners[i].push(m))}}return k.setAttrs(j),k},toDataURL:function(j){j=j||{};var i=j.mimeType||null,p=j.quality||null,o=this.getStage(),n=j.x||0,m=j.y||0,l=new Kinetic.SceneCanvas({width:j.width||this.getWidth()||(o?o.getWidth():0),height:j.height||this.getHeight()||(o?o.getHeight():0),pixelRatio:1}),k=l.getContext();return k.save(),(n||m)&&k.translate(-1*n,-1*m),this.drawScene(l),k.restore(),l.toDataURL(i,p)},toImage:function(b){Kinetic.Util._getImage(this.toDataURL(b),function(a){b.callback(a)})},setSize:function(b){return this.setWidth(b.width),this.setHeight(b.height),this},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},getWidth:function(){return this.attrs.width||0},getHeight:function(){return this.attrs.height||0},getClassName:function(){return this.className||this.nodeType},getType:function(){return this.nodeType},_get:function(b){return this.nodeType===b?[this]:[]},_off:function(g,f){var j,i,h=this.eventListeners[g];for(j=0;j<h.length;j++){if(i=h[j].name,!("kinetic"===i&&"kinetic"!==f||f&&i!==f)){if(h.splice(j,1),0===h.length){delete this.eventListeners[g];break}j--}}},_fireBeforeChangeEvent:function(d,c,f){this._fire([P,Kinetic.Util._capitalize(d),O].join(L),{oldVal:c,newVal:f})},_fireChangeEvent:function(e,d,f){this._fire(e+O,{oldVal:d,newVal:f})},setId:function(d){var c=this.getId();return Kinetic._removeId(c),Kinetic._addId(this,d),this._setAttr(J,d),this},setName:function(d){var c=this.getName();return Kinetic._removeName(c,this._id),Kinetic._addName(this,d),this._setAttr(E,d),this},setAttr:function(){var g=Array.prototype.slice.call(arguments),f=g[0],j=g[1],i=D+Kinetic.Util._capitalize(f),h=this[i];return Kinetic.Util._isFunction(h)?h.call(this,j):this._setAttr(f,j),this},_setAttr:function(e,d){var f;void 0!==d&&(f=this.attrs[e],this.attrs[e]=d,this._fireChangeEvent(e,f,d))},_setComponentAttr:function(f,e,h){var g;void 0!==h&&(g=this.attrs[f],g||(this.attrs[f]=this.getAttr(f)),this.attrs[f][e]=h,this._fireChangeEvent(f,g,h))},_fireAndBubble:function(f,e,h){var g=!0;e&&this.nodeType===C&&(e.targetNode=this),f===G&&h&&this._id===h._id?g=!1:f===F&&h&&this._id===h._id&&(g=!1),g&&(this._fire(f,e),e&&!e.cancelBubble&&this.parent&&(h&&h.parent?this._fireAndBubble.call(this.parent,f,e,h.parent):this._fireAndBubble.call(this.parent,f,e)))},_fire:function(f,e){var h,g=this.eventListeners[f];if(g){for(h=0;h<g.length;h++){g[h].handler.call(this,e)}}},draw:function(){return this.drawScene(),this.drawHit(),this}}),Kinetic.Node.create=function(d,c){return this._createNode(JSON.parse(d),c)},Kinetic.Node._createNode=function(i,h){var n,m,l,k=Kinetic.Node.prototype.getClassName.call(i),j=i.children;if(h&&(i.attrs.container=h),n=new Kinetic[k](i.attrs),j){for(m=j.length,l=0;m>l;l++){n.add(this._createNode(j[l]))}}return n},Kinetic.Factory.addOverloadedGetterSetter(Kinetic.Node,"position"),Kinetic.Factory.addGetterSetter(Kinetic.Node,"x",0),Kinetic.Factory.addGetterSetter(Kinetic.Node,"y",0),Kinetic.Factory.addGetterSetter(Kinetic.Node,"opacity",1),Kinetic.Factory.addGetter(Kinetic.Node,"name"),Kinetic.Factory.addOverloadedGetterSetter(Kinetic.Node,"name"),Kinetic.Factory.addGetter(Kinetic.Node,"id"),Kinetic.Factory.addOverloadedGetterSetter(Kinetic.Node,"id"),Kinetic.Factory.addGetterSetter(Kinetic.Node,"rotation",0),Kinetic.Factory.addComponentsGetterSetter(Kinetic.Node,"scale",["x","y"]),Kinetic.Factory.addGetterSetter(Kinetic.Node,"scaleX",1),Kinetic.Factory.addGetterSetter(Kinetic.Node,"scaleY",1),Kinetic.Factory.addComponentsGetterSetter(Kinetic.Node,"skew",["x","y"]),Kinetic.Factory.addGetterSetter(Kinetic.Node,"skewX",0),Kinetic.Factory.addGetterSetter(Kinetic.Node,"skewY",0),Kinetic.Factory.addComponentsGetterSetter(Kinetic.Node,"offset",["x","y"]),Kinetic.Factory.addGetterSetter(Kinetic.Node,"offsetX",0),Kinetic.Factory.addGetterSetter(Kinetic.Node,"offsetY",0),Kinetic.Factory.addSetter(Kinetic.Node,"width",0),Kinetic.Factory.addOverloadedGetterSetter(Kinetic.Node,"width"),Kinetic.Factory.addSetter(Kinetic.Node,"height",0),Kinetic.Factory.addOverloadedGetterSetter(Kinetic.Node,"height"),Kinetic.Factory.addGetterSetter(Kinetic.Node,"listening","inherit"),Kinetic.Factory.addGetterSetter(Kinetic.Node,"filters",void 0,function(b){return this._filterUpToDate=!1,b}),Kinetic.Factory.addGetterSetter(Kinetic.Node,"visible","inherit"),Kinetic.Factory.addGetterSetter(Kinetic.Node,"transformsEnabled","all"),Kinetic.Factory.backCompat(Kinetic.Node,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),Kinetic.Collection.mapMethods(Kinetic.Node)}(),function(){Kinetic.Filters.Grayscale=function(g){var f,j,i=g.data,h=i.length;for(f=0;h>f;f+=4){j=0.34*i[f]+0.5*i[f+1]+0.16*i[f+2],i[f]=j,i[f+1]=j,i[f+2]=j}}}(),function(){Kinetic.Filters.Brighten=function(g){var f,j=255*this.brightness(),i=g.data,h=i.length;for(f=0;h>f;f+=4){i[f]+=j,i[f+1]+=j,i[f+2]+=j}},Kinetic.Factory.addGetterSetter(Kinetic.Node,"brightness",0,null,Kinetic.Factory.afterSetFilter)}(),function(){Kinetic.Filters.Invert=function(f){var e,h=f.data,g=h.length;for(e=0;g>e;e+=4){h[e]=255-h[e],h[e+1]=255-h[e+1],h[e+2]=255-h[e+2]}}}(),function(){function f(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}function e(aE,aD){var aC,aB,aA,az,ay,ax,aw,av,au,at,ar,aq,ap,ao,an,am,al,ak,aj,ai,ah,ag,af,ae,ad=aE.data,ac=aE.width,ab=aE.height,aa=aD+aD+1,Z=ac-1,Y=ab-1,X=aD+1,W=X*(X+1)/2,V=new f,U=null,T=V,S=null,d=null,c=h[aD],a=g[aD];for(aA=1;aa>aA;aA++){T=T.next=new f,aA==X&&(U=T)}for(T.next=V,aw=ax=0,aB=0;ab>aB;aB++){for(am=al=ak=aj=av=au=at=ar=0,aq=X*(ai=ad[ax]),ap=X*(ah=ad[ax+1]),ao=X*(ag=ad[ax+2]),an=X*(af=ad[ax+3]),av+=W*ai,au+=W*ah,at+=W*ag,ar+=W*af,T=V,aA=0;X>aA;aA++){T.r=ai,T.g=ah,T.b=ag,T.a=af,T=T.next}for(aA=1;X>aA;aA++){az=ax+((aA>Z?Z:aA)<<2),av+=(T.r=ai=ad[az])*(ae=X-aA),au+=(T.g=ah=ad[az+1])*ae,at+=(T.b=ag=ad[az+2])*ae,ar+=(T.a=af=ad[az+3])*ae,am+=ai,al+=ah,ak+=ag,aj+=af,T=T.next}for(S=V,d=U,aC=0;ac>aC;aC++){ad[ax+3]=af=ar*c>>a,0!==af?(af=255/af,ad[ax]=(av*c>>a)*af,ad[ax+1]=(au*c>>a)*af,ad[ax+2]=(at*c>>a)*af):ad[ax]=ad[ax+1]=ad[ax+2]=0,av-=aq,au-=ap,at-=ao,ar-=an,aq-=S.r,ap-=S.g,ao-=S.b,an-=S.a,az=aw+((az=aC+aD+1)<Z?az:Z)<<2,am+=S.r=ad[az],al+=S.g=ad[az+1],ak+=S.b=ad[az+2],aj+=S.a=ad[az+3],av+=am,au+=al,at+=ak,ar+=aj,S=S.next,aq+=ai=d.r,ap+=ah=d.g,ao+=ag=d.b,an+=af=d.a,am-=ai,al-=ah,ak-=ag,aj-=af,d=d.next,ax+=4}aw+=ac}for(aC=0;ac>aC;aC++){for(al=ak=aj=am=au=at=ar=av=0,ax=aC<<2,aq=X*(ai=ad[ax]),ap=X*(ah=ad[ax+1]),ao=X*(ag=ad[ax+2]),an=X*(af=ad[ax+3]),av+=W*ai,au+=W*ah,at+=W*ag,ar+=W*af,T=V,aA=0;X>aA;aA++){T.r=ai,T.g=ah,T.b=ag,T.a=af,T=T.next}for(ay=ac,aA=1;aD>=aA;aA++){ax=ay+aC<<2,av+=(T.r=ai=ad[ax])*(ae=X-aA),au+=(T.g=ah=ad[ax+1])*ae,at+=(T.b=ag=ad[ax+2])*ae,ar+=(T.a=af=ad[ax+3])*ae,am+=ai,al+=ah,ak+=ag,aj+=af,T=T.next,Y>aA&&(ay+=ac)}for(ax=aC,S=V,d=U,aB=0;ab>aB;aB++){az=ax<<2,ad[az+3]=af=ar*c>>a,af>0?(af=255/af,ad[az]=(av*c>>a)*af,ad[az+1]=(au*c>>a)*af,ad[az+2]=(at*c>>a)*af):ad[az]=ad[az+1]=ad[az+2]=0,av-=aq,au-=ap,at-=ao,ar-=an,aq-=S.r,ap-=S.g,ao-=S.b,an-=S.a,az=aC+((az=aB+X)<Y?az:Y)*ac<<2,av+=am+=S.r=ad[az],au+=al+=S.g=ad[az+1],at+=ak+=S.b=ad[az+2],ar+=aj+=S.a=ad[az+3],S=S.next,aq+=ai=d.r,ap+=ah=d.g,ao+=ag=d.b,an+=af=d.a,am-=ai,al-=ah,ak-=ag,aj-=af,d=d.next,ax+=ac}}}var h=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],g=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];Kinetic.Filters.Blur=function(b){var d=0|this.blurRadius();d>0&&e(b,d)},Kinetic.Factory.addGetterSetter(Kinetic.Node,"blurRadius",0,null,Kinetic.Factory.afterSetFilter)}(),function(){function j(g,f,r){var q=4*(r*g.width+f),h=[];return h.push(g.data[q++],g.data[q++],g.data[q++],g.data[q++]),h}function i(d,c){return Math.sqrt(Math.pow(d[0]-c[0],2)+Math.pow(d[1]-c[1],2)+Math.pow(d[2]-c[2],2))}function p(e){for(var d=[0,0,0],f=0;f<e.length;f++){d[0]+=e[f][0],d[1]+=e[f][1],d[2]+=e[f][2]}return d[0]/=e.length,d[1]/=e.length,d[2]/=e.length,d}function o(y,x){var w=j(y,0,0),v=j(y,y.width-1,0),u=j(y,0,y.height-1),s=j(y,y.width-1,y.height-1),r=x||10;if(i(w,v)<r&&i(v,s)<r&&i(s,u)<r&&i(u,w)<r){for(var q=p([v,w,s,u]),c=[],b=0;b<y.width*y.height;b++){var a=i(q,[y.data[4*b],y.data[4*b+1],y.data[4*b+2]]);c[b]=r>a?0:255}return c}}function n(e,d){for(var f=0;f<e.width*e.height;f++){e.data[4*f+3]=d[f]}}function m(I,H,G){for(var F=[1,1,1,1,0,1,1,1,1],E=Math.round(Math.sqrt(F.length)),D=Math.floor(E/2),C=[],B=0;G>B;B++){for(var A=0;H>A;A++){for(var z=B*H+A,y=0,x=0;E>x;x++){for(var w=0;E>w;w++){var v=B+x-D,u=A+w-D;if(v>=0&&G>v&&u>=0&&H>u){var s=v*H+u,r=F[x*E+w];y+=I[s]*r}}}C[z]=2040===y?255:0}}return C}function l(I,H,G){for(var F=[1,1,1,1,1,1,1,1,1],E=Math.round(Math.sqrt(F.length)),D=Math.floor(E/2),C=[],B=0;G>B;B++){for(var A=0;H>A;A++){for(var z=B*H+A,y=0,x=0;E>x;x++){for(var w=0;E>w;w++){var v=B+x-D,u=A+w-D;if(v>=0&&G>v&&u>=0&&H>u){var s=v*H+u,r=F[x*E+w];y+=I[s]*r}}}C[z]=y>=1020?255:0}}return C}function k(I,H,G){for(var F=[1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9],E=Math.round(Math.sqrt(F.length)),D=Math.floor(E/2),C=[],B=0;G>B;B++){for(var A=0;H>A;A++){for(var z=B*H+A,y=0,x=0;E>x;x++){for(var w=0;E>w;w++){var v=B+x-D,u=A+w-D;if(v>=0&&G>v&&u>=0&&H>u){var s=v*H+u,r=F[x*E+w];y+=I[s]*r}}}C[z]=y}}return C}Kinetic.Filters.Mask=function(e){var d=this.threshold(),f=o(e,d);return f&&(f=m(f,e.width,e.height),f=l(f,e.width,e.height),f=k(f,e.width,e.height),n(e,f)),e},Kinetic.Factory.addGetterSetter(Kinetic.Node,"threshold",0,null,Kinetic.Factory.afterSetFilter)}(),function(){Kinetic.Filters.RGB=function(j){var i,p,o=j.data,n=o.length,m=this.red(),l=this.green(),k=this.blue();for(i=0;n>i;i+=4){p=(0.34*o[i]+0.5*o[i+1]+0.16*o[i+2])/255,o[i]=p*m,o[i+1]=p*l,o[i+2]=p*k,o[i+3]=o[i+3]}},Kinetic.Factory.addGetterSetter(Kinetic.Node,"red",0,function(b){return this._filterUpToDate=!1,b>255?255:0>b?0:Math.round(b)}),Kinetic.Factory.addGetterSetter(Kinetic.Node,"green",0,function(b){return this._filterUpToDate=!1,b>255?255:0>b?0:Math.round(b)}),Kinetic.Factory.addGetterSetter(Kinetic.Node,"blue",0,Kinetic.Validators.RGBComponent,Kinetic.Factory.afterSetFilter)}(),function(){Kinetic.Filters.HSV=function(R){var Q,P,O,N,M,L=R.data,K=L.length,J=this.value(),I=this.saturation(),H=Math.abs(this.hue()+360)%360,G=J*I*Math.cos(H*Math.PI/180),F=J*I*Math.sin(H*Math.PI/180),E=0.299*J+0.701*G+0.167*F,D=0.587*J-0.587*G+0.33*F,C=0.114*J-0.114*G-0.497*F,B=0.299*J-0.299*G-0.328*F,A=0.587*J+0.413*G+0.035*F,z=0.114*J-0.114*G+0.293*F,y=0.299*J-0.3*G+1.25*F,x=0.587*J-0.586*G-1.05*F,w=0.114*J+0.886*G-0.2*F;for(Q=0;K>Q;Q+=4){P=L[Q+0],O=L[Q+1],N=L[Q+2],M=L[Q+3],L[Q+0]=E*P+D*O+C*N,L[Q+1]=B*P+A*O+z*N,L[Q+2]=y*P+x*O+w*N,L[Q+3]=M}},Kinetic.Factory.addGetterSetter(Kinetic.Node,"hue",0,null,Kinetic.Factory.afterSetFilter),Kinetic.Factory.addGetterSetter(Kinetic.Node,"saturation",1,null,Kinetic.Factory.afterSetFilter),Kinetic.Factory.addGetterSetter(Kinetic.Node,"value",1,null,Kinetic.Factory.afterSetFilter)}(),function(){Kinetic.Filters.Emboss=function(ah){var ag=10*this.embossStrength(),af=255*this.embossWhiteLevel(),ae=this.embossDirection(),ad=this.embossBlend(),ac=0,ab=0,aa=ah.data,Z=ah.width,Y=ah.height,X=4*Z,W=Y;switch(ae){case"top-left":ac=-1,ab=-1;break;case"top":ac=-1,ab=0;break;case"top-right":ac=-1,ab=1;break;case"right":ac=0,ab=1;break;case"bottom-right":ac=1,ab=1;break;case"bottom":ac=1,ab=0;break;case"bottom-left":ac=1,ab=-1;break;case"left":ac=0,ab=-1}do{var V=(W-1)*X,U=ac;1>W+U&&(U=0),W+U>Y&&(U=0);var T=4*(W-1+U)*Z,S=Z;do{var Q=V+4*(S-1),O=ab;1>S+O&&(O=0),S+O>Z&&(O=0);var M=T+4*(S-1+O),K=aa[Q]-aa[M],J=aa[Q+1]-aa[M+1],I=aa[Q+2]-aa[M+2],H=K,G=H>0?H:-H,F=J>0?J:-J,E=I>0?I:-I;if(F>G&&(H=J),E>G&&(H=I),H*=ag,ad){var R=aa[Q]+H,P=aa[Q+1]+H,N=aa[Q+2]+H;aa[Q]=R>255?255:0>R?0:R,aa[Q+1]=P>255?255:0>P?0:P,aa[Q+2]=N>255?255:0>N?0:N}else{var L=af-H;0>L?L=0:L>255&&(L=255),aa[Q]=aa[Q+1]=aa[Q+2]=L}}while(--S)}while(--W)},Kinetic.Factory.addGetterSetter(Kinetic.Node,"embossStrength",0.5,null,Kinetic.Factory.afterSetFilter),Kinetic.Factory.addGetterSetter(Kinetic.Node,"embossWhiteLevel",0.5,null,Kinetic.Factory.afterSetFilter),Kinetic.Factory.addGetterSetter(Kinetic.Node,"embossDirection","top-left",null,Kinetic.Factory.afterSetFilter),Kinetic.Factory.addGetterSetter(Kinetic.Node,"embossBlend",!1,null,Kinetic.Factory.afterSetFilter)}(),function(){function b(j,i,p,o,n){var m,l=p-i,k=n-o;return 0===l?o+k/2:0===k?o:(m=(j-i)/l,m=k*m+o)}Kinetic.Filters.Enhance=function(ad){var ac,ab,aa,Z,Y=ad.data,X=Y.length,W=Y[0],V=W,U=Y[1],T=U,S=Y[2],R=S,Q=Y[3],P=Q,N=this.enhance();if(0!==N){for(Z=0;X>Z;Z+=4){ac=Y[Z+0],W>ac?W=ac:ac>V&&(V=ac),ab=Y[Z+1],U>ab?U=ab:ab>T&&(T=ab),aa=Y[Z+2],S>aa?S=aa:aa>R&&(R=aa)}V===W&&(V=255,W=0),T===U&&(T=255,U=0),R===S&&(R=255,S=0),P===Q&&(P=255,Q=0);var L,J,I,H,G,F,E,D,a,O,M,K;for(N>0?(J=V+N*(255-V),I=W-N*(W-0),G=T+N*(255-T),F=U-N*(U-0),D=R+N*(255-R),K=S-N*(S-0),M=P+N*(255-P),a=Q-N*(Q-0)):(L=0.5*(V+W),J=V+N*(V-L),I=W+N*(W-L),H=0.5*(T+U),G=T+N*(T-H),F=U+N*(U-H),E=0.5*(R+S),D=R+N*(R-E),K=S+N*(S-E),O=0.5*(P+Q),M=P+N*(P-O),a=Q+N*(Q-O)),Z=0;X>Z;Z+=4){Y[Z+0]=b(Y[Z+0],W,V,I,J),Y[Z+1]=b(Y[Z+1],U,T,F,G),Y[Z+2]=b(Y[Z+2],S,R,K,D)}}},Kinetic.Factory.addGetterSetter(Kinetic.Node,"enhance",0,null,Kinetic.Factory.afterSetFilter)}(),function(){Kinetic.Filters.Posterize=function(h){var g,l=Math.round(254*this.levels())+1,k=h.data,j=k.length,i=255/l;for(g=0;j>g;g+=1){k[g]=Math.floor(k[g]/i)*i}},Kinetic.Factory.addGetterSetter(Kinetic.Node,"levels",0.5,null,Kinetic.Factory.afterSetFilter)}(),function(){Kinetic.Filters.Noise=function(h){var g,l=255*this.noise(),k=h.data,j=k.length,i=l/2;for(g=0;j>g;g+=4){k[g+0]+=i-2*i*Math.random(),k[g+1]+=i-2*i*Math.random(),k[g+2]+=i-2*i*Math.random()}},Kinetic.Factory.addGetterSetter(Kinetic.Node,"noise",0.2,null,Kinetic.Factory.afterSetFilter)}(),function(){Kinetic.Filters.Pixelate=function(N){var M,L,K,J,I,H,G,F,E,D,C,B,A,z,y=Math.ceil(this.pixelSize()),x=N.width,w=N.height,N=N.data,v=Math.ceil(x/y),u=Math.ceil(w/y);for(B=0;v>B;B+=1){for(A=0;u>A;A+=1){for(J=0,I=0,H=0,G=0,F=B*y,E=F+y,D=A*y,C=D+y,z=0,M=F;E>M;M+=1){if(!(M>=x)){for(L=D;C>L;L+=1){L>=w||(K=4*(x*L+M),J+=N[K+0],I+=N[K+1],H+=N[K+2],G+=N[K+3],z+=1)}}}for(J/=z,I/=z,H/=z,alphas=G/z,M=F;E>M;M+=1){if(!(M>=x)){for(L=D;C>L;L+=1){L>=w||(K=4*(x*L+M),N[K+0]=J,N[K+1]=I,N[K+2]=H,N[K+3]=G)}}}}}},Kinetic.Factory.addGetterSetter(Kinetic.Node,"pixelSize",8,null,Kinetic.Factory.afterSetFilter)}(),function(){Kinetic.Filters.Threshold=function(g){var f,j=255*this.threshold(),i=g.data,h=i.length;for(f=0;h>f;f+=1){i[f]=i[f]<j?0:255}},Kinetic.Factory.addGetterSetter(Kinetic.Node,"threshold",0.5,null,Kinetic.Factory.afterSetFilter)}(),function(){Kinetic.Filters.Sepia=function(C){var B,A,z,y,x,w,v,u,s,r=C.data,q=C.width,p=C.height,o=4*q;do{B=(p-1)*o,A=q;do{z=B+4*(A-1),y=r[z],x=r[z+1],w=r[z+2],v=0.393*y+0.769*x+0.189*w,u=0.349*y+0.686*x+0.168*w,s=0.272*y+0.534*x+0.131*w,r[z]=v>255?255:v,r[z+1]=u>255?255:u,r[z+2]=s>255?255:s,r[z+3]=r[z+3]}while(--A)}while(--p)}}(),function(){Kinetic.Filters.Solarize=function(y){var x=y.data,w=y.width,v=y.height,u=4*w,s=v;do{var r=(s-1)*u,q=w;do{var p=r+4*(q-1),o=x[p],n=x[p+1],m=x[p+2];o>127&&(o=255-o),n>127&&(n=255-n),m>127&&(m=255-m),x[p]=o,x[p+1]=n,x[p+2]=m}while(--q)}while(--s)}}(),function(){var e=function(ap,ao,an){var am,al,ak,aj,ai=ap.data,ah=ao.data,ag=ap.width,af=ap.height,ae=an.polarCenterX||ag/2,ad=an.polarCenterY||af/2,ac=0,ab=0,aa=0,Y=0,W=Math.sqrt(ae*ae+ad*ad);al=ag-ae,ak=af-ad,aj=Math.sqrt(al*al+ak*ak),W=aj>W?aj:W;var U,S,Q,O,M,K,J,I,Z,X,V,T,R,P=af,N=ag,L=360/N*Math.PI/180;for(S=0;N>S;S+=1){for(Q=Math.sin(S*L),O=Math.cos(S*L),U=0;P>U;U+=1){al=ae+W*U/P*O,ak=ad+W*U/P*Q,1>=al&&(al=1),al>=ag-0.5&&(al=ag-1),1>=ak&&(ak=1),ak>=af-0.5&&(ak=af-1),M=al-0.5,K=al+0.5,J=Math.floor(M),I=Math.floor(K),Z=ak-0.5,X=ak+0.5,V=Math.floor(Z),T=Math.floor(X),R=(1-(M-J))*(1-(Z-V)),am=4*(V*ag+J),ac=ai[am+0]*R,ab=ai[am+1]*R,aa=ai[am+2]*R,Y=ai[am+3]*R,R=(1-(M-J))*(X-T),am=4*(T*ag+J),ac+=ai[am+0]*R,ab+=ai[am+1]*R,aa+=ai[am+2]*R,Y+=ai[am+3]*R,R=(K-I)*(X-T),am=4*(T*ag+I),ac+=ai[am+0]*R,ab+=ai[am+1]*R,aa+=ai[am+2]*R,Y+=ai[am+3]*R,R=(K-I)*(1-(Z-V)),am=4*(V*ag+I),ac+=ai[am+0]*R,ab+=ai[am+1]*R,aa+=ai[am+2]*R,Y+=ai[am+3]*R,am=4*(S+U*ag),ah[am+0]=ac,ah[am+1]=ab,ah[am+2]=aa,ah[am+3]=Y}}},d=function(ap,ao,an){var am,al,ak,aj,ai,ah,ag=ap.data,af=ao.data,ae=ap.width,ad=ap.height,ac=an.polarCenterX||ae/2,ab=an.polarCenterY||ad/2,aa=0,Y=0,W=0,U=0,S=Math.sqrt(ac*ac+ab*ab);al=ae-ac,ak=ad-ab,ah=Math.sqrt(al*al+ak*ak),S=ah>S?ah:S;var Q,O,M=ad,K=ae,J=an.polarRotation||0;180*(K/360)/Math.PI;var I,Z,X,V,T,R,P,N,L;for(al=0;ae>al;al+=1){for(ak=0;ad>ak;ak+=1){aj=al-ac,ai=ak-ab,Q=Math.sqrt(aj*aj+ai*ai)*M/S,O=(180*Math.atan2(ai,aj)/Math.PI+360+J)%360,O=O*K/360,I=O-0.5,Z=O+0.5,X=Math.floor(I),V=Math.floor(Z),T=Q-0.5,R=Q+0.5,P=Math.floor(T),N=Math.floor(R),L=(1-(I-X))*(1-(T-P)),am=4*(P*ae+X),aa=ag[am+0]*L,Y=ag[am+1]*L,W=ag[am+2]*L,U=ag[am+3]*L,L=(1-(I-X))*(R-N),am=4*(N*ae+X),aa+=ag[am+0]*L,Y+=ag[am+1]*L,W+=ag[am+2]*L,U+=ag[am+3]*L,L=(Z-V)*(R-N),am=4*(N*ae+V),aa+=ag[am+0]*L,Y+=ag[am+1]*L,W+=ag[am+2]*L,U+=ag[am+3]*L,L=(Z-V)*(1-(T-P)),am=4*(P*ae+V),aa+=ag[am+0]*L,Y+=ag[am+1]*L,W+=ag[am+2]*L,U+=ag[am+3]*L,am=4*(ak*ae+al),af[am+0]=aa,af[am+1]=Y,af[am+2]=W,af[am+3]=U}}},f=document.createElement("canvas");Kinetic.Filters.Kaleidoscope=function(R){var Q=R.width,P=R.height,O=Math.round(this.kaleidoscopePower()),N=Math.round(this.kaleidoscopeAngle()),M=Math.floor(Q*(N%360)/360);if(!(1>O)){f.width=Q,f.height=P;var L=f.getContext("2d").getImageData(0,0,Q,P);e(R,L,{polarCenterX:Q/2,polarCenterY:P/2});for(var K=Q/Math.pow(2,O);8>=K;){K=2*K,O-=1}K=Math.ceil(K);var J=K,I=0,H=J,G=1;for(M+K>Q&&(I=J,H=0,G=-1),E=0;P>E;E+=1){for(F=I;F!==H;F+=G){D=Math.round(F+M)%Q,b=4*(Q*E+D),B=L.data[b+0],A=L.data[b+1],z=L.data[b+2],c=L.data[b+3],a=4*(Q*E+F),L.data[a+0]=B,L.data[a+1]=A,L.data[a+2]=z,L.data[a+3]=c}}var F,E,D,C,B,A,z,c,b,a;for(E=0;P>E;E+=1){for(J=Math.floor(K),C=0;O>C;C+=1){for(F=0;J+1>F;F+=1){b=4*(Q*E+F),B=L.data[b+0],A=L.data[b+1],z=L.data[b+2],c=L.data[b+3],a=4*(Q*E+2*J-F-1),L.data[a+0]=B,L.data[a+1]=A,L.data[a+2]=z,L.data[a+3]=c}J*=2}}d(L,R,{polarRotation:0})}},Kinetic.Factory.addGetterSetter(Kinetic.Node,"kaleidoscopePower",2,null,Kinetic.Factory.afterSetFilter),Kinetic.Factory.addGetterSetter(Kinetic.Node,"kaleidoscopeAngle",0,null,Kinetic.Factory.afterSetFilter)}(),function(){function f(b){window.setTimeout(b,1000/60)}var e=500;Kinetic.Animation=function(d,c){this.func=d,this.setLayers(c),this.id=Kinetic.Animation.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:(new Date).getTime()}},Kinetic.Animation.prototype={setLayers:function(d){var c=[];c=d?d.length>0?d:[d]:[],this.layers=c},getLayers:function(){return this.layers},addLayer:function(j){var i,l,k=this.layers;if(k){for(i=k.length,l=0;i>l;l++){if(k[l]._id===j._id){return !1}}}else{this.layers=[]}return this.layers.push(j),!0},isRunning:function(){for(var i=Kinetic.Animation,d=i.animations,j=0;j<d.length;j++){if(d[j].id===this.id){return !0}}return !1},start:function(){this.stop(),this.frame.timeDiff=0,this.frame.lastTime=(new Date).getTime(),Kinetic.Animation._addAnimation(this)},stop:function(){Kinetic.Animation._removeAnimation(this)},_updateFrameObject:function(b){this.frame.timeDiff=b-this.frame.lastTime,this.frame.lastTime=b,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1000/this.frame.timeDiff}},Kinetic.Animation.animations=[],Kinetic.Animation.animIdCounter=0,Kinetic.Animation.animRunning=!1,Kinetic.Animation._addAnimation=function(b){this.animations.push(b),this._handleAnimation()},Kinetic.Animation._removeAnimation=function(j){for(var i=j.id,m=this.animations,l=m.length,k=0;l>k;k++){if(m[k].id===i){this.animations.splice(k,1);break}}},Kinetic.Animation._runFrames=function(){var u,s,r,q,p,o,n,m,l={},k=this.animations;for(q=0;q<k.length;q++){for(u=k[q],s=u.layers,r=u.func,u._updateFrameObject((new Date).getTime()),o=s.length,p=0;o>p;p++){n=s[p],void 0!==n._id&&(l[n._id]=n)}r&&r.call(u,u.frame)}for(m in l){l[m].draw()}},Kinetic.Animation._animationLoop=function(){var b=this;this.animations.length>0?(this._runFrames(),Kinetic.Animation.requestAnimFrame(function(){b._animationLoop()})):this.animRunning=!1},Kinetic.Animation._handleAnimation=function(){var b=this;this.animRunning||(this.animRunning=!0,b._animationLoop())};var h=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||f}();Kinetic.Animation.requestAnimFrame=function(a){var c=Kinetic.isDragging?f:h;c(a)};var g=Kinetic.Node.prototype.moveTo;Kinetic.Node.prototype.moveTo=function(b){g.call(this,b)},Kinetic.Layer.prototype.batchDraw=function(){var b=this;this.batchAnim||(this.batchAnim=new Kinetic.Animation(function(){b.lastBatchDrawTime&&(new Date).getTime()-b.lastBatchDrawTime>e&&b.batchAnim.stop()},this)),this.lastBatchDrawTime=(new Date).getTime(),this.batchAnim.isRunning()||(this.draw(),this.batchAnim.start())},Kinetic.Stage.prototype.batchDraw=function(){this.getChildren().each(function(b){b.batchDraw()})}}(),function(){var h={node:1,duration:1,easing:1,onFinish:1,yoyo:1},g=1,l=2,k=3,j=0;Kinetic.Tween=function(a){var q,p=this,o=a.node,n=o._id,m=a.duration||1,f=a.easing||Kinetic.Easings.Linear,e=!!a.yoyo;this.node=o,this._id=j++,this.anim=new Kinetic.Animation(function(){p.tween.onEnterFrame()},o.getLayer()||o.getLayers()),this.tween=new i(q,function(b){p._tweenFunc(b)},f,0,1,1000*m,e),this._addListeners(),Kinetic.Tween.attrs[n]||(Kinetic.Tween.attrs[n]={}),Kinetic.Tween.attrs[n][this._id]||(Kinetic.Tween.attrs[n][this._id]={}),Kinetic.Tween.tweens[n]||(Kinetic.Tween.tweens[n]={});for(q in a){void 0===h[q]&&this._addAttr(q,a[q])}this.reset(),this.onFinish=a.onFinish,this.onReset=a.onReset},Kinetic.Tween.attrs={},Kinetic.Tween.tweens={},Kinetic.Tween.prototype={_addAttr:function(v,u){var s,r,q,p,o,n=this.node,m=n._id;if(q=Kinetic.Tween.tweens[m][v],q&&delete Kinetic.Tween.attrs[m][q][v],s=n.getAttr(v),Kinetic.Util._isArray(u)){for(r=[],o=u.length,p=0;o>p;p++){r.push(u[p]-s[p])}}else{r=u-s}Kinetic.Tween.attrs[m][this._id][v]={start:s,diff:r},Kinetic.Tween.tweens[m][v]=this._id},_tweenFunc:function(w){var v,u,s,r,q,p,o,n=this.node,m=Kinetic.Tween.attrs[n._id][this._id];for(v in m){if(u=m[v],s=u.start,r=u.diff,Kinetic.Util._isArray(s)){for(q=[],o=s.length,p=0;o>p;p++){q.push(s[p]+r[p]*w)}}else{q=s+r*w}n.setAttr(v,q)}},_addListeners:function(){var b=this;this.tween.onPlay=function(){b.anim.start()},this.tween.onReverse=function(){b.anim.start()},this.tween.onPause=function(){b.anim.stop()},this.tween.onFinish=function(){b.onFinish&&b.onFinish()},this.tween.onReset=function(){b.onReset&&b.onReset()}},play:function(){return this.tween.play(),this},reverse:function(){return this.tween.reverse(),this},reset:function(){var b=this.node;return this.tween.reset(),(b.getLayer()||b.getLayers()).draw(),this},seek:function(d){var c=this.node;return this.tween.seek(1000*d),(c.getLayer()||c.getLayers()).draw(),this},pause:function(){return this.tween.pause(),this},finish:function(){var b=this.node;return this.tween.finish(),(b.getLayer()||b.getLayers()).draw(),this},destroy:function(){var f,e=this.node._id,n=this._id,m=Kinetic.Tween.tweens[e];this.pause();for(f in m){delete Kinetic.Tween.tweens[e][f]}delete Kinetic.Tween.attrs[e][n]}};var i=function(n,m,s,r,q,p,o){this.prop=n,this.propFunc=m,this.begin=r,this._pos=r,this.duration=p,this._change=0,this.prevPos=0,this.yoyo=o,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=s,this._change=q-this.begin,this.pause()};i.prototype={fire:function(d){var c=this[d];c&&c()},setTime:function(b){b>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():0>b?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=b,this.update())},getTime:function(){return this._time},setPosition:function(b){this.prevPos=this._pos,this.propFunc(b),this._pos=b},getPosition:function(b){return void 0===b&&(b=this._time),this.func(b,this.begin,this._change,this.duration)},play:function(){this.state=l,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")},reverse:function(){this.state=k,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")},seek:function(b){this.pause(),this._time=b,this.update(),this.fire("onSeek")},reset:function(){this.pause(),this._time=0,this.update(),this.fire("onReset")},finish:function(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")},update:function(){this.setPosition(this.getPosition(this._time))},onEnterFrame:function(){var b=this.getTimer()-this._startTime;this.state===l?this.setTime(b):this.state===k&&this.setTime(this.duration-b)},pause:function(){this.state=g,this.fire("onPause")},getTimer:function(){return(new Date).getTime()}},Kinetic.Easings={BackEaseIn:function(m,f,p,o){var n=1.70158;return p*(m/=o)*m*((n+1)*m-n)+f},BackEaseOut:function(m,f,p,o){var n=1.70158;return p*((m=m/o-1)*m*((n+1)*m+n)+1)+f},BackEaseInOut:function(m,f,p,o){var n=1.70158;return(m/=o/2)<1?p/2*m*m*(((n*=1.525)+1)*m-n)+f:p/2*((m-=2)*m*(((n*=1.525)+1)*m+n)+2)+f},ElasticEaseIn:function(n,m,s,r,q,p){var o=0;return 0===n?m:1==(n/=r)?m+s:(p||(p=0.3*r),!q||q<Math.abs(s)?(q=s,o=p/4):o=p/(2*Math.PI)*Math.asin(s/q),-(q*Math.pow(2,10*(n-=1))*Math.sin((n*r-o)*2*Math.PI/p))+m)},ElasticEaseOut:function(n,m,s,r,q,p){var o=0;return 0===n?m:1==(n/=r)?m+s:(p||(p=0.3*r),!q||q<Math.abs(s)?(q=s,o=p/4):o=p/(2*Math.PI)*Math.asin(s/q),q*Math.pow(2,-10*n)*Math.sin((n*r-o)*2*Math.PI/p)+s+m)},ElasticEaseInOut:function(n,m,s,r,q,p){var o=0;return 0===n?m:2==(n/=r/2)?m+s:(p||(p=r*0.3*1.5),!q||q<Math.abs(s)?(q=s,o=p/4):o=p/(2*Math.PI)*Math.asin(s/q),1>n?-0.5*q*Math.pow(2,10*(n-=1))*Math.sin((n*r-o)*2*Math.PI/p)+m:0.5*q*Math.pow(2,-10*(n-=1))*Math.sin((n*r-o)*2*Math.PI/p)+s+m)},BounceEaseOut:function(f,e,n,m){return(f/=m)<1/2.75?n*7.5625*f*f+e:2/2.75>f?n*(7.5625*(f-=1.5/2.75)*f+0.75)+e:2.5/2.75>f?n*(7.5625*(f-=2.25/2.75)*f+0.9375)+e:n*(7.5625*(f-=2.625/2.75)*f+0.984375)+e},BounceEaseIn:function(f,e,n,m){return n-Kinetic.Easings.BounceEaseOut(m-f,0,n,m)+e},BounceEaseInOut:function(f,e,n,m){return m/2>f?0.5*Kinetic.Easings.BounceEaseIn(2*f,0,n,m)+e:0.5*Kinetic.Easings.BounceEaseOut(2*f-m,0,n,m)+0.5*n+e},EaseIn:function(f,e,n,m){return n*(f/=m)*f+e},EaseOut:function(f,e,n,m){return -n*(f/=m)*(f-2)+e},EaseInOut:function(f,e,n,m){return(f/=m/2)<1?n/2*f*f+e:-n/2*(--f*(f-2)-1)+e},StrongEaseIn:function(f,e,n,m){return n*(f/=m)*f*f*f*f+e},StrongEaseOut:function(f,e,n,m){return n*((f=f/m-1)*f*f*f*f+1)+e},StrongEaseInOut:function(f,e,n,m){return(f/=m/2)<1?n/2*f*f*f*f*f+e:n/2*((f-=2)*f*f*f*f+2)+e},Linear:function(f,e,n,m){return n*f/m+e}}}(),function(){Kinetic.DD={anim:new Kinetic.Animation,isDragging:!1,offset:{x:0,y:0},node:null,_drag:function(f){var e=Kinetic.DD,g=e.node;g&&(g._setDragPosition(f),e.isDragging||(e.isDragging=!0,g.fire("dragstart",f,!0)),g.fire("dragmove",f,!0))},_endDragBefore:function(g){var f,j,i=Kinetic.DD,h=i.node;h&&(f=h.nodeType,j=h.getLayer(),i.anim.stop(),i.isDragging&&(i.isDragging=!1,Kinetic.listenClickTap=!1,g&&(g.dragEndNode=h)),delete i.node,(j||h).draw())},_endDragAfter:function(f){f=f||{};var e=f.dragEndNode;f&&e&&e.fire("dragend",f,!0)}},Kinetic.Node.prototype.startDrag=function(){var g=Kinetic.DD,f=this.getStage(),j=this.getLayer(),i=f.getPointerPosition(),h=this.getAbsolutePosition();i&&(g.node&&g.node.stopDrag(),g.node=this,g.offset.x=i.x-h.x,g.offset.y=i.y-h.y,g.anim.setLayers(j||this.getLayers()),g.anim.start(),this._setDragPosition())},Kinetic.Node.prototype._setDragPosition=function(g){var f=Kinetic.DD,j=this.getStage().getPointerPosition(),i=this.getDragBoundFunc(),h={x:j.x-f.offset.x,y:j.y-f.offset.y};void 0!==i&&(h=i.call(this,h,g)),this.setAbsolutePosition(h)},Kinetic.Node.prototype.stopDrag=function(){var f=Kinetic.DD,e={};f._endDragBefore(e),f._endDragAfter(e)},Kinetic.Node.prototype.setDraggable=function(b){this._setAttr("draggable",b),this._dragChange()};var d=Kinetic.Node.prototype.destroy;Kinetic.Node.prototype.destroy=function(){var a=Kinetic.DD;a.node&&a.node._id===this._id&&this.stopDrag(),d.call(this)},Kinetic.Node.prototype.isDragging=function(){var b=Kinetic.DD;return b.node&&b.node._id===this._id&&b.isDragging},Kinetic.Node.prototype._listenDrag=function(){var b=this;this._dragCleanup(),"Stage"===this.getClassName()?this.on("contentMousedown.kinetic contentTouchstart.kinetic",function(a){Kinetic.DD.node||b.startDrag(a)}):this.on("mousedown.kinetic touchstart.kinetic",function(a){Kinetic.DD.node||b.startDrag(a)})},Kinetic.Node.prototype._dragChange=function(){if(this.attrs.draggable){this._listenDrag()}else{this._dragCleanup();var f=this.getStage(),e=Kinetic.DD;f&&e.node&&e.node._id===this._id&&e.node.stopDrag()}},Kinetic.Node.prototype._dragCleanup=function(){"Stage"===this.getClassName()?(this.off("contentMousedown.kinetic"),this.off("contentTouchstart.kinetic")):(this.off("mousedown.kinetic"),this.off("touchstart.kinetic"))},Kinetic.Factory.addGetterSetter(Kinetic.Node,"dragBoundFunc"),Kinetic.Factory.addGetter(Kinetic.Node,"draggable",!1),Kinetic.Factory.addOverloadedGetterSetter(Kinetic.Node,"draggable");var c=document.documentElement;c.addEventListener("mouseup",Kinetic.DD._endDragBefore,!0),c.addEventListener("touchend",Kinetic.DD._endDragBefore,!0),c.addEventListener("mouseup",Kinetic.DD._endDragAfter,!1),c.addEventListener("touchend",Kinetic.DD._endDragAfter,!1)}(),function(){Kinetic.Util.addMethods(Kinetic.Container,{__init:function(b){this.children=new Kinetic.Collection,Kinetic.Node.call(this,b)},getChildren:function(){return this.children},hasChildren:function(){return this.getChildren().length>0},removeChildren:function(){for(var d,c=this.children;c.length>0;){d=c[0],d.hasChildren()&&d.removeChildren(),d.remove()}return this},destroyChildren:function(){for(var b=this.children;b.length>0;){b[0].destroy()}return this},add:function(d){var c=this.children;return this._validateAdd(d),d.index=c.length,d.parent=this,c.push(d),this._fire("add",{child:d}),this},destroy:function(){this.hasChildren()&&this.destroyChildren(),Kinetic.Node.prototype.destroy.call(this)},find:function(w){var v,u,s,r,q,p,o,n=[],m=w.replace(/ /g,"").split(","),l=m.length;for(v=0;l>v;v++){if(s=m[v],"#"===s.charAt(0)){q=this._getNodeById(s.slice(1)),q&&n.push(q)}else{if("."===s.charAt(0)){r=this._getNodesByName(s.slice(1)),n=n.concat(r)}else{for(p=this.getChildren(),o=p.length,u=0;o>u;u++){n=n.concat(p[u]._get(s))}}}}return Kinetic.Collection.toCollection(n)},_getNodeById:function(d){var c=Kinetic.ids[d];return void 0!==c&&this.isAncestorOf(c)?c:null},_getNodesByName:function(d){var c=Kinetic.names[d]||[];return this._getDescendants(c)},_get:function(g){for(var f=Kinetic.Node.prototype._get.call(this,g),j=this.getChildren(),i=j.length,h=0;i>h;h++){f=f.concat(j[h]._get(g))}return f},toObject:function(){var g=Kinetic.Node.prototype.toObject.call(this);g.children=[];for(var f=this.getChildren(),j=f.length,i=0;j>i;i++){var h=f[i];g.children.push(h.toObject())}return g},_getDescendants:function(g){for(var f=[],j=g.length,i=0;j>i;i++){var h=g[i];this.isAncestorOf(h)&&f.push(h)}return f},isAncestorOf:function(d){for(var c=d.getParent();c;){if(c._id===this._id){return !0}c=c.getParent()}return !1},clone:function(d){var c=Kinetic.Node.prototype.clone.call(this,d);return this.getChildren().each(function(b){c.add(b.clone())}),c},getAllIntersections:function(d){var c=[];return this.find("Shape").each(function(a){a.isVisible()&&a.intersects(d)&&c.push(a)}),c},_setChildrenIndices:function(){this.children.each(function(d,c){d.index=c})},drawScene:function(h){var g=this.getLayer(),l=h||g&&g.getCanvas(),k=l&&l.getContext(),j=this._cache.canvas,i=j&&j.scene;return this.isVisible()&&(i?this._drawCachedSceneCanvas(k):this._drawChildren(l,"drawScene")),this},drawHit:function(h){var g=this.getLayer(),l=h||g&&g.hitCanvas,k=l&&l.getContext(),j=this._cache.canvas,i=j&&j.hit;return this.shouldDrawHit()&&(i?this._drawCachedHitCanvas(k):this._drawChildren(l,"drawHit")),this},_drawChildren:function(j,i){var p,o,n=j&&j.getContext(),m=this.getClipWidth(),l=this.getClipHeight(),k=m&&l;k&&(p=this.getClipX(),o=this.getClipY(),n.save(),n._applyTransform(this),n.beginPath(),n.rect(p,o,m,l),n.clip(),n.reset()),this.children.each(function(a){a[i](j)}),k&&n.restore()}}),Kinetic.Util.extend(Kinetic.Container,Kinetic.Node),Kinetic.Container.prototype.get=Kinetic.Container.prototype.find,Kinetic.Factory.addComponentsGetterSetter(Kinetic.Container,"clip",["x","y","width","height"]),Kinetic.Factory.addGetterSetter(Kinetic.Container,"clipX"),Kinetic.Factory.addGetterSetter(Kinetic.Container,"clipY"),Kinetic.Factory.addGetterSetter(Kinetic.Container,"clipWidth"),Kinetic.Factory.addGetterSetter(Kinetic.Container,"clipHeight"),Kinetic.Collection.mapMethods(Kinetic.Container)}(),function(){function h(b){b.fill()}function g(b){b.stroke()}function l(b){b.fill()}function k(b){b.stroke()}function j(){this._clearCache(i)}var i="hasShadow";Kinetic.Util.addMethods(Kinetic.Shape,{__init:function(c){this.nodeType="Shape",this._fillFunc=h,this._strokeFunc=g,this._fillFuncHit=l,this._strokeFuncHit=k;for(var b,a=Kinetic.shapes;;){if(b=Kinetic.Util.getRandomColor(),b&&!(b in a)){break}}this.colorKey=b,a[b]=this,Kinetic.Node.call(this,c),this.on("shadowColorChange.kinetic shadowBlurChange.kinetic shadowOffsetChange.kinetic shadowOpacityChange.kinetic shadowEnabledChanged.kinetic",j)},hasChildren:function(){return !1},getChildren:function(){return[]},getContext:function(){return this.getLayer().getContext()},getCanvas:function(){return this.getLayer().getCanvas()},hasShadow:function(){return this._getCache(i,this._hasShadow)},_hasShadow:function(){return this.getShadowEnabled()&&0!==this.getShadowOpacity()&&!!(this.getShadowColor()||this.getShadowBlur()||this.getShadowOffsetX()||this.getShadowOffsetY())},hasFill:function(){return !!(this.getFill()||this.getFillPatternImage()||this.getFillLinearGradientColorStops()||this.getFillRadialGradientColorStops())},hasStroke:function(){return !!(this.stroke()||this.strokeRed()||this.strokeGreen()||this.strokeBlue())},_get:function(b){return this.className===b||this.nodeType===b?[this]:[]},intersects:function(f){var e,n=this.getStage(),m=n.bufferHitCanvas;return m.getContext().clear(),this.drawScene(m),e=m.context.getImageData(0|f.x,0|f.y,1,1).data,e[3]>0},destroy:function(){Kinetic.Node.prototype.destroy.call(this),delete Kinetic.shapes[this.colorKey]},_useBufferCanvas:function(){return(this.hasShadow()||1!==this.getAbsoluteOpacity())&&this.hasFill()&&this.hasStroke()},drawScene:function(v){var u,s,r,q=v||this.getLayer().getCanvas(),p=q.getContext(),o=this._cache.canvas,n=this.sceneFunc(),m=this.hasShadow();return this.isVisible()&&(o?this._drawCachedSceneCanvas(p):n&&(p.save(),this._useBufferCanvas()?(u=this.getStage(),s=u.bufferCanvas,r=s.getContext(),r.clear(),r.save(),r._applyLineJoin(this),r._applyTransform(this),n.call(this,r),r.restore(),m&&(p.save(),p._applyShadow(this),p.drawImage(s._canvas,0,0),p.restore()),p._applyOpacity(this),p.drawImage(s._canvas,0,0)):(p._applyLineJoin(this),p._applyTransform(this),m&&(p.save(),p._applyShadow(this),n.call(this,p),p.restore()),p._applyOpacity(this),n.call(this,p)),p.restore())),this},drawHit:function(n){var m=n||this.getLayer().hitCanvas,r=m.getContext(),q=this.hitFunc()||this.sceneFunc(),p=this._cache.canvas,o=p&&p.hit;return this.shouldDrawHit()&&(o?this._drawCachedHitCanvas(r):q&&(r.save(),r._applyLineJoin(this),r._applyTransform(this),q.call(this,r),r.restore())),this},drawHitFromCache:function(K){var J,I,H,G,F,E,D,C,B=K||0,A=this._cache.canvas,z=this._getCachedSceneCanvas(),y=z.getContext(),x=A.hit,w=x.getContext(),v=z.getWidth(),u=z.getHeight();w.clear();try{for(J=y.getImageData(0,0,v,u),I=J.data,H=w.getImageData(0,0,v,u),G=H.data,F=I.length,E=Kinetic.Util._hexToRgb(this.colorKey),D=0;F>D;D+=4){C=I[D+3],C>B&&(G[D]=E.r,G[D+1]=E.g,G[D+2]=E.b,G[D+3]=255)}w.putImageData(H,0,0)}catch(s){Kinetic.Util.warn("Unable to draw hit graph from cached scene canvas. "+s.message)}return this}}),Kinetic.Util.extend(Kinetic.Shape,Kinetic.Node),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"stroke"),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"strokeRed",0,Kinetic.Validators.RGBComponent),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"strokeGreen",0,Kinetic.Validators.RGBComponent),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"strokeBlue",0,Kinetic.Validators.RGBComponent),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"strokeAlpha",1,Kinetic.Validators.alphaComponent),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"strokeWidth",2),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"lineJoin"),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"lineCap"),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"sceneFunc"),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"hitFunc"),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"dash"),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"shadowColor"),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"shadowRed",0,Kinetic.Validators.RGBComponent),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"shadowGreen",0,Kinetic.Validators.RGBComponent),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"shadowBlue",0,Kinetic.Validators.RGBComponent),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"shadowAlpha",1,Kinetic.Validators.alphaComponent),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"shadowBlur"),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"shadowOpacity"),Kinetic.Factory.addComponentsGetterSetter(Kinetic.Shape,"shadowOffset",["x","y"]),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"shadowOffsetX",0),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"shadowOffsetY",0),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillPatternImage"),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fill"),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillRed",0,Kinetic.Validators.RGBComponent),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillGreen",0,Kinetic.Validators.RGBComponent),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillBlue",0,Kinetic.Validators.RGBComponent),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillAlpha",1,Kinetic.Validators.alphaComponent),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillPatternX",0),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillPatternY",0),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillLinearGradientColorStops"),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillRadialGradientStartRadius",0),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillRadialGradientEndRadius",0),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillRadialGradientColorStops"),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillPatternRepeat","repeat"),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillEnabled",!0),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"strokeEnabled",!0),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"shadowEnabled",!0),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"dashEnabled",!0),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"strokeScaleEnabled",!0),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillPriority","color"),Kinetic.Factory.addComponentsGetterSetter(Kinetic.Shape,"fillPatternOffset",["x","y"]),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillPatternOffsetX",0),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillPatternOffsetY",0),Kinetic.Factory.addComponentsGetterSetter(Kinetic.Shape,"fillPatternScale",["x","y"]),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillPatternScaleX",1),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillPatternScaleY",1),Kinetic.Factory.addComponentsGetterSetter(Kinetic.Shape,"fillLinearGradientStartPoint",["x","y"]),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillLinearGradientStartPointX",0),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillLinearGradientStartPointY",0),Kinetic.Factory.addComponentsGetterSetter(Kinetic.Shape,"fillLinearGradientEndPoint",["x","y"]),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillLinearGradientEndPointX",0),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillLinearGradientEndPointY",0),Kinetic.Factory.addComponentsGetterSetter(Kinetic.Shape,"fillRadialGradientStartPoint",["x","y"]),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillRadialGradientStartPointX",0),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillRadialGradientStartPointY",0),Kinetic.Factory.addComponentsGetterSetter(Kinetic.Shape,"fillRadialGradientEndPoint",["x","y"]),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillRadialGradientEndPointX",0),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillRadialGradientEndPointY",0),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillPatternRotation",0),Kinetic.Factory.backCompat(Kinetic.Shape,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"}),Kinetic.Collection.mapMethods(Kinetic.Shape)}(),function(){function aA(d,c){d.content.addEventListener(c,function(a){d[R+c](a)},!1)}var az="Stage",ay="string",ax="px",aw="mouseout",av="mouseleave",au="mouseover",at="mouseenter",ar="mousemove",aq="mousedown",ap="mouseup",ao="click",an="dblclick",am="touchstart",al="touchend",ak="tap",aj="dbltap",ai="touchmove",ah="contentMouseout",ag="contentMouseover",af="contentMousemove",ae="contentMousedown",ad="contentMouseup",ac="contentClick",ab="contentDblclick",aa="contentTouchstart",Z="contentTouchend",Y="contentDbltap",X="contentTouchmove",W="div",V="relative",U="inline-block",T="kineticjs-content",S=" ",R="_",Q="container",P="",O=[aq,ar,ap,aw,am,ai,al,au],N=O.length;Kinetic.Util.addMethods(Kinetic.Stage,{___init:function(b){this.nodeType=az,Kinetic.Container.call(this,b),this._id=Kinetic.idCounter++,this._buildDOM(),this._bindContentEvents(),this._enableNestedTransforms=!1,Kinetic.stages.push(this)},_validateAdd:function(b){"Layer"!==b.getType()&&Kinetic.Util.error("You may only add layers to the stage.")},setContainer:function(b){return typeof b===ay&&(b=document.getElementById(b)),this._setAttr(Q,b),this},shouldDrawHit:function(){return !0},draw:function(){return Kinetic.Node.prototype.draw.call(this),this},setHeight:function(b){return Kinetic.Node.prototype.setHeight.call(this,b),this._resizeDOM(),this},setWidth:function(b){return Kinetic.Node.prototype.setWidth.call(this,b),this._resizeDOM(),this},clear:function(){var e,d=this.children,f=d.length;for(e=0;f>e;e++){d[e].clear()}return this},destroy:function(){var b=this.content;Kinetic.Container.prototype.destroy.call(this),b&&Kinetic.Util._isInDocument(b)&&this.getContainer().removeChild(b)},getPointerPosition:function(){return this.pointerPos},getStage:function(){return this},getContent:function(){return this.content},toDataURL:function(r){function q(d){var c=j[d],b=c.toDataURL(),a=new Image;a.onload=function(){k.drawImage(a,0,0),d<j.length-1?q(d+1):r.callback(l.toDataURL(p,o))},a.src=b}r=r||{};var p=r.mimeType||null,o=r.quality||null,n=r.x||0,m=r.y||0,l=new Kinetic.SceneCanvas({width:r.width||this.getWidth(),height:r.height||this.getHeight(),pixelRatio:1}),k=l.getContext()._context,j=this.children;(n||m)&&k.translate(-1*n,-1*m),q(0)},toImage:function(d){var c=d.callback;d.callback=function(b){Kinetic.Util._getImage(b,function(e){c(e)})},this.toDataURL(d)},getIntersection:function(h){var g,l,k=this.getChildren(),j=k.length,i=j-1;for(g=i;g>=0;g--){if(l=k[g].getIntersection(h)){return l}}return null},_resizeDOM:function(){if(this.content){var h,d,l=this.getWidth(),k=this.getHeight(),j=this.getChildren(),i=j.length;for(this.content.style.width=l+ax,this.content.style.height=k+ax,this.bufferCanvas.setSize(l,k),this.bufferHitCanvas.setSize(l,k),h=0;i>h;h++){d=j[h],d.getCanvas().setSize(l,k),d.hitCanvas.setSize(l,k),d.draw()}}},add:function(b){return Kinetic.Container.prototype.add.call(this,b),b.canvas.setSize(this.attrs.width,this.attrs.height),b.hitCanvas.setSize(this.attrs.width,this.attrs.height),b.draw(),this.content.appendChild(b.canvas._canvas),this},getParent:function(){return null},getLayer:function(){return null},getLayers:function(){return this.getChildren()},_bindContentEvents:function(){var a;for(a=0;N>a;a++){aA(this,O[a])}},_mouseover:function(b){this._fire(ag,b)},_mouseout:function(d){this._setPointerPosition(d);var c=this.targetShape;c&&!Kinetic.isDragging()&&(c._fireAndBubble(aw,d),c._fireAndBubble(av,d),this.targetShape=null),this.pointerPos=void 0,this._fire(ah,d)},_mousemove:function(e){this._setPointerPosition(e);var d=Kinetic.DD,f=this.getIntersection(this.getPointerPosition());f&&f.isListening()?Kinetic.isDragging()||this.targetShape&&this.targetShape._id===f._id?f._fireAndBubble(ar,e):(this.targetShape&&(this.targetShape._fireAndBubble(aw,e,f),this.targetShape._fireAndBubble(av,e,f)),f._fireAndBubble(au,e,this.targetShape),f._fireAndBubble(at,e,this.targetShape),this.targetShape=f):this.targetShape&&!Kinetic.isDragging()&&(this.targetShape._fireAndBubble(aw,e),this.targetShape._fireAndBubble(av,e),this.targetShape=null),this._fire(af,e),d&&d._drag(e),e.preventDefault&&e.preventDefault()},_mousedown:function(d){this._setPointerPosition(d);var c=this.getIntersection(this.getPointerPosition());Kinetic.listenClickTap=!0,c&&c.isListening()&&(this.clickStartShape=c,c._fireAndBubble(aq,d)),this._fire(ae,d),d.preventDefault&&d.preventDefault()},_mouseup:function(f){this._setPointerPosition(f);var e=this.getIntersection(this.getPointerPosition()),h=this.clickStartShape,g=!1;Kinetic.inDblClickWindow?(g=!0,Kinetic.inDblClickWindow=!1):Kinetic.inDblClickWindow=!0,setTimeout(function(){Kinetic.inDblClickWindow=!1},Kinetic.dblClickWindow),e&&e.isListening()&&(e._fireAndBubble(ap,f),Kinetic.listenClickTap&&h&&h._id===e._id&&(e._fireAndBubble(ao,f),g&&e._fireAndBubble(an,f))),this._fire(ad,f),Kinetic.listenClickTap&&(this._fire(ac,f),g&&this._fire(ab,f)),Kinetic.listenClickTap=!1,f.preventDefault&&f.preventDefault()},_touchstart:function(d){this._setPointerPosition(d);var c=this.getIntersection(this.getPointerPosition());Kinetic.listenClickTap=!0,c&&c.isListening()&&(this.tapStartShape=c,c._fireAndBubble(am,d),c.isListening()&&d.preventDefault&&d.preventDefault()),this._fire(aa,d)},_touchend:function(d){this._setPointerPosition(d);var c=this.getIntersection(this.getPointerPosition());fireDblClick=!1,Kinetic.inDblClickWindow?(fireDblClick=!0,Kinetic.inDblClickWindow=!1):Kinetic.inDblClickWindow=!0,setTimeout(function(){Kinetic.inDblClickWindow=!1},Kinetic.dblClickWindow),c&&c.isListening()&&(c._fireAndBubble(al,d),Kinetic.listenClickTap&&c._id===this.tapStartShape._id&&(c._fireAndBubble(ak,d),fireDblClick&&c._fireAndBubble(aj,d)),c.isListening()&&d.preventDefault&&d.preventDefault()),Kinetic.listenClickTap&&(this._fire(Z,d),fireDblClick&&this._fire(Y,d)),Kinetic.listenClickTap=!1},_touchmove:function(e){this._setPointerPosition(e);var d=Kinetic.DD,f=this.getIntersection(this.getPointerPosition());f&&f.isListening()&&(f._fireAndBubble(ai,e),f.isListening()&&e.preventDefault&&e.preventDefault()),this._fire(X,e),d&&d._drag(e)},_setPointerPosition:function(i){var h,i=i?i:window.event,n=this._getContentPosition(),m=i.offsetX,l=i.clientX,k=null,j=null;void 0!==i.touches?1===i.touches.length&&(h=i.touches[0],k=h.clientX-n.left,j=h.clientY-n.top):void 0!==m?(k=m,j=i.offsetY):"mozilla"===Kinetic.UA.browser?(k=i.layerX,j=i.layerY):void 0!==l&&n&&(k=l-n.left,j=i.clientY-n.top),null!==k&&null!==j&&(this.pointerPos={x:k,y:j})},_getContentPosition:function(){var b=this.content.getBoundingClientRect?this.content.getBoundingClientRect():{top:0,left:0};return{top:b.top,left:b.left}},_buildDOM:function(){var b=this.getContainer();b.innerHTML=P,this.content=document.createElement(W),this.content.style.position=V,this.content.style.display=U,this.content.className=T,this.content.setAttribute("role","presentation"),b.appendChild(this.content),this.bufferCanvas=new Kinetic.SceneCanvas({pixelRatio:1}),this.bufferHitCanvas=new Kinetic.HitCanvas,this._resizeDOM()},_onContent:function(h,g){var l,k,j=h.split(S),i=j.length;for(l=0;i>l;l++){k=j[l],this.content.addEventListener(k,g,!1)}}}),Kinetic.Util.extend(Kinetic.Stage,Kinetic.Container),Kinetic.Factory.addGetter(Kinetic.Stage,"container"),Kinetic.Factory.addOverloadedGetterSetter(Kinetic.Stage,"container")}(),function(){var g="#",f="beforeDraw",j="draw",i=[{x:0,y:0},{x:-1,y:0},{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1},{x:1,y:0},{x:1,y:1},{x:0,y:1},{x:-1,y:1}],h=i.length;Kinetic.Util.addMethods(Kinetic.Layer,{___init:function(b){this.nodeType="Layer",this.canvas=new Kinetic.SceneCanvas,this.hitCanvas=new Kinetic.HitCanvas,Kinetic.Container.call(this,b)},_validateAdd:function(d){var c=d.getType();"Group"!==c&&"Shape"!==c&&Kinetic.Util.error("You may only add groups and shapes to a layer.")},getIntersection:function(e){var d,m,l,k;if(!this.isVisible()){return null}for(m=0;h>m;m++){if(l=i[m],d=this._getIntersection({x:e.x+l.x,y:e.y+l.y}),k=d.shape){return k}if(!d.antialiased){return null}}},_getIntersection:function(a){var n,m,l=this.hitCanvas.context._context.getImageData(a.x,a.y,1,1).data,k=l[3];return 255===k?(n=Kinetic.Util._rgbToHex(l[0],l[1],l[2]),m=Kinetic.shapes[g+n],{shape:m}):k>0?{antialiased:!0}:{}},drawScene:function(b){var k=this.getLayer(),c=b||k&&k.getCanvas();return this._fire(f,{node:this}),this.getClearBeforeDraw()&&c.getContext().clear(),Kinetic.Container.prototype.drawScene.call(this,c),this._fire(j,{node:this}),this},drawHit:function(e){var d=this.getLayer(),k=e||d&&d.hitCanvas;return d&&d.getClearBeforeDraw()&&d.getHitCanvas().getContext().clear(),Kinetic.Container.prototype.drawHit.call(this,k),this},getCanvas:function(){return this.canvas},getHitCanvas:function(){return this.hitCanvas},getContext:function(){return this.getCanvas().getContext()},clear:function(e){var d=this.getContext(),k=this.getHitCanvas().getContext();return d.clear(e),k.clear(e),this},setVisible:function(b){return Kinetic.Node.prototype.setVisible.call(this,b),b?(this.getCanvas()._canvas.style.display="block",this.hitCanvas._canvas.style.display="block"):(this.getCanvas()._canvas.style.display="none",this.hitCanvas._canvas.style.display="none"),this},setZIndex:function(d){Kinetic.Node.prototype.setZIndex.call(this,d);var c=this.getStage();return c&&(c.content.removeChild(this.getCanvas()._canvas),d<c.getChildren().length-1?c.content.insertBefore(this.getCanvas()._canvas,c.getChildren()[d+1].getCanvas()._canvas):c.content.appendChild(this.getCanvas()._canvas)),this},moveToTop:function(){Kinetic.Node.prototype.moveToTop.call(this);var b=this.getStage();b&&(b.content.removeChild(this.getCanvas()._canvas),b.content.appendChild(this.getCanvas()._canvas))},moveUp:function(){if(Kinetic.Node.prototype.moveUp.call(this)){var b=this.getStage();b&&(b.content.removeChild(this.getCanvas()._canvas),this.index<b.getChildren().length-1?b.content.insertBefore(this.getCanvas()._canvas,b.getChildren()[this.index+1].getCanvas()._canvas):b.content.appendChild(this.getCanvas()._canvas))}},moveDown:function(){if(Kinetic.Node.prototype.moveDown.call(this)){var d=this.getStage();if(d){var c=d.getChildren();d.content.removeChild(this.getCanvas()._canvas),d.content.insertBefore(this.getCanvas()._canvas,c[this.index+1].getCanvas()._canvas)}}},moveToBottom:function(){if(Kinetic.Node.prototype.moveToBottom.call(this)){var d=this.getStage();if(d){var c=d.getChildren();d.content.removeChild(this.getCanvas()._canvas),d.content.insertBefore(this.getCanvas()._canvas,c[1].getCanvas()._canvas)}}},getLayer:function(){return this},remove:function(){var e=this.getStage(),d=this.getCanvas(),k=d._canvas;return Kinetic.Node.prototype.remove.call(this),e&&k&&Kinetic.Util._isInDocument(k)&&e.content.removeChild(k),this},getStage:function(){return this.parent},enableHitGraph:function(){return this.setHitGraphEnabled(!0),this},disableHitGraph:function(){return this.setHitGraphEnabled(!1),this}}),Kinetic.Util.extend(Kinetic.Layer,Kinetic.Container),Kinetic.Factory.addGetterSetter(Kinetic.Layer,"clearBeforeDraw",!0),Kinetic.Factory.addGetterSetter(Kinetic.Layer,"hitGraphEnabled",!0),Kinetic.Collection.mapMethods(Kinetic.Layer)}(),function(){Kinetic.Util.addMethods(Kinetic.Group,{___init:function(b){this.nodeType="Group",Kinetic.Container.call(this,b)},_validateAdd:function(d){var c=d.getType();"Group"!==c&&"Shape"!==c&&Kinetic.Util.error("You may only add groups and shapes to groups.")}}),Kinetic.Util.extend(Kinetic.Group,Kinetic.Container),Kinetic.Collection.mapMethods(Kinetic.Group)}(),function(){Kinetic.Rect=function(b){this.___init(b)},Kinetic.Rect.prototype={___init:function(b){Kinetic.Shape.call(this,b),this.className="Rect",this.sceneFunc(this._sceneFunc)},_sceneFunc:function(f){var e=this.getCornerRadius(),h=this.getWidth(),g=this.getHeight();f.beginPath(),e?(f.moveTo(e,0),f.lineTo(h-e,0),f.arc(h-e,e,e,3*Math.PI/2,0,!1),f.lineTo(h,g-e),f.arc(h-e,g-e,e,0,Math.PI/2,!1),f.lineTo(e,g),f.arc(e,g-e,e,Math.PI/2,Math.PI,!1),f.lineTo(0,e),f.arc(e,e,e,Math.PI,3*Math.PI/2,!1)):f.rect(0,0,h,g),f.closePath(),f.fillStrokeShape(this)}},Kinetic.Util.extend(Kinetic.Rect,Kinetic.Shape),Kinetic.Factory.addGetterSetter(Kinetic.Rect,"cornerRadius",0),Kinetic.Collection.mapMethods(Kinetic.Rect)}(),function(){var d=2*Math.PI-0.0001,c="Circle";Kinetic.Circle=function(b){this.___init(b)},Kinetic.Circle.prototype={___init:function(b){Kinetic.Shape.call(this,b),this.className=c,this.sceneFunc(this._sceneFunc)},_sceneFunc:function(a){a.beginPath(),a.arc(0,0,this.getRadius(),0,d,!1),a.closePath(),a.fillStrokeShape(this)},getWidth:function(){return 2*this.getRadius()},getHeight:function(){return 2*this.getRadius()},setWidth:function(b){Kinetic.Node.prototype.setWidth.call(this,b),this.setRadius(b/2)},setHeight:function(b){Kinetic.Node.prototype.setHeight.call(this,b),this.setRadius(b/2)}},Kinetic.Util.extend(Kinetic.Circle,Kinetic.Shape),Kinetic.Factory.addGetterSetter(Kinetic.Circle,"radius",0),Kinetic.Collection.mapMethods(Kinetic.Circle)}(),function(){var d=2*Math.PI-0.0001,c="Ellipse";Kinetic.Ellipse=function(b){this.___init(b)},Kinetic.Ellipse.prototype={___init:function(b){Kinetic.Shape.call(this,b),this.className=c,this.sceneFunc(this._sceneFunc)},_sceneFunc:function(a){var h=this.getRadius(),g=h.x,f=h.y;a.beginPath(),a.save(),g!==f&&a.scale(1,f/g),a.arc(0,0,g,0,d,!1),a.restore(),a.closePath(),a.fillStrokeShape(this)},getWidth:function(){return 2*this.getRadius().x},getHeight:function(){return 2*this.getRadius().y},setWidth:function(b){Kinetic.Node.prototype.setWidth.call(this,b),this.setRadius({x:b/2})},setHeight:function(b){Kinetic.Node.prototype.setHeight.call(this,b),this.setRadius({y:b/2})}},Kinetic.Util.extend(Kinetic.Ellipse,Kinetic.Shape),Kinetic.Factory.addComponentsGetterSetter(Kinetic.Ellipse,"radius",["x","y"]),Kinetic.Factory.addGetterSetter(Kinetic.Ellipse,"radiusX",0),Kinetic.Factory.addGetterSetter(Kinetic.Ellipse,"radiusY",0),Kinetic.Collection.mapMethods(Kinetic.Ellipse)}(),function(){var b=2*Math.PI-0.0001;Kinetic.Ring=function(c){this.___init(c)},Kinetic.Ring.prototype={___init:function(c){Kinetic.Shape.call(this,c),this.className="Ring",this.sceneFunc(this._sceneFunc)},_sceneFunc:function(a){a.beginPath(),a.arc(0,0,this.getInnerRadius(),0,b,!1),a.moveTo(this.getOuterRadius(),0),a.arc(0,0,this.getOuterRadius(),b,0,!0),a.closePath(),a.fillStrokeShape(this)},getWidth:function(){return 2*this.getOuterRadius()},getHeight:function(){return 2*this.getOuterRadius()},setWidth:function(c){Kinetic.Node.prototype.setWidth.call(this,c),this.setOuterRadius(c/2)},setHeight:function(c){Kinetic.Node.prototype.setHeight.call(this,c),this.setOuterRadius(c/2)}},Kinetic.Util.extend(Kinetic.Ring,Kinetic.Shape),Kinetic.Factory.addGetterSetter(Kinetic.Ring,"innerRadius",0),Kinetic.Factory.addGetterSetter(Kinetic.Ring,"outerRadius",0),Kinetic.Collection.mapMethods(Kinetic.Ring)}(),function(){Kinetic.Wedge=function(b){this.___init(b)},Kinetic.Wedge.prototype={___init:function(b){Kinetic.Shape.call(this,b),this.className="Wedge",this.sceneFunc(this._sceneFunc)},_sceneFunc:function(b){b.beginPath(),b.arc(0,0,this.getRadius(),0,this.getAngle()*Math.PI/180,this.getClockwise()),b.lineTo(0,0),b.closePath(),b.fillStrokeShape(this)}},Kinetic.Util.extend(Kinetic.Wedge,Kinetic.Shape),Kinetic.Factory.addGetterSetter(Kinetic.Wedge,"radius",0),Kinetic.Factory.addGetterSetter(Kinetic.Wedge,"angle",0),Kinetic.Factory.addGetterSetter(Kinetic.Wedge,"clockwise",!1),Kinetic.Factory.backCompat(Kinetic.Wedge,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),Kinetic.Collection.mapMethods(Kinetic.Wedge)}(),function(){Kinetic.Arc=function(b){this.___init(b)},Kinetic.Arc.prototype={___init:function(b){Kinetic.Shape.call(this,b),this.className="Arc",this.sceneFunc(this._sceneFunc)},_sceneFunc:function(e){var d=this.angle()*Math.PI/180,f=this.clockwise();e.beginPath(),e.arc(0,0,this.getOuterRadius(),0,d,f),e.arc(0,0,this.getInnerRadius(),d,0,!f),e.closePath(),e.fillStrokeShape(this)}},Kinetic.Util.extend(Kinetic.Arc,Kinetic.Shape),Kinetic.Factory.addGetterSetter(Kinetic.Arc,"innerRadius",0),Kinetic.Factory.addGetterSetter(Kinetic.Arc,"outerRadius",0),Kinetic.Factory.addGetterSetter(Kinetic.Arc,"angle",0),Kinetic.Factory.addGetterSetter(Kinetic.Arc,"clockwise",!1),Kinetic.Collection.mapMethods(Kinetic.Arc)}(),function(){var b="Image";Kinetic.Image=function(c){this.___init(c)},Kinetic.Image.prototype={___init:function(a){Kinetic.Shape.call(this,a),this.className=b,this.sceneFunc(this._sceneFunc),this.hitFunc(this._hitFunc)},_useBufferCanvas:function(){return(this.hasShadow()||1!==this.getAbsoluteOpacity())&&this.hasStroke()},_sceneFunc:function(j){var i,p,o,n,m=this.getWidth(),l=this.getHeight(),k=this.getImage();k&&(i=this.getCrop(),p=i.width,o=i.height,n=p&&o?[k,i.x,i.y,p,o,0,0,m,l]:[k,0,0,m,l]),j.beginPath(),j.rect(0,0,m,l),j.closePath(),j.fillStrokeShape(this),k&&j.drawImage.apply(j,n)},_hitFunc:function(e){var d=this.getWidth(),f=this.getHeight();e.beginPath(),e.rect(0,0,d,f),e.closePath(),e.fillStrokeShape(this)},getWidth:function(){var c=this.getImage();return this.attrs.width||(c?c.width:0)},getHeight:function(){var c=this.getImage();return this.attrs.height||(c?c.height:0)}},Kinetic.Util.extend(Kinetic.Image,Kinetic.Shape),Kinetic.Factory.addGetterSetter(Kinetic.Image,"image"),Kinetic.Factory.addComponentsGetterSetter(Kinetic.Image,"crop",["x","y","width","height"]),Kinetic.Factory.addGetterSetter(Kinetic.Image,"cropX",0),Kinetic.Factory.addGetterSetter(Kinetic.Image,"cropY",0),Kinetic.Factory.addGetterSetter(Kinetic.Image,"cropWidth",0),Kinetic.Factory.addGetterSetter(Kinetic.Image,"cropHeight",0),Kinetic.Collection.mapMethods(Kinetic.Image)}(),function(){function T(b){b.fillText(this.partialText,0,0)}function S(b){b.strokeText(this.partialText,0,0)}var R="auto",Q="canvas",P="center",O="Change.kinetic",N="2d",M="-",L="",K="left",J="text",I="Text",H="middle",G="normal",F="px ",E=" ",D="right",C="word",B="char",A="none",z=["fontFamily","fontSize","fontStyle","padding","align","lineHeight","text","width","height","wrap"],y=z.length,x=document.createElement(Q).getContext(N);Kinetic.Text=function(b){this.___init(b)},Kinetic.Text.prototype={___init:function(c){var b=this;void 0===c.width&&(c.width=R),void 0===c.height&&(c.height=R),Kinetic.Shape.call(this,c),this._fillFunc=T,this._strokeFunc=S,this.className=I;for(var a=0;y>a;a++){this.on(z[a]+O,b._setTextData)}this._setTextData(),this.sceneFunc(this._sceneFunc),this.hitFunc(this._hitFunc)},_sceneFunc:function(w){var v,u=this.getPadding(),s=this.getTextHeight(),r=this.getLineHeight()*s,q=this.textArr,p=q.length,o=this.getWidth();for(w.setAttr("font",this._getContextFont()),w.setAttr("textBaseline",H),w.setAttr("textAlign",K),w.save(),w.translate(u,0),w.translate(0,u+s/2),v=0;p>v;v++){var m=q[v],j=m.text,e=m.width;w.save(),this.getAlign()===D?w.translate(o-e-2*u,0):this.getAlign()===P&&w.translate((o-e-2*u)/2,0),this.partialText=j,w.fillStrokeShape(this),w.restore(),w.translate(0,r)}w.restore()},_hitFunc:function(e){var d=this.getWidth(),f=this.getHeight();e.beginPath(),e.rect(0,0,d,f),e.closePath(),e.fillStrokeShape(this)},setText:function(d){var c=Kinetic.Util._isString(d)?d:d.toString();return this._setAttr(J,c),this},getWidth:function(){return this.attrs.width===R?this.getTextWidth()+2*this.getPadding():this.attrs.width},getHeight:function(){return this.attrs.height===R?this.getTextHeight()*this.textArr.length*this.getLineHeight()+2*this.getPadding():this.attrs.height},getTextWidth:function(){return this.textWidth},getTextHeight:function(){return this.textHeight},_getTextSize:function(f){var e,h=x,g=this.getFontSize();return h.save(),h.font=this._getContextFont(),e=h.measureText(f),h.restore(),{width:e.width,height:parseInt(g,10)}},_getContextFont:function(){return this.getFontStyle()+E+this.getFontSize()+F+this.getFontFamily()},_addTextLine:function(d,c){return this.textArr.push({text:d,width:c})},_getTextWidth:function(b){return x.measureText(b).width},_setTextData:function(){var ao=this.getText().split("\n"),an=+this.getFontSize(),am=0,al=this.getLineHeight()*an,ak=this.attrs.width,aj=this.attrs.height,ai=ak!==R,ah=aj!==R,ag=this.getPadding(),af=ak-2*ag,ae=aj-2*ag,ad=0,ab=this.getWrap(),Z=ab!==A,V=ab!==B&&Z;this.textArr=[],x.save(),x.font=this.getFontStyle()+E+an+F+this.getFontFamily();for(var w=0,o=ao.length;o>w;++w){var h=ao[w],c=this._getTextWidth(h);if(ai&&c>af){for(;h.length>0;){for(var ac=0,aa=h.length,Y="",X=0;aa>ac;){var W=ac+aa>>>1,U=h.slice(0,W+1),s=this._getTextWidth(U);af>=s?(ac=W+1,Y=U,X=s):aa=W}if(!Y){break}if(V){var p=Math.max(Y.lastIndexOf(E),Y.lastIndexOf(M))+1;p>0&&(ac=p,Y=Y.slice(0,ac),X=this._getTextWidth(Y))}if(this._addTextLine(Y,X),ad+=al,!Z||ah&&ad+al>ae){break}if(h=h.slice(ac),h.length>0&&(c=this._getTextWidth(h),af>=c)){this._addTextLine(h,c),ad+=al;break}}}else{this._addTextLine(h,c),ad+=al,am=Math.max(am,c)}if(ah&&ad+al>ae){break}}x.restore(),this.textHeight=an,this.textWidth=am}},Kinetic.Util.extend(Kinetic.Text,Kinetic.Shape),Kinetic.Factory.addGetterSetter(Kinetic.Text,"fontFamily","Arial"),Kinetic.Factory.addGetterSetter(Kinetic.Text,"fontSize",12),Kinetic.Factory.addGetterSetter(Kinetic.Text,"fontStyle",G),Kinetic.Factory.addGetterSetter(Kinetic.Text,"padding",0),Kinetic.Factory.addGetterSetter(Kinetic.Text,"align",K),Kinetic.Factory.addGetterSetter(Kinetic.Text,"lineHeight",1),Kinetic.Factory.addGetterSetter(Kinetic.Text,"wrap",C),Kinetic.Factory.addGetter(Kinetic.Text,"text",L),Kinetic.Factory.addOverloadedGetterSetter(Kinetic.Text,"text"),Kinetic.Collection.mapMethods(Kinetic.Text)}(),function(){Kinetic.Line=function(b){this.___init(b)},Kinetic.Line.prototype={___init:function(b){Kinetic.Shape.call(this,b),this.className="Line",this.on("pointsChange.kinetic tensionChange.kinetic closedChange.kinetic",function(){this._clearCache("tensionPoints")}),this.sceneFunc(this._sceneFunc)},_sceneFunc:function(j){var i,p,o,n=this.getPoints(),m=n.length,l=this.getTension(),k=this.getClosed();if(j.beginPath(),j.moveTo(n[0],n[1]),0!==l&&m>4){for(i=this.getTensionPoints(),p=i.length,o=k?0:4,k||j.quadraticCurveTo(i[0],i[1],i[2],i[3]);p-2>o;){j.bezierCurveTo(i[o++],i[o++],i[o++],i[o++],i[o++],i[o++])}k||j.quadraticCurveTo(i[p-2],i[p-1],n[m-2],n[m-1])}else{for(o=2;m>o;o+=2){j.lineTo(n[o],n[o+1])}}k?(j.closePath(),j.fillStrokeShape(this)):j.strokeShape(this)},getTensionPoints:function(){return this._getCache("tensionPoints",this._getTensionPoints)},_getTensionPoints:function(){return this.getClosed()?this._getTensionPointsClosed():Kinetic.Util._expandPoints(this.getPoints(),this.getTension())},_getTensionPointsClosed:function(){var j=this.getPoints(),i=j.length,p=this.getTension(),o=Kinetic.Util,n=o._getControlPoints(j[i-2],j[i-1],j[0],j[1],j[2],j[3],p),m=o._getControlPoints(j[i-4],j[i-3],j[i-2],j[i-1],j[0],j[1],p),l=Kinetic.Util._expandPoints(j,p),k=[n[2],n[3]].concat(l).concat([m[0],m[1],j[i-2],j[i-1],m[2],m[3],n[0],n[1],j[0],j[1]]);return k}},Kinetic.Util.extend(Kinetic.Line,Kinetic.Shape),Kinetic.Factory.addGetterSetter(Kinetic.Line,"closed",!1),Kinetic.Factory.addGetterSetter(Kinetic.Line,"tension",0),Kinetic.Factory.addGetterSetter(Kinetic.Line,"points"),Kinetic.Collection.mapMethods(Kinetic.Line)}(),function(){Kinetic.Sprite=function(b){this.___init(b)},Kinetic.Sprite.prototype={___init:function(b){Kinetic.Shape.call(this,b),this.className="Sprite",this.anim=new Kinetic.Animation,this.on("animationChange.kinetic",function(){this.frameIndex(0)}),this.sceneFunc(this._sceneFunc),this.hitFunc(this._hitFunc)},_sceneFunc:function(u){var s=this.getAnimation(),r=this.frameIndex(),q=4*r,p=this.getAnimations()[s],o=p[q+0],n=p[q+1],m=p[q+2],l=p[q+3],k=this.getImage();k&&u.drawImage(k,o,n,m,l,0,0,m,l)},_hitFunc:function(i){var h=this.getAnimation(),n=this.frameIndex(),m=4*n,l=this.getAnimations()[h],k=l[m+2],j=l[m+3];i.beginPath(),i.rect(0,0,k,j),i.closePath(),i.fillShape(this)},_useBufferCanvas:function(){return(this.hasShadow()||1!==this.getAbsoluteOpacity())&&this.hasStroke()},start:function(){var d=this,c=this.getLayer();this.anim.setLayers(c),this.interval=setInterval(function(){d._updateIndex()},1000/this.getFrameRate()),this.anim.start()},stop:function(){this.anim.stop(),clearInterval(this.interval)},_updateIndex:function(){var g=this.frameIndex(),f=this.getAnimation(),j=this.getAnimations(),i=j[f],h=i.length/4;h-1>g?this.frameIndex(g+1):this.frameIndex(0)}},Kinetic.Util.extend(Kinetic.Sprite,Kinetic.Shape),Kinetic.Factory.addGetterSetter(Kinetic.Sprite,"animation"),Kinetic.Factory.addGetterSetter(Kinetic.Sprite,"animations"),Kinetic.Factory.addGetterSetter(Kinetic.Sprite,"image"),Kinetic.Factory.addGetterSetter(Kinetic.Sprite,"frameIndex",0),Kinetic.Factory.addGetterSetter(Kinetic.Sprite,"frameRate",17),Kinetic.Factory.backCompat(Kinetic.Sprite,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),Kinetic.Collection.mapMethods(Kinetic.Sprite)}(),function(){Kinetic.Path=function(b){this.___init(b)},Kinetic.Path.prototype={___init:function(d){this.dataArray=[];var c=this;Kinetic.Shape.call(this,d),this.className="Path",this.dataArray=Kinetic.Path.parsePathData(this.getData()),this.on("dataChange.kinetic",function(){c.dataArray=Kinetic.Path.parsePathData(this.getData())}),this.sceneFunc(this._sceneFunc)},_sceneFunc:function(I){var H=this.dataArray,G=!1;I.beginPath();for(var F=0;F<H.length;F++){var E=H[F].command,D=H[F].points;switch(E){case"L":I.lineTo(D[0],D[1]);break;case"M":I.moveTo(D[0],D[1]);break;case"C":I.bezierCurveTo(D[0],D[1],D[2],D[3],D[4],D[5]);break;case"Q":I.quadraticCurveTo(D[0],D[1],D[2],D[3]);break;case"A":var C=D[0],B=D[1],A=D[2],z=D[3],y=D[4],x=D[5],w=D[6],v=D[7],u=A>z?A:z,s=A>z?1:A/z,r=A>z?z/A:1;I.translate(C,B),I.rotate(w),I.scale(s,r),I.arc(0,0,u,y,y+x,1-v),I.scale(1/s,1/r),I.rotate(-w),I.translate(-C,-B);break;case"z":I.closePath(),G=!0}}G?I.fillStrokeShape(this):I.strokeShape(this)}},Kinetic.Util.extend(Kinetic.Path,Kinetic.Shape),Kinetic.Path.getLineLength=function(f,e,h,g){return Math.sqrt((h-f)*(h-f)+(g-e)*(g-e))},Kinetic.Path.getPointOnLine=function(I,H,G,F,E,D,C){void 0===D&&(D=H),void 0===C&&(C=G);var B=(E-G)/(F-H+1e-8),A=Math.sqrt(I*I/(1+B*B));H>F&&(A*=-1);var z,y=B*A;if(F===H){z={x:D,y:C+y}}else{if((C-G)/(D-H+1e-8)===B){z={x:D+A,y:C+y}}else{var x,w,v=this.getLineLength(H,G,F,E);if(1e-8>v){return void 0}var u=(D-H)*(F-H)+(C-G)*(E-G);u/=v*v,x=H+u*(F-H),w=G+u*(E-G);var s=this.getLineLength(D,C,x,w),r=Math.sqrt(I*I-s*s);A=Math.sqrt(r*r/(1+B*B)),H>F&&(A*=-1),y=B*A,z={x:x+A,y:w+y}}}return z},Kinetic.Path.getPointOnCubicBezier=function(E,D,C,B,A,z,y,x,w){function v(b){return b*b*b}function u(b){return 3*b*b*(1-b)}function s(b){return 3*b*(1-b)*(1-b)}function r(b){return(1-b)*(1-b)*(1-b)}var q=x*v(E)+z*u(E)+B*s(E)+D*r(E),p=w*v(E)+y*u(E)+A*s(E)+C*r(E);return{x:q,y:p}},Kinetic.Path.getPointOnQuadraticBezier=function(y,x,w,v,u,s,r){function q(b){return b*b}function p(b){return 2*b*(1-b)}function o(b){return(1-b)*(1-b)}var n=s*q(y)+v*p(y)+x*o(y),m=r*q(y)+u*p(y)+w*o(y);return{x:n,y:m}},Kinetic.Path.getPointOnEllipticalArc=function(r,q,p,o,n,m){var l=Math.cos(m),k=Math.sin(m),j={x:p*Math.cos(n),y:o*Math.sin(n)};return{x:r+(j.x*l-j.y*k),y:q+(j.x*k+j.y*l)}},Kinetic.Path.parsePathData=function(af){if(!af){return[]}var ae=af,ad=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];ae=ae.replace(new RegExp(" ","g"),",");for(var ac=0;ac<ad.length;ac++){ae=ae.replace(new RegExp(ad[ac],"g"),"|"+ad[ac])}var ab=ae.split("|"),aa=[],Z=0,Y=0;for(ac=1;ac<ab.length;ac++){var X=ab[ac],W=X.charAt(0);X=X.slice(1),X=X.replace(new RegExp(",-","g"),"-"),X=X.replace(new RegExp("-","g"),",-"),X=X.replace(new RegExp("e,-","g"),"e-");var V=X.split(",");V.length>0&&""===V[0]&&V.shift();for(var U=0;U<V.length;U++){V[U]=parseFloat(V[U])}for(;V.length>0&&!isNaN(V[0]);){var T,S,R,Q,O,M,K,J,I,H,G=null,F=[],E=Z,D=Y;switch(W){case"l":Z+=V.shift(),Y+=V.shift(),G="L",F.push(Z,Y);break;case"L":Z=V.shift(),Y=V.shift(),F.push(Z,Y);break;case"m":var P=V.shift(),N=V.shift();if(Z+=P,Y+=N,G="M",aa.length>2&&"z"===aa[aa.length-1].command){for(var L=aa.length-2;L>=0;L--){if("M"===aa[L].command){Z=aa[L].points[0]+P,Y=aa[L].points[1]+N;break}}}F.push(Z,Y),W="l";break;case"M":Z=V.shift(),Y=V.shift(),G="M",F.push(Z,Y),W="L";break;case"h":Z+=V.shift(),G="L",F.push(Z,Y);break;case"H":Z=V.shift(),G="L",F.push(Z,Y);break;case"v":Y+=V.shift(),G="L",F.push(Z,Y);break;case"V":Y=V.shift(),G="L",F.push(Z,Y);break;case"C":F.push(V.shift(),V.shift(),V.shift(),V.shift()),Z=V.shift(),Y=V.shift(),F.push(Z,Y);break;case"c":F.push(Z+V.shift(),Y+V.shift(),Z+V.shift(),Y+V.shift()),Z+=V.shift(),Y+=V.shift(),G="C",F.push(Z,Y);break;case"S":S=Z,R=Y,T=aa[aa.length-1],"C"===T.command&&(S=Z+(Z-T.points[2]),R=Y+(Y-T.points[3])),F.push(S,R,V.shift(),V.shift()),Z=V.shift(),Y=V.shift(),G="C",F.push(Z,Y);break;case"s":S=Z,R=Y,T=aa[aa.length-1],"C"===T.command&&(S=Z+(Z-T.points[2]),R=Y+(Y-T.points[3])),F.push(S,R,Z+V.shift(),Y+V.shift()),Z+=V.shift(),Y+=V.shift(),G="C",F.push(Z,Y);break;case"Q":F.push(V.shift(),V.shift()),Z=V.shift(),Y=V.shift(),F.push(Z,Y);break;case"q":F.push(Z+V.shift(),Y+V.shift()),Z+=V.shift(),Y+=V.shift(),G="Q",F.push(Z,Y);break;case"T":S=Z,R=Y,T=aa[aa.length-1],"Q"===T.command&&(S=Z+(Z-T.points[0]),R=Y+(Y-T.points[1])),Z=V.shift(),Y=V.shift(),G="Q",F.push(S,R,Z,Y);break;case"t":S=Z,R=Y,T=aa[aa.length-1],"Q"===T.command&&(S=Z+(Z-T.points[0]),R=Y+(Y-T.points[1])),Z+=V.shift(),Y+=V.shift(),G="Q",F.push(S,R,Z,Y);break;case"A":Q=V.shift(),O=V.shift(),M=V.shift(),K=V.shift(),J=V.shift(),I=Z,H=Y,Z=V.shift(),Y=V.shift(),G="A",F=this.convertEndpointToCenterParameterization(I,H,Z,Y,K,J,Q,O,M);break;case"a":Q=V.shift(),O=V.shift(),M=V.shift(),K=V.shift(),J=V.shift(),I=Z,H=Y,Z+=V.shift(),Y+=V.shift(),G="A",F=this.convertEndpointToCenterParameterization(I,H,Z,Y,K,J,Q,O,M)}aa.push({command:G||W,points:F,start:{x:E,y:D},pathLength:this.calcLength(E,D,G||W,F)})}("z"===W||"Z"===W)&&aa.push({command:"z",points:[],start:void 0,pathLength:0})}return aa},Kinetic.Path.calcLength=function(y,x,w,v){var u,s,r,q=Kinetic.Path;switch(w){case"L":return q.getLineLength(y,x,v[0],v[1]);case"C":for(u=0,s=q.getPointOnCubicBezier(0,y,x,v[0],v[1],v[2],v[3],v[4],v[5]),t=0.01;1>=t;t+=0.01){r=q.getPointOnCubicBezier(t,y,x,v[0],v[1],v[2],v[3],v[4],v[5]),u+=q.getLineLength(s.x,s.y,r.x,r.y),s=r}return u;case"Q":for(u=0,s=q.getPointOnQuadraticBezier(0,y,x,v[0],v[1],v[2],v[3]),t=0.01;1>=t;t+=0.01){r=q.getPointOnQuadraticBezier(t,y,x,v[0],v[1],v[2],v[3]),u+=q.getLineLength(s.x,s.y,r.x,r.y),s=r}return u;case"A":u=0;var p=v[4],o=v[5],n=v[4]+o,m=Math.PI/180;if(Math.abs(p-n)<m&&(m=Math.abs(p-n)),s=q.getPointOnEllipticalArc(v[0],v[1],v[2],v[3],p,0),0>o){for(t=p-m;t>n;t-=m){r=q.getPointOnEllipticalArc(v[0],v[1],v[2],v[3],t,0),u+=q.getLineLength(s.x,s.y,r.x,r.y),s=r}}else{for(t=p+m;n>t;t+=m){r=q.getPointOnEllipticalArc(v[0],v[1],v[2],v[3],t,0),u+=q.getLineLength(s.x,s.y,r.x,r.y),s=r}}return r=q.getPointOnEllipticalArc(v[0],v[1],v[2],v[3],n,0),u+=q.getLineLength(s.x,s.y,r.x,r.y)}return 0},Kinetic.Path.convertEndpointToCenterParameterization=function(X,W,V,U,T,S,R,Q,P){var O=P*(Math.PI/180),N=Math.cos(O)*(X-V)/2+Math.sin(O)*(W-U)/2,M=-1*Math.sin(O)*(X-V)/2+Math.cos(O)*(W-U)/2,L=N*N/(R*R)+M*M/(Q*Q);L>1&&(R*=Math.sqrt(L),Q*=Math.sqrt(L));var K=Math.sqrt((R*R*Q*Q-R*R*M*M-Q*Q*N*N)/(R*R*M*M+Q*Q*N*N));T==S&&(K*=-1),isNaN(K)&&(K=0);var J=K*R*M/Q,I=K*-Q*N/R,H=(X+V)/2+Math.cos(O)*J-Math.sin(O)*I,G=(W+U)/2+Math.sin(O)*J+Math.cos(O)*I,F=function(b){return Math.sqrt(b[0]*b[0]+b[1]*b[1])},E=function(d,c){return(d[0]*c[0]+d[1]*c[1])/(F(d)*F(c))},D=function(d,c){return(d[0]*c[1]<d[1]*c[0]?-1:1)*Math.acos(E(d,c))},C=D([1,0],[(N-J)/R,(M-I)/Q]),B=[(N-J)/R,(M-I)/Q],A=[(-1*N-J)/R,(-1*M-I)/Q],z=D(B,A);return E(B,A)<=-1&&(z=Math.PI),E(B,A)>=1&&(z=0),0===S&&z>0&&(z-=2*Math.PI),1==S&&0>z&&(z+=2*Math.PI),[H,G,R,Q,C,z,O,S]},Kinetic.Factory.addGetterSetter(Kinetic.Path,"data"),Kinetic.Collection.mapMethods(Kinetic.Path)}(),function(){function f(b){b.fillText(this.partialText,0,0)}function e(b){b.strokeText(this.partialText,0,0)}var h="",g="normal";Kinetic.TextPath=function(b){this.___init(b)},Kinetic.TextPath.prototype={___init:function(b){var a=this;this.dummyCanvas=document.createElement("canvas"),this.dataArray=[],Kinetic.Shape.call(this,b),this._fillFunc=f,this._strokeFunc=e,this._fillFuncHit=f,this._strokeFuncHit=e,this.className="TextPath",this.dataArray=Kinetic.Path.parsePathData(this.attrs.data),this.on("dataChange.kinetic",function(){a.dataArray=Kinetic.Path.parsePathData(this.attrs.data)}),this.on("textChange.kinetic textStroke.kinetic textStrokeWidth.kinetic",a._setTextData),a._setTextData(),this.sceneFunc(this._sceneFunc)},_sceneFunc:function(j){j.setAttr("font",this._getContextFont()),j.setAttr("textBaseline","middle"),j.setAttr("textAlign","left"),j.save();for(var i=this.glyphInfo,l=0;l<i.length;l++){j.save();var k=i[l].p0;j.translate(k.x,k.y),j.rotate(i[l].rotation),this.partialText=i[l].text,j.fillStrokeShape(this),j.restore()}j.restore()},getTextWidth:function(){return this.textWidth},getTextHeight:function(){return this.textHeight},setText:function(b){Kinetic.Text.prototype.setText.call(this,b)},_getTextSize:function(j){var i=this.dummyCanvas,l=i.getContext("2d");l.save(),l.font=this._getContextFont();var k=l.measureText(j);return l.restore(),{width:k.width,height:parseInt(this.attrs.fontSize,10)}},_setTextData:function(){var E=this,D=this._getTextSize(this.attrs.text);this.textWidth=D.width,this.textHeight=D.height,this.glyphInfo=[];for(var C,B,A,z=this.attrs.text.split(""),y=-1,x=0,w=function(){x=0;for(var a=E.dataArray,c=y+1;c<a.length;c++){if(a[c].pathLength>0){return y=c,a[c]}"M"==a[c].command&&(C={x:a[c].points[0],y:a[c].points[1]})}return{}},v=function(J){var I=E._getTextSize(J).width,H=0,G=0;for(B=void 0;Math.abs(I-H)/I>0.01&&25>G;){G++;for(var F=H;void 0===A;){A=w(),A&&F+A.pathLength<I&&(F+=A.pathLength,A=void 0)}if(A==={}||void 0===C){return void 0}var i=!1;switch(A.command){case"L":Kinetic.Path.getLineLength(C.x,C.y,A.points[0],A.points[1])>I?B=Kinetic.Path.getPointOnLine(I,C.x,C.y,A.points[0],A.points[1],C.x,C.y):A=void 0;break;case"A":var d=A.points[4],c=A.points[5],a=A.points[4]+c;0===x?x=d+1e-8:I>H?x+=Math.PI/180*c/Math.abs(c):x-=Math.PI/360*c/Math.abs(c),(0>c&&a>x||c>=0&&x>a)&&(x=a,i=!0),B=Kinetic.Path.getPointOnEllipticalArc(A.points[0],A.points[1],A.points[2],A.points[3],x,A.points[6]);break;case"C":0===x?x=I>A.pathLength?1e-8:I/A.pathLength:I>H?x+=(I-H)/A.pathLength:x-=(H-I)/A.pathLength,x>1&&(x=1,i=!0),B=Kinetic.Path.getPointOnCubicBezier(x,A.start.x,A.start.y,A.points[0],A.points[1],A.points[2],A.points[3],A.points[4],A.points[5]);break;case"Q":0===x?x=I/A.pathLength:I>H?x+=(I-H)/A.pathLength:x-=(H-I)/A.pathLength,x>1&&(x=1,i=!0),B=Kinetic.Path.getPointOnQuadraticBezier(x,A.start.x,A.start.y,A.points[0],A.points[1],A.points[2],A.points[3])}void 0!==B&&(H=Kinetic.Path.getLineLength(C.x,C.y,B.x,B.y)),i&&(i=!1,A=void 0)}},u=0;u<z.length&&(v(z[u]),void 0!==C&&void 0!==B);u++){var s=Kinetic.Path.getLineLength(C.x,C.y,B.x,B.y),r=0,q=Kinetic.Path.getPointOnLine(r+s/2,C.x,C.y,B.x,B.y),p=Math.atan2(B.y-C.y,B.x-C.x);this.glyphInfo.push({transposeX:q.x,transposeY:q.y,text:z[u],rotation:p,p0:C,p1:B}),C=B}}},Kinetic.TextPath.prototype._getContextFont=Kinetic.Text.prototype._getContextFont,Kinetic.Util.extend(Kinetic.TextPath,Kinetic.Shape),Kinetic.Factory.addGetterSetter(Kinetic.TextPath,"fontFamily","Arial"),Kinetic.Factory.addGetterSetter(Kinetic.TextPath,"fontSize",12),Kinetic.Factory.addGetterSetter(Kinetic.TextPath,"fontStyle",g),Kinetic.Factory.addGetter(Kinetic.TextPath,"text",h),Kinetic.Collection.mapMethods(Kinetic.TextPath)}(),function(){Kinetic.RegularPolygon=function(b){this.___init(b)},Kinetic.RegularPolygon.prototype={___init:function(b){Kinetic.Shape.call(this,b),this.className="RegularPolygon",this.sceneFunc(this._sceneFunc)},_sceneFunc:function(h){var g,l,k,j=this.attrs.sides,i=this.attrs.radius;for(h.beginPath(),h.moveTo(0,0-i),g=1;j>g;g++){l=i*Math.sin(2*g*Math.PI/j),k=-1*i*Math.cos(2*g*Math.PI/j),h.lineTo(l,k)}h.closePath(),h.fillStrokeShape(this)}},Kinetic.Util.extend(Kinetic.RegularPolygon,Kinetic.Shape),Kinetic.Factory.addGetterSetter(Kinetic.RegularPolygon,"radius",0),Kinetic.Factory.addGetterSetter(Kinetic.RegularPolygon,"sides",0),Kinetic.Collection.mapMethods(Kinetic.RegularPolygon)}(),function(){Kinetic.Star=function(b){this.___init(b)},Kinetic.Star.prototype={___init:function(b){Kinetic.Shape.call(this,b),this.className="Star",this.sceneFunc(this._sceneFunc)},_sceneFunc:function(j){var i=this.innerRadius(),p=this.outerRadius(),o=this.numPoints();j.beginPath(),j.moveTo(0,0-p);for(var n=1;2*o>n;n++){var m=0===n%2?p:i,l=m*Math.sin(n*Math.PI/o),k=-1*m*Math.cos(n*Math.PI/o);j.lineTo(l,k)}j.closePath(),j.fillStrokeShape(this)}},Kinetic.Util.extend(Kinetic.Star,Kinetic.Shape),Kinetic.Factory.addGetterSetter(Kinetic.Star,"numPoints",5),Kinetic.Factory.addGetterSetter(Kinetic.Star,"innerRadius",0),Kinetic.Factory.addGetterSetter(Kinetic.Star,"outerRadius",0),Kinetic.Collection.mapMethods(Kinetic.Star)}(),function(){var r=["fontFamily","fontSize","fontStyle","padding","lineHeight","text"],q="Change.kinetic",p="none",o="up",n="right",m="down",l="left",k="Label",j=r.length;Kinetic.Label=function(b){this.____init(b)},Kinetic.Label.prototype={____init:function(d){var c=this;this.className=k,Kinetic.Group.call(this,d),this.on("add.kinetic",function(b){c._addListeners(b.child),c._sync()})},getText:function(){return this.find("Text")[0]},getTag:function(){return this.find("Tag")[0]},_addListeners:function(h){var g,b=this,a=function(){b._sync()};for(g=0;j>g;g++){h.on(r[g]+q,a)}},getWidth:function(){return this.getText().getWidth()},getHeight:function(){return this.getText().getHeight()},_sync:function(){var f,d,w,v,u,s,g=this.getText(),e=this.getTag();if(g&&e){switch(f=g.getWidth(),d=g.getHeight(),w=e.getPointerDirection(),v=e.getPointerWidth(),pointerHeight=e.getPointerHeight(),u=0,s=0,w){case o:u=f/2,s=-1*pointerHeight;break;case n:u=f+v,s=d/2;break;case m:u=f/2,s=d+pointerHeight;break;case l:u=-1*v,s=d/2}e.setAttrs({x:-1*u,y:-1*s,width:f,height:d}),g.setAttrs({x:-1*u,y:-1*s})}}},Kinetic.Util.extend(Kinetic.Label,Kinetic.Group),Kinetic.Collection.mapMethods(Kinetic.Label),Kinetic.Tag=function(b){this.___init(b)},Kinetic.Tag.prototype={___init:function(b){Kinetic.Shape.call(this,b),this.className="Tag",this.sceneFunc(this._sceneFunc)},_sceneFunc:function(e){var d=this.getWidth(),u=this.getHeight(),s=this.getPointerDirection(),g=this.getPointerWidth(),f=this.getPointerHeight();this.getCornerRadius(),e.beginPath(),e.moveTo(0,0),s===o&&(e.lineTo((d-g)/2,0),e.lineTo(d/2,-1*f),e.lineTo((d+g)/2,0)),e.lineTo(d,0),s===n&&(e.lineTo(d,(u-f)/2),e.lineTo(d+g,u/2),e.lineTo(d,(u+f)/2)),e.lineTo(d,u),s===m&&(e.lineTo((d+g)/2,u),e.lineTo(d/2,u+f),e.lineTo((d-g)/2,u)),e.lineTo(0,u),s===l&&(e.lineTo(0,(u+f)/2),e.lineTo(-1*g,u/2),e.lineTo(0,(u-f)/2)),e.closePath(),e.fillStrokeShape(this)}},Kinetic.Util.extend(Kinetic.Tag,Kinetic.Shape),Kinetic.Factory.addGetterSetter(Kinetic.Tag,"pointerDirection",p),Kinetic.Factory.addGetterSetter(Kinetic.Tag,"pointerWidth",0),Kinetic.Factory.addGetterSetter(Kinetic.Tag,"pointerHeight",0),Kinetic.Factory.addGetterSetter(Kinetic.Tag,"cornerRadius",0),Kinetic.Collection.mapMethods(Kinetic.Tag)}();var dat=dat||{};dat.gui=dat.gui||{};dat.utils=dat.utils||{};dat.controllers=dat.controllers||{};dat.dom=dat.dom||{};dat.color=dat.color||{};dat.utils.css=function(){return{load:function(f,d){d=d||document;var c=d.createElement("link");c.type="text/css";c.rel="stylesheet";c.href=f;d.getElementsByTagName("head")[0].appendChild(c)},inject:function(f,d){d=d||document;var c=document.createElement("style");c.type="text/css";c.innerHTML=f;d.getElementsByTagName("head")[0].appendChild(c)}}}();dat.utils.common=function(){var c=Array.prototype.forEach,b=Array.prototype.slice;return{BREAK:{},extend:function(a){this.each(b.call(arguments,1),function(d){for(var e in d){this.isUndefined(d[e])||(a[e]=d[e])}},this);return a},defaults:function(a){this.each(b.call(arguments,1),function(d){for(var e in d){this.isUndefined(a[e])&&(a[e]=d[e])}},this);return a},compose:function(){var a=b.call(arguments);return function(){for(var g=b.call(arguments),e=a.length-1;0<=e;e--){g=[a[e].apply(this,g)]}return g[0]}},each:function(e,i,g){if(c&&e.forEach===c){e.forEach(i,g)}else{if(e.length===e.length+0){for(var j=0,h=e.length;j<h&&!(j in e&&i.call(g,e[j],j)===this.BREAK);j++){}}else{for(j in e){if(i.call(g,e[j],j)===this.BREAK){break}}}}},defer:function(d){setTimeout(d,0)},toArray:function(a){return a.toArray?a.toArray():b.call(a)},isUndefined:function(d){return void 0===d},isNull:function(d){return null===d},isNaN:function(d){return d!==d},isArray:Array.isArray||function(d){return d.constructor===Array},isObject:function(d){return d===Object(d)},isNumber:function(d){return d===d+0},isString:function(d){return d===d+""},isBoolean:function(d){return !1===d||!0===d},isFunction:function(d){return"[object Function]"===Object.prototype.toString.call(d)}}}();dat.controllers.Controller=function(c){var b=function(e,f){this.initialValue=e[f];this.domElement=document.createElement("div");this.object=e;this.property=f;this.__onFinishChange=this.__onChange=void 0};c.extend(b.prototype,{onChange:function(d){this.__onChange=d;return this},onFinishChange:function(d){this.__onFinishChange=d;return this},setValue:function(d){this.object[this.property]=d;this.__onChange&&this.__onChange.call(this,d);this.updateDisplay();return this},getValue:function(){return this.object[this.property]},updateDisplay:function(){return this},isModified:function(){return this.initialValue!==this.getValue()}});return b}(dat.utils.common);dat.dom.dom=function(i){function g(a){if("0"===a||i.isUndefined(a)){return 0}a=a.match(j);return i.isNull(a)?0:parseFloat(a[1])}var c={};i.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(d,b){i.each(d,function(a){c[a]=b})});var j=/(\d+(\.\d+)?)px/,h={makeSelectable:function(d,b){void 0!==d&&void 0!==d.style&&(d.onselectstart=b?function(){return !1}:function(){},d.style.MozUserSelect=b?"auto":"none",d.style.KhtmlUserSelect=b?"auto":"none",d.unselectable=b?"on":"off")},makeFullscreen:function(f,b,e){i.isUndefined(b)&&(b=!0);i.isUndefined(e)&&(e=!0);f.style.position="absolute";b&&(f.style.left=0,f.style.right=0);e&&(f.style.top=0,f.style.bottom=0)},fakeEvent:function(o,b,l,k){l=l||{};var e=c[b];if(!e){throw Error("Event type "+b+" not supported.")}var m=document.createEvent(e);switch(e){case"MouseEvents":m.initMouseEvent(b,l.bubbles||!1,l.cancelable||!0,window,l.clickCount||1,0,0,l.x||l.clientX||0,l.y||l.clientY||0,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":e=m.initKeyboardEvent||m.initKeyEvent;i.defaults(l,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0});e(b,l.bubbles||!1,l.cancelable,window,l.ctrlKey,l.altKey,l.shiftKey,l.metaKey,l.keyCode,l.charCode);break;default:m.initEvent(b,l.bubbles||!1,l.cancelable||!0)}i.defaults(m,k);o.dispatchEvent(m)},bind:function(l,f,k,e){l.addEventListener?l.addEventListener(f,k,e||!1):l.attachEvent&&l.attachEvent("on"+f,k);return h},unbind:function(l,f,k,e){l.removeEventListener?l.removeEventListener(f,k,e||!1):l.detachEvent&&l.detachEvent("on"+f,k);return h},addClass:function(f,k){if(void 0===f.className){f.className=k}else{if(f.className!==k){var e=f.className.split(/ +/);-1==e.indexOf(k)&&(e.push(k),f.className=e.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}}return h},removeClass:function(k,m){if(m){if(void 0!==k.className){if(k.className===m){k.removeAttribute("class")}else{var f=k.className.split(/ +/),l=f.indexOf(m);-1!=l&&(f.splice(l,1),k.className=f.join(" "))}}}else{k.className=void 0}return h},hasClass:function(b,e){return RegExp("(?:^|\\s+)"+e+"(?:\\s+|$)").test(b.className)||!1},getWidth:function(a){a=getComputedStyle(a);return g(a["border-left-width"])+g(a["border-right-width"])+g(a["padding-left"])+g(a["padding-right"])+g(a.width)},getHeight:function(a){a=getComputedStyle(a);return g(a["border-top-width"])+g(a["border-bottom-width"])+g(a["padding-top"])+g(a["padding-bottom"])+g(a.height)},getOffset:function(b){var e={left:0,top:0};if(b.offsetParent){do{e.left+=b.offsetLeft,e.top+=b.offsetTop}while(b=b.offsetParent)}return e},isActive:function(b){return b===document.activeElement&&(b.type||b.href)}};return h}(dat.utils.common);dat.controllers.OptionController=function(g,f,c){var h=function(d,j,i){h.superclass.call(this,d,j);var b=this;this.__select=document.createElement("select");if(c.isArray(i)){var a={};c.each(i,function(e){a[e]=e});i=a}c.each(i,function(e,l){var k=document.createElement("option");k.innerHTML=l;k.setAttribute("value",e);b.__select.appendChild(k)});this.updateDisplay();f.bind(this.__select,"change",function(){b.setValue(this.options[this.selectedIndex].value)});this.domElement.appendChild(this.__select)};h.superclass=g;c.extend(h.prototype,g.prototype,{setValue:function(b){b=h.superclass.prototype.setValue.call(this,b);this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue());return b},updateDisplay:function(){this.__select.value=this.getValue();return h.superclass.prototype.updateDisplay.call(this)}});return h}(dat.controllers.Controller,dat.dom.dom,dat.utils.common);dat.controllers.NumberController=function(f,d){var c=function(b,a,e){c.superclass.call(this,b,a);e=e||{};this.__min=e.min;this.__max=e.max;this.__step=e.step;d.isUndefined(this.__step)?this.__impliedStep=0==this.initialValue?1:Math.pow(10,Math.floor(Math.log(this.initialValue)/Math.LN10))/10:this.__impliedStep=this.__step;b=this.__impliedStep;b=b.toString();b=-1<b.indexOf(".")?b.length-b.indexOf(".")-1:0;this.__precision=b};c.superclass=f;d.extend(c.prototype,f.prototype,{setValue:function(b){void 0!==this.__min&&b<this.__min?b=this.__min:void 0!==this.__max&&b>this.__max&&(b=this.__max);void 0!==this.__step&&0!=b%this.__step&&(b=Math.round(b/this.__step)*this.__step);return c.superclass.prototype.setValue.call(this,b)},min:function(b){this.__min=b;return this},max:function(b){this.__max=b;return this},step:function(b){this.__step=b;return this}});return c}(dat.controllers.Controller,dat.utils.common);dat.controllers.NumberControllerBox=function(g,f,c){var h=function(j,p,m){function b(){var e=parseFloat(o.__input.value);c.isNaN(e)||o.setValue(e)}function a(e){var k=d-e.clientY;o.setValue(o.getValue()+k*o.__impliedStep);d=e.clientY}function i(){f.unbind(window,"mousemove",a);f.unbind(window,"mouseup",i)}this.__truncationSuspended=!1;h.superclass.call(this,j,p,m);var o=this,d;this.__input=document.createElement("input");this.__input.setAttribute("type","text");f.bind(this.__input,"change",b);f.bind(this.__input,"blur",function(){b();o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())});f.bind(this.__input,"mousedown",function(e){f.bind(window,"mousemove",a);f.bind(window,"mouseup",i);d=e.clientY});f.bind(this.__input,"keydown",function(e){13===e.keyCode&&(o.__truncationSuspended=!0,this.blur(),o.__truncationSuspended=!1)});this.updateDisplay();this.domElement.appendChild(this.__input)};h.superclass=g;c.extend(h.prototype,g.prototype,{updateDisplay:function(){var e=this.__input,i;if(this.__truncationSuspended){i=this.getValue()}else{i=this.getValue();var d=Math.pow(10,this.__precision);i=Math.round(i*d)/d}e.value=i;return h.superclass.prototype.updateDisplay.call(this)}});return h}(dat.controllers.NumberController,dat.dom.dom,dat.utils.common);dat.controllers.NumberControllerSlider=function(k,h,g,l,i){function m(n,q,p,e,o){return e+(n-q)/(p-q)*(o-e)}var j=function(s,a,p,q,o){function t(u){u.preventDefault();var e=h.getOffset(c.__background),r=h.getWidth(c.__background);c.setValue(m(u.clientX,e.left,e.left+r,c.__min,c.__max));return !1}function n(){h.unbind(window,"mousemove",t);h.unbind(window,"mouseup",n);c.__onFinishChange&&c.__onFinishChange.call(c,c.getValue())}j.superclass.call(this,s,a,{min:p,max:q,step:o});var c=this;this.__background=document.createElement("div");this.__foreground=document.createElement("div");h.bind(this.__background,"mousedown",function(b){h.bind(window,"mousemove",t);h.bind(window,"mouseup",n);t(b)});h.addClass(this.__background,"slider");h.addClass(this.__foreground,"slider-fg");this.updateDisplay();this.__background.appendChild(this.__foreground);this.domElement.appendChild(this.__background)};j.superclass=k;j.useDefaultStyles=function(){g.inject(i)};l.extend(j.prototype,k.prototype,{updateDisplay:function(){var b=(this.getValue()-this.__min)/(this.__max-this.__min);this.__foreground.style.width=100*b+"%";return j.superclass.prototype.updateDisplay.call(this)}});return j}(dat.controllers.NumberController,dat.dom.dom,dat.utils.css,dat.utils.common,"/**\n * dat-gui JavaScript Controller Library\n * http://code.google.com/p/dat-gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n\n.slider {\n  box-shadow: inset 0 2px 4px rgba(0,0,0,0.15);\n  height: 1em;\n  border-radius: 1em;\n  background-color: #eee;\n  padding: 0 0.5em;\n  overflow: hidden;\n}\n\n.slider-fg {\n  padding: 1px 0 2px 0;\n  background-color: #aaa;\n  height: 1em;\n  margin-left: -0.5em;\n  padding-right: 0.5em;\n  border-radius: 1em 0 0 1em;\n}\n\n.slider-fg:after {\n  display: inline-block;\n  border-radius: 1em;\n  background-color: #fff;\n  border:  1px solid #aaa;\n  content: '';\n  float: right;\n  margin-right: -1em;\n  margin-top: -1px;\n  height: 0.9em;\n  width: 0.9em;\n}");dat.controllers.FunctionController=function(g,f,c){var h=function(a,j,i){h.superclass.call(this,a,j);var d=this;this.__button=document.createElement("div");this.__button.innerHTML=void 0===i?"Fire":i;f.bind(this.__button,"click",function(b){b.preventDefault();d.fire();return !1});f.addClass(this.__button,"button");this.domElement.appendChild(this.__button)};h.superclass=g;c.extend(h.prototype,g.prototype,{fire:function(){this.__onChange&&this.__onChange.call(this);this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue());this.getValue().call(this.object)}});return h}(dat.controllers.Controller,dat.dom.dom,dat.utils.common);dat.controllers.BooleanController=function(g,f,c){var h=function(a,i){h.superclass.call(this,a,i);var d=this;this.__prev=this.getValue();this.__checkbox=document.createElement("input");this.__checkbox.setAttribute("type","checkbox");f.bind(this.__checkbox,"change",function(){d.setValue(!d.__prev)},!1);this.domElement.appendChild(this.__checkbox);this.updateDisplay()};h.superclass=g;c.extend(h.prototype,g.prototype,{setValue:function(b){b=h.superclass.prototype.setValue.call(this,b);this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue());this.__prev=this.getValue();return b},updateDisplay:function(){!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0):this.__checkbox.checked=!1;return h.superclass.prototype.updateDisplay.call(this)}});return h}(dat.controllers.Controller,dat.dom.dom,dat.utils.common);dat.color.toString=function(a){return function(b){if(1==b.a||a.isUndefined(b.a)){for(b=b.hex.toString(16);6>b.length;){b="0"+b}return"#"+b}return"rgba("+Math.round(b.r)+","+Math.round(b.g)+","+Math.round(b.b)+","+b.a+")"}}(dat.utils.common);dat.color.interpret=function(i,g){var c,j,h=[{litmus:g.isString,conversions:{THREE_CHAR_HEX:{read:function(b){b=b.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null===b?!1:{space:"HEX",hex:parseInt("0x"+b[1].toString()+b[1].toString()+b[2].toString()+b[2].toString()+b[3].toString()+b[3].toString())}},write:i},SIX_CHAR_HEX:{read:function(b){b=b.match(/^#([A-F0-9]{6})$/i);return null===b?!1:{space:"HEX",hex:parseInt("0x"+b[1].toString())}},write:i},CSS_RGB:{read:function(b){b=b.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null===b?!1:{space:"RGB",r:parseFloat(b[1]),g:parseFloat(b[2]),b:parseFloat(b[3])}},write:i},CSS_RGBA:{read:function(b){b=b.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/);return null===b?!1:{space:"RGB",r:parseFloat(b[1]),g:parseFloat(b[2]),b:parseFloat(b[3]),a:parseFloat(b[4])}},write:i}}},{litmus:g.isNumber,conversions:{HEX:{read:function(b){return{space:"HEX",hex:b,conversionName:"HEX"}},write:function(b){return b.hex}}}},{litmus:g.isArray,conversions:{RGB_ARRAY:{read:function(b){return 3!=b.length?!1:{space:"RGB",r:b[0],g:b[1],b:b[2]}},write:function(b){return[b.r,b.g,b.b]}},RGBA_ARRAY:{read:function(b){return 4!=b.length?!1:{space:"RGB",r:b[0],g:b[1],b:b[2],a:b[3]}},write:function(b){return[b.r,b.g,b.b,b.a]}}}},{litmus:g.isObject,conversions:{RGBA_OBJ:{read:function(a){return g.isNumber(a.r)&&g.isNumber(a.g)&&g.isNumber(a.b)&&g.isNumber(a.a)?{space:"RGB",r:a.r,g:a.g,b:a.b,a:a.a}:!1},write:function(b){return{r:b.r,g:b.g,b:b.b,a:b.a}}},RGB_OBJ:{read:function(a){return g.isNumber(a.r)&&g.isNumber(a.g)&&g.isNumber(a.b)?{space:"RGB",r:a.r,g:a.g,b:a.b}:!1},write:function(b){return{r:b.r,g:b.g,b:b.b}}},HSVA_OBJ:{read:function(a){return g.isNumber(a.h)&&g.isNumber(a.s)&&g.isNumber(a.v)&&g.isNumber(a.a)?{space:"HSV",h:a.h,s:a.s,v:a.v,a:a.a}:!1},write:function(b){return{h:b.h,s:b.s,v:b.v,a:b.a}}},HSV_OBJ:{read:function(a){return g.isNumber(a.h)&&g.isNumber(a.s)&&g.isNumber(a.v)?{space:"HSV",h:a.h,s:a.s,v:a.v}:!1},write:function(b){return{h:b.h,s:b.s,v:b.v}}}}}];return function(){j=!1;var a=1<arguments.length?g.toArray(arguments):arguments[0];g.each(h,function(b){if(b.litmus(a)){return g.each(b.conversions,function(k,d){c=k.read(a);if(!1===j&&!1!==c){return j=c,c.conversionName=d,c.conversion=k,g.BREAK}}),g.BREAK}});return j}}(dat.color.toString,dat.utils.common);dat.GUI=dat.gui.GUI=function(an,ar,aq,ao,am,ap,af,aj,ai,ad,ag,ab,N,al,ak){function X(f,k,d,h){if(void 0===k[d]){throw Error("Object "+k+' has no property "'+d+'"')}h.color?k=new ag(k,d):(k=[k,d].concat(h.factoryArgs),k=ao.apply(f,k));h.before instanceof am&&(h.before=h.before.__li);T(f,k);al.addClass(k.domElement,"c");d=document.createElement("span");al.addClass(d,"property-name");d.innerHTML=k.property;var g=document.createElement("div");g.appendChild(d);g.appendChild(k.domElement);h=V(f,g,h.before);al.addClass(h,ah.CLASS_CONTROLLER_ROW);al.addClass(h,typeof k.getValue());Z(f,h,k);f.__controllers.push(k);return k}function V(f,g,h){var e=document.createElement("li");g&&e.appendChild(g);h?f.__ul.insertBefore(e,params.before):f.__ul.appendChild(e);f.onResize();return e}function Z(g,l,c){c.__li=l;c.__gui=g;ak.extend(c,{options:function(a){if(1<arguments.length){return c.remove(),X(g,c.object,c.property,{before:c.__li.nextElementSibling,factoryArgs:[ak.toArray(arguments)]})}if(ak.isArray(a)||ak.isObject(a)){return c.remove(),X(g,c.object,c.property,{before:c.__li.nextElementSibling,factoryArgs:[a]})}},name:function(b){c.__li.firstElementChild.firstElementChild.innerHTML=b;return c},listen:function(){c.__gui.listen(c);return c},remove:function(){c.__gui.remove(c);return c}});if(c instanceof ai){var k=new aj(c.object,c.property,{min:c.__min,max:c.__max,step:c.__step});ak.each(["updateDisplay","onChange","onFinishChange"],function(b){var f=c[b],e=k[b];c[b]=k[b]=function(){var d=Array.prototype.slice.call(arguments);f.apply(c,d);return e.apply(k,d)}});al.addClass(l,"has-slider");c.domElement.insertBefore(k.domElement,c.domElement.firstElementChild)}else{if(c instanceof aj){var h=function(a){return ak.isNumber(c.__min)&&ak.isNumber(c.__max)?(c.remove(),X(g,c.object,c.property,{before:c.__li.nextElementSibling,factoryArgs:[c.__min,c.__max,c.__step]})):a};c.min=ak.compose(h,c.min);c.max=ak.compose(h,c.max)}else{c instanceof ap?(al.bind(l,"click",function(){al.fakeEvent(c.__checkbox,"click")}),al.bind(c.__checkbox,"click",function(b){b.stopPropagation()})):c instanceof af?(al.bind(l,"click",function(){al.fakeEvent(c.__button,"click")}),al.bind(l,"mouseover",function(){al.addClass(c.__button,"hover")}),al.bind(l,"mouseout",function(){al.removeClass(c.__button,"hover")})):c instanceof ag&&(al.addClass(l,"color"),c.updateDisplay=ak.compose(function(b){l.style.borderLeftColor=c.__color.toString();return b},c.updateDisplay),c.updateDisplay())}}c.setValue=ak.compose(function(a){g.getRoot().__preset_select&&c.isModified()&&Y(g.getRoot(),!0);return a},c.setValue)}function T(g,k){var f=g.getRoot(),l=f.__rememberedObjects.indexOf(k.object);if(-1!=l){var h=f.__rememberedObjectIndecesToControllers[l];void 0===h&&(h={},f.__rememberedObjectIndecesToControllers[l]=h);h[k.property]=k;if(f.load&&f.load.remembered){f=f.load.remembered;if(f[g.preset]){f=f[g.preset]}else{if(f[o]){f=f[o]}else{return}}f[l]&&void 0!==f[l][k.property]&&(l=f[l][k.property],k.initialValue=l,k.setValue(l))}}}function J(w){var v=w.__save_row=document.createElement("li");al.addClass(w.domElement,"has-save");w.__ul.insertBefore(v,w.__ul.firstChild);al.addClass(v,"save-row");var t=document.createElement("span");t.innerHTML="&nbsp;";al.addClass(t,"button gears");var u=document.createElement("span");u.innerHTML="Save";al.addClass(u,"button");al.addClass(u,"save");var s=document.createElement("span");s.innerHTML="New";al.addClass(s,"button");al.addClass(s,"save-as");var p=document.createElement("span");p.innerHTML="Revert";al.addClass(p,"button");al.addClass(p,"revert");var h=w.__preset_select=document.createElement("select");w.load&&w.load.remembered?ak.each(w.load.remembered,function(a,c){W(w,c,c==w.preset)}):W(w,o,!1);al.bind(h,"change",function(){for(var a=0;a<w.__preset_select.length;a++){w.__preset_select[a].innerHTML=w.__preset_select[a].value}w.preset=this.value});v.appendChild(h);v.appendChild(t);v.appendChild(u);v.appendChild(s);v.appendChild(p);if(R){var v=document.getElementById("dg-save-locally"),l=document.getElementById("dg-local-explain");v.style.display="block";v=document.getElementById("dg-local-storage");"true"===localStorage.getItem(document.location.href+".isLocal")&&v.setAttribute("checked","checked");var m=function(){l.style.display=w.useLocalStorage?"block":"none"};m();al.bind(v,"change",function(){w.useLocalStorage=!w.useLocalStorage;m()})}var g=document.getElementById("dg-new-constructor");al.bind(g,"keydown",function(b){!b.metaKey||67!==b.which&&67!=b.keyCode||ae.hide()});al.bind(t,"click",function(){g.innerHTML=JSON.stringify(w.getSaveObject(),void 0,2);ae.show();g.focus();g.select()});al.bind(u,"click",function(){w.save()});al.bind(s,"click",function(){var a=prompt("Enter a new preset name.");a&&w.saveAs(a)});al.bind(p,"click",function(){w.revert()})}function j(g){function f(a){a.preventDefault();h=a.clientX;al.addClass(g.__closeButton,ah.CLASS_DRAG);al.bind(window,"mousemove",k);al.bind(window,"mouseup",l);return !1}function k(a){a.preventDefault();g.width+=h-a.clientX;g.onResize();h=a.clientX;return !1}function l(){al.removeClass(g.__closeButton,ah.CLASS_DRAG);al.unbind(window,"mousemove",k);al.unbind(window,"mouseup",l)}g.__resize_handle=document.createElement("div");ak.extend(g.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});var h;al.bind(g.__resize_handle,"mousedown",f);al.bind(g.__closeButton,"mousedown",f);g.domElement.insertBefore(g.__resize_handle,g.domElement.firstElementChild)}function U(d,c){d.domElement.style.width=c+"px";d.__save_row&&d.autoPlace&&(d.__save_row.style.width=c+"px");d.__closeButton&&(d.__closeButton.style.width=c+"px")}function ac(e,c){var f={};ak.each(e.__rememberedObjects,function(d,b){var a={};ak.each(e.__rememberedObjectIndecesToControllers[b],function(g,h){a[h]=c?g.initialValue:g.getValue()});f[b]=a});return f}function W(f,e,g){var h=document.createElement("option");h.innerHTML=e;h.value=e;f.__preset_select.appendChild(h);g&&(f.__preset_select.selectedIndex=f.__preset_select.length-1)}function Y(e,c){var f=e.__preset_select[e.__preset_select.selectedIndex];f.innerHTML=c?f.value+"*":f.value}function S(b){0!=b.length&&ab(function(){S(b)});ak.each(b,function(c){c.updateDisplay()})}an.inject(aq);var o="Default",R;try{R="localStorage" in window&&null!==window.localStorage}catch(i){R=!1}var ae,Q=!0,P,aa=!1,O=[],ah=function(h){function g(){localStorage.setItem(document.location.href+".gui",JSON.stringify(p.getSaveObject()))}function n(){var b=p.getRoot();b.width+=1;ak.defer(function(){b.width-=1})}var p=this;this.domElement=document.createElement("div");this.__ul=document.createElement("ul");this.domElement.appendChild(this.__ul);al.addClass(this.domElement,"dg");this.__folders={};this.__controllers=[];this.__rememberedObjects=[];this.__rememberedObjectIndecesToControllers=[];this.__listening=[];h=h||{};h=ak.defaults(h,{autoPlace:!0,width:ah.DEFAULT_WIDTH});h=ak.defaults(h,{resizable:h.autoPlace,hideable:h.autoPlace});ak.isUndefined(h.load)?h.load={preset:o}:h.preset&&(h.load.preset=h.preset);ak.isUndefined(h.parent)&&h.hideable&&O.push(this);h.resizable=ak.isUndefined(h.parent)&&h.resizable;h.autoPlace&&ak.isUndefined(h.scrollable)&&(h.scrollable=!0);var m=R&&"true"===localStorage.getItem(document.location.href+".isLocal");Object.defineProperties(this,{parent:{get:function(){return h.parent}},scrollable:{get:function(){return h.scrollable}},autoPlace:{get:function(){return h.autoPlace}},preset:{get:function(){return p.parent?p.getRoot().preset:h.load.preset},set:function(a){p.parent?p.getRoot().preset=a:h.load.preset=a;for(a=0;a<this.__preset_select.length;a++){this.__preset_select[a].value==this.preset&&(this.__preset_select.selectedIndex=a)}p.revert()}},width:{get:function(){return h.width},set:function(a){h.width=a;U(p,a)}},name:{get:function(){return h.name},set:function(a){h.name=a;k&&(k.innerHTML=h.name)}},closed:{get:function(){return h.closed},set:function(a){h.closed=a;h.closed?al.addClass(p.__ul,ah.CLASS_CLOSED):al.removeClass(p.__ul,ah.CLASS_CLOSED);this.onResize();p.__closeButton&&(p.__closeButton.innerHTML=a?ah.TEXT_OPEN:ah.TEXT_CLOSED)}},load:{get:function(){return h.load}},useLocalStorage:{get:function(){return m},set:function(b){R&&((m=b)?al.bind(window,"unload",g):al.unbind(window,"unload",g),localStorage.setItem(document.location.href+".isLocal",b))}}});if(ak.isUndefined(h.parent)){h.closed=!1;al.addClass(this.domElement,ah.CLASS_MAIN);al.makeSelectable(this.domElement,!1);if(R&&m){p.useLocalStorage=!0;var l=localStorage.getItem(document.location.href+".gui");l&&(h.load=JSON.parse(l))}this.__closeButton=document.createElement("div");this.__closeButton.innerHTML=ah.TEXT_CLOSED;al.addClass(this.__closeButton,ah.CLASS_CLOSE_BUTTON);this.domElement.appendChild(this.__closeButton);al.bind(this.__closeButton,"click",function(){p.closed=!p.closed})}else{void 0===h.closed&&(h.closed=!0);var k=document.createTextNode(h.name);al.addClass(k,"controller-name");l=V(p,k);al.addClass(this.__ul,ah.CLASS_CLOSED);al.addClass(l,"title");al.bind(l,"click",function(b){b.preventDefault();p.closed=!p.closed;return !1});h.closed||(this.closed=!1)}h.autoPlace&&(ak.isUndefined(h.parent)&&(Q&&(P=document.createElement("div"),al.addClass(P,"dg"),al.addClass(P,ah.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(P),Q=!1),P.appendChild(this.domElement),al.addClass(this.domElement,ah.CLASS_AUTO_PLACE)),this.parent||U(p,h.width));al.bind(window,"resize",function(){p.onResize()});al.bind(this.__ul,"webkitTransitionEnd",function(){p.onResize()});al.bind(this.__ul,"transitionend",function(){p.onResize()});al.bind(this.__ul,"oTransitionEnd",function(){p.onResize()});this.onResize();h.resizable&&j(this);p.getRoot();h.parent||n()};ah.toggleHide=function(){aa=!aa;ak.each(O,function(b){b.domElement.style.zIndex=aa?-999:999;b.domElement.style.opacity=aa?0:1})};ah.CLASS_AUTO_PLACE="a";ah.CLASS_AUTO_PLACE_CONTAINER="ac";ah.CLASS_MAIN="main";ah.CLASS_CONTROLLER_ROW="cr";ah.CLASS_TOO_TALL="taller-than-window";ah.CLASS_CLOSED="closed";ah.CLASS_CLOSE_BUTTON="close-button";ah.CLASS_DRAG="drag";ah.DEFAULT_WIDTH=245;ah.TEXT_CLOSED="Close Controls";ah.TEXT_OPEN="Open Controls";al.bind(window,"keydown",function(b){"text"===document.activeElement.type||72!==b.which&&72!=b.keyCode||ah.toggleHide()},!1);ak.extend(ah.prototype,{add:function(d,c){return X(this,d,c,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(d,c){return X(this,d,c,{color:!0})},remove:function(d){this.__ul.removeChild(d.__li);this.__controllers.slice(this.__controllers.indexOf(d),1);var c=this;ak.defer(function(){c.onResize()})},destroy:function(){this.autoPlace&&P.removeChild(this.domElement)},addFolder:function(d){if(void 0!==this.__folders[d]){throw Error('You already have a folder in this GUI by the name "'+d+'"')}var c={name:d,parent:this};c.autoPlace=this.autoPlace;this.load&&this.load.folders&&this.load.folders[d]&&(c.closed=this.load.folders[d].closed,c.load=this.load.folders[d]);c=new ah(c);this.__folders[d]=c;d=V(this,c.domElement);al.addClass(d,"folder");return c},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var e=this.getRoot();if(e.scrollable){var c=al.getOffset(e.__ul).top,f=0;ak.each(e.__ul.childNodes,function(a){e.autoPlace&&a===e.__save_row||(f+=al.getHeight(a))});window.innerHeight-c-20<f?(al.addClass(e.domElement,ah.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-c-20+"px"):(al.removeClass(e.domElement,ah.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&ak.defer(function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"});e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},remember:function(){ak.isUndefined(ae)&&(ae=new N,ae.domElement.innerHTML=ar);if(this.parent){throw Error("You can only call remember on a top level GUI.")}var a=this;ak.each(Array.prototype.slice.call(arguments),function(b){0==a.__rememberedObjects.length&&J(a);-1==a.__rememberedObjects.indexOf(b)&&a.__rememberedObjects.push(b)});this.autoPlace&&U(this,this.width)},getRoot:function(){for(var b=this;b.parent;){b=b.parent}return b},getSaveObject:function(){var b=this.load;b.closed=this.closed;0<this.__rememberedObjects.length&&(b.preset=this.preset,b.remembered||(b.remembered={}),b.remembered[this.preset]=ac(this));b.folders={};ak.each(this.__folders,function(a,c){b.folders[c]=a.getSaveObject()});return b},save:function(){this.load.remembered||(this.load.remembered={});this.load.remembered[this.preset]=ac(this);Y(this,!1)},saveAs:function(b){this.load.remembered||(this.load.remembered={},this.load.remembered[o]=ac(this,!0));this.load.remembered[b]=ac(this);this.preset=b;W(this,b,!0)},revert:function(b){ak.each(this.__controllers,function(a){this.getRoot().load.remembered?T(b||this.getRoot(),a):a.setValue(a.initialValue)},this);ak.each(this.__folders,function(c){c.revert(c)});b||Y(this.getRoot(),!1)},listen:function(d){var c=0==this.__listening.length;this.__listening.push(d);c&&S(this.__listening)}});return ah}(dat.utils.css,'<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n      \n    </div>\n    \n  </div>\n\n</div>',".dg {\n  /** Clear list styles */\n  /* Auto-place container */\n  /* Auto-placed GUI's */\n  /* Line items that don't contain folders. */\n  /** Folder names */\n  /** Hides closed items */\n  /** Controller row */\n  /** Name-half (left) */\n  /** Controller-half (right) */\n  /** Controller placement */\n  /** Shorter number boxes when slider is present. */\n  /** Ensure the entire boolean and function row shows a hand */ }\n  .dg ul {\n    list-style: none;\n    margin: 0;\n    padding: 0;\n    width: 100%;\n    clear: both; }\n  .dg.ac {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    height: 0;\n    z-index: 0; }\n  .dg:not(.ac) .main {\n    /** Exclude mains in ac so that we don't hide close button */\n    overflow: hidden; }\n  .dg.main {\n    -webkit-transition: opacity 0.1s linear;\n    -o-transition: opacity 0.1s linear;\n    -moz-transition: opacity 0.1s linear;\n    transition: opacity 0.1s linear; }\n    .dg.main.taller-than-window {\n      overflow-y: auto; }\n      .dg.main.taller-than-window .close-button {\n        opacity: 1;\n        /* TODO, these are style notes */\n        margin-top: -1px;\n        border-top: 1px solid #2c2c2c; }\n    .dg.main ul.closed .close-button {\n      opacity: 1 !important; }\n    .dg.main:hover .close-button,\n    .dg.main .close-button.drag {\n      opacity: 1; }\n    .dg.main .close-button {\n      /*opacity: 0;*/\n      -webkit-transition: opacity 0.1s linear;\n      -o-transition: opacity 0.1s linear;\n      -moz-transition: opacity 0.1s linear;\n      transition: opacity 0.1s linear;\n      border: 0;\n      position: absolute;\n      line-height: 19px;\n      height: 20px;\n      /* TODO, these are style notes */\n      cursor: pointer;\n      text-align: center;\n      background-color: #000; }\n      .dg.main .close-button:hover {\n        background-color: #111; }\n  .dg.a {\n    float: right;\n    margin-right: 15px;\n    overflow-x: hidden; }\n    .dg.a.has-save > ul {\n      margin-top: 27px; }\n      .dg.a.has-save > ul.closed {\n        margin-top: 0; }\n    .dg.a .save-row {\n      position: fixed;\n      top: 0;\n      z-index: 1002; }\n  .dg li {\n    -webkit-transition: height 0.1s ease-out;\n    -o-transition: height 0.1s ease-out;\n    -moz-transition: height 0.1s ease-out;\n    transition: height 0.1s ease-out; }\n  .dg li:not(.folder) {\n    cursor: auto;\n    height: 27px;\n    line-height: 27px;\n    overflow: hidden;\n    padding: 0 4px 0 5px; }\n  .dg li.folder {\n    padding: 0;\n    border-left: 4px solid rgba(0, 0, 0, 0); }\n  .dg li.title {\n    cursor: pointer;\n    margin-left: -4px; }\n  .dg .closed li:not(.title),\n  .dg .closed ul li,\n  .dg .closed ul li > * {\n    height: 0;\n    overflow: hidden;\n    border: 0; }\n  .dg .cr {\n    clear: both;\n    padding-left: 3px;\n    height: 27px; }\n  .dg .property-name {\n    cursor: default;\n    float: left;\n    clear: left;\n    width: 40%;\n    overflow: hidden;\n    text-overflow: ellipsis; }\n  .dg .c {\n    float: left;\n    width: 60%; }\n  .dg .c input[type=text] {\n    border: 0;\n    margin-top: 4px;\n    padding: 3px;\n    width: 100%;\n    float: right; }\n  .dg .has-slider input[type=text] {\n    width: 30%;\n    /*display: none;*/\n    margin-left: 0; }\n  .dg .slider {\n    float: left;\n    width: 66%;\n    margin-left: -5px;\n    margin-right: 0;\n    height: 19px;\n    margin-top: 4px; }\n  .dg .slider-fg {\n    height: 100%; }\n  .dg .c input[type=checkbox] {\n    margin-top: 9px; }\n  .dg .c select {\n    margin-top: 5px; }\n  .dg .cr.function,\n  .dg .cr.function .property-name,\n  .dg .cr.function *,\n  .dg .cr.boolean,\n  .dg .cr.boolean * {\n    cursor: pointer; }\n  .dg .selector {\n    display: none;\n    position: absolute;\n    margin-left: -9px;\n    margin-top: 23px;\n    z-index: 10; }\n  .dg .c:hover .selector,\n  .dg .selector.drag {\n    display: block; }\n  .dg li.save-row {\n    padding: 0; }\n    .dg li.save-row .button {\n      display: inline-block;\n      padding: 0px 6px; }\n  .dg.dialogue {\n    background-color: #222;\n    width: 460px;\n    padding: 15px;\n    font-size: 13px;\n    line-height: 15px; }\n\n/* TODO Separate style and structure */\n#dg-new-constructor {\n  padding: 10px;\n  color: #222;\n  font-family: Monaco, monospace;\n  font-size: 10px;\n  border: 0;\n  resize: none;\n  box-shadow: inset 1px 1px 1px #888;\n  word-wrap: break-word;\n  margin: 12px 0;\n  display: block;\n  width: 440px;\n  overflow-y: scroll;\n  height: 100px;\n  position: relative; }\n\n#dg-local-explain {\n  display: none;\n  font-size: 11px;\n  line-height: 17px;\n  border-radius: 3px;\n  background-color: #333;\n  padding: 8px;\n  margin-top: 10px; }\n  #dg-local-explain code {\n    font-size: 10px; }\n\n#dat-gui-save-locally {\n  display: none; }\n\n/** Main type */\n.dg {\n  color: #eee;\n  font: 11px 'Lucida Grande', sans-serif;\n  text-shadow: 0 -1px 0 #111;\n  /** Auto place */\n  /* Controller row, <li> */\n  /** Controllers */ }\n  .dg.main {\n    /** Scrollbar */ }\n    .dg.main::-webkit-scrollbar {\n      width: 5px;\n      background: #1a1a1a; }\n    .dg.main::-webkit-scrollbar-corner {\n      height: 0;\n      display: none; }\n    .dg.main::-webkit-scrollbar-thumb {\n      border-radius: 5px;\n      background: #676767; }\n  .dg li:not(.folder) {\n    background: #1a1a1a;\n    border-bottom: 1px solid #2c2c2c; }\n  .dg li.save-row {\n    line-height: 25px;\n    background: #dad5cb;\n    border: 0; }\n    .dg li.save-row select {\n      margin-left: 5px;\n      width: 108px; }\n    .dg li.save-row .button {\n      margin-left: 5px;\n      margin-top: 1px;\n      border-radius: 2px;\n      font-size: 9px;\n      line-height: 7px;\n      padding: 4px 4px 5px 4px;\n      background: #c5bdad;\n      color: #fff;\n      text-shadow: 0 1px 0 #b0a58f;\n      box-shadow: 0 -1px 0 #b0a58f;\n      cursor: pointer; }\n      .dg li.save-row .button.gears {\n        background: #c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;\n        height: 7px;\n        width: 8px; }\n      .dg li.save-row .button:hover {\n        background-color: #bab19e;\n        box-shadow: 0 -1px 0 #b0a58f; }\n  .dg li.folder {\n    border-bottom: 0; }\n  .dg li.title {\n    padding-left: 16px;\n    background: black url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;\n    cursor: pointer;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.2); }\n  .dg .closed li.title {\n    background-image: url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==); }\n  .dg .cr.boolean {\n    border-left: 3px solid #806787; }\n  .dg .cr.function {\n    border-left: 3px solid #e61d5f; }\n  .dg .cr.number {\n    border-left: 3px solid #2fa1d6; }\n    .dg .cr.number input[type=text] {\n      color: #2fa1d6; }\n  .dg .cr.string {\n    border-left: 3px solid #1ed36f; }\n    .dg .cr.string input[type=text] {\n      color: #1ed36f; }\n  .dg .cr.function:hover, .dg .cr.boolean:hover {\n    background: #111; }\n  .dg .c input[type=text] {\n    background: #303030;\n    outline: none; }\n    .dg .c input[type=text]:hover {\n      background: #3c3c3c; }\n    .dg .c input[type=text]:focus {\n      background: #494949;\n      color: #fff; }\n  .dg .c .slider {\n    background: #303030;\n    cursor: ew-resize; }\n  .dg .c .slider-fg {\n    background: #2fa1d6; }\n  .dg .c .slider:hover {\n    background: #3c3c3c; }\n    .dg .c .slider:hover .slider-fg {\n      background: #44abda; }\n",dat.controllers.factory=function(k,h,g,l,i,m,j){return function(b,a,d,e){var c=b[a];if(j.isArray(d)||j.isObject(d)){return new k(b,a,d)}if(j.isNumber(c)){return j.isNumber(d)&&j.isNumber(e)?new g(b,a,d,e):new h(b,a,{min:d,max:e})}if(j.isString(c)){return new l(b,a)}if(j.isFunction(c)){return new i(b,a,"")}if(j.isBoolean(c)){return new m(b,a)}}}(dat.controllers.OptionController,dat.controllers.NumberControllerBox,dat.controllers.NumberControllerSlider,dat.controllers.StringController=function(g,f,c){var h=function(a,j){function i(){d.setValue(d.__input.value)}h.superclass.call(this,a,j);var d=this;this.__input=document.createElement("input");this.__input.setAttribute("type","text");f.bind(this.__input,"keyup",i);f.bind(this.__input,"change",i);f.bind(this.__input,"blur",function(){d.__onFinishChange&&d.__onFinishChange.call(d,d.getValue())});f.bind(this.__input,"keydown",function(b){13===b.keyCode&&this.blur()});this.updateDisplay();this.domElement.appendChild(this.__input)};h.superclass=g;c.extend(h.prototype,g.prototype,{updateDisplay:function(){f.isActive(this.__input)||(this.__input.value=this.getValue());return h.superclass.prototype.updateDisplay.call(this)}});return h}(dat.controllers.Controller,dat.dom.dom,dat.utils.common),dat.controllers.FunctionController,dat.controllers.BooleanController,dat.utils.common),dat.controllers.Controller,dat.controllers.BooleanController,dat.controllers.FunctionController,dat.controllers.NumberControllerBox,dat.controllers.NumberControllerSlider,dat.controllers.OptionController,dat.controllers.ColorController=function(m,r,q,n,j){function o(f,e,k,l){f.style.background="";j.each(h,function(a){f.style.cssText+="background: "+a+"linear-gradient("+e+", "+k+" 0%, "+l+" 100%); "})}function g(b){b.style.background="";b.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);";b.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);";b.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);";b.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);";b.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var i=function(k,b){function a(e){x(e);r.bind(window,"mousemove",x);r.bind(window,"mouseup",c)}function c(){r.unbind(window,"mousemove",x);r.unbind(window,"mouseup",c)}function f(){var e=n(this.value);!1!==e?(y.__color.__state=e,y.setValue(y.__color.toOriginal())):this.value=y.__color.toString()}function d(){r.unbind(window,"mousemove",w);r.unbind(window,"mouseup",d)}function x(l){l.preventDefault();var t=r.getWidth(y.__saturation_field),u=r.getOffset(y.__saturation_field),s=(l.clientX-u.left+document.body.scrollLeft)/t;l=1-(l.clientY-u.top+document.body.scrollTop)/t;1<l?l=1:0>l&&(l=0);1<s?s=1:0>s&&(s=0);y.__color.v=l;y.__color.s=s;y.setValue(y.__color.toOriginal());return !1}function w(e){e.preventDefault();var l=r.getHeight(y.__hue_field),s=r.getOffset(y.__hue_field);e=1-(e.clientY-s.top+document.body.scrollTop)/l;1<e?e=1:0>e&&(e=0);y.__color.h=360*e;y.setValue(y.__color.toOriginal());return !1}i.superclass.call(this,k,b);this.__color=new q(this.getValue());this.__temp=new q(0);var y=this;this.domElement=document.createElement("div");r.makeSelectable(this.domElement,!1);this.__selector=document.createElement("div");this.__selector.className="selector";this.__saturation_field=document.createElement("div");this.__saturation_field.className="saturation-field";this.__field_knob=document.createElement("div");this.__field_knob.className="field-knob";this.__field_knob_border="2px solid ";this.__hue_knob=document.createElement("div");this.__hue_knob.className="hue-knob";this.__hue_field=document.createElement("div");this.__hue_field.className="hue-field";this.__input=document.createElement("input");this.__input.type="text";this.__input_textShadow="0 1px 1px ";r.bind(this.__input,"keydown",function(e){13===e.keyCode&&f.call(this)});r.bind(this.__input,"blur",f);r.bind(this.__selector,"mousedown",function(e){r.addClass(this,"drag").bind(window,"mouseup",function(l){r.removeClass(y.__selector,"drag")})});var p=document.createElement("div");j.extend(this.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"});j.extend(this.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:this.__field_knob_border+(0.5>this.__color.v?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1});j.extend(this.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1});j.extend(this.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"});j.extend(p.style,{width:"100%",height:"100%",background:"none"});o(p,"top","rgba(0,0,0,0)","#000");j.extend(this.__hue_field.style,{width:"15px",height:"100px",display:"inline-block",border:"1px solid #555",cursor:"ns-resize"});g(this.__hue_field);j.extend(this.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:this.__input_textShadow+"rgba(0,0,0,0.7)"});r.bind(this.__saturation_field,"mousedown",a);r.bind(this.__field_knob,"mousedown",a);r.bind(this.__hue_field,"mousedown",function(e){w(e);r.bind(window,"mousemove",w);r.bind(window,"mouseup",d)});this.__saturation_field.appendChild(p);this.__selector.appendChild(this.__field_knob);this.__selector.appendChild(this.__saturation_field);this.__selector.appendChild(this.__hue_field);this.__hue_field.appendChild(this.__hue_knob);this.domElement.appendChild(this.__input);this.domElement.appendChild(this.__selector);this.updateDisplay()};i.superclass=m;j.extend(i.prototype,m.prototype,{updateDisplay:function(){var c=n(this.getValue());if(!1!==c){var f=!1;j.each(q.COMPONENTS,function(a){if(!j.isUndefined(c[a])&&!j.isUndefined(this.__color.__state[a])&&c[a]!==this.__color.__state[a]){return f=!0,{}}},this);f&&j.extend(this.__color.__state,c)}j.extend(this.__temp.__state,this.__color.__state);this.__temp.a=1;var d=0.5>this.__color.v||0.5<this.__color.s?255:0,b=255-d;j.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toString(),border:this.__field_knob_border+"rgb("+d+","+d+","+d+")"});this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px";this.__temp.s=1;this.__temp.v=1;o(this.__saturation_field,"left","#fff",this.__temp.toString());j.extend(this.__input.style,{backgroundColor:this.__input.value=this.__color.toString(),color:"rgb("+d+","+d+","+d+")",textShadow:this.__input_textShadow+"rgba("+b+","+b+","+b+",.7)"})}});var h=["-moz-","-o-","-webkit-","-ms-",""];return i}(dat.controllers.Controller,dat.dom.dom,dat.color.Color=function(m,r,q,n){function j(e,c,f){Object.defineProperty(e,c,{get:function(){if("RGB"===this.__state.space){return this.__state[c]}g(this,c,f);return this.__state[c]},set:function(b){"RGB"!==this.__state.space&&(g(this,c,f),this.__state.space="RGB");this.__state[c]=b}})}function o(d,c){Object.defineProperty(d,c,{get:function(){if("HSV"===this.__state.space){return this.__state[c]}i(this);return this.__state[c]},set:function(b){"HSV"!==this.__state.space&&(i(this),this.__state.space="HSV");this.__state[c]=b}})}function g(a,f,d){if("HEX"===a.__state.space){a.__state[f]=r.component_from_hex(a.__state.hex,d)}else{if("HSV"===a.__state.space){n.extend(a.__state,r.hsv_to_rgb(a.__state.h,a.__state.s,a.__state.v))}else{throw"Corrupted color state"}}}function i(a){var d=r.rgb_to_hsv(a.r,a.g,a.b);n.extend(a.__state,{s:d.s,v:d.v});n.isNaN(d.h)?n.isUndefined(a.__state.h)&&(a.__state.h=0):a.__state.h=d.h}var h=function(){this.__state=m.apply(this,arguments);if(!1===this.__state){throw"Failed to interpret color arguments"}this.__state.a=this.__state.a||1};h.COMPONENTS="r g b h s v hex a".split(" ");n.extend(h.prototype,{toString:function(){return q(this)},toOriginal:function(){return this.__state.conversion.write(this)}});j(h.prototype,"r",2);j(h.prototype,"g",1);j(h.prototype,"b",0);o(h.prototype,"h");o(h.prototype,"s");o(h.prototype,"v");Object.defineProperty(h.prototype,"a",{get:function(){return this.__state.a},set:function(b){this.__state.a=b}});Object.defineProperty(h.prototype,"hex",{get:function(){"HEX"!==!this.__state.space&&(this.__state.hex=r.rgb_to_hex(this.r,this.g,this.b));return this.__state.hex},set:function(b){this.__state.space="HEX";this.__state.hex=b}});return h}(dat.color.interpret,dat.color.math=function(){var a;return{hsv_to_rgb:function(g,f,j){var i=g/60-Math.floor(g/60),k=j*(1-f),h=j*(1-i*f);f=j*(1-(1-i)*f);g=[[j,f,k],[h,j,k],[k,j,f],[k,h,j],[f,k,j],[j,k,h]][Math.floor(g/60)%6];return{r:255*g[0],g:255*g[1],b:255*g[2]}},rgb_to_hsv:function(g,f,i){var h=Math.min(g,f,i),j=Math.max(g,f,i),h=j-h;if(0==j){return{h:NaN,s:0,v:0}}g=(g==j?(f-i)/h:f==j?2+(i-g)/h:4+(g-f)/h)/6;0>g&&(g+=1);return{h:360*g,s:h/j,v:j/255}},rgb_to_hex:function(e,c,f){e=this.hex_with_component(0,2,e);e=this.hex_with_component(e,1,c);return e=this.hex_with_component(e,0,f)},component_from_hex:function(d,c){return d>>8*c&255},hex_with_component:function(e,c,f){return f<<(a=8*c)|e&~(255<<a)}}}(),dat.color.toString,dat.utils.common),dat.color.interpret,dat.utils.common),dat.utils.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(c,b){window.setTimeout(c,1000/60)}}(),dat.dom.CenteredDiv=function(f,d){var c=function(){this.backgroundElement=document.createElement("div");d.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear"});f.makeFullscreen(this.backgroundElement);this.backgroundElement.style.position="fixed";this.domElement=document.createElement("div");d.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear"});document.body.appendChild(this.backgroundElement);document.body.appendChild(this.domElement);var a=this;f.bind(this.backgroundElement,"click",function(){a.hide()})};c.prototype.show=function(){var a=this;this.backgroundElement.style.display="block";this.domElement.style.display="block";this.domElement.style.opacity=0;this.domElement.style.webkitTransform="scale(1.1)";this.layout();d.defer(function(){a.backgroundElement.style.opacity=1;a.domElement.style.opacity=1;a.domElement.style.webkitTransform="scale(1)"})};c.prototype.hide=function(){var g=this,e=function(){g.domElement.style.display="none";g.backgroundElement.style.display="none";f.unbind(g.domElement,"webkitTransitionEnd",e);f.unbind(g.domElement,"transitionend",e);f.unbind(g.domElement,"oTransitionEnd",e)};f.bind(this.domElement,"webkitTransitionEnd",e);f.bind(this.domElement,"transitionend",e);f.bind(this.domElement,"oTransitionEnd",e);this.backgroundElement.style.opacity=0;this.domElement.style.opacity=0;this.domElement.style.webkitTransform="scale(1.1)"};c.prototype.layout=function(){this.domElement.style.left=window.innerWidth/2-f.getWidth(this.domElement)/2+"px";this.domElement.style.top=window.innerHeight/2-f.getHeight(this.domElement)/2+"px"};return c}(dat.dom.dom,dat.utils.common),dat.dom.dom,dat.utils.common);