


  
  
 
  
  
 


<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Touch Emulation &mdash; Leap Motion Unity SDK v2.3 documentation</title>
    
    <link rel="stylesheet" href="../../cpp/_static/bootstrap-3.0.0/css/documentation-bundle.1439949735.css" type="text/css" />
    
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
      <script type="text/javascript" src="../../cpp/_static/bootstrap-3.0.0/js/documentation-bundle.1439949735.js"></script>
    <link rel="top" title="Leap Motion Unity SDK v2.3 documentation" href="../index.html" />
<script type="text/javascript" src="/assets/standalone-header.js?r9"></script>
<link rel="stylesheet" href="/assets/standalone-header.css?r9" type="text/css" />

<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-31536531-1']);
  _gaq.push(['_setDomainName', 'leapmotion.com']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

 

<script>

    function getQueryValue(variable)
    {
        var query = window.location.search.substring(1);
        var vars = query.split("&");
        for (var i=0;i<vars.length;i++) {
            var pair = vars[i].split("=");
            if(pair[0] == variable){return pair[1];}
        }
        return(false);
    }
        var relPath = "../../";

    var requestedAPI = getQueryValue("proglang");
    if(requestedAPI == "current") requestedAPI = localStorage["currentAPI"];
    var pageAPI = 'unity';
    var hasAPI = {};
    hasAPI.cpp = true;
    hasAPI.csharp = true;
    hasAPI.objc = true;
    hasAPI.java = true;
    hasAPI.javascript = true;
    hasAPI.python = true;

    if(requestedAPI && (requestedAPI != pageAPI))
    {
        if(pageAPI != 'none'){
            var redirectedLocation = relPath + 'unity/devguide/Leap_Touch_Emulation.html';
            if( requestedAPI == 'cpp' && hasAPI.cpp){
                redirectedLocation = relPath + "cpp/devguide/Leap_Touch_Emulation.html";
            }
            else if( requestedAPI == 'csharp' && hasAPI.csharp){
                redirectedLocation = relPath + "csharp/devguide/Leap_Touch_Emulation.html";
            }
            else if( requestedAPI == 'unity' && hasAPI.unity){
                redirectedLocation = relPath + "unity/devguide/Leap_Touch_Emulation.html";
            }
            else if( requestedAPI == 'objc' && hasAPI.objc){
                redirectedLocation = relPath + "objc/devguide/Leap_Touch_Emulation.html";
            }
            else if( requestedAPI == 'java' && hasAPI.java) {
                redirectedLocation = relPath + "java/devguide/Leap_Touch_Emulation.html";
            }
            else if( requestedAPI == 'javascript' && hasAPI.javascript){
                redirectedLocation = relPath + "javascript/devguide/Leap_Touch_Emulation.html";
            }
            else if( requestedAPI == 'python' && hasAPI.python){
                redirectedLocation = relPath + "python/devguide/Leap_Touch_Emulation.html";
            }
            else if( requestedAPI == 'unreal' && hasAPI.unreal) {
                redirectedLocation = relPath + "unreal/devguide/Leap_Touch_Emulation.html";
            } else {

                    if( requestedAPI == 'cpp'){
                        redirectedLocation = relPath + "cpp/index.html?proglang=cpp";
                    }
                    else if( requestedAPI == 'csharp'){
                        redirectedLocation = relPath + "csharp/index.html?proglang=csharp";
                    }
                    else if( requestedAPI == 'unity'){
                        redirectedLocation = relPath + "unity/index.html?proglang=unity";
                    }
                    else if( requestedAPI == 'objc'){
                        redirectedLocation = relPath + "objc/index.html?proglang=objc";
                    }
                    else if( requestedAPI == 'java') {
                        redirectedLocation = relPath + "java/index.html?proglang=java";
                    }
                    else if( requestedAPI == 'javascript'){
                        redirectedLocation = relPath + "javascript/index.html?proglang=javascript";
                    }
                    else if( requestedAPI == 'python'){
                        redirectedLocation = relPath + "python/index.html?proglang=python";
                    }
                    else if( requestedAPI == 'unreal') {
                        redirectedLocation = relPath + "unreal/index.html?proglang=unreal";
                    } else {
                        redirectedLocation = relPath + "index.html";
                    }
            }

            //Guard against redirecting to the same page (infinitely)
            if(relPath + 'unity/devguide/Leap_Touch_Emulation.html' != redirectedLocation) window.location.replace(redirectedLocation);
        }
    }

</script>

<script>
window.addEventListener('keyup', handleKeyInput);
function handleKeyInput(e)
{
    var code;
    if (!e) var e = window.event;
    if (e.keyCode) code = e.keyCode;
    else if (e.which) code = e.which;
    var character = String.fromCharCode(code);
    if( character == "J" & e.altKey){    }
    else if( character == "K" & e.altKey){
    }

}
</script>


  </head>
  <body role="document">

<div class="developer-portal-styles">
  <header class="navbar navbar-static-top developer-navbar header beta-header">
    <nav class="container pr">
      <a class="logo-link pull-left" href="/">
        <img alt="Leap Motion Developers" class="media-object pull-left white-background" src="../_static/logo.png" />
      </a>
      <span class="inline-block hidden-phone developer-logo-text">
        <div class="text">
          <a href="/">
            <span class="more-than-1199">Developer Portal</span>

          </a>
        </div>
      </span>

      <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <!-- Everything within here will be hidden at 940px or less, accessible via a button. -->
      <div class="nav-collapse">
        <ul class="nav header-navigation developer-links">
          <li class="external-link"><a href="https://developer.leapmotion.com/features">What's new</a> </li>
          <li class="external-link"><a href="https://developer.leapmotion.com/downloads/skeletal-beta" class="">Getting Started</a></li>
          <li><a class="active" href="#" class="">Documentation</a></li>
          <li class="external-link"> <a href="https://developer.leapmotion.com/gallery" class="">Examples</a> </li>
          <li class="external-link"> <a href="https://www.leapmotion.com/blog/category/labs/" class="" target="_blank">Blog <i class='fa fa-external-link'></i></a> </li>
          <li class="external-link"> <a href="https://community.leapmotion.com/category/beta" class="" target="_blank">Community <i class='fa fa-external-link'></i></a> </li>
        </ul>
      </div>

    </nav>
  </header>
</div>
<section class="main-wrap">
  <div data-swiftype-index="true">
    <div class="second_navigation">
      <div class="container">
        <div class="row">
          <div class="col-md-8">
            
              

<ul>
  <li>
      <a href="../../javascript/devguide/Leap_Touch_Emulation.html?proglang=javascript" onclick="localStorage['currentAPI'] = 'javascript'">JavaScript</a>
    
  </li>
  <li>
      Unity
    
  </li>
  <li>
      <a href="../../csharp/devguide/Leap_Touch_Emulation.html?proglang=csharp" onclick="localStorage['currentAPI'] = 'csharp'">C#</a>
    
  </li>
  <li>
      <a href="../../cpp/devguide/Leap_Touch_Emulation.html?proglang=cpp" onclick="localStorage['currentAPI'] = 'cpp'">C++</a>
    
  </li>
  <li>
      <a href="../../java/devguide/Leap_Touch_Emulation.html?proglang=java" onclick="localStorage['currentAPI'] = 'java'">Java</a>
    
  </li>
  <li>
      <a href="../../python/devguide/Leap_Touch_Emulation.html?proglang=python" onclick="localStorage['currentAPI'] = 'python'">Python</a>
    
  </li>
  <li>
      <a href="../../objc/devguide/Leap_Touch_Emulation.html?proglang=objc" onclick="localStorage['currentAPI'] = 'objc'">Objective-C</a>
    
  </li>
  <li>
      <a href="../../unreal/index.html?proglang=unreal" onclick="localStorage['currentAPI'] = 'unreal'">Unreal</a>
    
  </li>
</ul>
            
          </div>
          <div class="col-md-4 search">
            
              <script>
function storeThisPage(){
    sessionStorage["pageBeforeSearch"] = window.location;
    return true;
}
function doneWithSearch(){
    var storedPage = sessionStorage["pageBeforeSearch"];
    if(storedPage){
        window.location = storedPage;
    } else {
        window.location = "index.html"; //fallback
    }
    return false;
}
</script>
<div  style="margin-top:-4px">
<ul style="display:inline; white-space:nowrap"><li>
<form class="navbar-form" action="../search.html" method="get" onsubmit="storeThisPage()">
 <div class="form-group">
  <input type="search" results="5" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form></li>
</ul>
</div>
            
          </div>
        </div>
      </div>
    </div>
    <script>
        //Remove dev portal header and footer when viewing from file system
       if(window.location.protocol == 'file:'){
            var navNode = document.querySelector(".developer-links");
            navNode.parentNode.removeChild(navNode);
        }

    </script>


<div id="wrap" data-spy="scroll" data-target="#sidebar">
  <div class="container">
    <div class="row">
      <div class="col-md-9 pull-right">
        <!-- 
 
<span id="breadcrumbs">
  <a href="../index.html">Home</a>&raquo;
  Touch Emulation
</span> -->
        
  <div class="section" id="id1">
<h1>Touch Emulation<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>The Leap Motion API provides information that you can use to implement touch emulation in your application. Touch information is provided by the <a class="reference external" href="../api/Leap.Pointable.html"><tt class="docutils literal"><span class="pre">Pointable</span></tt></a> class.</p>
<div class="section" id="id2">
<h2>Overview<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>The Leap defines an adaptive touch surface that you can use to orchestrate interaction with 2D elements of your application. This surface is oriented roughly parallel to the x-y plane, but adapts to the user&#8217;s finger and hand position. As the user reaches forward with a finger or tool, the Leap reports whether that pointable object is close-to or touching this imaginary surface. The API reports touches with respect to the surface with two values: the zone and the distance to the touch plane.</p>
<div class="figure">
<img alt="devguide/../../../images/Leap_Touch_Plane.png" src="devguide/../../../images/Leap_Touch_Plane.png" />
<p class="caption">The virtual touch surface</p>
</div>
<p>The touch zone identifies whether the Leap Motion software considers a <tt class="docutils literal"><span class="pre">Pointable</span></tt> as hovering near the touch surface, as penetrating the touch surface, or as too far from the surface (or pointing in the wrong direction). The zones are &#8220;hovering,&#8221; &#8220;touching,&#8221; and &#8220;none.&#8221; The transition between zones tends to lag behind the touch distance. This lag is used to prevent abrupt and repeated transitions. If you are implementing touch interaction within an application, you may not need to consider the touch zone very often.</p>
<p>The touch distance is valid only when a <tt class="docutils literal"><span class="pre">Pointable</span></tt> is within the hovering or touching zones. The distance is a normalized value in the range [+1..-1]. When a <tt class="docutils literal"><span class="pre">Pointable</span></tt> first enters the hovering zone, the touch distance is +1.0 and the distance decreases toward 0 as the <tt class="docutils literal"><span class="pre">Pointable</span></tt> nears the touch surface. When the <tt class="docutils literal"><span class="pre">Pointable</span></tt> penetrates the surface, the distance is 0. As the <tt class="docutils literal"><span class="pre">Pointable</span></tt> pushes deeper into the touch zone, the distance approaches, but never exceeds, -1.</p>
<p>You can use the zone value to decide when to update UI elements based on hover or touch. You can use the distance to further modify UI elements based on proximity to the touch plane. For example, you can show the highlight state of a control when a finger is over the control and in the hovering zone and change the cursor based on distance to provide feedback about how close the user is to touching the control.</p>
<p>As part of the touch emulation API the Leap Motion provides a stabilized position for <tt class="docutils literal"><span class="pre">Pointable</span></tt> objects in addition to the standard position. The Leap Motion software stabilizes the position using an adaptive filter that smooths and slows the motion to make it easier for the user to interact with small regions on the screen (like buttons and links). The smoothing is greater when the movement is slow so that the user can zero in and touch a particular point more easily.</p>
</div>
<div class="section" id="id3">
<h2>Getting the Touch Zone<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>The touch zone is reported by the <tt class="docutils literal"><span class="pre">touchZone</span></tt> attribute of the <a class="reference external" href="../api/Leap.Pointable.html"><tt class="docutils literal"><span class="pre">Pointable</span></tt></a> class. The zones are identified using the Zone enumeration, which defines the following states:</p>
<ul class="simple">
<li>NONE — the pointable is either too far from the touch surface to be considered touching, or it is pointing back toward the user.</li>
<li>HOVERING — the pointable tip has crossed into the hovering zone, but isn&#8217;t considered touching.</li>
<li>TOUCHING — the pointable has crossed the virtual touch surface.</li>
</ul>
<p>The following code snippet illustrates how to retrieve the zone of the forward-most finger:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span class="n">Frame</span> <span class="n">frame</span> <span class="p">=</span> <span class="n">controller</span><span class="p">.</span><span class="n">Frame</span> <span class="p">();</span>
<span class="n">Pointable</span> <span class="n">pointable</span> <span class="p">=</span> <span class="n">frame</span><span class="p">.</span><span class="n">Pointables</span><span class="p">.</span><span class="n">Frontmost</span><span class="p">;</span>
<span class="n">Pointable</span><span class="p">.</span><span class="n">Zone</span> <span class="n">zone</span> <span class="p">=</span> <span class="n">pointable</span><span class="p">.</span><span class="n">TouchZone</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="id4">
<h2>Getting the Touch Distance<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>The touch distance is reported by the <tt class="docutils literal"><span class="pre">touchDistance</span></tt> attribute of the <a class="reference external" href="../api/Leap.Pointable.html"><tt class="docutils literal"><span class="pre">Pointable</span></tt></a> class. The distance ranges from +1 to -1 as the finger moves to and through the virtual touch surface. The distance does not represent a physical quantity, but rather how close to touching the Leap Software considers the pointable.</p>
<p>The following code snippet illustrates how to retrieve the touch distance of the forward-most finger:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span class="n">Frame</span> <span class="n">frame</span> <span class="p">=</span> <span class="n">controller</span><span class="p">.</span><span class="n">Frame</span> <span class="p">();</span>
<span class="n">Pointable</span> <span class="n">pointable</span> <span class="p">=</span> <span class="n">frame</span><span class="p">.</span><span class="n">Pointables</span><span class="p">.</span><span class="n">Frontmost</span><span class="p">;</span>
<span class="kt">float</span> <span class="n">distance</span> <span class="p">=</span> <span class="n">pointable</span><span class="p">.</span><span class="n">TouchDistance</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="id5">
<h2>Getting the Stabilized Position of a Pointable<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p>The stabilized position is reported by the <tt class="docutils literal"><span class="pre">stabilizedTipPosition</span></tt> attribute of the <a class="reference external" href="../api/Leap.Pointable.html"><tt class="docutils literal"><span class="pre">Pointable</span></tt></a> class. This position is reported in reference to the standard Leap Motion coordinate system, but has a context-sensitive amount of filtering and stabilization.</p>
<p>The following code snippet illustrates how to retrieve the stabilized position of the forward-most finger:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span class="n">Frame</span> <span class="n">frame</span> <span class="p">=</span> <span class="n">controller</span><span class="p">.</span><span class="n">Frame</span> <span class="p">();</span>
<span class="n">Pointable</span> <span class="n">pointable</span> <span class="p">=</span> <span class="n">frame</span><span class="p">.</span><span class="n">Pointables</span><span class="p">.</span><span class="n">Frontmost</span><span class="p">;</span>
<span class="n">Vector</span> <span class="n">stabilizedPosition</span> <span class="p">=</span> <span class="n">pointable</span><span class="p">.</span><span class="n">StabilizedTipPosition</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="id6">
<h2>Converting from Leap Motion Coordinates to Application Coordinates<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<p>When implementing touch emulation, you must map the Leap Motion coordinate space to the screen space of your application. To make this mapping easier, the Leap Motion API provides the <a class="reference external" href="../api/Leap.InteractionBox.html"><tt class="docutils literal"><span class="pre">InteractionBox</span></tt></a> class. The <tt class="docutils literal"><span class="pre">InteractionBox</span></tt> represents a rectilinear volume within the Leap Motion field of view. The class provides a function that normalizes positions within this volume to coordinates in the range [0..1]. You can normalize a position and then scale the resulting coordinate by the application dimensions to get a point in application coordinates.</p>
<p>For example, if you have a window with a client-area size represented by the variables <tt class="docutils literal"><span class="pre">windowWidth</span></tt> and <tt class="docutils literal"><span class="pre">windowHeight</span></tt>, you can get the 2D pixel coordinates of a touch point within this window using the following code:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span class="n">Frame</span> <span class="n">frame</span> <span class="p">=</span> <span class="n">controller</span><span class="p">.</span><span class="n">Frame</span> <span class="p">();</span>
<span class="n">Finger</span> <span class="n">finger</span> <span class="p">=</span> <span class="n">frame</span><span class="p">.</span><span class="n">Fingers</span><span class="p">.</span><span class="n">Frontmost</span><span class="p">;</span>
<span class="n">Vector</span> <span class="n">stabilizedPosition</span> <span class="p">=</span> <span class="n">finger</span><span class="p">.</span><span class="n">StabilizedTipPosition</span><span class="p">;</span>

<span class="n">InteractionBox</span> <span class="n">iBox</span> <span class="p">=</span> <span class="n">controller</span><span class="p">.</span><span class="n">Frame</span> <span class="p">().</span><span class="n">InteractionBox</span><span class="p">;</span>
<span class="n">Vector</span> <span class="n">normalizedPosition</span> <span class="p">=</span> <span class="n">iBox</span><span class="p">.</span><span class="n">NormalizePoint</span> <span class="p">(</span><span class="n">stabilizedPosition</span><span class="p">);</span>
<span class="kt">float</span> <span class="n">x</span> <span class="p">=</span> <span class="n">normalizedPosition</span><span class="p">.</span><span class="n">x</span> <span class="p">*</span> <span class="n">windowWidth</span><span class="p">;</span>
<span class="kt">float</span> <span class="n">y</span> <span class="p">=</span> <span class="n">windowHeight</span> <span class="p">-</span> <span class="n">normalizedPosition</span><span class="p">.</span><span class="n">y</span> <span class="p">*</span> <span class="n">windowHeight</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="id7">
<h2>TouchPoints Example<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h2>
<p>The following example uses the touch emulation APIs to display the positions of all detected Pointable objects in an application window. The example uses the touch zone to set the color of the points and uses the touch distance to set the alpha value. The stabilized tip positions are mapped to the application window using the <a class="reference external" href="../api/Leap.InteractionBox.html"><tt class="docutils literal"><span class="pre">InteractionBox</span></tt></a> class.</p>
<div id="stage" style="background-color:rgb(191,191,191); width:400px; height:200"></div>
<script src="http://cdnjs.cloudflare.com/ajax/libs/kineticjs/5.0.6/kinetic.min.js"></script>
<script>
  var touchPoints = {};
  touchPoints.stageWidth = 400;
  touchPoints.stageHeight = 200;
  
  touchPoints.tips = new Array(10);
  touchPoints.labels = new Array(10);
  
  touchPoints.stage = new Kinetic.Stage({
    container: 'stage',
    width: touchPoints.stageWidth,
    height: touchPoints.stageHeight
  });

  touchPoints.leap = new Leap.Controller();
  touchPoints.leap.connect();
  
  touchPoints.layer = new Kinetic.Layer();
  for(var t = 0; t< 10; t++)
  {
var tip = new Kinetic.Circle({
  x: 239,
  y: 75,
  radius: 20,
  fill: 'green',
  stroke: 'black',
  strokeWidth: 4,
  opacity:.5,
  visible: false
});
touchPoints.tips[t] = tip;
touchPoints.layer.add(tip);

var label = new Kinetic.Text({
    text: 'bar',
    fontSize: 15,
    visible: false,
    fill: 'black'
});
touchPoints.labels[t] = label;
touchPoints.layer.add(label);
    } 

  // add the layer to the stage
  touchPoints.stage.add(touchPoints.layer);
  
  touchPoints.anim = new Kinetic.Animation(function(frame) {
    var time = frame.time,
  timeDiff = frame.timeDiff,
  frameRate = frame.frameRate;

    // update stuff
    var tipPointer = 0;
    var leapFrame = touchPoints.leap.frame();
    if(leapFrame.valid)
    {
  var iBox = leapFrame.interactionBox;
  for(var p = 0; p < leapFrame.pointables.length; p++)
  {
      var pointable = leapFrame.pointables[p];
      var pos = iBox.normalizePoint(pointable.tipPosition,true);
      touchPoints.tips[tipPointer].x(pos[0] * touchPoints.stageWidth);
      touchPoints.tips[tipPointer].y(touchPoints.stageHeight - pos[1] * touchPoints.stageHeight);
      touchPoints.tips[tipPointer].visible(true);
      if(pointable.touchZone == "hovering" )
      {
          touchPoints.tips[tipPointer].opacity(.375 - pointable.touchDistance * .2);
          touchPoints.tips[tipPointer].fill('rgb(0,128,0)');
      }
      else if(pointable.touchZone == "touching" )
      {
          touchPoints.tips[tipPointer].opacity(.375 - pointable.touchDistance * .5);
          touchPoints.tips[tipPointer].fill('rgb(128,0,0)');
      }
      else
      {
         touchPoints.tips[tipPointer].opacity(.1);
         touchPoints.tips[tipPointer].fill('rgb(0,0,128)');
      }
      
      touchPoints.labels[tipPointer].text(pointable.touchDistance.toFixed(2));
      touchPoints.labels[tipPointer].x(touchPoints.tips[tipPointer].x() - 15);
      touchPoints.labels[tipPointer].y(touchPoints.tips[tipPointer].y() - 8);
      touchPoints.labels[tipPointer].visible(true);
      if(tipPointer < 9) tipPointer++;
  }
  
  while(tipPointer<=9){
    touchPoints.labels[tipPointer].visible(false);
    touchPoints.tips[tipPointer++].visible(false);
 }
    }
  }, touchPoints.layer);

  touchPoints.anim.start();
</script>
<blockquote>
<div><div class="highlight-csharp"><div class="highlight"><pre><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Windows</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Windows.Input</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Windows.Media</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Windows.Shapes</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Windows.Ink</span><span class="p">;</span>

<span class="k">using</span> <span class="nn">Leap</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">TouchPoints</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">partial</span> <span class="k">class</span> <span class="nc">MainWindow</span> <span class="p">:</span> <span class="n">Window</span>
    <span class="p">{</span>
        <span class="n">Controller</span> <span class="n">leap</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Controller</span><span class="p">();</span>
        <span class="kt">float</span> <span class="n">windowWidth</span> <span class="p">=</span> <span class="m">1400</span><span class="p">;</span>
        <span class="kt">float</span> <span class="n">windowHeight</span> <span class="p">=</span> <span class="m">800</span><span class="p">;</span>
        <span class="n">DrawingAttributes</span> <span class="n">touchIndicator</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DrawingAttributes</span><span class="p">();</span>
        <span class="k">public</span> <span class="nf">MainWindow</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">InitializeComponent</span><span class="p">();</span>
            <span class="n">CompositionTarget</span><span class="p">.</span><span class="n">Rendering</span> <span class="p">+=</span> <span class="n">Update</span><span class="p">;</span>
            <span class="n">touchIndicator</span><span class="p">.</span><span class="n">Width</span> <span class="p">=</span> <span class="m">20</span><span class="p">;</span>
            <span class="n">touchIndicator</span><span class="p">.</span><span class="n">Height</span> <span class="p">=</span> <span class="m">20</span><span class="p">;</span>
            <span class="n">touchIndicator</span><span class="p">.</span><span class="n">StylusTip</span> <span class="p">=</span> <span class="n">StylusTip</span><span class="p">.</span><span class="n">Ellipse</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">protected</span> <span class="k">void</span> <span class="nf">Update</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">paintCanvas</span><span class="p">.</span><span class="n">Strokes</span><span class="p">.</span><span class="n">Clear</span><span class="p">();</span>
            <span class="n">windowWidth</span> <span class="p">=</span> <span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="k">this</span><span class="p">.</span><span class="n">Width</span><span class="p">;</span>
            <span class="n">windowHeight</span> <span class="p">=</span> <span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="k">this</span><span class="p">.</span><span class="n">Height</span><span class="p">;</span>

            <span class="n">Leap</span><span class="p">.</span><span class="n">Frame</span> <span class="n">frame</span> <span class="p">=</span> <span class="n">leap</span><span class="p">.</span><span class="n">Frame</span><span class="p">();</span> 
            <span class="n">InteractionBox</span> <span class="n">interactionBox</span> <span class="p">=</span> <span class="n">leap</span><span class="p">.</span><span class="n">Frame</span><span class="p">().</span><span class="n">InteractionBox</span><span class="p">;</span>

            <span class="k">foreach</span><span class="p">(</span><span class="n">Pointable</span> <span class="n">pointable</span> <span class="k">in</span> <span class="n">leap</span><span class="p">.</span><span class="n">Frame</span><span class="p">().</span><span class="n">Pointables</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">Leap</span><span class="p">.</span><span class="n">Vector</span> <span class="n">normalizedPosition</span> <span class="p">=</span> 
                    <span class="n">interactionBox</span><span class="p">.</span><span class="n">NormalizePoint</span><span class="p">(</span><span class="n">pointable</span><span class="p">.</span><span class="n">StabilizedTipPosition</span><span class="p">);</span>
                <span class="kt">float</span> <span class="n">tx</span> <span class="p">=</span> <span class="n">normalizedPosition</span><span class="p">.</span><span class="n">x</span> <span class="p">*</span> <span class="n">windowWidth</span><span class="p">;</span>
                <span class="kt">float</span> <span class="n">ty</span> <span class="p">=</span> <span class="n">windowHeight</span> <span class="p">-</span> <span class="n">normalizedPosition</span><span class="p">.</span><span class="n">y</span> <span class="p">*</span> <span class="n">windowHeight</span><span class="p">;</span>

                <span class="kt">int</span> <span class="n">alpha</span> <span class="p">=</span> <span class="m">255</span><span class="p">;</span>
                <span class="k">if</span><span class="p">(</span><span class="n">pointable</span><span class="p">.</span><span class="n">TouchDistance</span> <span class="p">&gt;</span> <span class="m">0</span> <span class="p">&amp;&amp;</span> <span class="n">pointable</span><span class="p">.</span><span class="n">TouchZone</span> <span class="p">!=</span> <span class="n">Pointable</span><span class="p">.</span><span class="n">Zone</span><span class="p">.</span><span class="n">ZONENONE</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">alpha</span> <span class="p">=</span> <span class="m">255</span> <span class="p">-</span> <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="m">255</span> <span class="p">*</span> <span class="n">pointable</span><span class="p">.</span><span class="n">TouchDistance</span><span class="p">);</span>
                    <span class="n">touchIndicator</span><span class="p">.</span><span class="n">Color</span> <span class="p">=</span> <span class="n">Color</span><span class="p">.</span><span class="n">FromArgb</span><span class="p">((</span><span class="kt">byte</span><span class="p">)</span><span class="n">alpha</span><span class="p">,</span> <span class="m">0</span><span class="n">x0</span><span class="p">,</span> <span class="m">0</span><span class="n">xff</span><span class="p">,</span> <span class="m">0</span><span class="n">x0</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="nf">if</span><span class="p">(</span><span class="n">pointable</span><span class="p">.</span><span class="n">TouchDistance</span> <span class="p">&lt;=</span> <span class="m">0</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">alpha</span> <span class="p">=</span> <span class="p">-(</span><span class="kt">int</span><span class="p">)(</span><span class="m">255</span> <span class="p">*</span> <span class="n">pointable</span><span class="p">.</span><span class="n">TouchDistance</span><span class="p">);</span>
                    <span class="n">touchIndicator</span><span class="p">.</span><span class="n">Color</span> <span class="p">=</span> <span class="n">Color</span><span class="p">.</span><span class="n">FromArgb</span><span class="p">((</span><span class="kt">byte</span><span class="p">)</span><span class="n">alpha</span><span class="p">,</span> <span class="m">0</span><span class="n">xff</span><span class="p">,</span> <span class="m">0</span><span class="n">x0</span><span class="p">,</span> <span class="m">0</span><span class="n">x0</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="k">else</span>
                <span class="p">{</span>
                    <span class="n">alpha</span> <span class="p">=</span> <span class="m">50</span><span class="p">;</span>
                    <span class="n">touchIndicator</span><span class="p">.</span><span class="n">Color</span> <span class="p">=</span> <span class="n">Color</span><span class="p">.</span><span class="n">FromArgb</span><span class="p">((</span><span class="kt">byte</span><span class="p">)</span><span class="n">alpha</span><span class="p">,</span> <span class="m">0</span><span class="n">x0</span><span class="p">,</span> <span class="m">0</span><span class="n">x0</span><span class="p">,</span> <span class="m">0</span><span class="n">xff</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="n">StylusPoint</span> <span class="n">touchPoint</span> <span class="p">=</span> <span class="k">new</span> <span class="n">StylusPoint</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">);</span>
                <span class="n">StylusPointCollection</span> <span class="n">tips</span> <span class="p">=</span> 
                    <span class="k">new</span> <span class="nf">StylusPointCollection</span><span class="p">(</span><span class="k">new</span> <span class="n">StylusPoint</span><span class="p">[]</span> <span class="p">{</span> <span class="n">touchPoint</span> <span class="p">});</span>
                <span class="n">Stroke</span> <span class="n">touchStroke</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Stroke</span><span class="p">(</span><span class="n">tips</span><span class="p">,</span> <span class="n">touchIndicator</span><span class="p">);</span>
                <span class="n">paintCanvas</span><span class="p">.</span><span class="n">Strokes</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">touchStroke</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="p">&lt;</span><span class="n">Window</span> <span class="n">x</span><span class="p">:</span><span class="n">Class</span><span class="p">=</span><span class="s">&quot;TouchPoints.MainWindow&quot;</span>
        <span class="n">xmlns</span><span class="p">=</span><span class="s">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span>
        <span class="n">xmlns</span><span class="p">:</span><span class="n">x</span><span class="p">=</span><span class="s">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span>
        <span class="n">Title</span><span class="p">=</span><span class="s">&quot;MainWindow&quot;</span> <span class="n">Height</span><span class="p">=</span><span class="s">&quot;350&quot;</span> <span class="n">Width</span><span class="p">=</span><span class="s">&quot;525&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="n">Grid</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="n">InkPresenter</span> <span class="n">Name</span><span class="p">=</span><span class="s">&quot;paintCanvas&quot;</span><span class="p">&gt;&lt;/</span><span class="n">InkPresenter</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="n">Grid</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="n">Window</span><span class="p">&gt;</span>
</pre></div>
</div>
</div></blockquote>
<p>The example uses Microsoft WPF, but the Leap Motion-related code is applicable to all C# projects.</p>
</div>
</div>


           <!-- get_disqus_sso -->
      </div>
      <div id="sidebar" class="col-md-3">
        <div class="well-sidebar" data-offset-top="188">
          <ul>
            <li><a href="../index.html" title="Home">Unity Docs (v2.3)</a></li>
          </ul><ul>
<li class="toctree-l1"><a class="reference internal" href="../unity/Unity_Overview.html">Unity Plugin Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unity/Unity_Image_Hand.html">Getting Started With the Image Hand Assets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unity/Unity_Hand_Assets.html">Hand Assets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unity/Unity_Widgets.html">Widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unity/Unity_Classes.html">Unity Script Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/Leap_Classes.html">C# API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../practices/Leap_Practices.html">Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="Leap_Guides.html">Application Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../supplements/Leap_Supplements.html">Appendices</a></li>
</ul>


        </div>
      </div>
        
    </div>
  </div>
</div>
<!--


<footer>
  <div id="footer" class="container">
    <div class="container">
      <div class="copyright">
        <span>Copyright &copy; 2012 - 2014, Leap Motion, Inc.</span>
      </div>
    </div>
  </div>
</footer>
  </body>
</html>